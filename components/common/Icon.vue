<template>
  <component
    :is="resolvedIcon"
    v-bind="$attrs"
  />
</template>

<script setup lang="ts">
import { computed } from 'vue'
import type { Component } from 'vue'
import {
  AlertCircle,
  AlertTriangle,
  Apple,
  ArrowLeft,
  ArrowRight,
  ArrowUpRight,
  Award,
  BadgeCheck,
  BadgeDollarSign,
  Ban,
  Banknote,
  BarChart2,
  Bell,
  Box,
  Boxes,
  Briefcase,
  Building2,
  CalendarDays,
  Camera,
  Check,
  CheckCircle2,
  ChevronDown,
  ChevronLeft,
  ChevronRight,
  ChevronUp,
  ChevronsUpDown,
  CircleHelp,
  CircleX,
  ClipboardList,
  Clock,
  CreditCard,
  Euro,
  Eye,
  Filter,
  FlaskConical,
  Gem,
  Grape,
  Gift,
  Globe2,
  Hand,
  Headphones,
  Heart,
  Home,
  Image,
  Info,
  Key,
  Landmark,
  LayoutDashboard,
  Leaf,
  LifeBuoy,
  Lightbulb,
  Loader2,
  Lock,
  LogIn,
  LogOut,
  MapPin,
  Megaphone,
  Menu,
  MessageCircle,
  Minus,
  Monitor,
  MoreVertical,
  MousePointerClick,
  Package,
  Palette,
  PanelsTopLeft,
  Pause,
  Pencil,
  Phone,
  Play,
  Plus,
  Radar,
  RefreshCcw,
  RotateCcw,
  Search,
  Send,
  Settings,
  Shield,
  ShieldCheck,
  Shirt,
  ShoppingBag,
  ShoppingCart,
  SlidersHorizontal,
  Smartphone,
  Snowflake,
  Sparkles,
  SquarePen,
  Star,
  Tag,
  Trash2,
  TrendingUp,
  Truck,
  User,
  UserPlus,
  Users,
  Utensils,
  Wallet,
  Wine,
  Wrench,
  X,
  Zap,
} from 'lucide-vue-next'

const props = defineProps<{ name: string }>()

const ICONS: Record<string, Component> = {
  'alert-circle': AlertCircle,
  'alert-triangle': AlertTriangle,
  'apple': Apple,
  'arrow-left': ArrowLeft,
  'arrow-right': ArrowRight,
  'arrow-trending-up': TrendingUp,
  'arrow-up-right': ArrowUpRight,
  'arrow-path': RefreshCcw,
  'arrow-right-on-rectangle': LogOut,
  'arrow-left-on-rectangle': LogIn,
  'award': Award,
  'banknote': Banknote,
  'banknotes': Banknote,
  'bar-chart-2': BarChart2,
  'chart-bar': BarChart2,
  'badge-check': BadgeCheck,
  'badge-dollar-sign': BadgeDollarSign,
  'ban': Ban,
  'bell': Bell,
  'box': Box,
  'boxes': Boxes,
  'building-2': Building2,
  'building-library': Building2,
  'calendar-days': CalendarDays,
  'camera': Camera,
  'check': Check,
  'check-badge': BadgeCheck,
  'check-circle': CheckCircle2,
  'check-circle-2': CheckCircle2,
  'chevron-down': ChevronDown,
  'chevron-left': ChevronLeft,
  'chevron-right': ChevronRight,
  'chevron-up': ChevronUp,
  'chevrons-up-down': ChevronsUpDown,
  'circle-help': CircleHelp,
  'question-mark-circle': CircleHelp,
  'circle-x': CircleX,
  'x-circle': CircleX,
  'clipboard-document': ClipboardList,
  'clipboard-list': ClipboardList,
  'clock': Clock,
  'credit-card': CreditCard,
  'cube': Box,
  'cube-transparent': Boxes,
  'cursor-click': MousePointerClick,
  'currency-euro': Euro,
  'device-phone-mobile': Smartphone,
  'ellipsis-vertical': MoreVertical,
  'exclamation-circle': AlertCircle,
  'eye': Eye,
  'filter': Filter,
  'funnel': Filter,
  'flask-conical': FlaskConical,
  'beaker': FlaskConical,
  'gem': Gem,
  'jewelry': Gem,
  'gift': Gift,
  'gift-top': Gift,
  'globe-2': Globe2,
  'globe-alt': Globe2,
  'grape': Grape,
  'hand': Hand,
  'hand-raised': Hand,
  'headphones': Headphones,
  'heart': Heart,
  'home': Home,
  'information-circle': Info,
  'info': Info,
  'key': Key,
  'landmark': Landmark,
  'layout-dashboard': LayoutDashboard,
  'leaf': Leaf,
  'life-buoy': LifeBuoy,
  'light-bulb': Lightbulb,
  'lightbulb': Lightbulb,
  'loader-2': Loader2,
  'lock': Lock,
  'lock-closed': Lock,
  'log-in': LogIn,
  'log-out': LogOut,
  'magnifying-glass': Search,
  'map-pin': MapPin,
  'package': Package,
  'palette': Palette,
  'art': Palette,
  'megaphone': Megaphone,
  'menu': Menu,
  'bars-3': Menu,
  'minus': Minus,
  'monitor': Monitor,
  'more-vertical': MoreVertical,
  'paper-airplane': Send,
  'pause': Pause,
  'pencil': Pencil,
  'pencil-square': SquarePen,
  'phone': Phone,
  'play': Play,
  'plus': Plus,
  'question-circle': CircleHelp,
  'radar': Radar,
  'refresh-ccw': RefreshCcw,
  'rotate-ccw': RotateCcw,
  'arrow-path-refresh': RefreshCcw,
  'search': Search,
  'send': Send,
  'settings': Settings,
  'shield': Shield,
  'shield-check': ShieldCheck,
  'shirt': Shirt,
  'textile': Shirt,
  'clothing': Shirt,
  'shopping-bag': ShoppingBag,
  'shopping-cart': ShoppingCart,
  'sliders-horizontal': SlidersHorizontal,
  'smartphone': Smartphone,
  'sparkles': Sparkles,
  'squares-2x2': PanelsTopLeft,
  'panels-top-left': PanelsTopLeft,
  'square-pen': SquarePen,
  'star': Star,
  'tag': Tag,
  'trash-2': Trash2,
  'trending-up': TrendingUp,
  'triangle-alert': AlertTriangle,
  'truck': Truck,
  'user': User,
  'user-plus': UserPlus,
  'users': Users,
  'utensils': Utensils,
  'food': Utensils,
  'cutlery': Utensils,
  'wallet': Wallet,
  'wine': Wine,
  'wine-glass': Wine,
  'wrench': Wrench,
  'x': X,
  'x-mark': X,
  'image': Image,
  'photo': Image,
  'alert-octagon': AlertTriangle,
  'alert': AlertTriangle,
  'zap': Zap,
  'bolt': Zap,
  'lightning': Zap,
  'snowflake': Snowflake,
  'message-circle': MessageCircle,
  'chat': MessageCircle,
  'briefcase': Briefcase,
  'luggage': Briefcase,
}

const fallbackIcon = CircleHelp

const resolvedIcon = computed<Component>(() => {
  const raw = props.name?.trim()
  if (!raw) {
    console.warn('[Icon] Empty icon name provided')
    return fallbackIcon
  }

  let key = raw.replace(/\s+/g, '-').replace(/_/g, '-').toLowerCase()

  if (key.startsWith('simple-icons:')) {
    const icon = ICONS[key]
    if (!icon) {
      console.error(`[Icon] Icon not found: "${props.name}" (resolved key: "${key}")`)
      if (import.meta.dev) {
        console.warn('[Icon] Available simple-icons:', Object.keys(ICONS).filter(k => k.startsWith('simple-icons:')).join(', '))
      }
    }
    return icon ?? fallbackIcon
  }

  key = key
    .replace(/^lucide:/, '')
    .replace(/^heroicons:/, '')

  const icon = ICONS[key]
  if (!icon) {
    console.error(`[Icon] Icon not found: "${props.name}" (resolved key: "${key}")`)
    if (import.meta.dev) {
      console.warn('[Icon] Did you mean one of these?', Object.keys(ICONS).filter(k => k.includes(key.slice(0, 3))).slice(0, 5))
    }
  }
  return icon ?? fallbackIcon
})
</script>
