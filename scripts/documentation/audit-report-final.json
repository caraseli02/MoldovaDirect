{
  "summary": {
    "totalFiles": 320,
    "byCategory": {
      "tutorial": 5,
      "how-to": 76,
      "reference": 86,
      "explanation": 40,
      "project": 10,
      "archive": 103,
      "uncategorized": 0
    },
    "duplicates": 26,
    "gaps": 13
  },
  "details": {
    "inventory": {
      "files": [
        {
          "path": "docs/CHANGELOG.md",
          "name": "CHANGELOG.md",
          "size": 18707,
          "lastModified": "2025-11-20T09:01:57.306Z",
          "category": "project",
          "contentLength": 18433
        },
        {
          "path": "docs/CODEBASE_AUDIT_REPORT.md",
          "name": "CODEBASE_AUDIT_REPORT.md",
          "size": 11617,
          "lastModified": "2026-01-14T21:35:39.882Z",
          "category": "explanation",
          "contentLength": 11553
        },
        {
          "path": "docs/MVP_ASSESSMENT_REPORT.md",
          "name": "MVP_ASSESSMENT_REPORT.md",
          "size": 8878,
          "lastModified": "2026-01-06T15:49:37.091Z",
          "category": "reference",
          "contentLength": 8778
        },
        {
          "path": "docs/NUXT3_LANDING_PAGES_RESEARCH.md",
          "name": "NUXT3_LANDING_PAGES_RESEARCH.md",
          "size": 54879,
          "lastModified": "2025-11-09T17:52:02.974Z",
          "category": "reference",
          "contentLength": 54735
        },
        {
          "path": "docs/NUXT3_PRODUCT_PAGE_DOCUMENTATION.md",
          "name": "NUXT3_PRODUCT_PAGE_DOCUMENTATION.md",
          "size": 37397,
          "lastModified": "2025-11-09T17:52:02.974Z",
          "category": "reference",
          "contentLength": 37363
        },
        {
          "path": "docs/QUICK_REFERENCE_PRODUCT_PAGES.md",
          "name": "QUICK_REFERENCE_PRODUCT_PAGES.md",
          "size": 7322,
          "lastModified": "2025-11-09T17:52:02.974Z",
          "category": "reference",
          "contentLength": 7302
        },
        {
          "path": "docs/README.md",
          "name": "README.md",
          "size": 9434,
          "lastModified": "2026-01-14T21:35:39.882Z",
          "category": "explanation",
          "contentLength": 9338
        },
        {
          "path": "docs/analysis/LOCALSTORAGE-PAGES-VERIFICATION.md",
          "name": "LOCALSTORAGE-PAGES-VERIFICATION.md",
          "size": 8957,
          "lastModified": "2025-12-04T10:27:33.818Z",
          "category": "reference",
          "contentLength": 8735
        },
        {
          "path": "docs/analysis/LOCALSTORAGE-PROBLEM-DEEP-DIVE.md",
          "name": "LOCALSTORAGE-PROBLEM-DEEP-DIVE.md",
          "size": 25306,
          "lastModified": "2025-12-04T10:27:33.818Z",
          "category": "reference",
          "contentLength": 23674
        },
        {
          "path": "docs/analysis/LOCALSTORAGE-SECURITY-AUDIT.md",
          "name": "LOCALSTORAGE-SECURITY-AUDIT.md",
          "size": 9958,
          "lastModified": "2025-12-04T10:27:33.819Z",
          "category": "reference",
          "contentLength": 9830
        },
        {
          "path": "docs/analysis/SSR-SAFETY-VERIFICATION.md",
          "name": "SSR-SAFETY-VERIFICATION.md",
          "size": 11012,
          "lastModified": "2025-12-04T10:27:33.819Z",
          "category": "reference",
          "contentLength": 10818
        },
        {
          "path": "docs/api/README.md",
          "name": "README.md",
          "size": 9944,
          "lastModified": "2025-12-04T10:27:33.820Z",
          "category": "reference",
          "contentLength": 9944
        },
        {
          "path": "docs/architecture/ACCESSIBILITY_REFACTORING_PLAN.md",
          "name": "ACCESSIBILITY_REFACTORING_PLAN.md",
          "size": 26159,
          "lastModified": "2025-11-20T09:01:57.307Z",
          "category": "explanation",
          "contentLength": 26155
        },
        {
          "path": "docs/architecture/ADR-001-auth-store-modularization.md",
          "name": "ADR-001-auth-store-modularization.md",
          "size": 6415,
          "lastModified": "2025-11-20T09:01:57.307Z",
          "category": "explanation",
          "contentLength": 6349
        },
        {
          "path": "docs/architecture/ARCHITECTURE_IMPROVEMENT_ROADMAP.md",
          "name": "ARCHITECTURE_IMPROVEMENT_ROADMAP.md",
          "size": 25670,
          "lastModified": "2025-11-05T22:08:50.604Z",
          "category": "explanation",
          "contentLength": 25612
        },
        {
          "path": "docs/architecture/AUTHENTICATION_ARCHITECTURE.md",
          "name": "AUTHENTICATION_ARCHITECTURE.md",
          "size": 5148,
          "lastModified": "2026-01-14T21:41:14.691Z",
          "category": "explanation",
          "contentLength": 5140
        },
        {
          "path": "docs/architecture/CART_SYSTEM_ARCHITECTURE.md",
          "name": "CART_SYSTEM_ARCHITECTURE.md",
          "size": 13457,
          "lastModified": "2026-01-14T21:42:07.687Z",
          "category": "explanation",
          "contentLength": 13453
        },
        {
          "path": "docs/architecture/CHECKOUT_FLOW.md",
          "name": "CHECKOUT_FLOW.md",
          "size": 6123,
          "lastModified": "2025-11-05T22:08:50.605Z",
          "category": "explanation",
          "contentLength": 6108
        },
        {
          "path": "docs/architecture/DOCUMENTATION_UPDATE_2026_01.md",
          "name": "DOCUMENTATION_UPDATE_2026_01.md",
          "size": 7773,
          "lastModified": "2026-01-14T21:43:41.538Z",
          "category": "explanation",
          "contentLength": 7689
        },
        {
          "path": "docs/architecture/MIDDLEWARE_ARCHITECTURE_ANALYSIS.md",
          "name": "MIDDLEWARE_ARCHITECTURE_ANALYSIS.md",
          "size": 20281,
          "lastModified": "2025-12-04T10:27:33.820Z",
          "category": "explanation",
          "contentLength": 20175
        },
        {
          "path": "docs/architecture/README.md",
          "name": "README.md",
          "size": 4695,
          "lastModified": "2025-11-11T21:50:30.720Z",
          "category": "explanation",
          "contentLength": 4685
        },
        {
          "path": "docs/architecture/asset-caching-strategy.md",
          "name": "asset-caching-strategy.md",
          "size": 9410,
          "lastModified": "2025-11-11T21:50:30.722Z",
          "category": "explanation",
          "contentLength": 9264
        },
        {
          "path": "docs/architecture/build-configuration-review.md",
          "name": "build-configuration-review.md",
          "size": 17727,
          "lastModified": "2025-11-11T21:50:30.723Z",
          "category": "explanation",
          "contentLength": 17607
        },
        {
          "path": "docs/architecture/build-optimization-adr.md",
          "name": "build-optimization-adr.md",
          "size": 12918,
          "lastModified": "2025-11-11T21:50:30.723Z",
          "category": "explanation",
          "contentLength": 12874
        },
        {
          "path": "docs/architecture/build-optimization-plan.md",
          "name": "build-optimization-plan.md",
          "size": 14050,
          "lastModified": "2025-11-11T21:50:30.724Z",
          "category": "explanation",
          "contentLength": 13932
        },
        {
          "path": "docs/architecture/tailwind-v4-build-fix-adr.md",
          "name": "tailwind-v4-build-fix-adr.md",
          "size": 11893,
          "lastModified": "2025-11-11T21:50:30.729Z",
          "category": "explanation",
          "contentLength": 11387
        },
        {
          "path": "docs/architecture/tailwind-v4-compatibility-summary.md",
          "name": "tailwind-v4-compatibility-summary.md",
          "size": 6985,
          "lastModified": "2025-11-11T21:50:30.729Z",
          "category": "explanation",
          "contentLength": 6547
        },
        {
          "path": "docs/architecture/tailwind-v4-implementation-checklist.md",
          "name": "tailwind-v4-implementation-checklist.md",
          "size": 7836,
          "lastModified": "2025-11-11T21:50:30.730Z",
          "category": "explanation",
          "contentLength": 7814
        },
        {
          "path": "docs/architecture/tanstack-table-lazy-loading-implementation.md",
          "name": "tanstack-table-lazy-loading-implementation.md",
          "size": 11691,
          "lastModified": "2025-11-11T21:50:30.730Z",
          "category": "explanation",
          "contentLength": 11603
        },
        {
          "path": "docs/archive/README.md",
          "name": "README.md",
          "size": 1654,
          "lastModified": "2026-01-06T15:49:37.092Z",
          "category": "archive",
          "contentLength": 1652
        },
        {
          "path": "docs/archive/architecture-reviews/ARCHITECTURE_REVIEW_2025_11.md",
          "name": "ARCHITECTURE_REVIEW_2025_11.md",
          "size": 25407,
          "lastModified": "2026-01-14T21:35:39.883Z",
          "category": "explanation",
          "contentLength": 24191
        },
        {
          "path": "docs/archive/cart-fixes/CART_PERSISTENCE_FIX.md",
          "name": "CART_PERSISTENCE_FIX.md",
          "size": 8918,
          "lastModified": "2026-01-06T15:49:37.092Z",
          "category": "archive",
          "contentLength": 8850
        },
        {
          "path": "docs/archive/cart-fixes/CART_SSR_HYDRATION_FIX_V2.md",
          "name": "CART_SSR_HYDRATION_FIX_V2.md",
          "size": 4327,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 4301
        },
        {
          "path": "docs/archive/checkout-fixes/CHECKOUT_BUTTON_ERROR_FINAL_REPORT.md",
          "name": "CHECKOUT_BUTTON_ERROR_FINAL_REPORT.md",
          "size": 9470,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 9458
        },
        {
          "path": "docs/archive/checkout-fixes/FINAL_CHECKOUT_BUTTON_FIX.md",
          "name": "FINAL_CHECKOUT_BUTTON_FIX.md",
          "size": 4275,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 4241
        },
        {
          "path": "docs/archive/checkout-fixes/LOGIN_INVESTIGATION.md",
          "name": "LOGIN_INVESTIGATION.md",
          "size": 5591,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 5573
        },
        {
          "path": "docs/archive/checkout-fixes/add-to-cart-root-cause.md",
          "name": "add-to-cart-root-cause.md",
          "size": 6174,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 6150
        },
        {
          "path": "docs/archive/checkout-fixes/products-page-empty-fix.md",
          "name": "products-page-empty-fix.md",
          "size": 6503,
          "lastModified": "2026-01-06T15:49:37.093Z",
          "category": "archive",
          "contentLength": 6503
        },
        {
          "path": "docs/archive/checkout-fixes/vercel-investigation-report.md",
          "name": "vercel-investigation-report.md",
          "size": 9066,
          "lastModified": "2026-01-06T15:49:37.094Z",
          "category": "archive",
          "contentLength": 8842
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_BEFORE_AFTER_COMPARISON.md",
          "name": "CHECKOUT_BEFORE_AFTER_COMPARISON.md",
          "size": 13293,
          "lastModified": "2026-01-06T15:49:37.094Z",
          "category": "archive",
          "contentLength": 13239
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_INDEX.md",
          "name": "CHECKOUT_SIMPLIFICATION_INDEX.md",
          "size": 13833,
          "lastModified": "2026-01-06T15:49:37.094Z",
          "category": "archive",
          "contentLength": 13649
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_QUICK_REFERENCE.md",
          "name": "CHECKOUT_SIMPLIFICATION_QUICK_REFERENCE.md",
          "size": 8770,
          "lastModified": "2026-01-06T15:49:37.094Z",
          "category": "archive",
          "contentLength": 8612
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md",
          "name": "CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md",
          "size": 11598,
          "lastModified": "2026-01-06T15:49:37.095Z",
          "category": "archive",
          "contentLength": 11598
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_UX_ANALYSIS_SUMMARY.md",
          "name": "CHECKOUT_UX_ANALYSIS_SUMMARY.md",
          "size": 7889,
          "lastModified": "2026-01-06T15:49:37.095Z",
          "category": "archive",
          "contentLength": 7877
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_UX_SIMPLIFICATION_REVIEW.md",
          "name": "CHECKOUT_UX_SIMPLIFICATION_REVIEW.md",
          "size": 15069,
          "lastModified": "2026-01-06T15:49:37.095Z",
          "category": "archive",
          "contentLength": 15047
        },
        {
          "path": "docs/archive/checkout-reviews/CHECKOUT_UX_SUMMARY.md",
          "name": "CHECKOUT_UX_SUMMARY.md",
          "size": 8965,
          "lastModified": "2026-01-06T15:49:37.096Z",
          "category": "archive",
          "contentLength": 8965
        },
        {
          "path": "docs/archive/checkout-reviews/README_CHECKOUT_REVIEW.md",
          "name": "README_CHECKOUT_REVIEW.md",
          "size": 12939,
          "lastModified": "2026-01-06T15:49:37.096Z",
          "category": "archive",
          "contentLength": 12811
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/API_USAGE_GUIDE.md",
          "name": "API_USAGE_GUIDE.md",
          "size": 8726,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "reference",
          "contentLength": 8726
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/COMPLETE.md",
          "name": "COMPLETE.md",
          "size": 7156,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "archive",
          "contentLength": 7054
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/FIXES_APPLIED.md",
          "name": "FIXES_APPLIED.md",
          "size": 4908,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "archive",
          "contentLength": 4866
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/MIGRATION_GUIDE.md",
          "name": "MIGRATION_GUIDE.md",
          "size": 9372,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "archive",
          "contentLength": 9366
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/design.md",
          "name": "design.md",
          "size": 14526,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "archive",
          "contentLength": 14526
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/requirements.md",
          "name": "requirements.md",
          "size": 5607,
          "lastModified": "2026-01-06T15:49:37.097Z",
          "category": "archive",
          "contentLength": 5607
        },
        {
          "path": "docs/archive/completed-specs/customer-order-history/tasks.md",
          "name": "tasks.md",
          "size": 9164,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "archive",
          "contentLength": 9164
        },
        {
          "path": "docs/archive/completed-specs/order-status-updates/COMPLETE.md",
          "name": "COMPLETE.md",
          "size": 11504,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "archive",
          "contentLength": 11352
        },
        {
          "path": "docs/archive/completed-specs/order-status-updates/design.md",
          "name": "design.md",
          "size": 20927,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "archive",
          "contentLength": 20925
        },
        {
          "path": "docs/archive/completed-specs/order-status-updates/requirements.md",
          "name": "requirements.md",
          "size": 7543,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "archive",
          "contentLength": 7543
        },
        {
          "path": "docs/archive/completed-specs/order-status-updates/tasks.md",
          "name": "tasks.md",
          "size": 11174,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "archive",
          "contentLength": 11174
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/FINAL_STATUS.md",
          "name": "FINAL_STATUS.md",
          "size": 5530,
          "lastModified": "2026-01-06T15:49:37.098Z",
          "category": "project",
          "contentLength": 5486
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/RECURSIVE_UPDATE_FIX.md",
          "name": "RECURSIVE_UPDATE_FIX.md",
          "size": 6630,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 6606
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/VERIFICATION_REPORT.md",
          "name": "VERIFICATION_REPORT.md",
          "size": 10247,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 10103
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/design.md",
          "name": "design.md",
          "size": 8582,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 8528
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/requirements.md",
          "name": "requirements.md",
          "size": 3471,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 3471
        },
        {
          "path": "docs/archive/completed-specs/shipping-step-refactor/tasks.md",
          "name": "tasks.md",
          "size": 2522,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 2522
        },
        {
          "path": "docs/archive/fix-summaries/CART-LOCK-FIX-SUMMARY.md",
          "name": "CART-LOCK-FIX-SUMMARY.md",
          "size": 6780,
          "lastModified": "2026-01-14T21:35:39.884Z",
          "category": "archive",
          "contentLength": 6538
        },
        {
          "path": "docs/archive/fix-summaries/CART_COOKIE_FIX_SUMMARY.md",
          "name": "CART_COOKIE_FIX_SUMMARY.md",
          "size": 4293,
          "lastModified": "2026-01-14T21:35:39.886Z",
          "category": "archive",
          "contentLength": 4263
        },
        {
          "path": "docs/archive/fix-summaries/CHANGES_SUMMARY.md",
          "name": "CHANGES_SUMMARY.md",
          "size": 8057,
          "lastModified": "2026-01-14T21:35:39.886Z",
          "category": "archive",
          "contentLength": 7976
        },
        {
          "path": "docs/archive/fix-summaries/CHECKOUT_FIXES_SUMMARY.md",
          "name": "CHECKOUT_FIXES_SUMMARY.md",
          "size": 7024,
          "lastModified": "2026-01-14T21:35:39.886Z",
          "category": "archive",
          "contentLength": 6988
        },
        {
          "path": "docs/archive/fixes/ARCHITECTURAL_FIXES_SUMMARY.md",
          "name": "ARCHITECTURAL_FIXES_SUMMARY.md",
          "size": 18686,
          "lastModified": "2026-01-06T15:49:37.099Z",
          "category": "archive",
          "contentLength": 17884
        },
        {
          "path": "docs/archive/fixes/ERROR_HANDLING_AUDIT.md",
          "name": "ERROR_HANDLING_AUDIT.md",
          "size": 4216,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 4190
        },
        {
          "path": "docs/archive/fixes/ERROR_HANDLING_FIXES.md",
          "name": "ERROR_HANDLING_FIXES.md",
          "size": 16424,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 16404
        },
        {
          "path": "docs/archive/fixes/FINAL_OPTIMIZATION_SUMMARY.md",
          "name": "FINAL_OPTIMIZATION_SUMMARY.md",
          "size": 10600,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 10488
        },
        {
          "path": "docs/archive/fixes/MIDDLEWARE_FIX_SUMMARY.md",
          "name": "MIDDLEWARE_FIX_SUMMARY.md",
          "size": 2879,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 2849
        },
        {
          "path": "docs/archive/fixes/RACE_CONDITION_FIX_SUMMARY.md",
          "name": "RACE_CONDITION_FIX_SUMMARY.md",
          "size": 12426,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 12388
        },
        {
          "path": "docs/archive/fixes/README.md",
          "name": "README.md",
          "size": 1698,
          "lastModified": "2026-01-06T15:49:37.100Z",
          "category": "archive",
          "contentLength": 1698
        },
        {
          "path": "docs/archive/fixes/SSR_FIX_SUMMARY.md",
          "name": "SSR_FIX_SUMMARY.md",
          "size": 3819,
          "lastModified": "2026-01-06T15:49:37.101Z",
          "category": "archive",
          "contentLength": 3793
        },
        {
          "path": "docs/archive/fixes/VISUAL_TEST_RESULTS.md",
          "name": "VISUAL_TEST_RESULTS.md",
          "size": 9215,
          "lastModified": "2026-01-06T15:49:37.101Z",
          "category": "archive",
          "contentLength": 9127
        },
        {
          "path": "docs/archive/fixes/admin-fixes/CLEAN-CODE-REVIEW.md",
          "name": "CLEAN-CODE-REVIEW.md",
          "size": 12279,
          "lastModified": "2026-01-06T15:49:37.101Z",
          "category": "archive",
          "contentLength": 12131
        },
        {
          "path": "docs/archive/fixes/admin-fixes/ISSUES-AND-SOLUTIONS.md",
          "name": "ISSUES-AND-SOLUTIONS.md",
          "size": 8969,
          "lastModified": "2026-01-06T15:49:37.101Z",
          "category": "archive",
          "contentLength": 8903
        },
        {
          "path": "docs/archive/meta-old/DOCUMENTATION_SUMMARY.md",
          "name": "DOCUMENTATION_SUMMARY.md",
          "size": 9297,
          "lastModified": "2026-01-06T15:49:37.102Z",
          "category": "archive",
          "contentLength": 9201
        },
        {
          "path": "docs/archive/meta-old/DOCUMENTATION_UPDATES_LOG.md",
          "name": "DOCUMENTATION_UPDATES_LOG.md",
          "size": 6074,
          "lastModified": "2026-01-06T15:49:37.102Z",
          "category": "archive",
          "contentLength": 6052
        },
        {
          "path": "docs/archive/meta-old/DOCUMENTATION_UPDATE_2025-11-01.md",
          "name": "DOCUMENTATION_UPDATE_2025-11-01.md",
          "size": 6552,
          "lastModified": "2026-01-06T15:49:37.102Z",
          "category": "archive",
          "contentLength": 6530
        },
        {
          "path": "docs/archive/meta-old/MVP_PRIORITY_ORDER.md",
          "name": "MVP_PRIORITY_ORDER.md",
          "size": 11617,
          "lastModified": "2026-01-06T15:49:37.102Z",
          "category": "archive",
          "contentLength": 11487
        },
        {
          "path": "docs/archive/migrations/BUTTON_MIGRATION_AUDIT.md",
          "name": "BUTTON_MIGRATION_AUDIT.md",
          "size": 14725,
          "lastModified": "2026-01-06T15:49:37.102Z",
          "category": "archive",
          "contentLength": 14685
        },
        {
          "path": "docs/archive/migrations/SHADCN_MIGRATION.md",
          "name": "SHADCN_MIGRATION.md",
          "size": 7516,
          "lastModified": "2026-01-06T15:49:37.103Z",
          "category": "archive",
          "contentLength": 7456
        },
        {
          "path": "docs/archive/phase-docs/phase1-results.md",
          "name": "phase1-results.md",
          "size": 4674,
          "lastModified": "2026-01-06T15:49:37.103Z",
          "category": "archive",
          "contentLength": 4624
        },
        {
          "path": "docs/archive/phase-docs/phase2-results.md",
          "name": "phase2-results.md",
          "size": 11296,
          "lastModified": "2026-01-06T15:49:37.103Z",
          "category": "archive",
          "contentLength": 11122
        },
        {
          "path": "docs/archive/phase-docs/phase3-results.md",
          "name": "phase3-results.md",
          "size": 16392,
          "lastModified": "2026-01-06T15:49:37.103Z",
          "category": "archive",
          "contentLength": 16120
        },
        {
          "path": "docs/archive/phase-docs/phase4-analysis.md",
          "name": "phase4-analysis.md",
          "size": 2424,
          "lastModified": "2026-01-06T15:49:37.103Z",
          "category": "archive",
          "contentLength": 2400
        },
        {
          "path": "docs/archive/phase-docs/phase4-honest-assessment.md",
          "name": "phase4-honest-assessment.md",
          "size": 4223,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 4197
        },
        {
          "path": "docs/archive/phase-docs/phase4-optimized-results.md",
          "name": "phase4-optimized-results.md",
          "size": 6061,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 6027
        },
        {
          "path": "docs/archive/reports/ASSET_OPTIMIZATION_SUMMARY.md",
          "name": "ASSET_OPTIMIZATION_SUMMARY.md",
          "size": 11752,
          "lastModified": "2026-01-14T21:35:39.886Z",
          "category": "archive",
          "contentLength": 11634
        },
        {
          "path": "docs/archive/reports/BUILD_SUCCESS_REPORT.md",
          "name": "BUILD_SUCCESS_REPORT.md",
          "size": 10763,
          "lastModified": "2026-01-14T21:35:39.886Z",
          "category": "archive",
          "contentLength": 10649
        },
        {
          "path": "docs/archive/reports/CODE_QUALITY_ANALYSIS_2025-11-01.md",
          "name": "CODE_QUALITY_ANALYSIS_2025-11-01.md",
          "size": 32462,
          "lastModified": "2026-01-14T21:35:39.887Z",
          "category": "archive",
          "contentLength": 32328
        },
        {
          "path": "docs/archive/reports/TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md",
          "name": "TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md",
          "size": 9395,
          "lastModified": "2026-01-14T21:35:39.887Z",
          "category": "archive",
          "contentLength": 9313
        },
        {
          "path": "docs/archive/reports/prerender-optimization-report.md",
          "name": "prerender-optimization-report.md",
          "size": 7857,
          "lastModified": "2026-01-14T21:35:39.887Z",
          "category": "archive",
          "contentLength": 7843
        },
        {
          "path": "docs/archive/research/hero-section/hero-demo-images.md",
          "name": "hero-demo-images.md",
          "size": 5642,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 5616
        },
        {
          "path": "docs/archive/research/hero-section/hero-image-requirements.md",
          "name": "hero-image-requirements.md",
          "size": 6834,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 6792
        },
        {
          "path": "docs/archive/research/hero-section/hero-section-best-practices-2025.md",
          "name": "hero-section-best-practices-2025.md",
          "size": 29712,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 29698
        },
        {
          "path": "docs/archive/research/hero-section/hero-section-implementation-guide.md",
          "name": "hero-section-implementation-guide.md",
          "size": 28658,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 28354
        },
        {
          "path": "docs/archive/research/hero-section/hero-section-technical-implementation.md",
          "name": "hero-section-technical-implementation.md",
          "size": 59767,
          "lastModified": "2026-01-06T15:49:37.104Z",
          "category": "archive",
          "contentLength": 59745
        },
        {
          "path": "docs/archive/reviews/CODE_REVIEW_2025.md",
          "name": "CODE_REVIEW_2025.md",
          "size": 21962,
          "lastModified": "2026-01-14T21:35:39.888Z",
          "category": "archive",
          "contentLength": 21896
        },
        {
          "path": "docs/archive/reviews/DOCUMENTATION_REVIEW_2025-11-27.md",
          "name": "DOCUMENTATION_REVIEW_2025-11-27.md",
          "size": 12548,
          "lastModified": "2026-01-14T21:35:39.888Z",
          "category": "archive",
          "contentLength": 12296
        },
        {
          "path": "docs/archive/reviews/PR_258_ACCESSIBILITY_ARCHITECTURE_REVIEW.md",
          "name": "PR_258_ACCESSIBILITY_ARCHITECTURE_REVIEW.md",
          "size": 28325,
          "lastModified": "2026-01-14T21:35:39.888Z",
          "category": "archive",
          "contentLength": 27964
        },
        {
          "path": "docs/archive/reviews/PR_258_EXECUTIVE_SUMMARY.md",
          "name": "PR_258_EXECUTIVE_SUMMARY.md",
          "size": 8852,
          "lastModified": "2026-01-14T21:35:39.889Z",
          "category": "archive",
          "contentLength": 8828
        },
        {
          "path": "docs/archive/specs/CART_FIXES_SUMMARY.md",
          "name": "CART_FIXES_SUMMARY.md",
          "size": 4125,
          "lastModified": "2026-01-14T21:35:39.889Z",
          "category": "archive",
          "contentLength": 4107
        },
        {
          "path": "docs/archive/specs-legacy/ORIGINAL_REQUIREMENTS.md",
          "name": "ORIGINAL_REQUIREMENTS.md",
          "size": 29308,
          "lastModified": "2026-01-06T15:49:37.105Z",
          "category": "archive",
          "contentLength": 27146
        },
        {
          "path": "docs/archive/specs-legacy/design.md",
          "name": "design.md",
          "size": 12106,
          "lastModified": "2026-01-06T15:49:37.105Z",
          "category": "archive",
          "contentLength": 10491
        },
        {
          "path": "docs/archive/test-reports/visual-regression-20251123/MANUAL_TEST_CHECKLIST.md",
          "name": "MANUAL_TEST_CHECKLIST.md",
          "size": 6907,
          "lastModified": "2026-01-06T15:49:37.106Z",
          "category": "archive",
          "contentLength": 6891
        },
        {
          "path": "docs/archive/test-reports/visual-regression-20251123/README.md",
          "name": "README.md",
          "size": 4699,
          "lastModified": "2026-01-06T15:49:37.106Z",
          "category": "archive",
          "contentLength": 4595
        },
        {
          "path": "docs/archive/test-reports/visual-regression-20251123/TEST_SUMMARY.md",
          "name": "TEST_SUMMARY.md",
          "size": 5110,
          "lastModified": "2026-01-06T15:49:37.106Z",
          "category": "archive",
          "contentLength": 5100
        },
        {
          "path": "docs/archive/test-reports/visual-regression-20251123/VISUAL_REGRESSION_TEST_REPORT.md",
          "name": "VISUAL_REGRESSION_TEST_REPORT.md",
          "size": 11489,
          "lastModified": "2026-01-06T15:49:37.106Z",
          "category": "archive",
          "contentLength": 11418
        },
        {
          "path": "docs/archive/testing/BRANCH_COMPARISON_SUMMARY.md",
          "name": "BRANCH_COMPARISON_SUMMARY.md",
          "size": 7562,
          "lastModified": "2026-01-06T15:49:37.107Z",
          "category": "archive",
          "contentLength": 7518
        },
        {
          "path": "docs/archive/testing/E2E_AUTH_TEST_IMPROVEMENTS.md",
          "name": "E2E_AUTH_TEST_IMPROVEMENTS.md",
          "size": 5612,
          "lastModified": "2026-01-06T15:49:37.107Z",
          "category": "archive",
          "contentLength": 5612
        },
        {
          "path": "docs/archive/testing/E2E_TEST_REVIEW_AND_FIXES.md",
          "name": "E2E_TEST_REVIEW_AND_FIXES.md",
          "size": 19431,
          "lastModified": "2026-01-06T15:49:37.107Z",
          "category": "archive",
          "contentLength": 19084
        },
        {
          "path": "docs/archive/testing/IMPLEMENTATION_SUMMARY.md",
          "name": "IMPLEMENTATION_SUMMARY.md",
          "size": 10411,
          "lastModified": "2026-01-06T15:49:37.107Z",
          "category": "archive",
          "contentLength": 10327
        },
        {
          "path": "docs/archive/testing/PHASE_2_PLAYWRIGHT_CONFIG_SIMPLIFICATION.md",
          "name": "PHASE_2_PLAYWRIGHT_CONFIG_SIMPLIFICATION.md",
          "size": 9327,
          "lastModified": "2026-01-06T15:49:37.107Z",
          "category": "archive",
          "contentLength": 9281
        },
        {
          "path": "docs/archive/testing/PHASE_3_FINAL_CLEANUP.md",
          "name": "PHASE_3_FINAL_CLEANUP.md",
          "size": 14336,
          "lastModified": "2026-01-06T15:49:37.108Z",
          "category": "archive",
          "contentLength": 14196
        },
        {
          "path": "docs/archive/testing/QUICK_START_TESTING_GUIDE.md",
          "name": "QUICK_START_TESTING_GUIDE.md",
          "size": 7948,
          "lastModified": "2026-01-06T15:49:37.108Z",
          "category": "archive",
          "contentLength": 7772
        },
        {
          "path": "docs/archive/testing/SEARCH_PERFORMANCE_VERIFICATION.md",
          "name": "SEARCH_PERFORMANCE_VERIFICATION.md",
          "size": 7883,
          "lastModified": "2026-01-06T15:49:37.108Z",
          "category": "archive",
          "contentLength": 7859
        },
        {
          "path": "docs/archive/testing/TEST_COVERAGE_IMPLEMENTATION.md",
          "name": "TEST_COVERAGE_IMPLEMENTATION.md",
          "size": 8661,
          "lastModified": "2026-01-06T15:49:37.108Z",
          "category": "archive",
          "contentLength": 8557
        },
        {
          "path": "docs/archive/testing/TEST_STATUS_REPORT.md",
          "name": "TEST_STATUS_REPORT.md",
          "size": 7388,
          "lastModified": "2026-01-06T15:49:37.108Z",
          "category": "project",
          "contentLength": 7266
        },
        {
          "path": "docs/archive/testing/checkout/CHECKOUT-TEST-COVERAGE-ANALYSIS.md",
          "name": "CHECKOUT-TEST-COVERAGE-ANALYSIS.md",
          "size": 11951,
          "lastModified": "2026-01-06T15:49:37.109Z",
          "category": "archive",
          "contentLength": 11723
        },
        {
          "path": "docs/archive/testing/checkout/E2E_TEST_FIXES.md",
          "name": "E2E_TEST_FIXES.md",
          "size": 4426,
          "lastModified": "2026-01-06T15:49:37.109Z",
          "category": "archive",
          "contentLength": 4414
        },
        {
          "path": "docs/archive/testing/checkout/END-TO-END-TESTING-COMPLETE.md",
          "name": "END-TO-END-TESTING-COMPLETE.md",
          "size": 12516,
          "lastModified": "2026-01-06T15:49:37.109Z",
          "category": "archive",
          "contentLength": 12316
        },
        {
          "path": "docs/archive/testing/mutation/MUTATION_TESTING_QUICK_REFERENCE.md",
          "name": "MUTATION_TESTING_QUICK_REFERENCE.md",
          "size": 6824,
          "lastModified": "2026-01-06T15:49:37.109Z",
          "category": "archive",
          "contentLength": 6752
        },
        {
          "path": "docs/archive/testing/mutation/MUTATION_TESTING_REPORT.md",
          "name": "MUTATION_TESTING_REPORT.md",
          "size": 17113,
          "lastModified": "2026-01-06T15:49:37.110Z",
          "category": "archive",
          "contentLength": 16931
        },
        {
          "path": "docs/archive/testing/mutation/MUTATION_TESTING_REPORT_ORDER_COMPONENTS.md",
          "name": "MUTATION_TESTING_REPORT_ORDER_COMPONENTS.md",
          "size": 11166,
          "lastModified": "2026-01-06T15:49:37.110Z",
          "category": "archive",
          "contentLength": 11086
        },
        {
          "path": "docs/archive/testing/mutation/MUTATION_TESTING_SUMMARY.md",
          "name": "MUTATION_TESTING_SUMMARY.md",
          "size": 6196,
          "lastModified": "2026-01-06T15:49:37.110Z",
          "category": "archive",
          "contentLength": 6158
        },
        {
          "path": "docs/archive/testing/mutation/mutation-test-report-checkout.md",
          "name": "mutation-test-report-checkout.md",
          "size": 14452,
          "lastModified": "2026-01-06T15:49:37.110Z",
          "category": "archive",
          "contentLength": 14368
        },
        {
          "path": "docs/archive/testing/playwright/E2E_CHECKOUT_BEST_PRACTICES.md",
          "name": "E2E_CHECKOUT_BEST_PRACTICES.md",
          "size": 58410,
          "lastModified": "2026-01-06T15:49:37.110Z",
          "category": "archive",
          "contentLength": 58308
        },
        {
          "path": "docs/archive/testing/playwright/PLAYWRIGHT_BEST_PRACTICES_ANALYSIS.md",
          "name": "PLAYWRIGHT_BEST_PRACTICES_ANALYSIS.md",
          "size": 35070,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "archive",
          "contentLength": 34737
        },
        {
          "path": "docs/archive/vercel-debug/VERCEL_ADD_TO_CART_DEBUG.md",
          "name": "VERCEL_ADD_TO_CART_DEBUG.md",
          "size": 6486,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "archive",
          "contentLength": 6456
        },
        {
          "path": "docs/archive/vercel-debug/VERCEL_ADD_TO_CART_FIX.md",
          "name": "VERCEL_ADD_TO_CART_FIX.md",
          "size": 8464,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "archive",
          "contentLength": 8412
        },
        {
          "path": "docs/archive/vercel-debug/VERCEL_CLIENT_BUNDLES_FIX.md",
          "name": "VERCEL_CLIENT_BUNDLES_FIX.md",
          "size": 7940,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "archive",
          "contentLength": 7868
        },
        {
          "path": "docs/archive/vercel-debug/VERCEL_DEBUG_STEPS.md",
          "name": "VERCEL_DEBUG_STEPS.md",
          "size": 4068,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "archive",
          "contentLength": 4058
        },
        {
          "path": "docs/automation/PROJECT_AUTOMATION_EXPLAINED.md",
          "name": "PROJECT_AUTOMATION_EXPLAINED.md",
          "size": 9916,
          "lastModified": "2025-11-05T22:08:50.605Z",
          "category": "project",
          "contentLength": 9040
        },
        {
          "path": "docs/automation/github-project-automation.md",
          "name": "github-project-automation.md",
          "size": 5865,
          "lastModified": "2025-11-05T22:08:50.605Z",
          "category": "how-to",
          "contentLength": 5843
        },
        {
          "path": "docs/design-inspiration/VISUAL_ANALYSIS.md",
          "name": "VISUAL_ANALYSIS.md",
          "size": 8347,
          "lastModified": "2025-11-09T17:52:02.975Z",
          "category": "explanation",
          "contentLength": 8271
        },
        {
          "path": "docs/development/ACCESSIBILITY_QUICK_REFERENCE.md",
          "name": "ACCESSIBILITY_QUICK_REFERENCE.md",
          "size": 11067,
          "lastModified": "2025-11-20T09:01:57.310Z",
          "category": "explanation",
          "contentLength": 11019
        },
        {
          "path": "docs/development/MILESTONE_QUICK_START.md",
          "name": "MILESTONE_QUICK_START.md",
          "size": 10201,
          "lastModified": "2025-11-13T17:08:41.651Z",
          "category": "how-to",
          "contentLength": 10055
        },
        {
          "path": "docs/development/MILESTONE_STRATEGY.md",
          "name": "MILESTONE_STRATEGY.md",
          "size": 18418,
          "lastModified": "2025-11-13T17:08:41.651Z",
          "category": "reference",
          "contentLength": 18250
        },
        {
          "path": "docs/development/PATTERNS_TO_PRESERVE.md",
          "name": "PATTERNS_TO_PRESERVE.md",
          "size": 19195,
          "lastModified": "2025-11-05T22:08:50.606Z",
          "category": "explanation",
          "contentLength": 18802
        },
        {
          "path": "docs/development/STATIC_ANALYSIS.md",
          "name": "STATIC_ANALYSIS.md",
          "size": 5139,
          "lastModified": "2026-01-06T15:49:37.111Z",
          "category": "reference",
          "contentLength": 5135
        },
        {
          "path": "docs/development/code-cleanup.md",
          "name": "code-cleanup.md",
          "size": 4387,
          "lastModified": "2025-12-04T10:27:33.863Z",
          "category": "reference",
          "contentLength": 4383
        },
        {
          "path": "docs/development/code-conventions.md",
          "name": "code-conventions.md",
          "size": 11736,
          "lastModified": "2025-12-04T10:27:33.863Z",
          "category": "reference",
          "contentLength": 11736
        },
        {
          "path": "docs/development/component-inventory.md",
          "name": "component-inventory.md",
          "size": 6485,
          "lastModified": "2026-01-14T21:35:39.890Z",
          "category": "how-to",
          "contentLength": 6485
        },
        {
          "path": "docs/development/component-modernization-plan.md",
          "name": "component-modernization-plan.md",
          "size": 10974,
          "lastModified": "2026-01-14T21:35:39.890Z",
          "category": "explanation",
          "contentLength": 10958
        },
        {
          "path": "docs/development/structure.md",
          "name": "structure.md",
          "size": 5939,
          "lastModified": "2026-01-06T15:49:37.112Z",
          "category": "reference",
          "contentLength": 5719
        },
        {
          "path": "docs/development/supabase-best-practices.md",
          "name": "supabase-best-practices.md",
          "size": 5103,
          "lastModified": "2025-12-04T10:27:33.864Z",
          "category": "how-to",
          "contentLength": 5097
        },
        {
          "path": "docs/development/tech.md",
          "name": "tech.md",
          "size": 2567,
          "lastModified": "2026-01-06T15:49:37.112Z",
          "category": "how-to",
          "contentLength": 2565
        },
        {
          "path": "docs/development/troubleshooting-components.md",
          "name": "troubleshooting-components.md",
          "size": 3890,
          "lastModified": "2025-11-05T22:08:50.607Z",
          "category": "how-to",
          "contentLength": 3860
        },
        {
          "path": "docs/development/ui-ux-review.md",
          "name": "ui-ux-review.md",
          "size": 5747,
          "lastModified": "2025-11-05T22:08:50.607Z",
          "category": "reference",
          "contentLength": 5733
        },
        {
          "path": "docs/features/AUDIT_LOGGING.md",
          "name": "AUDIT_LOGGING.md",
          "size": 15458,
          "lastModified": "2025-11-05T22:08:50.607Z",
          "category": "reference",
          "contentLength": 15458
        },
        {
          "path": "docs/features/GUEST_CHECKOUT_IMPLEMENTATION.md",
          "name": "GUEST_CHECKOUT_IMPLEMENTATION.md",
          "size": 6971,
          "lastModified": "2025-11-21T12:23:20.945Z",
          "category": "reference",
          "contentLength": 6917
        },
        {
          "path": "docs/features/I18N_CONFIGURATION.md",
          "name": "I18N_CONFIGURATION.md",
          "size": 8863,
          "lastModified": "2025-11-05T22:08:50.607Z",
          "category": "how-to",
          "contentLength": 8796
        },
        {
          "path": "docs/features/LANDING-PAGE-CMS.md",
          "name": "LANDING-PAGE-CMS.md",
          "size": 14243,
          "lastModified": "2025-11-05T22:08:50.607Z",
          "category": "reference",
          "contentLength": 14004
        },
        {
          "path": "docs/features/authentication/AUTH_MIDDLEWARE_TEST_RESULTS.md",
          "name": "AUTH_MIDDLEWARE_TEST_RESULTS.md",
          "size": 5966,
          "lastModified": "2025-11-05T22:08:50.608Z",
          "category": "reference",
          "contentLength": 5896
        },
        {
          "path": "docs/features/authentication/MFA_IMPLEMENTATION.md",
          "name": "MFA_IMPLEMENTATION.md",
          "size": 10045,
          "lastModified": "2025-11-05T22:08:50.608Z",
          "category": "how-to",
          "contentLength": 10027
        },
        {
          "path": "docs/features/authentication/auth-flow-review.md",
          "name": "auth-flow-review.md",
          "size": 2899,
          "lastModified": "2025-11-05T22:08:50.608Z",
          "category": "how-to",
          "contentLength": 2899
        },
        {
          "path": "docs/features/authentication/authentication-translations.md",
          "name": "authentication-translations.md",
          "size": 12879,
          "lastModified": "2025-11-05T22:08:50.608Z",
          "category": "how-to",
          "contentLength": 12839
        },
        {
          "path": "docs/features/cart/ATOMIC_INVENTORY_FIX.md",
          "name": "ATOMIC_INVENTORY_FIX.md",
          "size": 10003,
          "lastModified": "2025-11-05T22:08:50.609Z",
          "category": "reference",
          "contentLength": 9905
        },
        {
          "path": "docs/features/cart/CART_ANALYTICS.md",
          "name": "CART_ANALYTICS.md",
          "size": 9339,
          "lastModified": "2025-11-05T22:08:50.609Z",
          "category": "reference",
          "contentLength": 9339
        },
        {
          "path": "docs/features/cart/CART_LOCKING.md",
          "name": "CART_LOCKING.md",
          "size": 11903,
          "lastModified": "2025-11-05T22:08:50.609Z",
          "category": "reference",
          "contentLength": 11903
        },
        {
          "path": "docs/features/landing-videos/IMPLEMENTATION.md",
          "name": "IMPLEMENTATION.md",
          "size": 7642,
          "lastModified": "2026-01-06T15:49:37.112Z",
          "category": "how-to",
          "contentLength": 7520
        },
        {
          "path": "docs/features/landing-videos/QUICK-START.md",
          "name": "QUICK-START.md",
          "size": 5197,
          "lastModified": "2026-01-06T15:49:37.113Z",
          "category": "how-to",
          "contentLength": 5111
        },
        {
          "path": "docs/getting-started/DATABASE_SETUP.md",
          "name": "DATABASE_SETUP.md",
          "size": 5734,
          "lastModified": "2025-12-04T10:27:33.890Z",
          "category": "tutorial",
          "contentLength": 5716
        },
        {
          "path": "docs/getting-started/LOCAL_TESTING_GUIDE.md",
          "name": "LOCAL_TESTING_GUIDE.md",
          "size": 6482,
          "lastModified": "2025-11-05T22:08:50.609Z",
          "category": "tutorial",
          "contentLength": 6482
        },
        {
          "path": "docs/getting-started/MVP_QUICK_START.md",
          "name": "MVP_QUICK_START.md",
          "size": 2714,
          "lastModified": "2025-11-05T22:08:50.609Z",
          "category": "tutorial",
          "contentLength": 2686
        },
        {
          "path": "docs/getting-started/QUICK_START_GUIDE.md",
          "name": "QUICK_START_GUIDE.md",
          "size": 6378,
          "lastModified": "2026-01-06T15:49:37.113Z",
          "category": "tutorial",
          "contentLength": 6248
        },
        {
          "path": "docs/getting-started/SUPABASE_SETUP.md",
          "name": "SUPABASE_SETUP.md",
          "size": 4704,
          "lastModified": "2025-11-05T22:08:50.610Z",
          "category": "tutorial",
          "contentLength": 4678
        },
        {
          "path": "docs/guides/DEPLOYMENT_CHECKLIST.md",
          "name": "DEPLOYMENT_CHECKLIST.md",
          "size": 6250,
          "lastModified": "2025-11-20T09:01:57.314Z",
          "category": "how-to",
          "contentLength": 6184
        },
        {
          "path": "docs/guides/DEPLOYMENT_GUIDE.md",
          "name": "DEPLOYMENT_GUIDE.md",
          "size": 4501,
          "lastModified": "2025-12-04T10:27:33.891Z",
          "category": "how-to",
          "contentLength": 4487
        },
        {
          "path": "docs/guides/KEY_ROTATION_COMPLETION_GUIDE.md",
          "name": "KEY_ROTATION_COMPLETION_GUIDE.md",
          "size": 9815,
          "lastModified": "2025-11-05T22:08:50.610Z",
          "category": "how-to",
          "contentLength": 9745
        },
        {
          "path": "docs/guides/MARKETING-COPY-IMPROVEMENTS.md",
          "name": "MARKETING-COPY-IMPROVEMENTS.md",
          "size": 9338,
          "lastModified": "2025-11-05T22:08:50.610Z",
          "category": "how-to",
          "contentLength": 9219
        },
        {
          "path": "docs/guides/PREVENTION_STRATEGY.md",
          "name": "PREVENTION_STRATEGY.md",
          "size": 7663,
          "lastModified": "2025-11-20T09:01:57.314Z",
          "category": "how-to",
          "contentLength": 7539
        },
        {
          "path": "docs/guides/README.md",
          "name": "README.md",
          "size": 1535,
          "lastModified": "2025-11-20T09:01:57.315Z",
          "category": "how-to",
          "contentLength": 1535
        },
        {
          "path": "docs/guides/STRIPE_WEBHOOK_SETUP.md",
          "name": "STRIPE_WEBHOOK_SETUP.md",
          "size": 12436,
          "lastModified": "2025-11-20T09:01:57.315Z",
          "category": "how-to",
          "contentLength": 12138
        },
        {
          "path": "docs/guides/TESTING.md",
          "name": "TESTING.md",
          "size": 9972,
          "lastModified": "2025-12-04T10:27:33.891Z",
          "category": "how-to",
          "contentLength": 9840
        },
        {
          "path": "docs/guides/asset-optimization-quick-reference.md",
          "name": "asset-optimization-quick-reference.md",
          "size": 5838,
          "lastModified": "2025-11-11T21:50:30.731Z",
          "category": "how-to",
          "contentLength": 5814
        },
        {
          "path": "docs/guides/build-optimization-implementation.md",
          "name": "build-optimization-implementation.md",
          "size": 16282,
          "lastModified": "2025-11-11T21:50:30.731Z",
          "category": "how-to",
          "contentLength": 16252
        },
        {
          "path": "docs/guides/build-optimization-quick-start.md",
          "name": "build-optimization-quick-start.md",
          "size": 13814,
          "lastModified": "2025-11-11T21:50:30.731Z",
          "category": "how-to",
          "contentLength": 13718
        },
        {
          "path": "docs/guides/css-optimization-summary.md",
          "name": "css-optimization-summary.md",
          "size": 7639,
          "lastModified": "2025-11-11T21:50:30.732Z",
          "category": "how-to",
          "contentLength": 7609
        },
        {
          "path": "docs/guides/prerender-optimization-quick-reference.md",
          "name": "prerender-optimization-quick-reference.md",
          "size": 4574,
          "lastModified": "2025-11-11T21:50:30.732Z",
          "category": "how-to",
          "contentLength": 4568
        },
        {
          "path": "docs/guides/tanstack-table-lazy-loading.md",
          "name": "tanstack-table-lazy-loading.md",
          "size": 10927,
          "lastModified": "2025-11-11T21:50:30.732Z",
          "category": "how-to",
          "contentLength": 10837
        },
        {
          "path": "docs/issues/full-app-unit-test-coverage.md",
          "name": "full-app-unit-test-coverage.md",
          "size": 37490,
          "lastModified": "2025-10-30T22:26:52.245Z",
          "category": "reference",
          "contentLength": 37132
        },
        {
          "path": "docs/issues/transactional-email-hardening.md",
          "name": "transactional-email-hardening.md",
          "size": 4369,
          "lastModified": "2025-11-01T14:16:54.355Z",
          "category": "reference",
          "contentLength": 4281
        },
        {
          "path": "docs/lessons/lesson-1-security-and-dependencies.md",
          "name": "lesson-1-security-and-dependencies.md",
          "size": 6637,
          "lastModified": "2026-01-06T15:49:37.113Z",
          "category": "how-to",
          "contentLength": 6637
        },
        {
          "path": "docs/lessons/lesson-2-technical-debt-and-code-quality.md",
          "name": "lesson-2-technical-debt-and-code-quality.md",
          "size": 8519,
          "lastModified": "2026-01-06T15:49:37.113Z",
          "category": "how-to",
          "contentLength": 8519
        },
        {
          "path": "docs/lessons/lesson-3-testing-and-action-plan.md",
          "name": "lesson-3-testing-and-action-plan.md",
          "size": 8606,
          "lastModified": "2026-01-06T15:49:37.114Z",
          "category": "reference",
          "contentLength": 8606
        },
        {
          "path": "docs/manuals/ADMIN_TESTING.md",
          "name": "ADMIN_TESTING.md",
          "size": 10025,
          "lastModified": "2026-01-14T21:35:39.890Z",
          "category": "reference",
          "contentLength": 10023
        },
        {
          "path": "docs/manuals/IMPLEMENTATION_GUIDE.md",
          "name": "IMPLEMENTATION_GUIDE.md",
          "size": 18117,
          "lastModified": "2026-01-14T21:35:39.890Z",
          "category": "how-to",
          "contentLength": 17823
        },
        {
          "path": "docs/manuals/TESTING_STRATEGY.md",
          "name": "TESTING_STRATEGY.md",
          "size": 7060,
          "lastModified": "2026-01-14T21:35:39.891Z",
          "category": "reference",
          "contentLength": 7046
        },
        {
          "path": "docs/manuals/TEST_USER_SIMULATION.md",
          "name": "TEST_USER_SIMULATION.md",
          "size": 10195,
          "lastModified": "2026-01-14T21:35:39.891Z",
          "category": "reference",
          "contentLength": 10161
        },
        {
          "path": "docs/meta/AI_ERA_DOCUMENTATION_PROPOSAL.md",
          "name": "AI_ERA_DOCUMENTATION_PROPOSAL.md",
          "size": 20328,
          "lastModified": "2026-01-14T22:11:39.871Z",
          "category": "explanation",
          "contentLength": 20035
        },
        {
          "path": "docs/meta/ARCHIVAL_POLICY.md",
          "name": "ARCHIVAL_POLICY.md",
          "size": 8307,
          "lastModified": "2026-01-06T15:49:37.114Z",
          "category": "reference",
          "contentLength": 8199
        },
        {
          "path": "docs/meta/DOCUMENTATION_CONSOLIDATION_PLAN.md",
          "name": "DOCUMENTATION_CONSOLIDATION_PLAN.md",
          "size": 8115,
          "lastModified": "2026-01-06T15:49:37.114Z",
          "category": "how-to",
          "contentLength": 7611
        },
        {
          "path": "docs/meta/DOCUMENTATION_CONVENTIONS.md",
          "name": "DOCUMENTATION_CONVENTIONS.md",
          "size": 28144,
          "lastModified": "2025-11-05T22:08:50.611Z",
          "category": "how-to",
          "contentLength": 27568
        },
        {
          "path": "docs/meta/DOCUMENTATION_IMPROVEMENT_PROPOSAL.md",
          "name": "DOCUMENTATION_IMPROVEMENT_PROPOSAL.md",
          "size": 14439,
          "lastModified": "2026-01-14T22:00:53.297Z",
          "category": "how-to",
          "contentLength": 13432
        },
        {
          "path": "docs/meta/DOCUMENTATION_INDEX.md",
          "name": "DOCUMENTATION_INDEX.md",
          "size": 13574,
          "lastModified": "2025-12-04T10:27:33.892Z",
          "category": "how-to",
          "contentLength": 13524
        },
        {
          "path": "docs/meta/DOCUMENTATION_QUICK_WINS.md",
          "name": "DOCUMENTATION_QUICK_WINS.md",
          "size": 7168,
          "lastModified": "2026-01-14T22:01:33.836Z",
          "category": "how-to",
          "contentLength": 7106
        },
        {
          "path": "docs/meta/DUAL_LAYER_DOCS_IMPLEMENTATION_PROMPT.md",
          "name": "DUAL_LAYER_DOCS_IMPLEMENTATION_PROMPT.md",
          "size": 13730,
          "lastModified": "2026-01-15T07:01:09.102Z",
          "category": "how-to",
          "contentLength": 13532
        },
        {
          "path": "docs/meta/QUICK_START_DUAL_LAYER_DOCS.md",
          "name": "QUICK_START_DUAL_LAYER_DOCS.md",
          "size": 11082,
          "lastModified": "2026-01-14T22:27:43.433Z",
          "category": "how-to",
          "contentLength": 10927
        },
        {
          "path": "docs/meta/REMAINING_WORK_SUMMARY.md",
          "name": "REMAINING_WORK_SUMMARY.md",
          "size": 4317,
          "lastModified": "2025-12-04T10:27:33.893Z",
          "category": "reference",
          "contentLength": 4267
        },
        {
          "path": "docs/notebooklm/01_PROJECT_OVERVIEW.md",
          "name": "01_PROJECT_OVERVIEW.md",
          "size": 3268,
          "lastModified": "2026-01-06T15:49:37.114Z",
          "category": "reference",
          "contentLength": 3138
        },
        {
          "path": "docs/notebooklm/02_TECH_STACK.md",
          "name": "02_TECH_STACK.md",
          "size": 4300,
          "lastModified": "2026-01-14T21:35:39.891Z",
          "category": "how-to",
          "contentLength": 4276
        },
        {
          "path": "docs/notebooklm/03_ARCHITECTURE.md",
          "name": "03_ARCHITECTURE.md",
          "size": 7750,
          "lastModified": "2026-01-06T15:49:37.115Z",
          "category": "explanation",
          "contentLength": 6048
        },
        {
          "path": "docs/notebooklm/04_FEATURES.md",
          "name": "04_FEATURES.md",
          "size": 4939,
          "lastModified": "2026-01-06T15:49:37.115Z",
          "category": "reference",
          "contentLength": 4939
        },
        {
          "path": "docs/notebooklm/05_CODE_CONVENTIONS.md",
          "name": "05_CODE_CONVENTIONS.md",
          "size": 6486,
          "lastModified": "2026-01-06T15:49:37.115Z",
          "category": "reference",
          "contentLength": 6442
        },
        {
          "path": "docs/notebooklm/06_COMPONENT_LIBRARY.md",
          "name": "06_COMPONENT_LIBRARY.md",
          "size": 8435,
          "lastModified": "2026-01-14T21:35:39.892Z",
          "category": "how-to",
          "contentLength": 8433
        },
        {
          "path": "docs/notebooklm/07_TESTING_GUIDE.md",
          "name": "07_TESTING_GUIDE.md",
          "size": 7711,
          "lastModified": "2026-01-06T15:49:37.115Z",
          "category": "how-to",
          "contentLength": 7595
        },
        {
          "path": "docs/notebooklm/08_API_REFERENCE.md",
          "name": "08_API_REFERENCE.md",
          "size": 6963,
          "lastModified": "2026-01-06T15:49:37.115Z",
          "category": "reference",
          "contentLength": 6963
        },
        {
          "path": "docs/notebooklm/09_TROUBLESHOOTING.md",
          "name": "09_TROUBLESHOOTING.md",
          "size": 6724,
          "lastModified": "2026-01-06T15:49:37.116Z",
          "category": "how-to",
          "contentLength": 6710
        },
        {
          "path": "docs/notebooklm/README.md",
          "name": "README.md",
          "size": 2557,
          "lastModified": "2026-01-06T15:49:37.116Z",
          "category": "explanation",
          "contentLength": 2557
        },
        {
          "path": "docs/optimization/date-fns-optimization-report.md",
          "name": "date-fns-optimization-report.md",
          "size": 6798,
          "lastModified": "2025-11-11T21:50:30.732Z",
          "category": "reference",
          "contentLength": 6758
        },
        {
          "path": "docs/optimization/date-fns-quick-reference.md",
          "name": "date-fns-quick-reference.md",
          "size": 2911,
          "lastModified": "2025-11-11T21:50:30.733Z",
          "category": "reference",
          "contentLength": 2881
        },
        {
          "path": "docs/project/AI_CONTEXT_TESTING_GUIDE.md",
          "name": "AI_CONTEXT_TESTING_GUIDE.md",
          "size": 19862,
          "lastModified": "2026-01-15T11:17:12.203Z",
          "category": "project",
          "contentLength": 19782
        },
        {
          "path": "docs/project/MAINTENANCE_GUIDE.md",
          "name": "MAINTENANCE_GUIDE.md",
          "size": 12697,
          "lastModified": "2026-01-15T11:14:36.955Z",
          "category": "project",
          "contentLength": 12692
        },
        {
          "path": "docs/project/MIGRATION_GUIDE.md",
          "name": "MIGRATION_GUIDE.md",
          "size": 14551,
          "lastModified": "2026-01-15T11:15:44.106Z",
          "category": "project",
          "contentLength": 14496
        },
        {
          "path": "docs/research/FILTER_DOCUMENTATION_RESEARCH.md",
          "name": "FILTER_DOCUMENTATION_RESEARCH.md",
          "size": 61042,
          "lastModified": "2025-11-13T17:08:41.652Z",
          "category": "reference",
          "contentLength": 60931
        },
        {
          "path": "docs/research/FILTER_SEARCH_UX_RESEARCH.md",
          "name": "FILTER_SEARCH_UX_RESEARCH.md",
          "size": 35225,
          "lastModified": "2025-11-13T17:08:41.652Z",
          "category": "explanation",
          "contentLength": 35109
        },
        {
          "path": "docs/research/HERO-SECTION-RESEARCH-README.md",
          "name": "HERO-SECTION-RESEARCH-README.md",
          "size": 14119,
          "lastModified": "2025-11-09T17:52:02.976Z",
          "category": "explanation",
          "contentLength": 13819
        },
        {
          "path": "docs/research/IMPLEMENTATION_EXAMPLES.md",
          "name": "IMPLEMENTATION_EXAMPLES.md",
          "size": 23898,
          "lastModified": "2025-11-20T09:01:57.316Z",
          "category": "reference",
          "contentLength": 23894
        },
        {
          "path": "docs/research/KISS-PRINCIPLE-LANDING-PAGE-RESEARCH.md",
          "name": "KISS-PRINCIPLE-LANDING-PAGE-RESEARCH.md",
          "size": 26589,
          "lastModified": "2025-11-09T17:52:02.976Z",
          "category": "explanation",
          "contentLength": 26571
        },
        {
          "path": "docs/research/LANDING_PAGE_SECTION_ANALYSIS.md",
          "name": "LANDING_PAGE_SECTION_ANALYSIS.md",
          "size": 52933,
          "lastModified": "2025-11-13T17:08:41.653Z",
          "category": "reference",
          "contentLength": 52813
        },
        {
          "path": "docs/research/README.md",
          "name": "README.md",
          "size": 13458,
          "lastModified": "2025-11-09T17:52:02.977Z",
          "category": "how-to",
          "contentLength": 13248
        },
        {
          "path": "docs/research/RESEARCH_SUMMARY.md",
          "name": "RESEARCH_SUMMARY.md",
          "size": 12728,
          "lastModified": "2025-11-09T17:52:02.977Z",
          "category": "how-to",
          "contentLength": 12638
        },
        {
          "path": "docs/research/brand-examples-reference.md",
          "name": "brand-examples-reference.md",
          "size": 18820,
          "lastModified": "2025-11-09T17:52:02.977Z",
          "category": "explanation",
          "contentLength": 18738
        },
        {
          "path": "docs/research/build-performance-comparison.md",
          "name": "build-performance-comparison.md",
          "size": 2565,
          "lastModified": "2025-11-13T17:08:41.654Z",
          "category": "how-to",
          "contentLength": 2523
        },
        {
          "path": "docs/research/hero-section-quick-reference.md",
          "name": "hero-section-quick-reference.md",
          "size": 9365,
          "lastModified": "2026-01-06T15:49:37.116Z",
          "category": "how-to",
          "contentLength": 9171
        },
        {
          "path": "docs/research/nuxt3-pinia-ssr-best-practices.md",
          "name": "nuxt3-pinia-ssr-best-practices.md",
          "size": 25649,
          "lastModified": "2025-11-20T09:01:57.317Z",
          "category": "how-to",
          "contentLength": 25523
        },
        {
          "path": "docs/research/research-wine-luxury-ecommerce-best-practices.md",
          "name": "research-wine-luxury-ecommerce-best-practices.md",
          "size": 32482,
          "lastModified": "2025-11-13T17:08:41.654Z",
          "category": "explanation",
          "contentLength": 32465
        },
        {
          "path": "docs/reviews/CODE_REVIEW_FAQ_PAGE.md",
          "name": "CODE_REVIEW_FAQ_PAGE.md",
          "size": 12817,
          "lastModified": "2026-01-06T15:49:17.480Z",
          "category": "reference",
          "contentLength": 12297
        },
        {
          "path": "docs/reviews/DOCS_COMPLEXITY_AUDIT.md",
          "name": "DOCS_COMPLEXITY_AUDIT.md",
          "size": 3284,
          "lastModified": "2026-01-14T21:35:39.892Z",
          "category": "explanation",
          "contentLength": 3270
        },
        {
          "path": "docs/reviews/FAQ_REVIEW_SUMMARY.md",
          "name": "FAQ_REVIEW_SUMMARY.md",
          "size": 5924,
          "lastModified": "2026-01-06T15:49:17.480Z",
          "category": "how-to",
          "contentLength": 5858
        },
        {
          "path": "docs/reviews/IMPROVEMENTS_APPLIED.md",
          "name": "IMPROVEMENTS_APPLIED.md",
          "size": 8780,
          "lastModified": "2026-01-14T21:35:39.893Z",
          "category": "reference",
          "contentLength": 8670
        },
        {
          "path": "docs/reviews/PR_REVIEW.md",
          "name": "PR_REVIEW.md",
          "size": 11463,
          "lastModified": "2026-01-14T21:35:39.893Z",
          "category": "reference",
          "contentLength": 11269
        },
        {
          "path": "docs/reviews/VISUAL_VALIDATION_RESULTS.md",
          "name": "VISUAL_VALIDATION_RESULTS.md",
          "size": 8699,
          "lastModified": "2026-01-14T21:35:39.894Z",
          "category": "reference",
          "contentLength": 8591
        },
        {
          "path": "docs/reviews/checkout-ux-review-2025-12-23.md",
          "name": "checkout-ux-review-2025-12-23.md",
          "size": 18597,
          "lastModified": "2026-01-06T15:49:37.116Z",
          "category": "explanation",
          "contentLength": 18521
        },
        {
          "path": "docs/security/GDPR_COMPLIANCE.md",
          "name": "GDPR_COMPLIANCE.md",
          "size": 20513,
          "lastModified": "2025-11-20T09:01:57.317Z",
          "category": "how-to",
          "contentLength": 20457
        },
        {
          "path": "docs/security/README.md",
          "name": "README.md",
          "size": 1409,
          "lastModified": "2025-11-20T09:01:57.317Z",
          "category": "how-to",
          "contentLength": 1409
        },
        {
          "path": "docs/security/SECURE_LOGGER.md",
          "name": "SECURE_LOGGER.md",
          "size": 18948,
          "lastModified": "2025-11-20T09:01:57.318Z",
          "category": "how-to",
          "contentLength": 18860
        },
        {
          "path": "docs/specs/GLOBAL_REQUIREMENTS.md",
          "name": "GLOBAL_REQUIREMENTS.md",
          "size": 7021,
          "lastModified": "2026-01-14T21:35:39.895Z",
          "category": "reference",
          "contentLength": 7021
        },
        {
          "path": "docs/specs/GLOBAL_TASKS.md",
          "name": "GLOBAL_TASKS.md",
          "size": 13545,
          "lastModified": "2026-01-14T21:35:39.895Z",
          "category": "how-to",
          "contentLength": 13465
        },
        {
          "path": "docs/specs/admin-dashboard/design.md",
          "name": "design.md",
          "size": 14412,
          "lastModified": "2025-12-04T10:27:33.893Z",
          "category": "reference",
          "contentLength": 14158
        },
        {
          "path": "docs/specs/admin-dashboard/requirements.md",
          "name": "requirements.md",
          "size": 6292,
          "lastModified": "2025-12-04T10:27:33.893Z",
          "category": "how-to",
          "contentLength": 6292
        },
        {
          "path": "docs/specs/admin-dashboard/tasks.md",
          "name": "tasks.md",
          "size": 6678,
          "lastModified": "2025-12-04T10:27:33.894Z",
          "category": "how-to",
          "contentLength": 6678
        },
        {
          "path": "docs/specs/admin-order-management/ALIGNMENT_REVIEW.md",
          "name": "ALIGNMENT_REVIEW.md",
          "size": 7402,
          "lastModified": "2025-12-04T10:27:33.894Z",
          "category": "explanation",
          "contentLength": 7122
        },
        {
          "path": "docs/specs/admin-order-management/FULFILLMENT_WORKFLOW.md",
          "name": "FULFILLMENT_WORKFLOW.md",
          "size": 10164,
          "lastModified": "2025-12-04T10:27:33.894Z",
          "category": "how-to",
          "contentLength": 10163
        },
        {
          "path": "docs/specs/admin-order-management/MODERN_UI_IMPROVEMENTS.md",
          "name": "MODERN_UI_IMPROVEMENTS.md",
          "size": 10325,
          "lastModified": "2025-12-04T10:27:33.894Z",
          "category": "explanation",
          "contentLength": 8790
        },
        {
          "path": "docs/specs/admin-order-management/QUICK_REFERENCE.md",
          "name": "QUICK_REFERENCE.md",
          "size": 7984,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "how-to",
          "contentLength": 7968
        },
        {
          "path": "docs/specs/admin-order-management/README.md",
          "name": "README.md",
          "size": 2667,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "reference",
          "contentLength": 2575
        },
        {
          "path": "docs/specs/admin-order-management/STATUS_WORKFLOW.md",
          "name": "STATUS_WORKFLOW.md",
          "size": 6020,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "project",
          "contentLength": 6006
        },
        {
          "path": "docs/specs/admin-order-management/TASK_6_IMPLEMENTATION.md",
          "name": "TASK_6_IMPLEMENTATION.md",
          "size": 7693,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "reference",
          "contentLength": 7665
        },
        {
          "path": "docs/specs/admin-order-management/UI_IMPROVEMENTS.md",
          "name": "UI_IMPROVEMENTS.md",
          "size": 6517,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "explanation",
          "contentLength": 6481
        },
        {
          "path": "docs/specs/admin-order-management/design.md",
          "name": "design.md",
          "size": 16722,
          "lastModified": "2025-12-04T10:27:33.895Z",
          "category": "reference",
          "contentLength": 16678
        },
        {
          "path": "docs/specs/admin-order-management/requirements.md",
          "name": "requirements.md",
          "size": 8386,
          "lastModified": "2025-12-04T10:27:33.896Z",
          "category": "reference",
          "contentLength": 8386
        },
        {
          "path": "docs/specs/admin-order-management/tasks.md",
          "name": "tasks.md",
          "size": 8521,
          "lastModified": "2025-12-04T10:27:33.896Z",
          "category": "how-to",
          "contentLength": 8423
        },
        {
          "path": "docs/specs/code-refactoring/FIXES_APPLIED.md",
          "name": "FIXES_APPLIED.md",
          "size": 7283,
          "lastModified": "2025-12-04T10:27:33.898Z",
          "category": "reference",
          "contentLength": 7211
        },
        {
          "path": "docs/specs/code-refactoring/IMPLEMENTATION_SUMMARY.md",
          "name": "IMPLEMENTATION_SUMMARY.md",
          "size": 9595,
          "lastModified": "2025-12-04T10:27:33.898Z",
          "category": "explanation",
          "contentLength": 9379
        },
        {
          "path": "docs/specs/code-refactoring/MIGRATION_GUIDE.md",
          "name": "MIGRATION_GUIDE.md",
          "size": 8236,
          "lastModified": "2025-12-04T10:27:33.898Z",
          "category": "reference",
          "contentLength": 8168
        },
        {
          "path": "docs/specs/code-refactoring/design.md",
          "name": "design.md",
          "size": 13116,
          "lastModified": "2025-12-04T10:27:33.899Z",
          "category": "reference",
          "contentLength": 12794
        },
        {
          "path": "docs/specs/code-refactoring/requirements.md",
          "name": "requirements.md",
          "size": 6997,
          "lastModified": "2025-12-04T10:27:33.899Z",
          "category": "reference",
          "contentLength": 6997
        },
        {
          "path": "docs/specs/code-refactoring/tasks.md",
          "name": "tasks.md",
          "size": 13468,
          "lastModified": "2025-12-04T10:27:33.900Z",
          "category": "how-to",
          "contentLength": 13468
        },
        {
          "path": "docs/specs/invoice-generation/design.md",
          "name": "design.md",
          "size": 11663,
          "lastModified": "2025-12-04T10:27:33.904Z",
          "category": "reference",
          "contentLength": 11635
        },
        {
          "path": "docs/specs/invoice-generation/requirements.md",
          "name": "requirements.md",
          "size": 7162,
          "lastModified": "2025-12-04T10:27:33.904Z",
          "category": "reference",
          "contentLength": 7162
        },
        {
          "path": "docs/specs/invoice-generation/tasks.md",
          "name": "tasks.md",
          "size": 8135,
          "lastModified": "2025-12-04T10:27:33.904Z",
          "category": "how-to",
          "contentLength": 8135
        },
        {
          "path": "docs/specs/order-confirmation-emails/IMPLEMENTATION_SUMMARY.md",
          "name": "IMPLEMENTATION_SUMMARY.md",
          "size": 6141,
          "lastModified": "2025-12-04T10:27:33.904Z",
          "category": "reference",
          "contentLength": 6111
        },
        {
          "path": "docs/specs/order-confirmation-emails/TESTING-GUIDE.md",
          "name": "TESTING-GUIDE.md",
          "size": 6896,
          "lastModified": "2025-12-04T10:27:33.904Z",
          "category": "how-to",
          "contentLength": 6862
        },
        {
          "path": "docs/specs/order-confirmation-emails/admin-interface-guide.md",
          "name": "admin-interface-guide.md",
          "size": 7456,
          "lastModified": "2025-12-04T10:27:33.905Z",
          "category": "how-to",
          "contentLength": 7446
        },
        {
          "path": "docs/specs/order-confirmation-emails/design.md",
          "name": "design.md",
          "size": 10247,
          "lastModified": "2025-12-04T10:27:33.905Z",
          "category": "reference",
          "contentLength": 10247
        },
        {
          "path": "docs/specs/order-confirmation-emails/requirements.md",
          "name": "requirements.md",
          "size": 6187,
          "lastModified": "2025-12-04T10:27:33.905Z",
          "category": "reference",
          "contentLength": 6187
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-3-completion-summary.md",
          "name": "task-3-completion-summary.md",
          "size": 8799,
          "lastModified": "2025-12-04T10:27:33.905Z",
          "category": "reference",
          "contentLength": 8677
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-3.1-verification.md",
          "name": "task-3.1-verification.md",
          "size": 3482,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "how-to",
          "contentLength": 3438
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-3.2-verification.md",
          "name": "task-3.2-verification.md",
          "size": 6767,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "reference",
          "contentLength": 6272
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-4-completion-summary.md",
          "name": "task-4-completion-summary.md",
          "size": 6470,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "reference",
          "contentLength": 6434
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-5-completion-summary.md",
          "name": "task-5-completion-summary.md",
          "size": 11959,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "reference",
          "contentLength": 11887
        },
        {
          "path": "docs/specs/order-confirmation-emails/task-6-completion-summary.md",
          "name": "task-6-completion-summary.md",
          "size": 11535,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "reference",
          "contentLength": 11453
        },
        {
          "path": "docs/specs/order-confirmation-emails/tasks.md",
          "name": "tasks.md",
          "size": 6899,
          "lastModified": "2025-12-04T10:27:33.906Z",
          "category": "how-to",
          "contentLength": 6899
        },
        {
          "path": "docs/specs/order-confirmation-emails/usage-examples.md",
          "name": "usage-examples.md",
          "size": 14051,
          "lastModified": "2025-12-04T10:27:33.907Z",
          "category": "reference",
          "contentLength": 14051
        },
        {
          "path": "docs/specs/product-catalog/design.md",
          "name": "design.md",
          "size": 23648,
          "lastModified": "2025-12-04T10:27:33.908Z",
          "category": "reference",
          "contentLength": 23513
        },
        {
          "path": "docs/specs/product-catalog/requirements.md",
          "name": "requirements.md",
          "size": 15548,
          "lastModified": "2025-12-04T10:27:33.908Z",
          "category": "reference",
          "contentLength": 15548
        },
        {
          "path": "docs/specs/product-catalog/tasks.md",
          "name": "tasks.md",
          "size": 8145,
          "lastModified": "2026-01-06T15:49:37.116Z",
          "category": "reference",
          "contentLength": 8091
        },
        {
          "path": "docs/specs/product-recommendations/design.md",
          "name": "design.md",
          "size": 12776,
          "lastModified": "2025-12-04T10:27:33.909Z",
          "category": "reference",
          "contentLength": 12776
        },
        {
          "path": "docs/specs/product-recommendations/requirements.md",
          "name": "requirements.md",
          "size": 8044,
          "lastModified": "2025-12-04T10:27:33.909Z",
          "category": "explanation",
          "contentLength": 8044
        },
        {
          "path": "docs/specs/product-recommendations/tasks.md",
          "name": "tasks.md",
          "size": 7415,
          "lastModified": "2025-12-04T10:27:33.909Z",
          "category": "how-to",
          "contentLength": 7415
        },
        {
          "path": "docs/specs/shipping-notifications/design.md",
          "name": "design.md",
          "size": 11139,
          "lastModified": "2025-12-04T10:27:33.910Z",
          "category": "reference",
          "contentLength": 11139
        },
        {
          "path": "docs/specs/shipping-notifications/requirements.md",
          "name": "requirements.md",
          "size": 5522,
          "lastModified": "2025-12-04T10:27:33.911Z",
          "category": "reference",
          "contentLength": 5522
        },
        {
          "path": "docs/specs/shipping-notifications/tasks.md",
          "name": "tasks.md",
          "size": 6632,
          "lastModified": "2025-12-04T10:27:33.911Z",
          "category": "how-to",
          "contentLength": 6632
        },
        {
          "path": "docs/specs/shopping-cart/design.md",
          "name": "design.md",
          "size": 11880,
          "lastModified": "2025-12-04T10:27:33.912Z",
          "category": "reference",
          "contentLength": 11878
        },
        {
          "path": "docs/specs/shopping-cart/requirements.md",
          "name": "requirements.md",
          "size": 13146,
          "lastModified": "2025-12-04T10:27:33.913Z",
          "category": "reference",
          "contentLength": 13143
        },
        {
          "path": "docs/specs/shopping-cart/tasks.md",
          "name": "tasks.md",
          "size": 6947,
          "lastModified": "2025-12-04T10:27:33.913Z",
          "category": "how-to",
          "contentLength": 6945
        },
        {
          "path": "docs/specs/user-authentication/design.md",
          "name": "design.md",
          "size": 54803,
          "lastModified": "2026-01-06T15:49:37.117Z",
          "category": "reference",
          "contentLength": 54560
        },
        {
          "path": "docs/specs/user-authentication/requirements.md",
          "name": "requirements.md",
          "size": 12443,
          "lastModified": "2025-12-04T10:27:33.914Z",
          "category": "reference",
          "contentLength": 12443
        },
        {
          "path": "docs/specs/user-authentication/tasks.md",
          "name": "tasks.md",
          "size": 10077,
          "lastModified": "2025-12-04T10:27:33.914Z",
          "category": "how-to",
          "contentLength": 10073
        },
        {
          "path": "docs/specs/wishlist/design.md",
          "name": "design.md",
          "size": 13365,
          "lastModified": "2025-12-04T10:27:33.914Z",
          "category": "reference",
          "contentLength": 13359
        },
        {
          "path": "docs/specs/wishlist/requirements.md",
          "name": "requirements.md",
          "size": 8979,
          "lastModified": "2025-12-04T10:27:33.915Z",
          "category": "reference",
          "contentLength": 8979
        },
        {
          "path": "docs/specs/wishlist/tasks.md",
          "name": "tasks.md",
          "size": 7072,
          "lastModified": "2025-12-04T10:27:33.915Z",
          "category": "how-to",
          "contentLength": 7072
        },
        {
          "path": "docs/status/CURRENT_TEST_FAILURES_DETAILED.md",
          "name": "CURRENT_TEST_FAILURES_DETAILED.md",
          "size": 8738,
          "lastModified": "2026-01-06T15:49:17.482Z",
          "category": "reference",
          "contentLength": 8706
        },
        {
          "path": "docs/status/E2E_TEST_FAILURES_ANALYSIS.md",
          "name": "E2E_TEST_FAILURES_ANALYSIS.md",
          "size": 5085,
          "lastModified": "2026-01-06T15:49:17.482Z",
          "category": "reference",
          "contentLength": 5015
        },
        {
          "path": "docs/status/P0_ISSUES_SUMMARY.md",
          "name": "P0_ISSUES_SUMMARY.md",
          "size": 9171,
          "lastModified": "2026-01-14T21:56:47.066Z",
          "category": "explanation",
          "contentLength": 9087
        },
        {
          "path": "docs/status/PROGRESS.md",
          "name": "PROGRESS.md",
          "size": 13310,
          "lastModified": "2026-01-06T15:49:37.118Z",
          "category": "reference",
          "contentLength": 13014
        },
        {
          "path": "docs/status/PROJECT_STATUS.md",
          "name": "PROJECT_STATUS.md",
          "size": 12763,
          "lastModified": "2026-01-06T15:49:37.118Z",
          "category": "project",
          "contentLength": 12631
        },
        {
          "path": "docs/status/ROADMAP.md",
          "name": "ROADMAP.md",
          "size": 6231,
          "lastModified": "2026-01-06T15:49:37.118Z",
          "category": "project",
          "contentLength": 6185
        },
        {
          "path": "docs/testing/ADMIN_PAGES_COMPREHENSIVE_REPORT.md",
          "name": "ADMIN_PAGES_COMPREHENSIVE_REPORT.md",
          "size": 10187,
          "lastModified": "2025-11-21T13:04:49.345Z",
          "category": "how-to",
          "contentLength": 10010
        },
        {
          "path": "docs/testing/COMPREHENSIVE_CHECKOUT_REVIEW.md",
          "name": "COMPREHENSIVE_CHECKOUT_REVIEW.md",
          "size": 12837,
          "lastModified": "2026-01-06T15:49:37.118Z",
          "category": "reference",
          "contentLength": 12733
        },
        {
          "path": "docs/testing/E2E_CART_TESTS.md",
          "name": "E2E_CART_TESTS.md",
          "size": 7437,
          "lastModified": "2025-11-20T09:01:57.318Z",
          "category": "reference",
          "contentLength": 7411
        },
        {
          "path": "docs/testing/MUTATION_TESTING_FINAL_REPORT.md",
          "name": "MUTATION_TESTING_FINAL_REPORT.md",
          "size": 12020,
          "lastModified": "2026-01-06T15:49:37.119Z",
          "category": "reference",
          "contentLength": 12018
        },
        {
          "path": "docs/testing/PRODUCTION_TESTING_STRATEGY.md",
          "name": "PRODUCTION_TESTING_STRATEGY.md",
          "size": 27238,
          "lastModified": "2026-01-06T15:49:17.484Z",
          "category": "how-to",
          "contentLength": 27124
        },
        {
          "path": "docs/testing/README.md",
          "name": "README.md",
          "size": 2686,
          "lastModified": "2026-01-06T15:49:37.119Z",
          "category": "how-to",
          "contentLength": 2686
        },
        {
          "path": "docs/testing/TESTING_AUDIT_AND_STRATEGY.md",
          "name": "TESTING_AUDIT_AND_STRATEGY.md",
          "size": 12413,
          "lastModified": "2026-01-06T15:49:17.484Z",
          "category": "how-to",
          "contentLength": 12381
        },
        {
          "path": "docs/testing/TESTING_REVIEW.md",
          "name": "TESTING_REVIEW.md",
          "size": 11411,
          "lastModified": "2026-01-06T15:49:37.119Z",
          "category": "reference",
          "contentLength": 11329
        },
        {
          "path": "docs/testing/TEST_COVERAGE_ANALYSIS.md",
          "name": "TEST_COVERAGE_ANALYSIS.md",
          "size": 13477,
          "lastModified": "2026-01-06T15:49:37.120Z",
          "category": "reference",
          "contentLength": 13289
        },
        {
          "path": "docs/testing/TEST_COVERAGE_SUMMARY.md",
          "name": "TEST_COVERAGE_SUMMARY.md",
          "size": 4968,
          "lastModified": "2026-01-06T15:49:37.120Z",
          "category": "reference",
          "contentLength": 4884
        },
        {
          "path": "docs/testing/VISUAL-REGRESSION-SETUP.md",
          "name": "VISUAL-REGRESSION-SETUP.md",
          "size": 5573,
          "lastModified": "2026-01-06T15:49:37.120Z",
          "category": "how-to",
          "contentLength": 5571
        },
        {
          "path": "docs/testing/VISUAL-REGRESSION-SUMMARY.md",
          "name": "VISUAL-REGRESSION-SUMMARY.md",
          "size": 9750,
          "lastModified": "2026-01-06T15:49:37.120Z",
          "category": "how-to",
          "contentLength": 9698
        },
        {
          "path": "docs/visual-regression/VISUAL_REGRESSION_ISSUES_AND_FIXES.md",
          "name": "VISUAL_REGRESSION_ISSUES_AND_FIXES.md",
          "size": 8777,
          "lastModified": "2026-01-06T15:49:17.486Z",
          "category": "how-to",
          "contentLength": 8751
        },
        {
          "path": "docs/visual-regression/VISUAL_REGRESSION_REVIEW_INDEX.md",
          "name": "VISUAL_REGRESSION_REVIEW_INDEX.md",
          "size": 6434,
          "lastModified": "2026-01-06T15:49:17.486Z",
          "category": "how-to",
          "contentLength": 6434
        },
        {
          "path": "docs/visual-regression/VISUAL_REGRESSION_REVIEW_REPORT.md",
          "name": "VISUAL_REGRESSION_REVIEW_REPORT.md",
          "size": 11429,
          "lastModified": "2026-01-06T15:49:17.486Z",
          "category": "how-to",
          "contentLength": 11375
        },
        {
          "path": "docs/visual-regression/VISUAL_REGRESSION_SUMMARY.md",
          "name": "VISUAL_REGRESSION_SUMMARY.md",
          "size": 4242,
          "lastModified": "2026-01-06T15:49:17.486Z",
          "category": "how-to",
          "contentLength": 4234
        }
      ],
      "totalCount": 320,
      "totalSize": 3618214,
      "categories": {
        "tutorial": [
          "docs/getting-started/DATABASE_SETUP.md",
          "docs/getting-started/LOCAL_TESTING_GUIDE.md",
          "docs/getting-started/MVP_QUICK_START.md",
          "docs/getting-started/QUICK_START_GUIDE.md",
          "docs/getting-started/SUPABASE_SETUP.md"
        ],
        "how-to": [
          "docs/automation/github-project-automation.md",
          "docs/development/MILESTONE_QUICK_START.md",
          "docs/development/component-inventory.md",
          "docs/development/supabase-best-practices.md",
          "docs/development/tech.md",
          "docs/development/troubleshooting-components.md",
          "docs/features/I18N_CONFIGURATION.md",
          "docs/features/authentication/MFA_IMPLEMENTATION.md",
          "docs/features/authentication/auth-flow-review.md",
          "docs/features/authentication/authentication-translations.md",
          "docs/features/landing-videos/IMPLEMENTATION.md",
          "docs/features/landing-videos/QUICK-START.md",
          "docs/guides/DEPLOYMENT_CHECKLIST.md",
          "docs/guides/DEPLOYMENT_GUIDE.md",
          "docs/guides/KEY_ROTATION_COMPLETION_GUIDE.md",
          "docs/guides/MARKETING-COPY-IMPROVEMENTS.md",
          "docs/guides/PREVENTION_STRATEGY.md",
          "docs/guides/README.md",
          "docs/guides/STRIPE_WEBHOOK_SETUP.md",
          "docs/guides/TESTING.md",
          "docs/guides/asset-optimization-quick-reference.md",
          "docs/guides/build-optimization-implementation.md",
          "docs/guides/build-optimization-quick-start.md",
          "docs/guides/css-optimization-summary.md",
          "docs/guides/prerender-optimization-quick-reference.md",
          "docs/guides/tanstack-table-lazy-loading.md",
          "docs/lessons/lesson-1-security-and-dependencies.md",
          "docs/lessons/lesson-2-technical-debt-and-code-quality.md",
          "docs/manuals/IMPLEMENTATION_GUIDE.md",
          "docs/meta/DOCUMENTATION_CONSOLIDATION_PLAN.md",
          "docs/meta/DOCUMENTATION_CONVENTIONS.md",
          "docs/meta/DOCUMENTATION_IMPROVEMENT_PROPOSAL.md",
          "docs/meta/DOCUMENTATION_INDEX.md",
          "docs/meta/DOCUMENTATION_QUICK_WINS.md",
          "docs/meta/DUAL_LAYER_DOCS_IMPLEMENTATION_PROMPT.md",
          "docs/meta/QUICK_START_DUAL_LAYER_DOCS.md",
          "docs/notebooklm/02_TECH_STACK.md",
          "docs/notebooklm/06_COMPONENT_LIBRARY.md",
          "docs/notebooklm/07_TESTING_GUIDE.md",
          "docs/notebooklm/09_TROUBLESHOOTING.md",
          "docs/research/README.md",
          "docs/research/RESEARCH_SUMMARY.md",
          "docs/research/build-performance-comparison.md",
          "docs/research/hero-section-quick-reference.md",
          "docs/research/nuxt3-pinia-ssr-best-practices.md",
          "docs/reviews/FAQ_REVIEW_SUMMARY.md",
          "docs/security/GDPR_COMPLIANCE.md",
          "docs/security/README.md",
          "docs/security/SECURE_LOGGER.md",
          "docs/specs/GLOBAL_TASKS.md",
          "docs/specs/admin-dashboard/requirements.md",
          "docs/specs/admin-dashboard/tasks.md",
          "docs/specs/admin-order-management/FULFILLMENT_WORKFLOW.md",
          "docs/specs/admin-order-management/QUICK_REFERENCE.md",
          "docs/specs/admin-order-management/tasks.md",
          "docs/specs/code-refactoring/tasks.md",
          "docs/specs/invoice-generation/tasks.md",
          "docs/specs/order-confirmation-emails/TESTING-GUIDE.md",
          "docs/specs/order-confirmation-emails/admin-interface-guide.md",
          "docs/specs/order-confirmation-emails/task-3.1-verification.md",
          "docs/specs/order-confirmation-emails/tasks.md",
          "docs/specs/product-recommendations/tasks.md",
          "docs/specs/shipping-notifications/tasks.md",
          "docs/specs/shopping-cart/tasks.md",
          "docs/specs/user-authentication/tasks.md",
          "docs/specs/wishlist/tasks.md",
          "docs/testing/ADMIN_PAGES_COMPREHENSIVE_REPORT.md",
          "docs/testing/PRODUCTION_TESTING_STRATEGY.md",
          "docs/testing/README.md",
          "docs/testing/TESTING_AUDIT_AND_STRATEGY.md",
          "docs/testing/VISUAL-REGRESSION-SETUP.md",
          "docs/testing/VISUAL-REGRESSION-SUMMARY.md",
          "docs/visual-regression/VISUAL_REGRESSION_ISSUES_AND_FIXES.md",
          "docs/visual-regression/VISUAL_REGRESSION_REVIEW_INDEX.md",
          "docs/visual-regression/VISUAL_REGRESSION_REVIEW_REPORT.md",
          "docs/visual-regression/VISUAL_REGRESSION_SUMMARY.md"
        ],
        "reference": [
          "docs/MVP_ASSESSMENT_REPORT.md",
          "docs/NUXT3_LANDING_PAGES_RESEARCH.md",
          "docs/NUXT3_PRODUCT_PAGE_DOCUMENTATION.md",
          "docs/QUICK_REFERENCE_PRODUCT_PAGES.md",
          "docs/analysis/LOCALSTORAGE-PAGES-VERIFICATION.md",
          "docs/analysis/LOCALSTORAGE-PROBLEM-DEEP-DIVE.md",
          "docs/analysis/LOCALSTORAGE-SECURITY-AUDIT.md",
          "docs/analysis/SSR-SAFETY-VERIFICATION.md",
          "docs/api/README.md",
          "docs/archive/completed-specs/customer-order-history/API_USAGE_GUIDE.md",
          "docs/development/MILESTONE_STRATEGY.md",
          "docs/development/STATIC_ANALYSIS.md",
          "docs/development/code-cleanup.md",
          "docs/development/code-conventions.md",
          "docs/development/structure.md",
          "docs/development/ui-ux-review.md",
          "docs/features/AUDIT_LOGGING.md",
          "docs/features/GUEST_CHECKOUT_IMPLEMENTATION.md",
          "docs/features/LANDING-PAGE-CMS.md",
          "docs/features/authentication/AUTH_MIDDLEWARE_TEST_RESULTS.md",
          "docs/features/cart/ATOMIC_INVENTORY_FIX.md",
          "docs/features/cart/CART_ANALYTICS.md",
          "docs/features/cart/CART_LOCKING.md",
          "docs/issues/full-app-unit-test-coverage.md",
          "docs/issues/transactional-email-hardening.md",
          "docs/lessons/lesson-3-testing-and-action-plan.md",
          "docs/manuals/ADMIN_TESTING.md",
          "docs/manuals/TESTING_STRATEGY.md",
          "docs/manuals/TEST_USER_SIMULATION.md",
          "docs/meta/ARCHIVAL_POLICY.md",
          "docs/meta/REMAINING_WORK_SUMMARY.md",
          "docs/notebooklm/01_PROJECT_OVERVIEW.md",
          "docs/notebooklm/04_FEATURES.md",
          "docs/notebooklm/05_CODE_CONVENTIONS.md",
          "docs/notebooklm/08_API_REFERENCE.md",
          "docs/optimization/date-fns-optimization-report.md",
          "docs/optimization/date-fns-quick-reference.md",
          "docs/research/FILTER_DOCUMENTATION_RESEARCH.md",
          "docs/research/IMPLEMENTATION_EXAMPLES.md",
          "docs/research/LANDING_PAGE_SECTION_ANALYSIS.md",
          "docs/reviews/CODE_REVIEW_FAQ_PAGE.md",
          "docs/reviews/IMPROVEMENTS_APPLIED.md",
          "docs/reviews/PR_REVIEW.md",
          "docs/reviews/VISUAL_VALIDATION_RESULTS.md",
          "docs/specs/GLOBAL_REQUIREMENTS.md",
          "docs/specs/admin-dashboard/design.md",
          "docs/specs/admin-order-management/README.md",
          "docs/specs/admin-order-management/TASK_6_IMPLEMENTATION.md",
          "docs/specs/admin-order-management/design.md",
          "docs/specs/admin-order-management/requirements.md",
          "docs/specs/code-refactoring/FIXES_APPLIED.md",
          "docs/specs/code-refactoring/MIGRATION_GUIDE.md",
          "docs/specs/code-refactoring/design.md",
          "docs/specs/code-refactoring/requirements.md",
          "docs/specs/invoice-generation/design.md",
          "docs/specs/invoice-generation/requirements.md",
          "docs/specs/order-confirmation-emails/IMPLEMENTATION_SUMMARY.md",
          "docs/specs/order-confirmation-emails/design.md",
          "docs/specs/order-confirmation-emails/requirements.md",
          "docs/specs/order-confirmation-emails/task-3-completion-summary.md",
          "docs/specs/order-confirmation-emails/task-3.2-verification.md",
          "docs/specs/order-confirmation-emails/task-4-completion-summary.md",
          "docs/specs/order-confirmation-emails/task-5-completion-summary.md",
          "docs/specs/order-confirmation-emails/task-6-completion-summary.md",
          "docs/specs/order-confirmation-emails/usage-examples.md",
          "docs/specs/product-catalog/design.md",
          "docs/specs/product-catalog/requirements.md",
          "docs/specs/product-catalog/tasks.md",
          "docs/specs/product-recommendations/design.md",
          "docs/specs/shipping-notifications/design.md",
          "docs/specs/shipping-notifications/requirements.md",
          "docs/specs/shopping-cart/design.md",
          "docs/specs/shopping-cart/requirements.md",
          "docs/specs/user-authentication/design.md",
          "docs/specs/user-authentication/requirements.md",
          "docs/specs/wishlist/design.md",
          "docs/specs/wishlist/requirements.md",
          "docs/status/CURRENT_TEST_FAILURES_DETAILED.md",
          "docs/status/E2E_TEST_FAILURES_ANALYSIS.md",
          "docs/status/PROGRESS.md",
          "docs/testing/COMPREHENSIVE_CHECKOUT_REVIEW.md",
          "docs/testing/E2E_CART_TESTS.md",
          "docs/testing/MUTATION_TESTING_FINAL_REPORT.md",
          "docs/testing/TESTING_REVIEW.md",
          "docs/testing/TEST_COVERAGE_ANALYSIS.md",
          "docs/testing/TEST_COVERAGE_SUMMARY.md"
        ],
        "explanation": [
          "docs/CODEBASE_AUDIT_REPORT.md",
          "docs/README.md",
          "docs/architecture/ACCESSIBILITY_REFACTORING_PLAN.md",
          "docs/architecture/ADR-001-auth-store-modularization.md",
          "docs/architecture/ARCHITECTURE_IMPROVEMENT_ROADMAP.md",
          "docs/architecture/AUTHENTICATION_ARCHITECTURE.md",
          "docs/architecture/CART_SYSTEM_ARCHITECTURE.md",
          "docs/architecture/CHECKOUT_FLOW.md",
          "docs/architecture/DOCUMENTATION_UPDATE_2026_01.md",
          "docs/architecture/MIDDLEWARE_ARCHITECTURE_ANALYSIS.md",
          "docs/architecture/README.md",
          "docs/architecture/asset-caching-strategy.md",
          "docs/architecture/build-configuration-review.md",
          "docs/architecture/build-optimization-adr.md",
          "docs/architecture/build-optimization-plan.md",
          "docs/architecture/tailwind-v4-build-fix-adr.md",
          "docs/architecture/tailwind-v4-compatibility-summary.md",
          "docs/architecture/tailwind-v4-implementation-checklist.md",
          "docs/architecture/tanstack-table-lazy-loading-implementation.md",
          "docs/archive/architecture-reviews/ARCHITECTURE_REVIEW_2025_11.md",
          "docs/design-inspiration/VISUAL_ANALYSIS.md",
          "docs/development/ACCESSIBILITY_QUICK_REFERENCE.md",
          "docs/development/PATTERNS_TO_PRESERVE.md",
          "docs/development/component-modernization-plan.md",
          "docs/meta/AI_ERA_DOCUMENTATION_PROPOSAL.md",
          "docs/notebooklm/03_ARCHITECTURE.md",
          "docs/notebooklm/README.md",
          "docs/research/FILTER_SEARCH_UX_RESEARCH.md",
          "docs/research/HERO-SECTION-RESEARCH-README.md",
          "docs/research/KISS-PRINCIPLE-LANDING-PAGE-RESEARCH.md",
          "docs/research/brand-examples-reference.md",
          "docs/research/research-wine-luxury-ecommerce-best-practices.md",
          "docs/reviews/DOCS_COMPLEXITY_AUDIT.md",
          "docs/reviews/checkout-ux-review-2025-12-23.md",
          "docs/specs/admin-order-management/ALIGNMENT_REVIEW.md",
          "docs/specs/admin-order-management/MODERN_UI_IMPROVEMENTS.md",
          "docs/specs/admin-order-management/UI_IMPROVEMENTS.md",
          "docs/specs/code-refactoring/IMPLEMENTATION_SUMMARY.md",
          "docs/specs/product-recommendations/requirements.md",
          "docs/status/P0_ISSUES_SUMMARY.md"
        ],
        "project": [
          "docs/CHANGELOG.md",
          "docs/archive/completed-specs/shipping-step-refactor/FINAL_STATUS.md",
          "docs/archive/testing/TEST_STATUS_REPORT.md",
          "docs/automation/PROJECT_AUTOMATION_EXPLAINED.md",
          "docs/project/AI_CONTEXT_TESTING_GUIDE.md",
          "docs/project/MAINTENANCE_GUIDE.md",
          "docs/project/MIGRATION_GUIDE.md",
          "docs/specs/admin-order-management/STATUS_WORKFLOW.md",
          "docs/status/PROJECT_STATUS.md",
          "docs/status/ROADMAP.md"
        ],
        "archive": [
          "docs/archive/README.md",
          "docs/archive/cart-fixes/CART_PERSISTENCE_FIX.md",
          "docs/archive/cart-fixes/CART_SSR_HYDRATION_FIX_V2.md",
          "docs/archive/checkout-fixes/CHECKOUT_BUTTON_ERROR_FINAL_REPORT.md",
          "docs/archive/checkout-fixes/FINAL_CHECKOUT_BUTTON_FIX.md",
          "docs/archive/checkout-fixes/LOGIN_INVESTIGATION.md",
          "docs/archive/checkout-fixes/add-to-cart-root-cause.md",
          "docs/archive/checkout-fixes/products-page-empty-fix.md",
          "docs/archive/checkout-fixes/vercel-investigation-report.md",
          "docs/archive/checkout-reviews/CHECKOUT_BEFORE_AFTER_COMPARISON.md",
          "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_INDEX.md",
          "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_QUICK_REFERENCE.md",
          "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md",
          "docs/archive/checkout-reviews/CHECKOUT_UX_ANALYSIS_SUMMARY.md",
          "docs/archive/checkout-reviews/CHECKOUT_UX_SIMPLIFICATION_REVIEW.md",
          "docs/archive/checkout-reviews/CHECKOUT_UX_SUMMARY.md",
          "docs/archive/checkout-reviews/README_CHECKOUT_REVIEW.md",
          "docs/archive/completed-specs/customer-order-history/COMPLETE.md",
          "docs/archive/completed-specs/customer-order-history/FIXES_APPLIED.md",
          "docs/archive/completed-specs/customer-order-history/MIGRATION_GUIDE.md",
          "docs/archive/completed-specs/customer-order-history/design.md",
          "docs/archive/completed-specs/customer-order-history/requirements.md",
          "docs/archive/completed-specs/customer-order-history/tasks.md",
          "docs/archive/completed-specs/order-status-updates/COMPLETE.md",
          "docs/archive/completed-specs/order-status-updates/design.md",
          "docs/archive/completed-specs/order-status-updates/requirements.md",
          "docs/archive/completed-specs/order-status-updates/tasks.md",
          "docs/archive/completed-specs/shipping-step-refactor/RECURSIVE_UPDATE_FIX.md",
          "docs/archive/completed-specs/shipping-step-refactor/VERIFICATION_REPORT.md",
          "docs/archive/completed-specs/shipping-step-refactor/design.md",
          "docs/archive/completed-specs/shipping-step-refactor/requirements.md",
          "docs/archive/completed-specs/shipping-step-refactor/tasks.md",
          "docs/archive/fix-summaries/CART-LOCK-FIX-SUMMARY.md",
          "docs/archive/fix-summaries/CART_COOKIE_FIX_SUMMARY.md",
          "docs/archive/fix-summaries/CHANGES_SUMMARY.md",
          "docs/archive/fix-summaries/CHECKOUT_FIXES_SUMMARY.md",
          "docs/archive/fixes/ARCHITECTURAL_FIXES_SUMMARY.md",
          "docs/archive/fixes/ERROR_HANDLING_AUDIT.md",
          "docs/archive/fixes/ERROR_HANDLING_FIXES.md",
          "docs/archive/fixes/FINAL_OPTIMIZATION_SUMMARY.md",
          "docs/archive/fixes/MIDDLEWARE_FIX_SUMMARY.md",
          "docs/archive/fixes/RACE_CONDITION_FIX_SUMMARY.md",
          "docs/archive/fixes/README.md",
          "docs/archive/fixes/SSR_FIX_SUMMARY.md",
          "docs/archive/fixes/VISUAL_TEST_RESULTS.md",
          "docs/archive/fixes/admin-fixes/CLEAN-CODE-REVIEW.md",
          "docs/archive/fixes/admin-fixes/ISSUES-AND-SOLUTIONS.md",
          "docs/archive/meta-old/DOCUMENTATION_SUMMARY.md",
          "docs/archive/meta-old/DOCUMENTATION_UPDATES_LOG.md",
          "docs/archive/meta-old/DOCUMENTATION_UPDATE_2025-11-01.md",
          "docs/archive/meta-old/MVP_PRIORITY_ORDER.md",
          "docs/archive/migrations/BUTTON_MIGRATION_AUDIT.md",
          "docs/archive/migrations/SHADCN_MIGRATION.md",
          "docs/archive/phase-docs/phase1-results.md",
          "docs/archive/phase-docs/phase2-results.md",
          "docs/archive/phase-docs/phase3-results.md",
          "docs/archive/phase-docs/phase4-analysis.md",
          "docs/archive/phase-docs/phase4-honest-assessment.md",
          "docs/archive/phase-docs/phase4-optimized-results.md",
          "docs/archive/reports/ASSET_OPTIMIZATION_SUMMARY.md",
          "docs/archive/reports/BUILD_SUCCESS_REPORT.md",
          "docs/archive/reports/CODE_QUALITY_ANALYSIS_2025-11-01.md",
          "docs/archive/reports/TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md",
          "docs/archive/reports/prerender-optimization-report.md",
          "docs/archive/research/hero-section/hero-demo-images.md",
          "docs/archive/research/hero-section/hero-image-requirements.md",
          "docs/archive/research/hero-section/hero-section-best-practices-2025.md",
          "docs/archive/research/hero-section/hero-section-implementation-guide.md",
          "docs/archive/research/hero-section/hero-section-technical-implementation.md",
          "docs/archive/reviews/CODE_REVIEW_2025.md",
          "docs/archive/reviews/DOCUMENTATION_REVIEW_2025-11-27.md",
          "docs/archive/reviews/PR_258_ACCESSIBILITY_ARCHITECTURE_REVIEW.md",
          "docs/archive/reviews/PR_258_EXECUTIVE_SUMMARY.md",
          "docs/archive/specs/CART_FIXES_SUMMARY.md",
          "docs/archive/specs-legacy/ORIGINAL_REQUIREMENTS.md",
          "docs/archive/specs-legacy/design.md",
          "docs/archive/test-reports/visual-regression-20251123/MANUAL_TEST_CHECKLIST.md",
          "docs/archive/test-reports/visual-regression-20251123/README.md",
          "docs/archive/test-reports/visual-regression-20251123/TEST_SUMMARY.md",
          "docs/archive/test-reports/visual-regression-20251123/VISUAL_REGRESSION_TEST_REPORT.md",
          "docs/archive/testing/BRANCH_COMPARISON_SUMMARY.md",
          "docs/archive/testing/E2E_AUTH_TEST_IMPROVEMENTS.md",
          "docs/archive/testing/E2E_TEST_REVIEW_AND_FIXES.md",
          "docs/archive/testing/IMPLEMENTATION_SUMMARY.md",
          "docs/archive/testing/PHASE_2_PLAYWRIGHT_CONFIG_SIMPLIFICATION.md",
          "docs/archive/testing/PHASE_3_FINAL_CLEANUP.md",
          "docs/archive/testing/QUICK_START_TESTING_GUIDE.md",
          "docs/archive/testing/SEARCH_PERFORMANCE_VERIFICATION.md",
          "docs/archive/testing/TEST_COVERAGE_IMPLEMENTATION.md",
          "docs/archive/testing/checkout/CHECKOUT-TEST-COVERAGE-ANALYSIS.md",
          "docs/archive/testing/checkout/E2E_TEST_FIXES.md",
          "docs/archive/testing/checkout/END-TO-END-TESTING-COMPLETE.md",
          "docs/archive/testing/mutation/MUTATION_TESTING_QUICK_REFERENCE.md",
          "docs/archive/testing/mutation/MUTATION_TESTING_REPORT.md",
          "docs/archive/testing/mutation/MUTATION_TESTING_REPORT_ORDER_COMPONENTS.md",
          "docs/archive/testing/mutation/MUTATION_TESTING_SUMMARY.md",
          "docs/archive/testing/mutation/mutation-test-report-checkout.md",
          "docs/archive/testing/playwright/E2E_CHECKOUT_BEST_PRACTICES.md",
          "docs/archive/testing/playwright/PLAYWRIGHT_BEST_PRACTICES_ANALYSIS.md",
          "docs/archive/vercel-debug/VERCEL_ADD_TO_CART_DEBUG.md",
          "docs/archive/vercel-debug/VERCEL_ADD_TO_CART_FIX.md",
          "docs/archive/vercel-debug/VERCEL_CLIENT_BUNDLES_FIX.md",
          "docs/archive/vercel-debug/VERCEL_DEBUG_STEPS.md"
        ],
        "uncategorized": []
      }
    },
    "duplicates": {
      "duplicateSets": [
        {
          "files": [
            {
              "path": "docs/NUXT3_PRODUCT_PAGE_DOCUMENTATION.md",
              "name": "NUXT3_PRODUCT_PAGE_DOCUMENTATION.md",
              "size": 37397,
              "lastModified": "2025-11-09T17:52:02.974Z",
              "content": "# Nuxt 3 Product Listing Page Documentation\n\n## Project Context\n**Moldova Direct Wine E-commerce Site**\n- Nuxt: v3.19.2\n- @nuxt/image: v1.11.0\n- @pinia/nuxt: v0.11.2\n- @nuxtjs/supabase: v1.6.2\n- Vue: v3.5.18\n- Pinia: v3.0.4\n\n**Current Route Rules (nuxt.config.ts):**\n```typescript\nrouteRules: {\n  '/': { swr: 3600, prerender: true },\n  '/products': { swr: 3600 },\n  '/products/**': { swr: 3600 },\n}\n```\n\n---\n\n## 1. Nuxt 3 Core Data Fetching\n\n### 1.1 useFetch vs useAsyncData\n\n#### useFetch\n**Official Documentation:** https://nuxt.com/docs/api/composables/use-fetch\n\n**When to Use:**\n- Simple, straightforward API calls with a URL\n- Loading initial data once on the server\n- Prevents extra calls after hydration\n\n**Syntax:**\n```typescript\nconst { data, pending, error, refresh } = await useFetch('/api/products', {\n  query: { category: 'wine', page: 1 },\n  // Key for caching (auto-generated from URL if not provided)\n  key: 'products-wine-page-1',\n})\n```\n\n**Best Practice:**\n`useFetch` is essentially a wrapper: `useFetch(url)`  `useAsyncData(url, () => $fetch(url))`\n\n#### useAsyncData\n**Official Documentation:** https://nuxt.com/docs/api/composables/use-async-data\n\n**When to Use:**\n- Custom logic beyond simple HTTP requests\n- Third-party APIs with their own query methods (like Supabase)\n- More control over fetching process\n- Multiple data sources combined\n\n**Syntax:**\n```typescript\nconst { data, pending, error } = await useAsyncData(\n  'products-filtered',\n  async () => {\n    const supabase = useSupabaseClient()\n    const { data } = await supabase\n      .from('products')\n      .select('*, categories(*)')\n      .eq('active', true)\n      .range(0, 23)\n    return data\n  }\n)\n```\n\n**Critical Best Practice:**\n- Always specify a unique `key` to avoid unwanted cache reuse\n- The key should represent the unique state of the data being fetched\n\n### 1.2 Lazy Loading Data\n\n#### useLazyFetch\n**Official Documentation:** https://nuxt.com/docs/api/composables/use-lazy-fetch\n\n**Purpose:**\nBy default, `useFetch` blocks navigation until its async handler is resolved. `useLazyFetch` provides a wrapper that triggers navigation before the handler is resolved by setting `lazy: true`.\n\n**Two Approaches:**\n\n**1. Using lazy option:**\n```typescript\nconst { pending, data: products } = await useFetch('/api/products', {\n  lazy: true,\n  server: false, // Client-side only if needed\n})\n```\n\n**2. Using useLazyFetch composable:**\n```typescript\nconst { pending, data: products } = await useLazyFetch('/api/products')\n```\n\n**When to Use:**\n- Non-critical data (below-the-fold content)\n- Data that doesn't affect initial render\n- Improved perceived performance\n\n**Important:** You must manually handle loading state using the `pending` value.\n\n**Example for Product Filters:**\n```vue\n<script setup>\n// Critical data - blocks navigation\nconst { data: products } = await useFetch('/api/products')\n\n// Non-critical data - doesn't block\nconst { pending, data: filters } = await useLazyFetch('/api/filters')\n</script>\n\n<template>\n  <div>\n    <ProductGrid :products=\"products\" />\n    <FilterPanel v-if=\"!pending\" :filters=\"filters\" />\n    <FilterSkeleton v-else />\n  </div>\n</template>\n```\n\n### 1.3 Avoiding Double Fetching\n\n**Problem:**\nUsing `$fetch` in components without wrapping causes double fetching (once on server, once on client).\n\n**Solution:**\n```typescript\n//  Bad - fetches twice\nconst products = await $fetch('/api/products')\n\n//  Good - fetches once, hydrates\nconst { data: products } = await useFetch('/api/products')\n\n//  Good - for custom logic\nconst { data: products } = await useAsyncData('products', () =>\n  $fetch('/api/products')\n)\n```\n\n**When to Use $fetch:**\n- User interactions (button clicks, form submissions)\n- Inside server routes (`/server/api/*`)\n- When you explicitly want client-only fetching\n\n---\n\n## 2. Route Rules & Hybrid Rendering\n\n### 2.1 Understanding Rendering Modes\n\n**Official Guide:** https://nuxt.com/docs/guide/concepts/rendering\n\n#### SWR (Stale-While-Revalidate)\n**Configuration:**\n```typescript\n// nuxt.config.ts\nrouteRules: {\n  // Cache for 1 hour (3600 seconds)\n  '/products': { swr: 3600 },\n\n  // Cache with background revalidation (boolean)\n  '/products/**': { swr: true },\n}\n```\n\n**How It Works:**\n- First request: Generates page, caches it\n- Subsequent requests: Serves cached version immediately\n- Background: Regenerates page asynchronously\n- TTL: If number provided, cache expires after N seconds\n\n**Best For:**\n- Product listings (frequently accessed, updated periodically)\n- Category pages\n- Search results\n\n#### ISR (Incremental Static Regeneration)\n**Configuration:**\n```typescript\nrouteRules: {\n  // ISR with CDN caching (Netlify/Vercel)\n  '/products': { isr: 3600 },\n\n  // ISR until next deploy\n  '/products/**': { isr: true },\n}\n```\n\n**Difference from SWR:**\n- Adds response to CDN cache on platforms that support it\n- If `true`, content persists until next deploy\n- Currently supports Netlify and Vercel\n\n**Best For:**\n- Static product pages with occasional updates\n- Category pages on CDN\n- Blog/content pages\n\n#### Combining Strategies\n```typescript\nexport default defineNuxtConfig({\n  routeRules: {\n    // Homepage: Prerender + SWR\n    '/': { prerender: true, swr: 3600 },\n\n    // Products listing: SWR with 1 hour cache\n    '/products': { swr: 3600 },\n\n    // Individual products: ISR (rebuild on demand)\n    '/products/**': { isr: 3600 },\n\n    // Cart: CSR only (no caching)\n    '/cart': { ssr: false },\n\n    // Admin: SSR, no caching\n    '/admin/**': { ssr: true },\n\n    // API routes: Custom cache headers\n    '/api/products': {\n      cache: {\n        maxAge: 60 * 60, // 1 hour\n        staleMaxAge: 60 * 60 * 24, // 24 hours stale\n      }\n    }\n  }\n})\n```\n\n### 2.2 Best Practices\n\n**For Product Pages:**\n1. **Listing Page:** Use `swr: 3600` (1 hour cache)\n2. **Product Details:** Use `isr: 3600` for CDN caching\n3. **Cart/Checkout:** Use `ssr: false` (client-only)\n\n**Important Notes:**\n- Hybrid Rendering is NOT available with `nuxt generate`\n- Always test caching behavior in production environment\n- Use network tab to verify cache headers\n\n---\n\n## 3. Nuxt Image Module\n\n### 3.1 Responsive Product Images\n\n**Official Documentation:** https://image.nuxt.com/usage/nuxt-img\n\n#### Basic Product Card Image\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  :alt=\"product.name\"\n  width=\"400\"\n  height=\"400\"\n  format=\"webp\"\n  quality=\"80\"\n  loading=\"lazy\"\n  sizes=\"sm:100vw md:50vw lg:33vw xl:25vw\"\n/>\n```\n\n#### Understanding `sizes` Attribute\n\n**How It Works:**\n- Default size applies until next specified screen width\n- `md:400px` means image is 400px on md screens and up\n- More size options = better optimization\n\n**Product Grid Example:**\n```vue\n<!-- 4-column grid on desktop, full-width on mobile -->\n<NuxtImg\n  :src=\"product.image\"\n  sizes=\"100vw sm:50vw md:33vw lg:25vw\"\n  width=\"400\"\n  height=\"400\"\n/>\n```\n\n**Current Project Configuration (nuxt.config.ts):**\n```typescript\nimage: {\n  formats: ['webp', 'avif'],\n  quality: 80,\n  screens: {\n    xs: 320,\n    sm: 640,\n    md: 768,\n    lg: 1024,\n    xl: 1280,\n    xxl: 1536,\n  },\n  presets: {\n    hero: {\n      modifiers: {\n        format: 'webp',\n        quality: 85,\n        fit: 'cover',\n      }\n    }\n  }\n}\n```\n\n#### Creating Product Preset\n```typescript\n// nuxt.config.ts\nimage: {\n  presets: {\n    product: {\n      modifiers: {\n        format: 'webp',\n        quality: 80,\n        fit: 'cover',\n        width: 400,\n        height: 400,\n      }\n    },\n    productThumb: {\n      modifiers: {\n        format: 'webp',\n        quality: 75,\n        width: 200,\n        height: 200,\n      }\n    }\n  }\n}\n\n// Usage in component\n<NuxtImg preset=\"product\" :src=\"product.image\" />\n```\n\n### 3.2 High-DPI Displays (Retina)\n\n**Densities Example:**\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  width=\"400\"\n  height=\"400\"\n  densities=\"x1 x2\"\n/>\n\n<!-- Generates: -->\n<img\n  src=\"/_ipx/w_400/product.jpg\"\n  srcset=\"/_ipx/w_400/product.jpg 1x, /_ipx/w_800/product.jpg 2x\"\n/>\n```\n\n### 3.3 Placeholder Images\n\n**Auto-generated Placeholder:**\n```vue\n<NuxtImg :src=\"product.image\" placeholder />\n```\n\n**Custom Placeholder Size:**\n```vue\n<NuxtImg :src=\"product.image\" :placeholder=\"[50, 25]\" />\n```\n\n**With Blur Effect:**\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  :placeholder=\"img(product.image, { h: 10, blur: 2, q: 50 })\"\n/>\n```\n\n### 3.4 Performance Best Practices\n\n**1. Lazy Loading Product Cards:**\n```vue\n<template>\n  <div class=\"product-grid\">\n    <!-- First 4 products: eager loading (above fold) -->\n    <NuxtImg\n      v-for=\"(product, index) in products.slice(0, 4)\"\n      :key=\"product.id\"\n      :src=\"product.image\"\n      loading=\"eager\"\n      fetchpriority=\"high\"\n    />\n\n    <!-- Remaining products: lazy loading -->\n    <NuxtImg\n      v-for=\"product in products.slice(4)\"\n      :key=\"product.id\"\n      :src=\"product.image\"\n      loading=\"lazy\"\n      fetchpriority=\"low\"\n    />\n  </div>\n</template>\n```\n\n**2. Specify Dimensions (Prevent Layout Shift):**\n```vue\n<!--  Good - prevents CLS -->\n<NuxtImg :src=\"product.image\" width=\"400\" height=\"400\" />\n\n<!--  Bad - causes layout shift -->\n<NuxtImg :src=\"product.image\" />\n```\n\n**3. Use Modern Formats:**\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  format=\"webp\"\n  :modifiers=\"{ quality: 80 }\"\n/>\n```\n\n---\n\n## 4. Pinia Store Patterns\n\n### 4.1 Setup Store (Recommended for Nuxt 3)\n\n**Official Docs:** https://pinia.vuejs.org/ssr/nuxt.html\n\n**Your Current Store Structure (stores/products.ts):**\n- Uses Options API pattern\n- Has built-in caching with TTL\n- Includes pagination, filters, search\n\n**Setup Store Pattern (Modern Alternative):**\n```typescript\n// stores/products.ts\nimport { defineStore } from 'pinia'\nimport { ref, computed } from 'vue'\nimport type { ProductWithRelations, ProductFilters, Pagination } from '~/types'\n\nexport const useProductsStore = defineStore('products', () => {\n  // State (ref)\n  const products = ref<ProductWithRelations[]>([])\n  const loading = ref(false)\n  const filters = ref<ProductFilters>({})\n  const pagination = ref<Pagination>({\n    page: 1,\n    limit: 24,\n    total: 0,\n    totalPages: 0\n  })\n\n  // Getters (computed)\n  const filteredProducts = computed(() => {\n    let filtered = [...products.value]\n\n    if (filters.value.inStock) {\n      filtered = filtered.filter(p => p.stockQuantity > 0)\n    }\n\n    return filtered\n  })\n\n  const hasActiveFilters = computed(() => {\n    return !!(\n      filters.value.category ||\n      filters.value.search ||\n      filters.value.priceMin\n    )\n  })\n\n  // Actions (functions)\n  async function fetchProducts(newFilters: ProductFilters = {}) {\n    loading.value = true\n\n    try {\n      const params = new URLSearchParams()\n      if (newFilters.category) params.append('category', String(newFilters.category))\n      if (newFilters.page) params.append('page', String(newFilters.page))\n\n      const response = await $fetch(`/api/products?${params}`)\n\n      products.value = response.products\n      pagination.value = response.pagination\n      filters.value = { ...newFilters }\n    } catch (error) {\n      console.error('Failed to fetch products:', error)\n    } finally {\n      loading.value = false\n    }\n  }\n\n  function updateFilters(newFilters: Partial<ProductFilters>) {\n    filters.value = { ...filters.value, ...newFilters }\n  }\n\n  function clearFilters() {\n    filters.value = {}\n  }\n\n  return {\n    // State\n    products,\n    loading,\n    filters,\n    pagination,\n\n    // Getters\n    filteredProducts,\n    hasActiveFilters,\n\n    // Actions\n    fetchProducts,\n    updateFilters,\n    clearFilters,\n  }\n})\n```\n\n### 4.2 Nuxt 3 Integration\n\n**Auto-Import Configuration (nuxt.config.ts):**\n```typescript\nexport default defineNuxtConfig({\n  modules: ['@pinia/nuxt'],\n  pinia: {\n    storesDirs: ['./stores/**'],\n  },\n})\n```\n\n**Auto-imported:**\n- `usePinia()` - Better Nuxt integration than `getActivePinia()`\n- `defineStore()` - Store definition\n- `storeToRefs()` - Extract reactive references\n- All stores in `./stores/**`\n\n### 4.3 Using Stores in Components\n\n**Basic Usage:**\n```vue\n<script setup>\nconst productsStore = useProductsStore()\n\n// Direct access (loses reactivity when destructured)\nconst { products, loading } = productsStore\n\n// Reactive access (maintains reactivity)\nimport { storeToRefs } from 'pinia'\nconst { products, loading } = storeToRefs(productsStore)\n\n// Actions don't need storeToRefs\nconst { fetchProducts, updateFilters } = productsStore\n</script>\n```\n\n**With Data Fetching (callOnce):**\n```vue\n<script setup>\nconst productsStore = useProductsStore()\n\n// Prevents redundant requests during SSR/hydration\nawait callOnce('products', () => productsStore.fetchProducts())\n</script>\n```\n\n### 4.4 Filter State Management Pattern\n\n**Current Implementation (your products.ts):**\n```typescript\n// State\nfilters: ProductFilters\npagination: Pagination\n\n// Actions\nupdateFilters(newFilters: Partial<ProductFilters>) {\n  this.filters = { ...this.filters, ...newFilters }\n\n  // Reset pagination when filters change\n  if (newFilters.category !== undefined ||\n      newFilters.search !== undefined) {\n    this.filters.page = 1\n  }\n}\n\n// Usage in component\nconst handleFiltersUpdate = (newFilters: Partial<ProductFilters>) => {\n  productsStore.updateFilters(newFilters)\n  productsStore.fetchProducts(productsStore.filters)\n}\n```\n\n**Persistent Filters with localStorage:**\n```typescript\n// stores/products.ts\nimport { useStorage } from '@vueuse/core'\n\nexport const useProductsStore = defineStore('products', () => {\n  // Persist filters to localStorage\n  const filters = useStorage<ProductFilters>('product-filters', {\n    page: 1,\n    limit: 24,\n  })\n\n  // Rest of store...\n})\n```\n\n### 4.5 SSR Compatibility\n\n**Important Notes:**\n- `@pinia/nuxt` automatically handles SSR state synchronization\n- No manual serialization/hydration needed\n- State is serialized on server, hydrated on client\n\n**Avoid Initialization Outside Functions:**\n```typescript\n//  Bad - fails during SSR\nconst productsStore = useProductsStore()\n\nexport default defineNuxtComponent({\n  setup() {\n    // Store called before Pinia is ready\n  }\n})\n\n//  Good - called inside function\nexport default defineNuxtComponent({\n  setup() {\n    const productsStore = useProductsStore()\n    // Pinia is initialized\n  }\n})\n```\n\n---\n\n## 5. Vue 3 Composition API Patterns\n\n### 5.1 Watching Route Params\n\n**Official Docs:** https://router.vuejs.org/guide/advanced/composition-api.html\n\n**Basic Pattern:**\n```vue\n<script setup>\nimport { watch } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst route = useRoute()\nconst productsStore = useProductsStore()\n\n// Watch specific route properties (recommended)\nwatch(\n  () => route.query.category,\n  async (newCategory) => {\n    if (newCategory) {\n      await productsStore.fetchProducts({ category: newCategory })\n    }\n  }\n)\n\n//  Avoid watching entire route object\nwatch(route, (newRoute) => {\n  // This triggers too often\n})\n</script>\n```\n\n**Multiple Query Parameters:**\n```vue\n<script setup>\nimport { watch } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst route = useRoute()\n\nwatch(\n  () => [route.query.category, route.query.sort, route.query.page],\n  async ([category, sort, page]) => {\n    await productsStore.fetchProducts({\n      category,\n      sort,\n      page: Number(page) || 1,\n    })\n  }\n)\n</script>\n```\n\n**Navigation Guards:**\n```vue\n<script setup>\nimport { onBeforeRouteUpdate } from 'vue-router'\n\nonBeforeRouteUpdate(async (to, from) => {\n  // Fetch new data when route params change\n  if (to.params.category !== from.params.category) {\n    await productsStore.fetchCategory(to.params.category)\n  }\n})\n</script>\n```\n\n### 5.2 Computed Filters\n\n**Derived State from Filters:**\n```vue\n<script setup>\nimport { computed } from 'vue'\n\nconst productsStore = useProductsStore()\nconst { products, filters } = storeToRefs(productsStore)\n\n// Client-side filtering for immediate feedback\nconst filteredProducts = computed(() => {\n  let result = products.value\n\n  if (filters.value.search) {\n    const query = filters.value.search.toLowerCase()\n    result = result.filter(p =>\n      p.name.toLowerCase().includes(query) ||\n      p.description?.toLowerCase().includes(query)\n    )\n  }\n\n  if (filters.value.inStock) {\n    result = result.filter(p => p.stockQuantity > 0)\n  }\n\n  return result\n})\n</script>\n```\n\n### 5.3 URL Query Synchronization\n\n**Sync Filters with URL:**\n```vue\n<script setup>\nimport { watch } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\n\nconst route = useRoute()\nconst router = useRouter()\nconst productsStore = useProductsStore()\n\n// Update store from URL on mount\nonMounted(() => {\n  const urlFilters = {\n    category: route.query.category,\n    search: route.query.search,\n    page: Number(route.query.page) || 1,\n  }\n\n  productsStore.updateFilters(urlFilters)\n})\n\n// Update URL when filters change\nwatch(\n  () => productsStore.filters,\n  (newFilters) => {\n    router.push({\n      query: {\n        ...route.query,\n        category: newFilters.category || undefined,\n        search: newFilters.search || undefined,\n        page: newFilters.page || undefined,\n      }\n    })\n  },\n  { deep: true }\n)\n</script>\n```\n\n### 5.4 Provide/Inject Pattern\n\n**Product Context (for nested components):**\n```vue\n<!-- pages/products/[slug].vue -->\n<script setup>\nimport { provide } from 'vue'\n\nconst product = ref<ProductWithRelations>()\n\n// Fetch product\nconst { data } = await useFetch(`/api/products/${route.params.slug}`)\nproduct.value = data.value\n\n// Provide to child components\nprovide('product', readonly(product))\n</script>\n\n<!-- components/product/Details.vue -->\n<script setup>\nimport { inject } from 'vue'\n\nconst product = inject('product')\n</script>\n```\n\n### 5.5 Virtual Scrolling for Large Lists\n\n**Using vue-virtual-scroller:**\n\n**Installation:**\n```bash\npnpm add vue-virtual-scroller@next\n```\n\n**Nuxt Plugin (plugins/virtual-scroller.client.ts):**\n```typescript\nimport VirtualScroller from 'vue-virtual-scroller'\nimport 'vue-virtual-scroller/dist/vue-virtual-scroller.css'\n\nexport default defineNuxtPlugin((nuxtApp) => {\n  nuxtApp.vueApp.use(VirtualScroller)\n})\n```\n\n**Component Usage:**\n```vue\n<template>\n  <RecycleScroller\n    :items=\"products\"\n    :item-size=\"320\"\n    key-field=\"id\"\n    v-slot=\"{ item }\"\n  >\n    <ProductCard :product=\"item\" />\n  </RecycleScroller>\n</template>\n\n<script setup>\nimport { RecycleScroller } from 'vue-virtual-scroller'\n\nconst products = ref([]) // Large array of 1000+ products\n</script>\n```\n\n**Best Practices:**\n1. **Don't make lists reactive:** Avoid wrapping with `ref()`/`reactive()` for best performance\n2. **Use Object.freeze():** For Options API\n3. **Set accurate item size:** Closer to average = better scrollbar\n4. **Use proper keys:** Avoid array indexes\n\n**Current Implementation (your mobile/VirtualProductGrid.vue):**\nYour project already has a custom virtual scroller at `/components/mobile/VirtualProductGrid.vue`\n\n---\n\n## 6. TypeScript Patterns\n\n### 6.1 Product Type Definitions\n\n**Your Current Types (types/index.ts):**\n```typescript\nexport type {\n  Product,\n  ProductImage,\n  ProductAttribute,\n  ProductWithRelations,\n  ProductFilters,\n  PriceRange,\n  AttributeFilter,\n  Pagination,\n  ProductListResponse,\n  ProductDetailResponse,\n}\n```\n\n**Extended Product Types:**\n```typescript\n// types/database.ts\nexport interface Product {\n  id: number\n  name: Translations\n  slug: string\n  description: Translations | null\n  price: number\n  compareAtPrice: number | null\n  costPrice: number | null\n  sku: string\n  barcode: string | null\n  stockQuantity: number\n  stockStatus: 'in_stock' | 'low_stock' | 'out_of_stock'\n  isFeatured: boolean\n  isActive: boolean\n  weight: number | null\n  dimensions: {\n    length: number | null\n    width: number | null\n    height: number | null\n  } | null\n  createdAt: string\n  updatedAt: string\n}\n\nexport interface ProductWithRelations extends Product {\n  categories: Category[]\n  images: ProductImage[]\n  attributes: ProductAttribute[]\n  reviews?: ProductReview[]\n  variants?: ProductVariant[]\n}\n\nexport interface ProductFilters {\n  category?: string | number\n  search?: string\n  priceMin?: number\n  priceMax?: number\n  inStock?: boolean\n  featured?: boolean\n  sort?: 'created' | 'name' | 'price_asc' | 'price_desc' | 'featured'\n  page?: number\n  limit?: number\n  attributes?: Record<string, string[]>\n}\n\nexport interface Pagination {\n  page: number\n  limit: number\n  total: number\n  totalPages: number\n}\n```\n\n### 6.2 API Response Types\n\n**Type-safe API Responses:**\n```typescript\n// types/api.ts\nexport interface ProductListResponse {\n  success: boolean\n  products: ProductWithRelations[]\n  pagination: Pagination\n  filters?: ProductFilters\n}\n\nexport interface ProductDetailResponse {\n  success: boolean\n  product: ProductWithRelations\n  relatedProducts: ProductWithRelations[]\n}\n\nexport interface SearchResponse {\n  success: boolean\n  products: ProductWithRelations[]\n  suggestions: string[]\n  total: number\n}\n```\n\n**Usage in Components:**\n```vue\n<script setup lang=\"ts\">\nimport type { ProductListResponse } from '~/types'\n\nconst { data, error } = await useFetch<ProductListResponse>('/api/products', {\n  query: {\n    category: 'wine',\n    page: 1,\n  }\n})\n\n// Type-safe access\nif (data.value) {\n  const products = data.value.products // ProductWithRelations[]\n  const total = data.value.pagination.total // number\n}\n</script>\n```\n\n### 6.3 Component Prop Types\n\n**Typed Props:**\n```vue\n<script setup lang=\"ts\">\nimport type { ProductWithRelations } from '~/types'\n\ninterface Props {\n  product: ProductWithRelations\n  showQuickView?: boolean\n  loading?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  showQuickView: false,\n  loading: false,\n})\n\n// Fully typed\nconst productName = props.product.name.es\n</script>\n```\n\n### 6.4 Composable Types\n\n**Type-safe Composables:**\n```typescript\n// composables/useProductCatalog.ts\nimport type { ProductFilters, ProductWithRelations, Pagination } from '~/types'\n\nexport function useProductCatalog() {\n  const products = ref<ProductWithRelations[]>([])\n  const filters = ref<ProductFilters>({})\n  const pagination = ref<Pagination>({\n    page: 1,\n    limit: 24,\n    total: 0,\n    totalPages: 0,\n  })\n\n  async function fetchProducts(\n    newFilters: ProductFilters = {}\n  ): Promise<void> {\n    // Implementation\n  }\n\n  return {\n    products: readonly(products),\n    filters: readonly(filters),\n    pagination: readonly(pagination),\n    fetchProducts,\n  }\n}\n\n// Usage with full type inference\nconst { products, fetchProducts } = useProductCatalog()\n```\n\n---\n\n## 7. Supabase Integration\n\n### 7.1 Querying Products with Filters\n\n**Official Docs:** https://supabase.com/docs/reference/javascript/range\n\n**Basic Product Query:**\n```typescript\n// server/api/products.get.ts\nimport { serverSupabaseClient } from '#supabase/server'\nimport type { Database } from '~/types/supabase'\n\nexport default defineEventHandler(async (event) => {\n  const supabase = await serverSupabaseClient<Database>(event)\n  const query = getQuery(event)\n\n  let dbQuery = supabase\n    .from('products')\n    .select(`\n      *,\n      categories:product_categories(\n        category:categories(*)\n      ),\n      images:product_images(*),\n      attributes:product_attributes(*)\n    `)\n    .eq('is_active', true)\n\n  // Apply filters\n  if (query.category) {\n    dbQuery = dbQuery.eq('category_id', query.category)\n  }\n\n  if (query.search) {\n    dbQuery = dbQuery.ilike('name', `%${query.search}%`)\n  }\n\n  if (query.inStock) {\n    dbQuery = dbQuery.gt('stock_quantity', 0)\n  }\n\n  // Sorting\n  const sort = query.sort || 'created'\n  switch (sort) {\n    case 'name':\n      dbQuery = dbQuery.order('name', { ascending: true })\n      break\n    case 'price_asc':\n      dbQuery = dbQuery.order('price', { ascending: true })\n      break\n    case 'price_desc':\n      dbQuery = dbQuery.order('price', { ascending: false })\n      break\n    default:\n      dbQuery = dbQuery.order('created_at', { ascending: false })\n  }\n\n  // Get total count\n  const { count } = await supabase\n    .from('products')\n    .select('*', { count: 'exact', head: true })\n\n  // Pagination\n  const page = Number(query.page) || 1\n  const limit = Number(query.limit) || 24\n  const from = (page - 1) * limit\n  const to = from + limit - 1\n\n  dbQuery = dbQuery.range(from, to)\n\n  const { data: products, error } = await dbQuery\n\n  if (error) throw error\n\n  return {\n    success: true,\n    products,\n    pagination: {\n      page,\n      limit,\n      total: count || 0,\n      totalPages: Math.ceil((count || 0) / limit),\n    }\n  }\n})\n```\n\n### 7.2 Pagination Best Practices\n\n**Important:** The `range()` method respects query order. Always use `.order()` before `.range()` for predictable results.\n\n**Pagination Helper:**\n```typescript\n// utils/pagination.ts\nexport function calculateRange(page: number, limit: number) {\n  const from = (page - 1) * limit\n  const to = from + limit - 1\n  return { from, to }\n}\n\n// Usage\nconst { from, to } = calculateRange(currentPage, 24)\nconst { data } = await supabase\n  .from('products')\n  .select('*')\n  .order('created_at', { ascending: false })\n  .range(from, to)\n```\n\n### 7.3 Advanced Filtering\n\n**Price Range Filter:**\n```typescript\nlet query = supabase.from('products').select('*')\n\nif (priceMin) {\n  query = query.gte('price', priceMin)\n}\n\nif (priceMax) {\n  query = query.lte('price', priceMax)\n}\n```\n\n**Multiple Categories (OR condition):**\n```typescript\nif (categoryIds?.length) {\n  query = query.in('category_id', categoryIds)\n}\n```\n\n**Nested Filter (Product Attributes):**\n```typescript\n// Filter by wine type attribute\nquery = query.contains('attributes', [\n  { key: 'wine_type', value: 'red' }\n])\n```\n\n### 7.4 Real-time Product Updates\n\n**Subscribe to Changes:**\n```vue\n<script setup>\nimport { useSupabaseClient } from '#imports'\n\nconst supabase = useSupabaseClient()\nconst products = ref([])\n\n// Subscribe to product changes\nconst subscription = supabase\n  .channel('products')\n  .on(\n    'postgres_changes',\n    {\n      event: '*',\n      schema: 'public',\n      table: 'products'\n    },\n    (payload) => {\n      if (payload.eventType === 'INSERT') {\n        products.value.push(payload.new)\n      } else if (payload.eventType === 'UPDATE') {\n        const index = products.value.findIndex(p => p.id === payload.new.id)\n        if (index !== -1) {\n          products.value[index] = payload.new\n        }\n      } else if (payload.eventType === 'DELETE') {\n        products.value = products.value.filter(p => p.id !== payload.old.id)\n      }\n    }\n  )\n  .subscribe()\n\nonUnmounted(() => {\n  subscription.unsubscribe()\n})\n</script>\n```\n\n### 7.5 Search Optimization\n\n**Full-Text Search:**\n```typescript\n// Create text search configuration (run once in Supabase SQL editor)\n// ALTER TABLE products ADD COLUMN search_vector tsvector;\n// CREATE INDEX products_search_idx ON products USING gin(search_vector);\n\n// Update trigger\n// CREATE TRIGGER products_search_update\n//   BEFORE INSERT OR UPDATE ON products\n//   FOR EACH ROW EXECUTE FUNCTION\n//   tsvector_update_trigger(search_vector, 'pg_catalog.english', name, description);\n\n// Query with full-text search\nconst { data } = await supabase\n  .from('products')\n  .select('*')\n  .textSearch('search_vector', query, {\n    type: 'websearch',\n    config: 'english'\n  })\n```\n\n**TypeScript Support:**\n```typescript\n// Generate types from Supabase schema\nnpx supabase gen types typescript --project-id YOUR_PROJECT_ID > types/supabase.ts\n\n// Use in queries\nimport type { Database } from '~/types/supabase'\n\nconst supabase = useSupabaseClient<Database>()\nconst { data } = await supabase\n  .from('products')\n  .select('*')\n\n// data is fully typed!\n```\n\n---\n\n## 8. SEO & Head Management\n\n### 8.1 Product Listing Page SEO\n\n```vue\n<script setup>\nconst route = useRoute()\nconst productsStore = useProductsStore()\n\nconst seoTitle = computed(() => {\n  if (productsStore.filters.category) {\n    return `${getCategoryName()} - Moldova Direct`\n  }\n  return 'Shop Moldovan Wine & Food - Moldova Direct'\n})\n\nconst seoDescription = computed(() => {\n  if (productsStore.filters.category) {\n    return `Browse our selection of ${getCategoryName().toLowerCase()}. Authentic Moldovan products delivered to Spain.`\n  }\n  return 'Browse authentic Moldovan food and wine products. Premium quality directly from Moldova to Spain.'\n})\n\nuseHead({\n  title: seoTitle,\n  meta: [\n    { name: 'description', content: seoDescription },\n    { property: 'og:title', content: seoTitle },\n    { property: 'og:description', content: seoDescription },\n    { property: 'og:type', content: 'website' },\n    { property: 'og:url', content: `https://moldovadirect.com${route.path}` },\n  ],\n  link: [\n    { rel: 'canonical', href: `https://moldovadirect.com${route.path}` }\n  ]\n})\n\n// Or use useSeoMeta for type safety\nuseSeoMeta({\n  title: seoTitle,\n  description: seoDescription,\n  ogTitle: seoTitle,\n  ogDescription: seoDescription,\n  ogType: 'website',\n  ogUrl: `https://moldovadirect.com${route.path}`,\n  twitterCard: 'summary_large_image',\n})\n</script>\n```\n\n### 8.2 Product Detail Page SEO\n\n```vue\n<script setup>\nconst route = useRoute()\nconst { data: product } = await useFetch(`/api/products/${route.params.slug}`)\n\nif (!product.value) {\n  throw createError({ statusCode: 404, message: 'Product not found' })\n}\n\nuseSeoMeta({\n  title: `${product.value.name.en} - Moldova Direct`,\n  description: product.value.description?.en || product.value.name.en,\n  ogTitle: product.value.name.en,\n  ogDescription: product.value.description?.en,\n  ogImage: product.value.images[0]?.url,\n  ogType: 'product',\n  productPrice: product.value.price.toString(),\n  productCurrency: 'EUR',\n  productAvailability: product.value.stockQuantity > 0 ? 'in stock' : 'out of stock',\n})\n\n// Structured data for Google Shopping\nuseHead({\n  script: [\n    {\n      type: 'application/ld+json',\n      children: JSON.stringify({\n        '@context': 'https://schema.org',\n        '@type': 'Product',\n        name: product.value.name.en,\n        description: product.value.description?.en,\n        image: product.value.images.map(img => img.url),\n        sku: product.value.sku,\n        offers: {\n          '@type': 'Offer',\n          price: product.value.price,\n          priceCurrency: 'EUR',\n          availability: product.value.stockQuantity > 0\n            ? 'https://schema.org/InStock'\n            : 'https://schema.org/OutOfStock',\n        }\n      })\n    }\n  ]\n})\n</script>\n```\n\n---\n\n## 9. Common Patterns & Pitfalls\n\n### 9.1 Infinite Scroll Pattern\n\n```vue\n<script setup>\nimport { useIntersectionObserver } from '@vueuse/core'\n\nconst productsStore = useProductsStore()\nconst { products, pagination, loading } = storeToRefs(productsStore)\n\nconst loadMoreTrigger = ref<HTMLElement>()\nconst canLoadMore = computed(() =>\n  pagination.value.page < pagination.value.totalPages && !loading.value\n)\n\nuseIntersectionObserver(\n  loadMoreTrigger,\n  ([{ isIntersecting }]) => {\n    if (isIntersecting && canLoadMore.value) {\n      productsStore.fetchProducts({\n        ...productsStore.filters,\n        page: pagination.value.page + 1,\n      })\n    }\n  }\n)\n</script>\n\n<template>\n  <div>\n    <ProductCard v-for=\"product in products\" :key=\"product.id\" :product=\"product\" />\n    <div ref=\"loadMoreTrigger\" class=\"h-10\" />\n    <div v-if=\"loading\" class=\"text-center\">Loading more...</div>\n  </div>\n</template>\n```\n\n### 9.2 Debounced Search\n\n```vue\n<script setup>\nimport { useDebounceFn } from '@vueuse/core'\n\nconst searchQuery = ref('')\nconst productsStore = useProductsStore()\n\nconst performSearch = useDebounceFn((query: string) => {\n  if (query.trim()) {\n    productsStore.searchProducts(query)\n  } else {\n    productsStore.fetchProducts()\n  }\n}, 300)\n\nwatch(searchQuery, (newQuery) => {\n  performSearch(newQuery)\n})\n</script>\n\n<template>\n  <input v-model=\"searchQuery\" type=\"search\" placeholder=\"Search products...\" />\n</template>\n```\n\n### 9.3 Filter Persistence\n\n```vue\n<script setup>\nimport { useStorage } from '@vueuse/core'\n\nconst savedFilters = useStorage<ProductFilters>(\n  'product-filters',\n  {\n    page: 1,\n    limit: 24,\n  },\n  localStorage,\n  { mergeDefaults: true }\n)\n\nconst productsStore = useProductsStore()\n\nonMounted(() => {\n  // Restore filters from localStorage\n  productsStore.updateFilters(savedFilters.value)\n  productsStore.fetchProducts(savedFilters.value)\n})\n\nwatch(\n  () => productsStore.filters,\n  (newFilters) => {\n    // Save to localStorage\n    savedFilters.value = newFilters\n  },\n  { deep: true }\n)\n</script>\n```\n\n### 9.4 Common Pitfalls\n\n**1. Double Fetching:**\n```vue\n<!--  Bad -->\n<script setup>\nconst { data } = await useFetch('/api/products')\nconst products = await $fetch('/api/products') // Fetches twice!\n</script>\n\n<!--  Good -->\n<script setup>\nconst { data: products } = await useFetch('/api/products')\n</script>\n```\n\n**2. Not Handling Loading States:**\n```vue\n<!--  Bad -->\n<script setup>\nconst { data } = await useLazyFetch('/api/products')\n</script>\n<template>\n  <div>{{ data.products.length }}</div> <!-- Error if data is null -->\n</template>\n\n<!--  Good -->\n<script setup>\nconst { pending, data } = await useLazyFetch('/api/products')\n</script>\n<template>\n  <div v-if=\"pending\">Loading...</div>\n  <div v-else-if=\"data\">{{ data.products.length }}</div>\n</template>\n```\n\n**3. Not Specifying Keys:**\n```typescript\n//  Bad - cache collision\nawait useFetch('/api/products') // Uses '/api/products' as key\nawait useFetch('/api/products') // Same key, returns cached data\n\n//  Good - unique keys\nawait useFetch('/api/products', { key: 'products-all' })\nawait useFetch('/api/products', {\n  key: 'products-wine',\n  query: { category: 'wine' }\n})\n```\n\n**4. Watching Entire Route Object:**\n```vue\n<!--  Bad -->\n<script setup>\nwatch(route, () => { /* triggers on every navigation */ })\n</script>\n\n<!--  Good -->\n<script setup>\nwatch(() => route.query.category, () => { /* only when category changes */ })\n</script>\n```\n\n---\n\n## 10. Implementation Checklist\n\n### Product Listing Page\n\n- [ ] Implement `useFetch` or `useAsyncData` for product fetching\n- [ ] Add proper `key` to avoid cache collisions\n- [ ] Use `lazy: true` for below-fold content\n- [ ] Configure route rules (`swr: 3600`)\n- [ ] Implement pagination with Supabase `.range()`\n- [ ] Add loading states and skeletons\n- [ ] Optimize images with NuxtImg\n  - [ ] Use `loading=\"lazy\"` for products below fold\n  - [ ] Set `sizes` attribute for responsive images\n  - [ ] Add `width` and `height` to prevent CLS\n- [ ] Implement filter state management with Pinia\n- [ ] Sync filters with URL query params\n- [ ] Add debounced search (300ms)\n- [ ] Implement SEO meta tags with `useSeoMeta`\n- [ ] Add structured data (JSON-LD)\n\n### Performance Optimizations\n\n- [ ] Enable SWR/ISR in route rules\n- [ ] Lazy load filter panel\n- [ ] Use virtual scrolling for 100+ products\n- [ ] Implement infinite scroll (optional)\n- [ ] Add filter persistence (localStorage)\n- [ ] Optimize Supabase queries (indexes)\n- [ ] Use `Object.freeze()` for large product arrays\n- [ ] Implement image placeholders\n\n### TypeScript\n\n- [ ] Define product types\n- [ ] Type API responses\n- [ ] Type component props\n- [ ] Generate Supabase types\n\n---\n\n## Resources\n\n### Official Documentation\n- **Nuxt 3:** https://nuxt.com/docs\n- **Nuxt Image:** https://image.nuxt.com\n- **Pinia:** https://pinia.vuejs.org\n- **Vue Router:** https://router.vuejs.org\n- **Supabase JS:** https://supabase.com/docs/reference/javascript\n\n### Useful Articles\n- Nuxt Data Fetching Guide: https://masteringnuxt.com/blog/data-fetching-basics\n- Nuxt Rendering Modes: https://blog.risingstack.com/nuxt-3-rendering-modes/\n- Pinia Nuxt Integration: https://pinia.vuejs.org/ssr/nuxt.html\n- Vue Virtual Scroller: https://github.com/Rootmen/vue3-virtual-scroll-list\n\n### Your Project Structure\n```\n/stores\n  /products.ts              # Main products store (Options API)\n  /categories.ts            # Categories store\n  /search.ts                # Search store\n\n/pages\n  /products\n    /index.vue              # Product listing page\n    /[slug].vue             # Product detail page\n\n/components\n  /product\n    /Card.vue               # Product card component\n    /Filter/\n      /Main.vue             # Filter panel\n    /CategoryNavigation.vue # Category navigation\n  /mobile\n    /VirtualProductGrid.vue # Virtual scroller for mobile\n\n/types\n  /index.ts                 # Main types export\n  /database.ts              # Database types\n\n/server/api\n  /products\n    /index.get.ts           # GET /api/products\n    /[slug].get.ts          # GET /api/products/:slug\n    /price-range.get.ts     # GET /api/products/price-range\n```\n\n---\n\n## Next Steps\n\n1. **Review Current Implementation:**\n   - Check `/pages/products/index.vue` (currently using Options API patterns)\n   - Review `/stores/products.ts` (already has good caching)\n   - Analyze filter synchronization with URL\n\n2. **Consider Refactoring:**\n   - Convert Pinia store to Setup Stores (optional, for consistency)\n   - Add virtual scrolling for products > 100\n   - Implement infinite scroll pattern\n   - Add filter persistence\n\n3. **Performance Audit:**\n   - Test SWR caching in production\n   - Measure image loading performance\n   - Check Supabase query performance\n   - Add database indexes if needed\n\n4. **SEO Enhancements:**\n   - Add structured data to product listing\n   - Implement breadcrumbs\n   - Add canonical URLs\n   - Generate XML sitemap\n\n---\n\n**Generated:** 2025-11-09\n**For:** Moldova Direct Wine E-commerce\n**Version:** Nuxt 3.19.2\n",
              "category": "reference"
            },
            {
              "path": "docs/QUICK_REFERENCE_PRODUCT_PAGES.md",
              "name": "QUICK_REFERENCE_PRODUCT_PAGES.md",
              "size": 7322,
              "lastModified": "2025-11-09T17:52:02.974Z",
              "content": "# Quick Reference: Product Pages\n\n## Data Fetching Cheat Sheet\n\n### When to Use What\n\n| Scenario | Use | Example |\n|----------|-----|---------|\n| Simple API call | `useFetch` | `useFetch('/api/products')` |\n| Supabase query | `useAsyncData` | `useAsyncData('products', async () => supabase.from('products').select())` |\n| Below-fold data | `useLazyFetch` | `useLazyFetch('/api/filters')` |\n| User interaction | `$fetch` | `$fetch('/api/cart', { method: 'POST' })` |\n\n### Common Patterns\n\n**Basic Product List:**\n```vue\n<script setup>\nconst { data, pending } = await useFetch('/api/products', {\n  key: 'products-all',\n  query: { category: 'wine' }\n})\n</script>\n```\n\n**With Supabase:**\n```vue\n<script setup>\nconst { data } = await useAsyncData('products', async () => {\n  const supabase = useSupabaseClient()\n  const { data } = await supabase\n    .from('products')\n    .select('*')\n    .order('created_at', { ascending: false })\n    .range(0, 23)\n  return data\n})\n</script>\n```\n\n---\n\n## Route Rules Quick Reference\n\n```typescript\n// nuxt.config.ts\nexport default defineNuxtConfig({\n  routeRules: {\n    // SWR - 1 hour cache\n    '/products': { swr: 3600 },\n\n    // ISR - CDN cache\n    '/products/**': { isr: 3600 },\n\n    // Client-only (no SSR)\n    '/cart': { ssr: false },\n\n    // Prerender + SWR\n    '/': { prerender: true, swr: 3600 },\n  }\n})\n```\n\n---\n\n## Nuxt Image Quick Patterns\n\n**Product Card:**\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  width=\"400\"\n  height=\"400\"\n  format=\"webp\"\n  loading=\"lazy\"\n  sizes=\"sm:100vw md:50vw lg:33vw xl:25vw\"\n  :alt=\"product.name\"\n/>\n```\n\n**Hero Image (above fold):**\n```vue\n<NuxtImg\n  :src=\"heroImage\"\n  loading=\"eager\"\n  fetchpriority=\"high\"\n  format=\"webp\"\n  sizes=\"100vw\"\n/>\n```\n\n**With Placeholder:**\n```vue\n<NuxtImg\n  :src=\"product.image\"\n  placeholder\n  sizes=\"sm:100vw md:50vw lg:400px\"\n/>\n```\n\n---\n\n## Pinia Store Patterns\n\n**Setup Store (Modern):**\n```typescript\nexport const useProductsStore = defineStore('products', () => {\n  const products = ref([])\n  const loading = ref(false)\n\n  async function fetchProducts(filters = {}) {\n    loading.value = true\n    const { data } = await $fetch('/api/products', { query: filters })\n    products.value = data\n    loading.value = false\n  }\n\n  return { products, loading, fetchProducts }\n})\n```\n\n**Use in Component:**\n```vue\n<script setup>\nimport { storeToRefs } from 'pinia'\n\nconst store = useProductsStore()\nconst { products, loading } = storeToRefs(store)\nconst { fetchProducts } = store\n\nawait callOnce('products', () => fetchProducts())\n</script>\n```\n\n---\n\n## Supabase Queries\n\n**Basic Query:**\n```typescript\nconst { data } = await supabase\n  .from('products')\n  .select('*')\n  .eq('is_active', true)\n```\n\n**With Relations:**\n```typescript\nconst { data } = await supabase\n  .from('products')\n  .select(`\n    *,\n    categories(*),\n    images:product_images(*)\n  `)\n```\n\n**Pagination:**\n```typescript\nconst page = 1\nconst limit = 24\nconst from = (page - 1) * limit\nconst to = from + limit - 1\n\nconst { data } = await supabase\n  .from('products')\n  .select('*')\n  .order('created_at', { ascending: false })\n  .range(from, to)\n```\n\n**Filters:**\n```typescript\nlet query = supabase.from('products').select('*')\n\nif (category) query = query.eq('category_id', category)\nif (search) query = query.ilike('name', `%${search}%`)\nif (priceMin) query = query.gte('price', priceMin)\nif (priceMax) query = query.lte('price', priceMax)\nif (inStock) query = query.gt('stock_quantity', 0)\n\nconst { data } = await query\n```\n\n---\n\n## Vue Router Patterns\n\n**Watch Route Params:**\n```vue\n<script setup>\nimport { watch } from 'vue'\nimport { useRoute } from 'vue-router'\n\nconst route = useRoute()\n\nwatch(\n  () => route.query.category,\n  async (newCategory) => {\n    await fetchProducts({ category: newCategory })\n  }\n)\n</script>\n```\n\n**Sync with URL:**\n```vue\n<script setup>\nimport { useRouter } from 'vue-router'\n\nconst router = useRouter()\n\nfunction updateURL(filters) {\n  router.push({\n    query: {\n      category: filters.category || undefined,\n      page: filters.page || undefined,\n    }\n  })\n}\n</script>\n```\n\n---\n\n## TypeScript Quick Types\n\n```typescript\n// Product Types\ninterface Product {\n  id: number\n  name: Translations\n  slug: string\n  price: number\n  stockQuantity: number\n}\n\ninterface ProductWithRelations extends Product {\n  categories: Category[]\n  images: ProductImage[]\n  attributes: ProductAttribute[]\n}\n\n// Filter Types\ninterface ProductFilters {\n  category?: string | number\n  search?: string\n  priceMin?: number\n  priceMax?: number\n  inStock?: boolean\n  page?: number\n  limit?: number\n}\n\n// API Response\ninterface ProductListResponse {\n  success: boolean\n  products: ProductWithRelations[]\n  pagination: Pagination\n}\n```\n\n---\n\n## SEO Quick Pattern\n\n```vue\n<script setup>\nuseSeoMeta({\n  title: 'Shop Moldovan Wine - Moldova Direct',\n  description: 'Browse authentic Moldovan wine and food products.',\n  ogTitle: 'Shop Moldovan Wine',\n  ogDescription: 'Premium quality directly from Moldova to Spain.',\n  ogImage: '/images/og-products.jpg',\n  ogType: 'website',\n})\n</script>\n```\n\n---\n\n## Performance Checklist\n\n### Product Listing Page\n- [ ] Use `useFetch` with unique `key`\n- [ ] Add route rule: `{ swr: 3600 }`\n- [ ] Lazy load images below fold\n- [ ] Set image `width` and `height`\n- [ ] Use `sizes` attribute\n- [ ] Debounce search (300ms)\n- [ ] Add loading skeletons\n- [ ] Implement pagination\n\n### Images\n- [ ] First 4 products: `loading=\"eager\"`\n- [ ] Rest: `loading=\"lazy\"`\n- [ ] Use `format=\"webp\"`\n- [ ] Set proper `sizes`\n- [ ] Add placeholders\n\n### Caching\n- [ ] Route rule configured\n- [ ] Unique keys for `useFetch`\n- [ ] Client-side cache in store\n- [ ] Filter persistence (optional)\n\n---\n\n## Common Mistakes to Avoid\n\n1. **Don't watch entire route object**\n   ```typescript\n   //  Bad\n   watch(route, ...)\n\n   //  Good\n   watch(() => route.query.category, ...)\n   ```\n\n2. **Don't forget keys**\n   ```typescript\n   //  Bad - cache collision\n   useFetch('/api/products')\n\n   //  Good\n   useFetch('/api/products', { key: 'products-all' })\n   ```\n\n3. **Don't use $fetch in components (for initial data)**\n   ```typescript\n   //  Bad - fetches twice\n   const data = await $fetch('/api/products')\n\n   //  Good\n   const { data } = await useFetch('/api/products')\n   ```\n\n4. **Don't forget loading states with lazy**\n   ```vue\n   <!--  Bad -->\n   <div>{{ data.products }}</div>\n\n   <!--  Good -->\n   <div v-if=\"pending\">Loading...</div>\n   <div v-else>{{ data.products }}</div>\n   ```\n\n5. **Don't forget to order before range**\n   ```typescript\n   //  Bad - unpredictable results\n   supabase.from('products').select().range(0, 23)\n\n   //  Good\n   supabase.from('products').select().order('created_at').range(0, 23)\n   ```\n\n---\n\n## Useful Composables from @vueuse/core\n\n```typescript\nimport {\n  useDebounceFn,        // Debounce function calls\n  useIntersectionObserver, // Infinite scroll\n  useStorage,           // localStorage persistence\n  useWindowScroll,      // Scroll position\n  useBreakpoints,       // Responsive breakpoints\n} from '@vueuse/core'\n```\n\n---\n\n**Quick Links:**\n- [Full Documentation](./NUXT3_PRODUCT_PAGE_DOCUMENTATION.md)\n- [Nuxt Docs](https://nuxt.com/docs)\n- [Nuxt Image](https://image.nuxt.com)\n- [Pinia](https://pinia.vuejs.org)\n- [Supabase](https://supabase.com/docs)\n",
              "category": "reference"
            }
          ],
          "similarity": 0.8664280893200355,
          "recommendation": "Consider consolidating into NUXT3_PRODUCT_PAGE_DOCUMENTATION.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/api/README.md",
              "name": "README.md",
              "size": 9944,
              "lastModified": "2025-12-04T10:27:33.820Z",
              "content": "# Moldova Direct - API Documentation\n\n**Last Updated:** November 27, 2025\n\nThis document provides an overview of all API endpoints in the Moldova Direct e-commerce platform.\n\n## Overview\n\n- **Base URL:** `/api/`\n- **Authentication:** Supabase Auth (JWT tokens)\n- **Format:** JSON request/response\n- **Total Endpoints:** 100+ API routes\n\n## Authentication\n\nMost endpoints require authentication via Supabase Auth. Include the JWT token in headers:\n\n```http\nAuthorization: Bearer <your-jwt-token>\n```\n\nAdmin endpoints additionally require the `admin` role.\n\n## API Categories\n\n### Public Endpoints\n\nThese endpoints are accessible without authentication:\n\n#### Products\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/products` | List all products (with filtering) |\n| GET | `/api/products/[slug]` | Get product by slug |\n| GET | `/api/products/featured` | Get featured products |\n| GET | `/api/products/price-range` | Get min/max price range |\n| GET | `/api/products/related/[id]` | Get related products |\n\n#### Categories\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/categories` | List all categories |\n| GET | `/api/categories/[slug]` | Get category by slug |\n\n#### Search\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/search` | Search products |\n\n#### Landing Page\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/landing/sections` | Get landing page sections |\n| GET | `/api/landing/sections/[id]` | Get specific section |\n\n#### Newsletter\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/newsletter/subscribe` | Subscribe to newsletter |\n\n### Authenticated Endpoints\n\nRequire valid user authentication:\n\n#### Cart\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/cart/validate` | Validate cart items |\n| POST | `/api/cart/lock` | Lock cart for checkout |\n| POST | `/api/cart/unlock` | Unlock cart |\n| GET | `/api/cart/lock-status` | Check cart lock status |\n| POST | `/api/cart/clear` | Clear cart |\n| POST | `/api/cart/secure` | Secure cart data |\n\n#### Checkout\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/checkout/addresses` | Get user addresses |\n| POST | `/api/checkout/addresses` | Add new address |\n| GET | `/api/checkout/shipping-methods` | Get shipping options |\n| GET | `/api/checkout/payment-methods` | Get payment methods |\n| POST | `/api/checkout/save-payment-method` | Save payment method |\n| POST | `/api/checkout/create-payment-intent` | Create Stripe payment intent |\n| POST | `/api/checkout/confirm-payment` | Confirm payment |\n| POST | `/api/checkout/create-order` | Create order |\n| POST | `/api/checkout/send-confirmation` | Send confirmation email |\n\n#### Shipping\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/shipping/methods` | Calculate shipping methods |\n\n#### Orders (Customer)\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/orders` | List user's orders |\n| GET | `/api/orders/[id]` | Get order details |\n| GET | `/api/orders/[id]/tracking` | Get tracking info |\n| POST | `/api/orders/[id]/reorder` | Reorder previous order |\n| POST | `/api/orders/[id]/return` | Request return |\n| POST | `/api/orders/[id]/support` | Contact support |\n\n#### Payment Methods\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/payment-methods` | List saved payment methods |\n| POST | `/api/payment-methods/create` | Add payment method |\n| DELETE | `/api/payment-methods/[id]` | Remove payment method |\n\n#### Recommendations\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/recommendations/cart` | Get cart recommendations |\n\n#### Analytics\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/analytics/track` | Track user event |\n| POST | `/api/analytics/cart-events` | Track cart events |\n\n#### Account\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| DELETE | `/api/auth/delete-account` | Delete user account (GDPR) |\n\n### Admin Endpoints\n\nRequire `admin` role:\n\n#### Dashboard\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/stats` | Get overview statistics |\n| GET | `/api/admin/dashboard/stats` | Dashboard statistics |\n| GET | `/api/admin/dashboard/activity` | Recent activity |\n\n#### Analytics\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/analytics/overview` | Analytics overview |\n| GET | `/api/admin/analytics/products` | Product analytics |\n| GET | `/api/admin/analytics/users` | User analytics |\n| POST | `/api/admin/analytics/aggregate` | Aggregate analytics data |\n\n#### Products (Admin)\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/products` | List all products |\n| GET | `/api/admin/products/[id]` | Get product |\n| POST | `/api/admin/products` | Create product |\n| PUT | `/api/admin/products/[id]` | Update product |\n| DELETE | `/api/admin/products/[id]` | Delete product |\n| PUT | `/api/admin/products/bulk` | Bulk update |\n| DELETE | `/api/admin/products/bulk` | Bulk delete |\n| PUT | `/api/admin/products/[id]/inventory` | Update inventory |\n\n#### Orders (Admin)\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/orders` | List all orders |\n| GET | `/api/admin/orders/[id]` | Get order details |\n| PATCH | `/api/admin/orders/[id]/status` | Update order status |\n| POST | `/api/admin/orders/[id]/notes` | Add order note |\n| GET | `/api/admin/orders/analytics` | Order analytics |\n| POST | `/api/admin/orders/bulk` | Bulk order actions |\n| POST | `/api/admin/orders/[id]/fulfillment-tasks` | Add fulfillment task |\n| PATCH | `/api/admin/orders/[id]/fulfillment-tasks/[taskId]` | Update task |\n\n#### Users (Admin)\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/users` | List all users |\n| GET | `/api/admin/users/[id]` | Get user details |\n| GET | `/api/admin/users/[id]/activity` | Get user activity |\n| POST | `/api/admin/users/[id]/actions` | Perform user action |\n\n#### Inventory\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/inventory/movements` | Get stock movements |\n| GET | `/api/admin/inventory/reports` | Get inventory reports |\n\n#### Email Management\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/email-logs/search` | Search email logs |\n| GET | `/api/admin/email-logs/stats` | Email statistics |\n| POST | `/api/admin/email-logs/[id]/retry` | Retry email |\n| GET | `/api/admin/email-retries/stats` | Retry queue stats |\n| POST | `/api/admin/email-retries/process` | Process retry queue |\n| GET | `/api/admin/email-templates/get` | Get template |\n| POST | `/api/admin/email-templates/save` | Save template |\n| POST | `/api/admin/email-templates/preview` | Preview template |\n| GET | `/api/admin/email-templates/history` | Template history |\n| POST | `/api/admin/email-templates/rollback` | Rollback template |\n| POST | `/api/admin/email-templates/synchronize` | Sync templates |\n\n#### Landing Page (Admin)\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/landing/sections` | Create section |\n| PUT | `/api/landing/sections/[id]` | Update section |\n| DELETE | `/api/landing/sections/[id]` | Delete section |\n| POST | `/api/landing/sections/reorder` | Reorder sections |\n\n#### System\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/admin/cache/invalidate` | Invalidate cache |\n| GET | `/api/admin/audit-logs` | Get audit logs |\n| GET | `/api/admin/impersonation-logs` | Impersonation logs |\n| POST | `/api/admin/impersonate` | Impersonate user |\n| POST | `/api/admin/cleanup` | Cleanup test data |\n| POST | `/api/admin/seed` | Seed test data |\n| POST | `/api/admin/seed-data` | Seed specific data |\n| POST | `/api/admin/seed-users` | Seed test users |\n| POST | `/api/admin/seed-orders` | Seed test orders |\n| POST | `/api/admin/setup-db` | Setup database |\n| POST | `/api/admin/setup-inventory` | Setup inventory |\n| GET | `/api/admin/job-status/[id]` | Check job status |\n| GET | `/api/admin/debug/products-count` | Debug products |\n\n### Webhooks\n\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/webhooks/stripe` | Stripe webhook handler |\n\n### Tools\n\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/tools/send-test-email` | Send test email |\n\n## Common Query Parameters\n\n### Pagination\n```\n?page=1&limit=20\n```\n\n### Sorting\n```\n?sort=created_at&order=desc\n```\n\n### Filtering (Products)\n```\n?category=wine&minPrice=10&maxPrice=100&inStock=true\n```\n\n### Locale\n```\n?locale=en\n```\n\n## Error Responses\n\nAll errors follow this format:\n\n```json\n{\n  \"statusCode\": 400,\n  \"statusMessage\": \"Bad Request\",\n  \"message\": \"Validation error description\"\n}\n```\n\n### Common Status Codes\n- `200` - Success\n- `201` - Created\n- `400` - Bad Request\n- `401` - Unauthorized\n- `403` - Forbidden\n- `404` - Not Found\n- `429` - Rate Limited\n- `500` - Internal Server Error\n\n## Rate Limiting\n\nAuthentication endpoints have rate limits:\n- Login: 5 attempts per 15 minutes\n- Register: 3 attempts per hour\n- Password Reset: 3 attempts per hour\n\n## Related Documentation\n\n- [Checkout Flow](../architecture/CHECKOUT_FLOW.md)\n- [Authentication Architecture](../architecture/AUTHENTICATION_ARCHITECTURE.md)\n- [Cart System Architecture](../architecture/CART_SYSTEM_ARCHITECTURE.md)\n- [Email System](../../server/utils/emailLogging.README.md)\n\n---\n\n**Note:** This is an overview document. For detailed request/response schemas, refer to the TypeScript types in `types/` directory.\n",
              "category": "reference"
            },
            {
              "path": "docs/notebooklm/08_API_REFERENCE.md",
              "name": "08_API_REFERENCE.md",
              "size": 6963,
              "lastModified": "2026-01-06T15:49:37.115Z",
              "content": "# Moldova Direct - API Reference\n\n## Overview\n\nThe API is built with Nuxt Server Routes, located in `server/api/`. All endpoints follow RESTful conventions and use Zod for request validation.\n\n**Base URL**: `/api`\n\n## Authentication\n\nMost endpoints require authentication via Supabase JWT tokens. Admin endpoints require the `admin` role.\n\n### Headers\n```\nAuthorization: Bearer <jwt_token>\n```\n\n## Public Endpoints\n\n### Products\n\n#### GET /api/products\nList all products with optional filtering.\n\n**Query Parameters:**\n- `category` (string) - Filter by category slug\n- `minPrice` (number) - Minimum price filter\n- `maxPrice` (number) - Maximum price filter\n- `sort` (string) - Sort by: `price_asc`, `price_desc`, `name`, `created`\n- `page` (number) - Page number\n- `limit` (number) - Items per page\n\n**Response:**\n```json\n{\n  \"products\": [\n    {\n      \"id\": 1,\n      \"slug\": \"wine-cabernet\",\n      \"name\": { \"es\": \"Vino\", \"en\": \"Wine\" },\n      \"price\": \"15.99\",\n      \"stockQuantity\": 50,\n      \"images\": [{ \"url\": \"...\", \"isPrimary\": true }],\n      \"category\": { \"slug\": \"wines\", \"name\": { \"es\": \"Vinos\" } }\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"limit\": 20,\n    \"total\": 100\n  }\n}\n```\n\n#### GET /api/products/[slug]\nGet single product by slug.\n\n#### GET /api/products/featured\nGet featured products for homepage.\n\n#### GET /api/products/related/[productId]\nGet related products.\n\n#### GET /api/products/price-range\nGet min/max prices for filter UI.\n\n### Categories\n\n#### GET /api/categories\nList all categories.\n\n#### GET /api/categories/[slug]\nGet category by slug with products.\n\n### Search\n\n#### GET /api/search\nSearch products.\n\n**Query Parameters:**\n- `q` (string) - Search query\n- `limit` (number) - Max results\n\n## Cart Endpoints\n\n#### POST /api/cart/validate\nValidate cart items and prices.\n\n**Body:**\n```json\n{\n  \"items\": [\n    { \"productId\": \"1\", \"quantity\": 2 }\n  ]\n}\n```\n\n**Response:**\n```json\n{\n  \"valid\": true,\n  \"items\": [...],\n  \"unavailableItems\": []\n}\n```\n\n#### POST /api/cart/lock\nLock cart for checkout (prevents concurrent modifications).\n\n#### POST /api/cart/unlock\nRelease cart lock.\n\n#### GET /api/cart/lock-status\nCheck if cart is locked.\n\n#### POST /api/cart/clear\nClear all cart items.\n\n## Order Endpoints (Authenticated)\n\n#### GET /api/orders\nGet current user's orders.\n\n**Query Parameters:**\n- `status` (string) - Filter by status\n- `page` (number) - Page number\n\n#### GET /api/orders/[orderId]\nGet order details.\n\n#### POST /api/orders/create\nCreate new order from cart.\n\n**Body:**\n```json\n{\n  \"shippingAddress\": {\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\",\n    \"street\": \"123 Main St\",\n    \"city\": \"Madrid\",\n    \"postalCode\": \"28001\",\n    \"country\": \"ES\"\n  },\n  \"shippingMethodId\": \"standard\",\n  \"paymentIntentId\": \"pi_...\"\n}\n```\n\n#### POST /api/orders/[orderId]/reorder\nCreate new order with same items.\n\n#### POST /api/orders/[orderId]/return\nRequest order return.\n\n#### POST /api/orders/track\nTrack order by number (guest access).\n\n**Body:**\n```json\n{\n  \"orderNumber\": \"ORD-123456\",\n  \"email\": \"customer@example.com\"\n}\n```\n\n## Shipping Endpoints\n\n#### GET /api/shipping/methods\nGet available shipping methods.\n\n#### POST /api/shipping/calculate\nCalculate shipping cost.\n\n**Body:**\n```json\n{\n  \"postalCode\": \"28001\",\n  \"country\": \"ES\",\n  \"items\": [{ \"productId\": \"1\", \"quantity\": 2 }]\n}\n```\n\n## Checkout/Payment Endpoints\n\n#### POST /api/checkout/create-payment-intent\nCreate Stripe payment intent.\n\n**Body:**\n```json\n{\n  \"cartItems\": [...],\n  \"shippingMethodId\": \"standard\"\n}\n```\n\n**Response:**\n```json\n{\n  \"clientSecret\": \"pi_..._secret_...\",\n  \"amount\": 4599\n}\n```\n\n#### GET /api/payment-methods\nGet saved payment methods (authenticated).\n\n#### POST /api/payment-methods/create\nSave new payment method.\n\n#### DELETE /api/payment-methods/[paymentMethodId]\nRemove saved payment method.\n\n## Webhook Endpoints\n\n#### POST /api/webhooks/stripe\nHandle Stripe webhook events.\n\nEvents handled:\n- `payment_intent.succeeded`\n- `payment_intent.payment_failed`\n- `charge.refunded`\n\n## Admin Endpoints\n\nAll admin endpoints require authentication with admin role.\n\n### Dashboard\n\n#### GET /api/admin/dashboard/stats\nGet dashboard statistics (orders, revenue, users).\n\n#### GET /api/admin/dashboard/activity\nGet recent activity feed.\n\n### Products\n\n#### GET /api/admin/products\nList all products (admin view).\n\n#### POST /api/admin/products\nCreate new product.\n\n#### GET /api/admin/products/[productId]\nGet product for editing.\n\n#### PUT /api/admin/products/[productId]\nUpdate product.\n\n#### DELETE /api/admin/products/[productId]\nDelete product.\n\n#### PUT /api/admin/products/[productId]/inventory\nUpdate product inventory.\n\n#### PUT /api/admin/products/bulk\nBulk update products.\n\n#### DELETE /api/admin/products/bulk\nBulk delete products.\n\n### Orders\n\n#### GET /api/admin/orders\nList all orders with filters.\n\n#### GET /api/admin/orders/[orderId]\nGet order details.\n\n#### POST /api/admin/orders/[orderId]/update-status\nUpdate order status.\n\n#### POST /api/admin/orders/[orderId]/send-status-email\nSend status update email.\n\n### Users\n\n#### GET /api/admin/users\nList all users.\n\n#### GET /api/admin/users/[userId]\nGet user details.\n\n#### PUT /api/admin/users/[userId]\nUpdate user.\n\n### Inventory\n\n#### GET /api/admin/inventory/movements\nGet inventory movement history.\n\n#### GET /api/admin/inventory/reports\nGet inventory reports.\n\n### Email Templates\n\n#### GET /api/admin/email-templates/get\nGet email template.\n\n#### POST /api/admin/email-templates/save\nSave email template.\n\n#### POST /api/admin/email-templates/preview\nPreview email template.\n\n## Analytics Endpoints\n\n#### POST /api/analytics/cart-events\nTrack cart events (add, remove, view).\n\n#### POST /api/analytics/track\nTrack general analytics events.\n\n## Utility Endpoints\n\n#### GET /api/security/csrf-token\nGet CSRF token for forms.\n\n#### POST /api/newsletter/subscribe\nSubscribe to newsletter.\n\n## Error Responses\n\nAll errors follow this format:\n\n```json\n{\n  \"statusCode\": 400,\n  \"statusMessage\": \"Invalid request\",\n  \"data\": {\n    \"field\": \"email\",\n    \"message\": \"Invalid email format\"\n  }\n}\n```\n\n### Common Status Codes\n- `200` - Success\n- `201` - Created\n- `400` - Bad Request (validation error)\n- `401` - Unauthorized\n- `403` - Forbidden (insufficient permissions)\n- `404` - Not Found\n- `429` - Rate Limited\n- `500` - Server Error\n\n## Rate Limiting\n\nAPI endpoints are rate limited:\n- Public endpoints: 100 requests/minute\n- Authenticated endpoints: 200 requests/minute\n- Admin endpoints: 500 requests/minute\n\n## Request Validation\n\nAll requests are validated using Zod schemas:\n\n```typescript\nimport { z } from 'zod'\n\nconst CreateOrderSchema = z.object({\n  shippingAddress: z.object({\n    firstName: z.string().min(1),\n    lastName: z.string().min(1),\n    street: z.string().min(1),\n    city: z.string().min(1),\n    postalCode: z.string().min(1),\n    country: z.string().length(2)\n  }),\n  shippingMethodId: z.string(),\n  paymentIntentId: z.string()\n})\n```\n",
              "category": "reference"
            }
          ],
          "similarity": 0.8798027832504318,
          "recommendation": "Consider consolidating into 08_API_REFERENCE.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/architecture/asset-caching-strategy.md",
              "name": "asset-caching-strategy.md",
              "size": 9410,
              "lastModified": "2025-11-11T21:50:30.722Z",
              "content": "# Asset Caching Strategy\n\n## Overview\n\nThis document describes the optimized asset naming and long-term caching strategy implemented for Moldova Direct. The strategy is designed to maximize cache hit rates, improve performance, and ensure efficient cache invalidation when assets change.\n\n## Problem Statement\n\nThe previous configuration had basic chunk splitting but lacked:\n- Organized asset file naming by type\n- Immutable cache headers for hash-based assets\n- Granular vendor chunk splitting\n- Optimized cache invalidation strategy\n\nThis resulted in:\n- Suboptimal cache hit rates\n- Larger vendor bundles than necessary\n- Inefficient cache invalidation\n\n## Solution\n\n### 1. Asset File Naming Strategy\n\nAssets are now organized by type with content-based hashing:\n\n```typescript\nassetFileNames: (assetInfo) => {\n  const info = assetInfo.name.split('.')\n  const ext = info[info.length - 1]\n\n  if (/png|jpe?g|svg|gif|tiff|bmp|ico/i.test(ext)) {\n    return 'assets/images/[name]-[hash][extname]'\n  } else if (/woff2?|ttf|otf|eot/i.test(ext)) {\n    return 'assets/fonts/[name]-[hash][extname]'\n  } else if (/css/i.test(ext)) {\n    return 'assets/css/[name]-[hash][extname]'\n  }\n  return 'assets/[name]-[hash][extname]'\n}\n```\n\n#### Directory Structure\n\n```\n.output/public/\n assets/\n    css/\n       [name]-[hash].css\n    fonts/\n       [name]-[hash].woff2\n    images/\n        [name]-[hash].png\n chunks/\n    vendor-vue-[hash].js\n    vendor-chart-[hash].js\n    feature-admin-[hash].js\n entries/\n     [name]-[hash].js\n```\n\n### 2. Chunk Naming Strategy\n\nChunks are organized with descriptive names and content hashes:\n\n```typescript\nchunkFileNames: 'chunks/[name]-[hash].js'\nentryFileNames: 'entries/[name]-[hash].js'\n```\n\nBenefits:\n- Clear separation between chunks and entries\n- Easy to identify chunk purpose in DevTools\n- Content-based hashing ensures cache invalidation\n\n### 3. Vendor Chunk Splitting\n\nVendors are split into granular chunks for better caching:\n\n```typescript\nmanualChunks(id) {\n  if (id.includes('node_modules')) {\n    // Large packages get their own chunks\n    if (id.includes('chart.js')) return 'vendor-chart'\n    if (id.includes('@stripe')) return 'vendor-stripe'\n    if (id.includes('@tanstack')) return 'vendor-table'\n    if (id.includes('swiper')) return 'vendor-swiper'\n\n    // Vue ecosystem packages together\n    if (id.includes('vue') || id.includes('@vue')) return 'vendor-vue'\n    if (id.includes('pinia')) return 'vendor-pinia'\n\n    // Smaller packages together\n    return 'vendor-misc'\n  }\n\n  // Feature-based splitting\n  if (id.includes('/components/admin/')) return 'feature-admin'\n  if (id.includes('/pages/admin/')) return 'feature-admin'\n\n  if (id.includes('/components/checkout/')) return 'feature-checkout'\n  if (id.includes('/pages/checkout/')) return 'feature-checkout'\n}\n```\n\n#### Chunk Strategy Rationale\n\n**Large Packages (Separate Chunks)**\n- `vendor-chart`: Chart.js (~170KB) - Only loaded on admin pages\n- `vendor-stripe`: Stripe SDK (~50KB) - Only loaded on checkout\n- `vendor-table`: TanStack Table (~80KB) - Only loaded on admin tables\n- `vendor-swiper`: Swiper (~100KB) - Only loaded on product galleries\n\n**Vue Ecosystem (Grouped)**\n- `vendor-vue`: Core Vue packages used everywhere\n- `vendor-pinia`: State management used across the app\n\n**Miscellaneous (Grouped)**\n- `vendor-misc`: Small utilities and helpers\n\n**Feature Chunks**\n- `feature-admin`: Admin-specific code (lazy loaded)\n- `feature-checkout`: Checkout-specific code (lazy loaded)\n\n### 4. Cache Headers Strategy\n\nImmutable cache headers are applied to all hash-based assets:\n\n```typescript\nrouteRules: {\n  '/assets/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/_nuxt/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/chunks/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/entries/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  }\n}\n```\n\n#### Cache Header Configuration\n\n**max-age=31536000 (1 year)**\n- Maximum recommended cache duration\n- Assets never expire until browser cache is cleared\n- Safe because content hash changes when content changes\n\n**immutable**\n- Tells browser the file will never change\n- Prevents conditional revalidation requests\n- Reduces server load and improves performance\n\n**public**\n- Allows caching by both browser and CDN\n- Maximizes cache hit rates across users\n\n## Benefits\n\n### 1. Improved Cache Hit Rates\n\n**Before**: Single vendor chunk invalidated on any dependency update\n**After**: Only changed vendor chunks invalidate\n\nExample:\n- Update Chart.js  Only `vendor-chart-[newhash].js` changes\n- Other vendor chunks remain cached\n\n### 2. Better Performance\n\n- **Parallel Downloads**: Multiple smaller chunks download in parallel\n- **Faster Updates**: Users only download changed chunks\n- **Reduced Bandwidth**: No re-downloading unchanged vendor code\n\n### 3. Optimized Bundle Size\n\n**Chunk Size Comparison** (estimated):\n```\nvendor-vue:      ~150KB (core Vue)\nvendor-chart:    ~170KB (Chart.js)\nvendor-stripe:   ~50KB  (Stripe)\nvendor-table:    ~80KB  (TanStack)\nvendor-swiper:   ~100KB (Swiper)\nvendor-pinia:    ~30KB  (Pinia)\nvendor-misc:     ~100KB (utilities)\nfeature-admin:   ~50KB  (admin code)\nfeature-checkout: ~40KB (checkout code)\n```\n\nTotal vendor size: ~770KB\n- Previously: ~770KB in 1-2 chunks\n- Now: ~770KB split across 9 chunks\n\n### 4. Vercel Edge Network Integration\n\nThe strategy is optimized for Vercel's Edge Network:\n\n- Hash-based URLs are cached at edge nodes\n- Immutable headers prevent unnecessary revalidation\n- Geographic distribution reduces latency\n\n## Testing & Verification\n\n### Local Development\n\n```bash\n# Build the application\npnpm build\n\n# Check output structure\nls -R .output/public/\n\n# Expected structure:\n# .output/public/\n#  assets/\n#     css/\n#     fonts/\n#     images/\n#  chunks/\n#  entries/\n```\n\n### Production Verification\n\n1. **Check Cache Headers**\n```bash\ncurl -I https://moldovadirect.com/_nuxt/[hash].js\n# Should return:\n# Cache-Control: public, max-age=31536000, immutable\n```\n\n2. **Verify Asset Organization**\n- Open DevTools  Network tab\n- Check that assets are organized by type:\n  - `/assets/css/` for CSS\n  - `/assets/images/` for images\n  - `/chunks/` for code chunks\n  - `/entries/` for entry points\n\n3. **Test Cache Invalidation**\n- Make a change to admin code\n- Build and deploy\n- Verify only `feature-admin-[newhash].js` changed\n- Other chunks should maintain same hash\n\n### Performance Metrics\n\nMonitor these metrics in production:\n\n1. **Cache Hit Rate**\n   - Target: >90% for vendor chunks\n   - Measure: CloudFlare/Vercel analytics\n\n2. **Bundle Size**\n   - Target: <200KB initial load\n   - Measure: Chrome DevTools Coverage\n\n3. **Page Load Time**\n   - Target: <2s for first contentful paint\n   - Measure: Lighthouse/WebPageTest\n\n## Troubleshooting\n\n### Problem: Assets Not Cached\n\n**Symptom**: Browser re-downloads assets on every visit\n\n**Solution**:\n1. Check that assets have content hash in filename\n2. Verify cache headers are present\n3. Ensure Vercel deployment succeeded\n\n### Problem: Large Vendor Chunks\n\n**Symptom**: Individual vendor chunks exceed 200KB\n\n**Solution**:\n1. Identify large dependency with bundle analyzer\n2. Add specific chunk rule in `manualChunks`\n3. Consider lazy loading if possible\n\n### Problem: Too Many Chunks\n\n**Symptom**: >15 parallel chunk downloads\n\n**Solution**:\n1. Group smaller related packages together\n2. Adjust `chunkSizeWarningLimit` if needed\n3. Use HTTP/2 server push for critical chunks\n\n## Future Improvements\n\n### 1. Preload Critical Chunks\n\n```typescript\n// In nuxt.config.ts\nexperimental: {\n  resourceHints: {\n    preload: [\n      'vendor-vue',\n      'vendor-pinia'\n    ]\n  }\n}\n```\n\n### 2. Service Worker Caching\n\n```typescript\n// In pwa configuration\nworkbox: {\n  runtimeCaching: [\n    {\n      urlPattern: /^https:\\/\\/moldovadirect\\.com\\/_nuxt\\/.*/,\n      handler: 'CacheFirst',\n      options: {\n        cacheName: 'nuxt-assets',\n        expiration: {\n          maxEntries: 60,\n          maxAgeSeconds: 60 * 60 * 24 * 365 // 1 year\n        }\n      }\n    }\n  ]\n}\n```\n\n### 3. Bundle Analysis\n\nAdd bundle analyzer to monitor chunk sizes:\n\n```bash\npnpm add -D rollup-plugin-visualizer\n```\n\n```typescript\n// In nuxt.config.ts\nimport { visualizer } from 'rollup-plugin-visualizer'\n\nvite: {\n  plugins: [\n    visualizer({\n      filename: './dist/stats.html',\n      open: true\n    })\n  ]\n}\n```\n\n## References\n\n- [Vite Build Options](https://vitejs.dev/config/build-options.html)\n- [Rollup Output Options](https://rollupjs.org/configuration-options/#output-manualchunks)\n- [HTTP Caching Best Practices](https://web.dev/http-cache/)\n- [Cache-Control Immutable](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#immutable)\n- [Vercel Edge Network](https://vercel.com/docs/concepts/edge-network/overview)\n\n## Version History\n\n- **v1.0** (2025-01-11): Initial implementation\n  - Added organized asset naming by type\n  - Implemented granular vendor chunk splitting\n  - Configured immutable cache headers\n  - Optimized for Vercel Edge Network\n",
              "category": "explanation"
            },
            {
              "path": "docs/archive/reports/ASSET_OPTIMIZATION_SUMMARY.md",
              "name": "ASSET_OPTIMIZATION_SUMMARY.md",
              "size": 11752,
              "lastModified": "2026-01-14T21:35:39.886Z",
              "content": "# Asset Optimization Implementation Summary\n\n## Overview\n\nThis document summarizes the asset file naming and long-term caching strategy optimization implemented for Moldova Direct.\n\n**Date**: 2025-01-11\n**Status**:  Complete\n**Impact**: Improved cache hit rates, better performance, optimized bundle delivery\n\n---\n\n## Changes Implemented\n\n### 1. Optimized Asset File Naming\n\n**Location**: `nuxt.config.ts` (lines 304-306)\n\n```typescript\nassetFileNames: (assetInfo) => {\n  const info = assetInfo.name.split('.')\n  const ext = info[info.length - 1]\n\n  if (/png|jpe?g|svg|gif|tiff|bmp|ico/i.test(ext)) {\n    return 'assets/images/[name]-[hash][extname]'\n  } else if (/woff2?|ttf|otf|eot/i.test(ext)) {\n    return 'assets/fonts/[name]-[hash][extname]'\n  } else if (/css/i.test(ext)) {\n    return 'assets/css/[name]-[hash][extname]'\n  }\n  return 'assets/[name]-[hash][extname]'\n}\n```\n\n**Benefits**:\n- Assets organized by type for better management\n- Content-based hashing ensures automatic cache invalidation\n- Clear directory structure for debugging\n\n### 2. Enhanced Chunk and Entry Naming\n\n**Location**: `nuxt.config.ts` (lines 309-310)\n\n```typescript\nchunkFileNames: 'chunks/[name]-[hash].js'\nentryFileNames: 'entries/[name]-[hash].js'\n```\n\n**Benefits**:\n- Separate directories for chunks and entries\n- Easier to identify and debug in DevTools\n- Better organization in production builds\n\n### 3. Granular Vendor Chunk Splitting\n\n**Location**: `nuxt.config.ts` (lines 313-336)\n\n```typescript\nmanualChunks(id) {\n  if (id.includes('node_modules')) {\n    // Large packages get their own chunks\n    if (id.includes('chart.js')) return 'vendor-chart'\n    if (id.includes('@stripe')) return 'vendor-stripe'\n    if (id.includes('@tanstack')) return 'vendor-table'\n    if (id.includes('swiper')) return 'vendor-swiper'\n\n    // Group Vue ecosystem packages together\n    if (id.includes('vue') || id.includes('@vue')) return 'vendor-vue'\n    if (id.includes('pinia')) return 'vendor-pinia'\n\n    // Group smaller packages together\n    return 'vendor-misc'\n  }\n\n  // Feature-based splitting\n  if (id.includes('/components/admin/')) return 'feature-admin'\n  if (id.includes('/pages/admin/')) return 'feature-admin'\n\n  if (id.includes('/components/checkout/')) return 'feature-checkout'\n  if (id.includes('/pages/checkout/')) return 'feature-checkout'\n}\n```\n\n**Benefits**:\n- Only changed packages invalidate their chunk\n- Better cache hit rates for unchanged dependencies\n- Reduced bandwidth usage for returning users\n\n### 4. Immutable Cache Headers\n\n**Location**: `nuxt.config.ts` (lines 100-121)\n\n```typescript\nrouteRules: {\n  // Static assets with immutable cache\n  '/assets/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/_nuxt/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/chunks/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  },\n  '/entries/**': {\n    headers: {\n      'Cache-Control': 'public, max-age=31536000, immutable'\n    }\n  }\n}\n```\n\n**Benefits**:\n- Assets cached for 1 year (max recommended)\n- Immutable flag prevents revalidation requests\n- Reduces server load and improves performance\n\n---\n\n## Build Output Structure\n\n### Current Structure (Verified)\n\n```\n.output/public/\n assets/\n    css/\n        entry-[hash].css (188KB)\n        swiper-vue-[hash].css (20KB)\n        [26 total CSS files] (304KB total)\n chunks/\n    swiper-vue-[hash].js (200KB)\n    [locale]-[hash].js (108-124KB each x4)\n    wine-story-[hash].js (72KB)\n    [132 total chunks] (1.9MB total)\n entries/\n     entry-[hash].js (492KB)\n```\n\n### Key Metrics\n\n| Metric | Value | Status |\n|--------|-------|--------|\n| Total CSS Size | 304KB |  Good |\n| Total Chunks Size | 1.9MB |  Acceptable |\n| Entry Point Size | 492KB |  Monitor |\n| CSS Files | 26 |  Good |\n| JS Chunks | 132 |  Good |\n| Largest Chunk | 200KB (Swiper) |  Under limit |\n\n---\n\n## Performance Improvements\n\n### Before Optimization\n\n- Single large vendor bundle (~1.5MB)\n- Assets mixed in single directory\n- No organized chunk splitting\n- Standard cache headers\n\n### After Optimization\n\n- **Cache Hit Rate**: Expected >90% for vendor chunks\n- **Bundle Organization**: Assets organized by type\n- **Cache Strategy**: Immutable headers for hash-based assets\n- **Chunk Granularity**: 9 vendor chunks + feature chunks\n\n### Expected Performance Gains\n\n1. **First Visit**\n   - Similar initial load (all assets needed)\n   - Better parallel downloading (smaller chunks)\n\n2. **Subsequent Visits**\n   - **70-90% fewer downloads** (cached vendor chunks)\n   - Only changed chunks re-downloaded\n   - Faster page loads\n\n3. **After Updates**\n   - Only changed chunks invalidate\n   - Example: Update admin code  Only `feature-admin-[newhash].js` changes\n   - Other 131 chunks remain cached\n\n---\n\n## Vendor Chunk Strategy\n\n### Large Packages (Separate Chunks)\n\n| Package | Chunk Name | Size | Usage |\n|---------|-----------|------|-------|\n| Chart.js | `vendor-chart` | ~170KB | Admin only |\n| Stripe | `vendor-stripe` | ~50KB | Checkout only |\n| TanStack Table | `vendor-table` | ~80KB | Admin tables |\n| Swiper | `vendor-swiper` | ~100KB | Product galleries |\n\n### Grouped Packages\n\n| Group | Chunk Name | Purpose |\n|-------|-----------|---------|\n| Vue Ecosystem | `vendor-vue` | Core Vue packages (everywhere) |\n| State Management | `vendor-pinia` | Pinia store (app-wide) |\n| Utilities | `vendor-misc` | Small packages grouped together |\n\n### Feature Chunks\n\n| Feature | Chunk Name | Components Included |\n|---------|-----------|---------------------|\n| Admin | `feature-admin` | `/components/admin/*`, `/pages/admin/*` |\n| Checkout | `feature-checkout` | `/components/checkout/*`, `/pages/checkout/*` |\n\n---\n\n## Cache Invalidation Strategy\n\n### Content-Based Hashing\n\nAll assets use content-based hashing:\n- **Format**: `[name]-[hash][ext]`\n- **Hash Type**: Content hash (changes only when file content changes)\n- **Length**: 8 characters (sufficient for collision avoidance)\n\n### Cache Invalidation Flow\n\n1. **Developer Updates Code**\n   ```bash\n   # Example: Update admin dashboard\n   vim pages/admin/dashboard.vue\n   ```\n\n2. **Build Process**\n   ```bash\n   pnpm build\n   # Only feature-admin-[newhash].js is created\n   # Other chunks maintain existing hashes\n   ```\n\n3. **Deployment**\n   ```bash\n   # New feature-admin chunk deployed\n   # Old chunks remain cached in CDN and browsers\n   ```\n\n4. **User Experience**\n   - User visits site\n   - Browser checks entry point (always fetched)\n   - Entry point references `feature-admin-[newhash].js`\n   - Browser downloads only the new admin chunk\n   - All other chunks loaded from cache\n\n---\n\n## Testing & Verification\n\n### Local Testing\n\n```bash\n# Build the application\npnpm build\n\n# Check output structure\nls -R .output/public/\n\n# Verify asset organization\nls .output/public/assets/css/\nls .output/public/chunks/\nls .output/public/entries/\n\n# Run verification script\n./scripts/verify-asset-structure.sh\n```\n\n### Production Verification\n\n1. **Check Cache Headers**\n   ```bash\n   curl -I https://moldovadirect.com/_nuxt/entry-[hash].js\n   # Expected: Cache-Control: public, max-age=31536000, immutable\n   ```\n\n2. **Monitor Cache Hit Rate**\n   - Vercel Analytics  Bandwidth\n   - Target: >90% cache hit rate\n\n3. **Performance Testing**\n   ```bash\n   # Lighthouse\n   npx lighthouse https://moldovadirect.com --view\n\n   # WebPageTest\n   # Visit: https://www.webpagetest.org/\n   ```\n\n### Verification Checklist\n\n- [x] Assets organized in correct directories\n- [x] All assets have content hash in filename\n- [x] CSS files in `assets/css/`\n- [x] Chunks in `chunks/` directory\n- [x] Entries in `entries/` directory\n- [x] Cache headers configured in `routeRules`\n- [x] Vendor chunks properly split\n- [x] Feature chunks properly split\n\n---\n\n## Monitoring & Maintenance\n\n### Key Metrics to Track\n\n1. **Cache Hit Rate** (Target: >90%)\n   - Monitor in Vercel Analytics\n   - Check monthly trends\n\n2. **Bundle Size** (Target: <200KB per chunk)\n   - Review after adding new dependencies\n   - Use bundle analyzer for large chunks\n\n3. **Page Load Time** (Target: <2s FCP)\n   - Monitor with Lighthouse\n   - Track in production analytics\n\n4. **Core Web Vitals**\n   - LCP: <2.5s\n   - FID: <100ms\n   - CLS: <0.1\n\n### Regular Maintenance Tasks\n\n**Monthly**:\n- Review bundle sizes\n- Check for unused dependencies\n- Monitor cache hit rates\n\n**Quarterly**:\n- Audit vendor chunks\n- Update chunk splitting strategy if needed\n- Review performance metrics\n\n**After Major Updates**:\n- Verify chunk sizes haven't grown significantly\n- Test cache invalidation\n- Run performance benchmarks\n\n---\n\n## Troubleshooting Guide\n\n### Issue: Assets Not Cached\n\n**Symptoms**:\n- Browser re-downloads assets every visit\n- Cache hit rate <50%\n\n**Solutions**:\n1. Verify cache headers in production\n2. Check CDN configuration\n3. Ensure hashes are in filenames\n4. Clear browser cache and test again\n\n### Issue: Chunk Too Large\n\n**Symptoms**:\n- Warning: Chunk size exceeds 1000KB\n- Slow initial page load\n\n**Solutions**:\n1. Identify large dependency:\n   ```bash\n   pnpm build --analyze\n   ```\n2. Add specific chunk rule:\n   ```typescript\n   if (id.includes('large-package')) return 'vendor-large-package'\n   ```\n3. Consider lazy loading for admin/checkout features\n\n### Issue: Too Many HTTP Requests\n\n**Symptoms**:\n- >20 parallel chunk downloads\n- Waterfall shows many small chunks\n\n**Solutions**:\n1. Group smaller packages together:\n   ```typescript\n   if (id.includes('util-1') || id.includes('util-2')) {\n     return 'vendor-utils'\n   }\n   ```\n2. Use HTTP/2 server push for critical chunks\n3. Adjust chunk size threshold\n\n---\n\n## Future Enhancements\n\n### Phase 2: Service Worker Caching\n\n```typescript\n// pwa configuration\nworkbox: {\n  runtimeCaching: [\n    {\n      urlPattern: /^https:\\/\\/moldovadirect\\.com\\/_nuxt\\/.*/,\n      handler: 'CacheFirst',\n      options: {\n        cacheName: 'nuxt-assets',\n        expiration: {\n          maxEntries: 60,\n          maxAgeSeconds: 60 * 60 * 24 * 365\n        }\n      }\n    }\n  ]\n}\n```\n\n### Phase 3: Preload Critical Chunks\n\n```typescript\nexperimental: {\n  resourceHints: {\n    preload: [\n      'vendor-vue',\n      'vendor-pinia'\n    ]\n  }\n}\n```\n\n### Phase 4: Bundle Analysis\n\n```bash\npnpm add -D rollup-plugin-visualizer\n```\n\n```typescript\nimport { visualizer } from 'rollup-plugin-visualizer'\n\nvite: {\n  plugins: [\n    visualizer({\n      filename: './dist/stats.html',\n      open: true\n    })\n  ]\n}\n```\n\n---\n\n## Related Documentation\n\n- [Asset Caching Strategy](./asset-caching-strategy.md) - Detailed technical documentation\n- [Asset Optimization Quick Reference](../guides/asset-optimization-quick-reference.md) - Quick commands and tips\n- [Build Optimization Guide](../guides/build-optimization-implementation.md) - Overall build optimization\n- [Nuxt Build Config](https://nuxt.com/docs/api/nuxt-config#build) - Official Nuxt documentation\n- [Vite Build Options](https://vitejs.dev/config/build-options.html) - Vite configuration reference\n\n---\n\n## Conclusion\n\nThe asset optimization implementation provides:\n\n **Organized Structure**: Assets categorized by type\n **Content Hashing**: Automatic cache invalidation\n **Granular Chunking**: Better cache hit rates\n **Immutable Headers**: Maximum cache efficiency\n **Vercel Integration**: Optimized for Edge Network\n\n**Next Steps**:\n1. Deploy to production\n2. Monitor cache hit rates\n3. Run performance tests\n4. Iterate based on metrics\n\n**Questions?** Refer to the troubleshooting guide or consult the related documentation.\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8964004930068912,
          "recommendation": "Consider consolidating into ASSET_OPTIMIZATION_SUMMARY.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/architecture/tanstack-table-lazy-loading-implementation.md",
              "name": "tanstack-table-lazy-loading-implementation.md",
              "size": 11691,
              "lastModified": "2025-11-11T21:50:30.730Z",
              "content": "# TanStack Table Lazy Loading - Implementation Summary\n\n## Executive Summary\n\nSuccessfully implemented lazy loading for TanStack Vue Table to reduce admin bundle size by ~15KB gzipped. The library is now loaded on-demand only when admin tables using advanced features are rendered.\n\n**Status:**  Complete and Production Ready\n\n**Impact:**\n- Main bundle size reduced by ~15KB gzipped\n- Improved initial page load time\n- No degradation in user experience\n- Full TypeScript support maintained\n\n## Implementation Date\n\n2025-01-11\n\n## Problem\n\nPreviously, `@tanstack/vue-table` was imported directly in `components/ui/table/utils.ts`, causing it to be bundled in the main chunk even though:\n\n1. Current admin tables use basic HTML tables (not TanStack)\n2. The library is only needed for advanced features (sorting, pagination, filtering)\n3. Admin pages are already code-split, but the import still affected the main bundle\n\n## Solution\n\nImplemented a three-part solution:\n\n### 1. Composable for Lazy Loading\n\n**File:** `/composables/useAsyncTable.ts`\n\n```typescript\nexport function useAsyncTable() {\n  const loadTable = async () => {\n    const module = await import('@tanstack/vue-table')\n    return {\n      useVueTable: module.useVueTable,\n      getCoreRowModel: module.getCoreRowModel,\n      // ... all TanStack exports\n    }\n  }\n\n  return { loadTable, isLoading, error, tableModule }\n}\n```\n\n**Features:**\n- Dynamic import with caching\n- Loading and error states\n- Type-safe exports\n- Lightweight (~2KB)\n\n### 2. Wrapper Component\n\n**File:** `/components/admin/Tables/AsyncTableWrapper.vue`\n\n```vue\n<AdminTablesAsyncTableWrapper\n  :data=\"products\"\n  :columns=\"columns\"\n  :enable-sorting=\"true\"\n  :enable-row-selection=\"true\"\n/>\n```\n\n**Features:**\n- Loading skeleton during module load\n- Error handling with retry\n- Supports all TanStack features\n- Customizable via slots\n- Empty state handling\n\n### 3. Updated Table Utils\n\n**File:** `/components/ui/table/utils.ts`\n\n**Before:**\n```typescript\nimport { isFunction } from \"@tanstack/vue-table\"  //  Direct import\n```\n\n**After:**\n```typescript\n// Standalone implementation, no imports\nexport function isFunction(value: unknown): value is Function {\n  return typeof value === 'function'\n}\n```\n\n**Changes:**\n- Removed all direct TanStack imports\n- Implemented standalone utility functions\n- Maintained type compatibility\n- Added migration comments\n\n## Files Created/Modified\n\n### Created Files\n\n1. `/composables/useAsyncTable.ts` (165 lines)\n   - Composable for lazy loading TanStack Table\n   - Exports all necessary functions\n   - Provides loading/error states\n\n2. `/components/admin/Tables/AsyncTableWrapper.vue` (205 lines)\n   - Wrapper component with loading states\n   - Supports all TanStack features\n   - Customizable via slots and props\n\n3. `/components/admin/Tables/AsyncTableWrapper.example.vue` (320 lines)\n   - Complete working example\n   - Demonstrates all features\n   - Shows column definitions, sorting, selection\n\n4. `/components/admin/Tables/AsyncTableWrapper.test.ts` (45 lines)\n   - Unit tests for composable and component\n   - Verifies lazy loading behavior\n   - Tests caching and error handling\n\n5. `/components/admin/Tables/README.md` (450 lines)\n   - Comprehensive documentation\n   - Usage examples\n   - Migration guide\n   - API reference\n\n6. `/docs/guides/tanstack-table-lazy-loading.md` (550 lines)\n   - Implementation guide\n   - Architecture explanation\n   - Performance analysis\n   - Troubleshooting\n\n7. `/docs/architecture/tanstack-table-lazy-loading-implementation.md` (This file)\n   - Implementation summary\n   - Architecture decisions\n   - Migration recommendations\n\n### Modified Files\n\n1. `/components/ui/table/utils.ts`\n   - Removed TanStack imports\n   - Added standalone implementations\n   - Documented migration path\n\n## Architecture Decisions\n\n### 1. Composable vs Direct Import\n\n**Decision:** Use composable pattern for dynamic loading\n\n**Rationale:**\n- Provides reactive loading/error states\n- Enables caching for multiple components\n- Maintains separation of concerns\n- Follows Vue 3 composition API best practices\n\n### 2. Wrapper Component vs Direct Usage\n\n**Decision:** Provide both wrapper component and composable\n\n**Rationale:**\n- Wrapper for simple use cases (most common)\n- Composable for advanced customization\n- Reduces boilerplate code\n- Consistent loading states across app\n\n### 3. Loading Strategy\n\n**Decision:** Load on component mount, not on route entry\n\n**Rationale:**\n- More granular control\n- Only loads when table actually renders\n- Better for conditional rendering\n- Simpler mental model\n\n### 4. Caching Strategy\n\n**Decision:** Cache module for session lifetime\n\n**Rationale:**\n- Module loaded once per session\n- Subsequent tables render instantly\n- No memory leaks (module is lightweight)\n- Better user experience\n\n## Performance Analysis\n\n### Bundle Size Impact\n\n**Before Implementation:**\n```\nMain bundle: ~345KB\n Vue + Nuxt: ~180KB\n TanStack Table: ~15KB   Always loaded\n Other deps: ~150KB\n```\n\n**After Implementation:**\n```\nMain bundle: ~330KB (-15KB)\n Vue + Nuxt: ~180KB\n Other deps: ~150KB\n\nAdmin table chunk: ~15KB (loaded on demand)\n TanStack Table: ~15KB   Lazy loaded\n```\n\n### Load Time Analysis\n\n**Scenario 1: Regular User (No Admin Access)**\n- Before: Loads TanStack unnecessarily (~15KB)\n- After: Never loads TanStack\n- **Savings:** 15KB + parse time (~20ms)\n\n**Scenario 2: Admin User (First Table Load)**\n- Before: TanStack in main bundle\n- After: TanStack loaded on demand\n- **Additional Time:** ~50-100ms (one-time)\n- **Mitigated by:** Loading skeleton (no layout shift)\n\n**Scenario 3: Admin User (Subsequent Tables)**\n- Before: Already loaded\n- After: Cached module used\n- **Additional Time:** 0ms (same as before)\n\n### User Experience Impact\n\n **Positive:**\n- Faster initial page load for all users\n- Loading skeleton prevents layout shift\n- Cached module = instant subsequent loads\n- Graceful error handling\n\n **Considerations:**\n- First admin table load adds 50-100ms\n- Requires JavaScript (no SSR for table logic)\n- Slightly more complex developer experience\n\n## Migration Path\n\n### Current State\n\nAdmin tables currently use **basic HTML tables**:\n\n```vue\n<!-- Current implementation -->\n<Table>\n  <TableHeader>\n    <TableRow>\n      <TableHead>Name</TableHead>\n      <TableHead>Price</TableHead>\n    </TableRow>\n  </TableHeader>\n  <TableBody>\n    <TableRow v-for=\"product in products\" :key=\"product.id\">\n      <TableCell>{{ product.name }}</TableCell>\n      <TableCell>{{ product.price }}</TableCell>\n    </TableRow>\n  </TableBody>\n</Table>\n```\n\n### Recommended Migration\n\n**Priority 1: Products Table** (High Complexity)\n- Reason: Needs sorting, filtering, bulk operations\n- Impact: Better UX for product management\n- Effort: ~2 hours\n\n**Priority 2: Users Table** (Medium Complexity)\n- Reason: Needs sorting, selection, bulk actions\n- Impact: Better UX for user management\n- Effort: ~1.5 hours\n\n**Priority 3: Email Logs** (Keep as-is)\n- Reason: Simple read-only table\n- Impact: None needed\n- Effort: N/A\n\n### Migration Steps\n\nFor each table:\n\n1. **Create column definitions**\n   ```typescript\n   const columns: ColumnDef<Product>[] = [\n     { accessorKey: 'name', header: 'Product' },\n     { accessorKey: 'price', header: 'Price' },\n   ]\n   ```\n\n2. **Replace table HTML**\n   ```vue\n   <AdminTablesAsyncTableWrapper\n     :data=\"products\"\n     :columns=\"columns\"\n     :enable-sorting=\"true\"\n   />\n   ```\n\n3. **Move sorting logic to columns**\n   ```typescript\n   {\n     accessorKey: 'price',\n     header: 'Price',\n     cell: ({ row }) => `${row.original.price.toFixed(2)}`,\n     sortingFn: 'basic',  // Built-in sorting\n   }\n   ```\n\n4. **Test thoroughly**\n   - Loading states\n   - Sorting\n   - Filtering\n   - Selection\n   - Mobile responsiveness\n\n## Testing Strategy\n\n### Unit Tests\n\n```typescript\n// composables/useAsyncTable.test.ts\n-  Loads module lazily\n-  Caches loaded module\n-  Handles errors gracefully\n-  Provides loading states\n```\n\n### Integration Tests\n\n```typescript\n// components/admin/Tables/AsyncTableWrapper.test.ts\n-  Shows loading skeleton\n-  Renders table after load\n-  Handles empty data\n-  Supports sorting\n-  Supports selection\n```\n\n### Manual Testing\n\n1. **Network Performance**\n   - Open DevTools Network tab\n   - Navigate to admin page\n   - Verify `@tanstack` chunk loads separately\n   - Check chunk size (~15KB)\n\n2. **User Experience**\n   - Verify loading skeleton appears\n   - Check no layout shift occurs\n   - Test sorting/filtering\n   - Verify error states\n\n3. **Build Analysis**\n   ```bash\n   npm run build\n   npm run analyze\n   ```\n   - Verify main bundle reduced\n   - Check table chunk is separate\n   - Confirm no duplicates\n\n## Monitoring\n\n### Metrics to Track\n\n1. **Bundle Size**\n   - Main chunk size\n   - Table chunk size\n   - Total size\n\n2. **Load Time**\n   - Initial page load\n   - Admin table first load\n   - Subsequent table loads\n\n3. **Error Rate**\n   - Module load failures\n   - Network errors\n   - User reports\n\n### Success Criteria\n\n Main bundle reduced by ~15KB\n No increase in error rates\n No user complaints about table loading\n Admin users can still perform all tasks\n\n## Known Limitations\n\n1. **SSR Compatibility**\n   - TanStack Table logic runs client-side only\n   - Initial HTML shows loading skeleton\n   - Hydration happens after module load\n\n2. **Type Safety**\n   - Type imports still from `@tanstack/vue-table`\n   - Runtime imports via composable\n   - May confuse some IDEs\n\n3. **Developer Experience**\n   - Slightly more complex than direct import\n   - Need to understand async loading\n   - More files to maintain\n\n## Future Improvements\n\n1. **Preload on Route Enter**\n   ```typescript\n   // router/middleware/admin.ts\n   export default defineNuxtRouteMiddleware(async () => {\n     const { loadTable } = useAsyncTable()\n     loadTable() // Preload (don't await)\n   })\n   ```\n\n2. **Server-Side Table Logic**\n   - Implement sorting/filtering on server\n   - Return pre-sorted data\n   - Reduce client-side complexity\n\n3. **Virtual Scrolling**\n   - Add virtual scrolling for large datasets\n   - Lazy load TanStack Virtual\n   - Further optimize performance\n\n4. **Export Functionality**\n   - Add CSV/Excel export\n   - Use lazy-loaded libraries\n   - Follow same pattern\n\n## Rollback Plan\n\nIf issues arise, rollback is straightforward:\n\n1. **Revert table utils**\n   ```typescript\n   // Restore direct import\n   import { isFunction } from \"@tanstack/vue-table\"\n   ```\n\n2. **Remove new files**\n   - Delete `/composables/useAsyncTable.ts`\n   - Delete `/components/admin/Tables/AsyncTableWrapper.vue`\n   - Delete related docs\n\n3. **Build and deploy**\n   ```bash\n   npm run build\n   npm run deploy\n   ```\n\n**Impact:** Main bundle increases by ~15KB (acceptable)\n\n## Conclusion\n\nThe lazy loading implementation for TanStack Table is:\n\n **Complete** - All components created and tested\n **Production Ready** - No breaking changes\n **Well Documented** - Comprehensive guides available\n **Performance Positive** - Reduces bundle size\n **Future Proof** - Scalable pattern for other libraries\n\nThe implementation can be adopted gradually:\n1. Use for new admin tables\n2. Migrate existing tables as needed\n3. Keep simple tables as-is\n\n**Recommendation:** Deploy to production and monitor metrics for 1 week before wider adoption.\n\n## References\n\n- [Build Optimization Plan](/docs/architecture/build-optimization-plan.md)\n- [Implementation Guide](/docs/guides/tanstack-table-lazy-loading.md)\n- [Component README](/components/admin/Tables/README.md)\n- [TanStack Table Docs](https://tanstack.com/table/latest)\n",
              "category": "explanation"
            },
            {
              "path": "docs/archive/reports/TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md",
              "name": "TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md",
              "size": 9395,
              "lastModified": "2026-01-14T21:35:39.887Z",
              "content": "# TanStack Table Lazy Loading - Implementation Deliverables\n\n## Summary\n\nSuccessfully implemented lazy loading for TanStack Vue Table components to reduce admin bundle size by ~15KB gzipped.\n\n**Status:**  Complete\n**Date:** 2025-01-11\n**Impact:** Main bundle size reduced by ~15KB gzipped\n\n---\n\n## Deliverables Checklist\n\n###  1. Core Implementation Files\n\n#### Composable for Lazy Loading\n- **File:** `/composables/useAsyncTable.ts`\n- **Lines:** 131\n- **Purpose:** Dynamic import of TanStack Table with caching and error handling\n- **Features:**\n  - Async module loading\n  - Loading and error states\n  - Module caching for performance\n  - Full TypeScript support\n  - Exports all TanStack functions\n\n#### Wrapper Component\n- **File:** `/components/admin/Tables/AsyncTableWrapper.vue`\n- **Lines:** 249\n- **Purpose:** Wrapper component for lazy-loaded TanStack tables\n- **Features:**\n  - Loading skeleton during module load\n  - Error handling with retry\n  - Supports sorting, pagination, filtering, selection\n  - Customizable via slots\n  - Empty state handling\n\n#### Updated Table Utils\n- **File:** `/components/ui/table/utils.ts`\n- **Lines:** 37\n- **Changes:** Removed direct TanStack imports, added standalone implementations\n- **Impact:** Eliminated unnecessary bundle inclusion\n\n###  2. Example & Documentation\n\n#### Working Example\n- **File:** `/components/admin/Tables/AsyncTableWrapper.example.vue`\n- **Lines:** 320\n- **Purpose:** Complete working example demonstrating all features\n- **Includes:**\n  - Column definitions\n  - Sorting and filtering\n  - Row selection\n  - Custom cell rendering\n  - Bulk operations\n\n#### Component README\n- **File:** `/components/admin/Tables/README.md`\n- **Lines:** 450+\n- **Contents:**\n  - Usage examples\n  - Props and events documentation\n  - Column definition guide\n  - Migration guide\n  - Best practices\n  - Troubleshooting\n\n#### Implementation Guide\n- **File:** `/docs/guides/tanstack-table-lazy-loading.md`\n- **Lines:** 550+\n- **Contents:**\n  - Architecture explanation\n  - Implementation details\n  - Performance analysis\n  - Migration checklist\n  - Testing strategy\n  - Troubleshooting\n\n#### Implementation Summary\n- **File:** `/docs/architecture/tanstack-table-lazy-loading-implementation.md`\n- **Lines:** 450+\n- **Contents:**\n  - Executive summary\n  - Architecture decisions\n  - Performance analysis\n  - Migration path\n  - Known limitations\n  - Future improvements\n\n###  3. Tests\n\n#### Unit Tests\n- **File:** `/components/admin/Tables/AsyncTableWrapper.test.ts`\n- **Lines:** 45\n- **Coverage:**\n  - Module loading\n  - Caching behavior\n  - Error handling\n  - Component rendering\n\n###  4. Admin Pages Modified\n\n#### None Required (Yet)\nCurrent admin tables use basic HTML tables and don't need immediate migration:\n- `/components/admin/Users/Table.vue` - Can be migrated later for enhanced features\n- `/components/admin/Products/Table.vue` - Can be migrated later for enhanced features\n- `/components/admin/Email/LogsTable.vue` - Basic table is sufficient\n\n**Recommendation:** Migrate products and users tables in future iterations when advanced features are needed.\n\n---\n\n## File Summary\n\n### Created Files (7 total)\n\n| File | Lines | Purpose |\n|------|-------|---------|\n| `/composables/useAsyncTable.ts` | 131 | Lazy loading composable |\n| `/components/admin/Tables/AsyncTableWrapper.vue` | 249 | Wrapper component |\n| `/components/admin/Tables/AsyncTableWrapper.example.vue` | 320 | Working example |\n| `/components/admin/Tables/AsyncTableWrapper.test.ts` | 45 | Unit tests |\n| `/components/admin/Tables/README.md` | 450+ | Component documentation |\n| `/docs/guides/tanstack-table-lazy-loading.md` | 550+ | Implementation guide |\n| `/docs/architecture/tanstack-table-lazy-loading-implementation.md` | 450+ | Architecture doc |\n\n### Modified Files (1 total)\n\n| File | Changes | Impact |\n|------|---------|--------|\n| `/components/ui/table/utils.ts` | Removed TanStack imports | -15KB from main bundle |\n\n---\n\n## Verification\n\n###  Functionality Verification\n\n1. **Loading States**\n   -  Shows skeleton during module load\n   -  Transitions smoothly to table\n   -  No layout shift\n\n2. **Error Handling**\n   -  Displays error if module fails to load\n   -  Provides clear error messages\n   -  Graceful degradation\n\n3. **Features**\n   -  Sorting works correctly\n   -  Pagination works correctly\n   -  Row selection works correctly\n   -  Custom rendering works correctly\n\n4. **Performance**\n   -  Module loads asynchronously\n   -  Module is cached after first load\n   -  No performance regression\n\n###  Build Verification\n\n```bash\n# Build configuration already optimized\n# nuxt.config.ts includes:\n# - manualChunks for @tanstack\n# - optimizeDeps excludes @tanstack\n```\n\n**Configuration Status:**  Already optimized in nuxt.config.ts (lines 251, 279)\n\n###  Type Safety Verification\n\n-  All TypeScript types working\n-  No type errors\n-  Full IntelliSense support\n-  Generic type support for data\n\n---\n\n## Usage Instructions\n\n### For Developers\n\n#### Creating a New Admin Table with TanStack\n\n```vue\n<template>\n  <AdminTablesAsyncTableWrapper\n    :data=\"products\"\n    :columns=\"columns\"\n    :loading=\"isLoading\"\n    :enable-sorting=\"true\"\n    @row-click=\"handleRowClick\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport type { ColumnDef } from '@tanstack/vue-table'\n\nconst products = ref([...])\nconst columns: ColumnDef<Product>[] = [\n  { accessorKey: 'name', header: 'Product' },\n  { accessorKey: 'price', header: 'Price' },\n]\n\nfunction handleRowClick(product: Product) {\n  // Handle click\n}\n</script>\n```\n\n#### Using the Composable Directly\n\n```vue\n<script setup lang=\"ts\">\nconst { loadTable, isLoading } = useAsyncTable()\n\nconst table = ref(null)\n\nonMounted(async () => {\n  const module = await loadTable()\n  if (module) {\n    table.value = module.useVueTable({\n      data: data.value,\n      columns: columns.value,\n      getCoreRowModel: module.getCoreRowModel(),\n    })\n  }\n})\n</script>\n```\n\n### For Reviewers\n\n#### Files to Review\n\n1. **Core Logic:** `/composables/useAsyncTable.ts`\n2. **Component:** `/components/admin/Tables/AsyncTableWrapper.vue`\n3. **Example:** `/components/admin/Tables/AsyncTableWrapper.example.vue`\n4. **Tests:** `/components/admin/Tables/AsyncTableWrapper.test.ts`\n\n#### Key Points\n\n- No breaking changes to existing code\n- Fully backward compatible\n- Opt-in adoption (existing tables unchanged)\n- Comprehensive documentation\n- Type-safe implementation\n\n---\n\n## Performance Metrics\n\n### Bundle Size Impact\n\n| Metric | Before | After | Change |\n|--------|--------|-------|--------|\n| Main Bundle | ~345KB | ~330KB | **-15KB**  |\n| Admin Chunk | N/A | ~15KB | +15KB (on demand) |\n| Total Initial Load | ~345KB | ~330KB | **-15KB**  |\n\n### Load Time Impact\n\n| Scenario | Before | After | Change |\n|----------|--------|-------|--------|\n| Regular User | Loads 15KB unused | No extra load | **-15KB**  |\n| Admin First Table | Instant | +50-100ms | Acceptable |\n| Admin Second Table | Instant | Instant | No change |\n\n### User Experience\n\n-  **Regular Users:** Faster initial load (no TanStack)\n-  **Admin Users:** Minimal delay (50-100ms, one-time)\n-  **All Users:** No layout shift (loading skeleton)\n-  **All Users:** Graceful error handling\n\n---\n\n## Next Steps\n\n### Immediate (Optional)\n\n1.  **Deploy to Production**\n   - All code is production-ready\n   - No breaking changes\n   - Can deploy immediately\n\n2.  **Monitor Metrics**\n   - Track bundle size\n   - Monitor load times\n   - Check error rates\n\n### Future Enhancements\n\n1. **Migrate Products Table** (Priority 1)\n   - Estimated effort: 2 hours\n   - Benefits: Better sorting, filtering, bulk operations\n   - File: `/components/admin/Products/Table.vue`\n\n2. **Migrate Users Table** (Priority 2)\n   - Estimated effort: 1.5 hours\n   - Benefits: Better UX for user management\n   - File: `/components/admin/Users/Table.vue`\n\n3. **Add Virtual Scrolling**\n   - For large datasets\n   - Lazy load TanStack Virtual\n   - Follow same pattern\n\n4. **Add Export Functionality**\n   - CSV/Excel export\n   - Lazy load export libraries\n   - Consistent pattern\n\n---\n\n## Support & Resources\n\n### Documentation\n\n- [Component README](/components/admin/Tables/README.md)\n- [Implementation Guide](/docs/guides/tanstack-table-lazy-loading.md)\n- [Architecture Doc](/docs/architecture/tanstack-table-lazy-loading-implementation.md)\n\n### External Resources\n\n- [TanStack Table Docs](https://tanstack.com/table/latest)\n- [Vue Async Components](https://vuejs.org/guide/components/async.html)\n- [Vite Code Splitting](https://vitejs.dev/guide/features.html#async-chunk-loading-optimization)\n\n### Contact\n\nFor questions or issues:\n1. Check documentation first\n2. Review example implementation\n3. Check troubleshooting section\n4. Create issue with details\n\n---\n\n## Conclusion\n\n **All deliverables complete**\n **Production ready**\n **Well documented**\n **Performance positive**\n **Type safe**\n **Future proof**\n\nThe lazy loading implementation for TanStack Table successfully reduces the admin bundle size by ~15KB gzipped while maintaining full functionality and type safety. The implementation can be adopted gradually across admin tables as needed.\n\n**Recommendation:** Deploy to production and adopt for new tables going forward. Migrate existing tables when adding advanced features.\n",
              "category": "archive"
            },
            {
              "path": "docs/guides/tanstack-table-lazy-loading.md",
              "name": "tanstack-table-lazy-loading.md",
              "size": 10927,
              "lastModified": "2025-11-11T21:50:30.732Z",
              "content": "# TanStack Table Lazy Loading - Implementation Guide\n\n## Overview\n\nThis guide explains the implementation of lazy loading for TanStack Vue Table in the MoldovaDirect admin interface. By deferring the loading of the TanStack Table library (~15KB gzipped) until it's actually needed, we reduce the initial bundle size and improve page load performance.\n\n## Problem Statement\n\nPreviously, `@tanstack/vue-table` was imported directly in `components/ui/table/utils.ts`, which caused it to be included in the main bundle even though:\n\n1. None of the current admin tables actually use TanStack Table\n2. The library is only needed for advanced table features (sorting, pagination, filtering)\n3. Basic tables can use native HTML with shadcn UI styling\n\n## Solution Architecture\n\n### Components Created\n\n```\ncomposables/\n   useAsyncTable.ts          # Composable for lazy loading TanStack Table\n\ncomponents/admin/Tables/\n   AsyncTableWrapper.vue     # Wrapper component with loading states\n   AsyncTableWrapper.example.vue  # Usage example\n   AsyncTableWrapper.test.ts      # Tests\n   README.md                      # Documentation\n\ncomponents/ui/table/\n   utils.ts                  # Updated to remove direct imports\n\ndocs/guides/\n   tanstack-table-lazy-loading.md  # This file\n```\n\n### How It Works\n\n1. **useAsyncTable Composable**\n   - Dynamically imports TanStack Table when `loadTable()` is called\n   - Caches the loaded module for reuse\n   - Provides loading and error states\n   - Returns all necessary TanStack functions\n\n2. **AsyncTableWrapper Component**\n   - Uses `useAsyncTable` to load the library on mount\n   - Shows loading skeleton during module load\n   - Handles errors gracefully\n   - Supports all TanStack Table features\n\n3. **Updated Table Utils**\n   - Removed direct imports from `@tanstack/vue-table`\n   - Provides standalone utility functions\n   - Maintains type compatibility\n\n## Implementation Details\n\n### Before (Direct Import)\n\n```typescript\n// components/ui/table/utils.ts\nimport { isFunction } from \"@tanstack/vue-table\"  //  Bundled in main chunk\n\nexport function valueUpdater<T>(updaterOrValue: Updater<T>, ref: Ref<T>) {\n  ref.value = isFunction(updaterOrValue)\n    ? updaterOrValue(ref.value)\n    : updaterOrValue\n}\n```\n\n### After (Lazy Loading)\n\n```typescript\n// composables/useAsyncTable.ts\nexport function useAsyncTable() {\n  const loadTable = async () => {\n    const module = await import('@tanstack/vue-table')  //  Lazy loaded\n    return {\n      useVueTable: module.useVueTable,\n      getCoreRowModel: module.getCoreRowModel,\n      // ... other exports\n    }\n  }\n\n  return { loadTable, isLoading, error }\n}\n```\n\n## Usage Examples\n\n### Example 1: Basic Usage\n\n```vue\n<template>\n  <AdminTablesAsyncTableWrapper\n    :data=\"products\"\n    :columns=\"columns\"\n    :loading=\"isLoading\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport type { ColumnDef } from '@tanstack/vue-table'\n\nconst products = ref([...])\nconst isLoading = ref(false)\n\nconst columns: ColumnDef<Product>[] = [\n  { accessorKey: 'name', header: 'Name' },\n  { accessorKey: 'price', header: 'Price' },\n]\n</script>\n```\n\n### Example 2: With Sorting and Selection\n\n```vue\n<template>\n  <AdminTablesAsyncTableWrapper\n    :data=\"users\"\n    :columns=\"columns\"\n    :enable-sorting=\"true\"\n    :enable-row-selection=\"true\"\n    @row-click=\"handleRowClick\"\n  />\n</template>\n\n<script setup lang=\"ts\">\nimport { h } from 'vue'\nimport { Checkbox } from '@/components/ui/checkbox'\n\nconst columns: ColumnDef<User>[] = [\n  {\n    id: 'select',\n    header: ({ table }) => h(Checkbox, {\n      checked: table.getIsAllPageRowsSelected(),\n      'onUpdate:checked': (v) => table.toggleAllPageRowsSelected(v),\n    }),\n    cell: ({ row }) => h(Checkbox, {\n      checked: row.getIsSelected(),\n      'onUpdate:checked': (v) => row.toggleSelected(v),\n    }),\n  },\n  { accessorKey: 'name', header: 'Name' },\n  { accessorKey: 'email', header: 'Email' },\n]\n</script>\n```\n\n### Example 3: Custom Rendering\n\n```vue\n<template>\n  <AdminTablesAsyncTableWrapper\n    :data=\"products\"\n    :columns=\"columns\"\n  >\n    <template #default=\"{ table, module }\">\n      <div class=\"custom-table\">\n        <!-- Full control over rendering -->\n        <div v-for=\"headerGroup in table.getHeaderGroups()\" :key=\"headerGroup.id\">\n          <div\n            v-for=\"header in headerGroup.headers\"\n            :key=\"header.id\"\n            @click=\"header.column.getToggleSortingHandler()?.($event)\"\n          >\n            <component\n              :is=\"module?.flexRender(\n                header.column.columnDef.header,\n                header.getContext()\n              )\"\n            />\n          </div>\n        </div>\n      </div>\n    </template>\n  </AdminTablesAsyncTableWrapper>\n</template>\n```\n\n### Example 4: Using Composable Directly\n\n```vue\n<script setup lang=\"ts\">\nconst { loadTable, isLoading, error } = useAsyncTable()\n\nconst table = ref(null)\n\nonMounted(async () => {\n  const module = await loadTable()\n  if (module) {\n    table.value = module.useVueTable({\n      data: data.value,\n      columns: columns.value,\n      getCoreRowModel: module.getCoreRowModel(),\n      getSortedRowModel: module.getSortedRowModel(),\n    })\n  }\n})\n</script>\n```\n\n## When to Use\n\n### Use AsyncTableWrapper when:\n\n You need advanced table features:\n- Sorting\n- Pagination\n- Filtering\n- Row selection\n- Column resizing\n\n You're building admin interfaces:\n- User management tables\n- Product listings\n- Order management\n- Analytics tables\n\n You have complex data structures:\n- Nested data\n- Dynamic columns\n- Virtual scrolling\n\n### Use basic HTML tables when:\n\n You have simple, read-only tables\n You're building public-facing pages where bundle size is critical\n You only need basic styling without interaction\n\n## Performance Impact\n\n### Bundle Size\n\n**Before:**\n- Main chunk: ~345KB\n- TanStack Table: ~15KB (included in main)\n\n**After:**\n- Main chunk: ~330KB\n- TanStack Table: ~15KB (separate chunk, loaded on demand)\n\n**Savings:** ~15KB removed from main bundle\n\n### Load Time\n\n**Initial Page Load:**\n- Before: Includes TanStack Table (even if not used)\n- After: Does not include TanStack Table\n\n**Admin Table Load:**\n- Module load time: ~50-100ms (first time only)\n- Cached for subsequent uses\n- Loading skeleton prevents layout shift\n\n### User Experience\n\n- **First visit to admin:** Slight delay (50-100ms) while loading table module\n- **Subsequent tables:** Instant (module cached)\n- **No layout shift:** Loading skeleton maintains layout\n- **Error handling:** Graceful degradation if module fails to load\n\n## Migration Checklist\n\nWhen migrating an existing table to use lazy loading:\n\n- [ ] Identify if the table actually needs TanStack features\n- [ ] Create column definitions using `ColumnDef<T>[]`\n- [ ] Replace table HTML with `<AdminTablesAsyncTableWrapper>`\n- [ ] Move sorting/filtering logic to column definitions\n- [ ] Update event handlers to use emitted events\n- [ ] Test loading states\n- [ ] Test error states\n- [ ] Verify sorting/filtering still works\n- [ ] Check mobile responsiveness\n\n## Current Status\n\n###  Implemented\n\n1. `useAsyncTable` composable\n2. `AsyncTableWrapper` component\n3. Updated table utils (removed direct imports)\n4. Example implementation\n5. Documentation\n6. Tests\n\n###  Admin Tables Status\n\nCurrent admin tables are using **basic HTML tables** with shadcn UI components:\n\n- `components/admin/Users/Table.vue` -  Could benefit from TanStack\n- `components/admin/Products/Table.vue` -  Could benefit from TanStack\n- `components/admin/Email/LogsTable.vue` -  Could benefit from TanStack\n- `components/admin/Utils/TopProductsTable.vue` -  Basic table is fine\n\n###  Recommended Next Steps\n\n1. **Migrate Products Table**\n   - Complex sorting requirements\n   - Bulk operations (selection)\n   - Filtering by category, status, price\n\n2. **Migrate Users Table**\n   - User selection for bulk actions\n   - Multi-column sorting\n   - Advanced filtering\n\n3. **Keep Email Logs as-is**\n   - Simple display table\n   - Pagination handled server-side\n   - No complex interactions needed\n\n## Build Configuration\n\nThe Nuxt config already has TanStack Table configured for optimal code splitting:\n\n```typescript\n// nuxt.config.ts\nexport default defineNuxtConfig({\n  vite: {\n    build: {\n      rollupOptions: {\n        output: {\n          manualChunks(id) {\n            if (id.includes('@tanstack')) return 'table'  //  Separate chunk\n          },\n        },\n      },\n    },\n    optimizeDeps: {\n      exclude: ['@tanstack/vue-table'],  //  Not pre-bundled\n    },\n  },\n})\n```\n\nThis ensures:\n- TanStack Table is in a separate chunk\n- It's not pre-bundled during dev\n- It can be lazy-loaded on demand\n\n## Testing\n\n### Unit Tests\n\n```bash\nnpm run test -- AsyncTableWrapper.test.ts\n```\n\n### Manual Testing\n\n1. Navigate to admin page with AsyncTableWrapper\n2. Open Network tab in DevTools\n3. Verify `@tanstack` chunk is loaded separately\n4. Check loading skeleton appears briefly\n5. Verify table renders correctly\n6. Test sorting, filtering, selection\n\n### Bundle Analysis\n\n```bash\nnpm run build\nnpm run analyze\n```\n\nCheck that:\n- `@tanstack/vue-table` is in a separate chunk\n- Main bundle size is reduced\n- Table chunk is ~15KB gzipped\n\n## Troubleshooting\n\n### Issue: \"Cannot find module '@tanstack/vue-table'\"\n\n**Cause:** TypeScript trying to import before runtime\n**Solution:** Ensure all TanStack imports use dynamic import:\n\n```typescript\n//  Don't do this\nimport { useVueTable } from '@tanstack/vue-table'\n\n//  Do this\nconst { loadTable } = useAsyncTable()\nconst module = await loadTable()\nmodule.useVueTable(...)\n```\n\n### Issue: Table not rendering\n\n**Cause:** Module not loaded before use\n**Solution:** Always await `loadTable()` before using table functions\n\n```typescript\nonMounted(async () => {\n  const module = await loadTable()  //  Await this\n  if (module) {\n    // Use module here\n  }\n})\n```\n\n### Issue: Types not working\n\n**Cause:** Type imports not resolved\n**Solution:** Import types separately (they're compiled away):\n\n```typescript\nimport type { ColumnDef, Table } from '@tanstack/vue-table'  //  OK for types\n```\n\n## Additional Resources\n\n- [TanStack Table Documentation](https://tanstack.com/table/latest/docs/framework/vue/vue-table)\n- [Vue Dynamic Components](https://vuejs.org/guide/components/async.html)\n- [Vite Code Splitting](https://vitejs.dev/guide/features.html#async-chunk-loading-optimization)\n- [Component README](/components/admin/Tables/README.md)\n\n## Conclusion\n\nLazy loading TanStack Table provides:\n\n1. **Smaller main bundle** (~15KB reduction)\n2. **Faster initial page load**\n3. **Better user experience** (loading states)\n4. **Flexible architecture** (use TanStack only when needed)\n5. **Type safety** (full TypeScript support)\n\nThe implementation is production-ready and can be adopted gradually across admin tables.\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8245979707713765,
          "recommendation": "Consider consolidating into TANSTACK_TABLE_LAZY_LOADING_DELIVERABLES.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/cart-fixes/CART_PERSISTENCE_FIX.md",
              "name": "CART_PERSISTENCE_FIX.md",
              "size": 8918,
              "lastModified": "2026-01-06T15:49:37.092Z",
              "content": "# Cart Persistence Fix - Cookie Migration Issue\n\n**Date:** 2024-11-24\n**Issue:** Cart items not persisting after localStorage  cookie migration\n**Status:**  FIXED\n\n---\n\n## Problem Summary\n\nAfter migrating from localStorage to cookies for SSR compatibility (commit `9272a4b`), cart items were not persisting between page refreshes or navigation. The cart would appear empty even after adding items.\n\n---\n\n## Root Cause Analysis\n\n### 1. Missing `path: '/'` Configuration  CRITICAL\n\n**File:** `config/cookies.ts`\n\nThe cart cookie configuration was missing the `path: '/'` option:\n\n```typescript\n//  BEFORE - Cookie might be scoped to specific path\nexport const CART_COOKIE_CONFIG: CookieConfig = {\n  maxAge: 60 * 60 * 24 * 30,\n  sameSite: 'lax',\n  secure: process.env.NODE_ENV === 'production',\n  watch: 'shallow',  //  Also problematic\n  default: () => null\n}\n```\n\n**Impact:** Without `path: '/'`, cookies are scoped to the path where they were created. If a user adds items on `/products/abc`, the cookie is scoped to `/products/*` and won't be accessible on `/checkout` or other routes.\n\n**Reference:** The checkout cookie config (line 39) correctly includes `path: '/'`, which is why checkout persistence worked but cart persistence didn't.\n\n###  2. Incorrect `watch` Configuration\n\n**Problem:** `watch: 'shallow'` doesn't work well with complex nested data structures like cart items arrays.\n\n**Impact:** Nuxt's `useCookie` with `watch: 'shallow'` might not detect changes to cart items properly, especially when modifying nested properties.\n\n**Solution:** Set `watch: false` because the cart store handles persistence manually via a Vue `watch()` on the items array (line 573).\n\n### 3. Non-Functional Lifecycle Hooks\n\n**File:** `stores/cart/index.ts` (lines 588-609 - now removed)\n\n```typescript\n//  This never runs - Pinia stores don't have lifecycle hooks outside components\nif (process.client) {\n  onMounted(async () => {\n    // This code never executes!\n    deserializeCartData(cartCookie.value)\n  })\n}\n```\n\n**Impact:** Dead code that creates false expectations. Cart loading actually happens via `initializeCart()` called from the plugin, not `onMounted`.\n\n---\n\n## Changes Made\n\n### 1. Fixed Cookie Configuration \n\n**File:** `config/cookies.ts:22-29`\n\n```typescript\n//  AFTER - Correct configuration\nexport const CART_COOKIE_CONFIG: CookieConfig = {\n  maxAge: 60 * 60 * 24 * 30, // 30 days\n  sameSite: 'lax',\n  secure: process.env.NODE_ENV === 'production',\n  path: '/', //  ADDED: Accessible from all routes\n  watch: false, //  CHANGED: Store handles persistence manually\n  default: () => null\n}\n```\n\n**Why This Fixes It:**\n- `path: '/'` ensures cookie is accessible site-wide\n- `watch: false` prevents Nuxt's automatic watch conflicts with store's manual watch\n\n### 2. Removed Dead Code \n\n**File:** `stores/cart/index.ts:582-588`\n\n**Before:** 26 lines of `onMounted`/`onUnmounted` hooks that never ran\n\n**After:** Clear comment explaining why lifecycle hooks don't work in stores\n\n```typescript\n// NOTE: onMounted/onUnmounted don't work in Pinia stores outside components\n// Cart loading is handled by initializeCart() called from plugin\n// Auto-save watch will be cleaned up when store instance is disposed\n```\n\n### 3. Cleaned Up Imports \n\n**File:** `stores/cart/index.ts:9`\n\n**Removed:** `onMounted`, `onUnmounted`, `nextTick` (no longer used)\n\n---\n\n## How Cart Persistence Actually Works\n\n### Initialization Flow\n\n1. **Plugin:** `plugins/cart.client.ts` runs on page load\n   ```typescript\n   cartStore.initializeCart()  // Line 20\n   ```\n\n2. **Initialize:** `stores/cart/index.ts` line 217\n   ```typescript\n   function initializeCart() {\n     core.initializeCart()        // Generate session ID\n     loadFromStorage()             // Load from cookie\n     // ... other initialization\n   }\n   ```\n\n3. **Load:** Line 175-192\n   ```typescript\n   async function loadFromStorage() {\n     const loadedData = cartCookie.value  // Read cookie\n     if (loadedData?.items) {\n       deserializeCartData(loadedData)    // Restore items\n     }\n   }\n   ```\n\n### Auto-Save Flow\n\n1. **Watch Setup:** Line 573-579\n   ```typescript\n   watch(() => items.value, () => {\n     saveAndCacheCartData()  // Debounced save (1 second)\n   }, { deep: true })\n   ```\n\n2. **Debounced Save:** Line 262-264\n   ```typescript\n   setTimeout(async () => {\n     await saveToStorage()  // Writes to cookie\n   }, 1000)\n   ```\n\n3. **Write to Cookie:** Line 161\n   ```typescript\n   cartCookie.value = serializeCartData()  // { items, sessionId, ... }\n   ```\n\n### Manual Save Flow\n\nAll cart mutations (add, remove, update) also call `saveAndCacheCartData()`:\n\n- `addItem()`  line 307\n- `removeItem()`  line 346\n- `updateQuantity()`  line 386\n- `clearCart()`  saveToStorage (from clearCart implementation)\n\n---\n\n## Testing Instructions\n\n### 1. Clear Existing Cart Data\n```bash\n# In browser DevTools Console:\ndocument.cookie = \"moldova_direct_cart=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\n```\n\n### 2. Test Cart Persistence\n\n**Scenario A: Add Items and Refresh**\n1. Go to homepage\n2. Add 2-3 products to cart\n3. Refresh page (F5)\n4. **Expected:** Cart still contains items\n5. **Check DevTools:** Application  Cookies  `moldova_direct_cart` should exist\n\n**Scenario B: Add Items and Navigate**\n1. Add product from `/products/abc`\n2. Navigate to `/checkout`\n3. **Expected:** Cart items visible in checkout\n4. Navigate to `/cart`\n5. **Expected:** Cart items still present\n\n**Scenario C: Add Items and Close Browser**\n1. Add products to cart\n2. Close browser completely\n3. Reopen browser and go to site\n4. **Expected:** Cart items restored (within 30 days)\n\n### 3. Verify Cookie\n\nOpen DevTools  Application  Cookies  Check for:\n- **Name:** `moldova_direct_cart`\n- **Path:** `/`\n- **Expires:** ~30 days from now\n- **Value:** JSON with `{ items: [...], sessionId: \"cart_...\", ... }`\n\n---\n\n## Related Files\n\n### Primary Files Modified\n- `config/cookies.ts` - Cookie configuration\n- `stores/cart/index.ts` - Main cart store (removed dead code, cleaned imports)\n\n### Related Files (No Changes)\n- `plugins/cart.client.ts` - Cart initialization plugin\n- `stores/cart/core.ts` - Cart core logic\n- `stores/cart/persistence.ts` - Persistence utilities (still used)\n\n---\n\n## Backward Compatibility\n\n **Fully Backward Compatible**\n\n- Existing localStorage data (if any) won't interfere\n- Cookie name unchanged (`moldova_direct_cart`)\n- API unchanged - all store methods work the same\n- No breaking changes to components using the cart\n\n---\n\n## Migration History\n\n**Commit Timeline:**\n1. Initial localStorage implementation\n2. `9272a4b` - Migrated to cookies for SSR\n3. Multiple follow-up fixes for cookie sync issues\n4. **THIS FIX** - Corrected cookie `path` and removed dead code\n\n**Previous Issues:**\n- Multiple `useCookie()` calls not syncing (fixed by single cookie ref)\n- Cart not auto-saving (fixed by adding watch)\n- Cart not persisting (fixed by this commit - `path: '/'`)\n\n---\n\n## Production Checklist\n\nBefore deploying:\n\n- [ ] Clear browser cache and cookies\n- [ ] Test on production-like environment\n- [ ] Verify cookie is set with `path=/`\n- [ ] Test cart persistence across different routes\n- [ ] Test cart persistence after browser close/reopen\n- [ ] Monitor browser console for cookie-related errors\n- [ ] Check DevTools Application  Cookies for proper config\n\n---\n\n## Success Metrics\n\n**Before Fix:**\n-  Cart items lost on page refresh\n-  Cart items not shared across routes\n-  Empty cart on checkout page\n-  User frustration - items disappear\n\n**After Fix:**\n-  Cart persists across page refreshes\n-  Cart accessible from all routes\n-  Cart data survives browser close (30 days)\n-  Seamless checkout experience\n\n---\n\n## Known Limitations\n\n1. **30-Day Expiration:** Cart data expires after 30 days of inactivity\n2. **Client-Side Only:** Cart is client-side - not synced to database for guests\n3. **Browser-Specific:** Cart is per-browser (not synced across devices)\n4. **Cookie Size:** Large carts (many items) might hit cookie size limits (~4KB)\n\n**Future Improvements:**\n- [ ] Sync cart to database for authenticated users\n- [ ] Implement cart size limits to prevent cookie overflow\n- [ ] Add cart expiration warnings for users\n- [ ] Consider IndexedDB for larger carts\n\n---\n\n## Conclusion\n\nThe cart persistence issue was caused by a missing `path: '/'` in the cookie configuration, which scoped cookies to specific routes instead of making them site-wide. This is now fixed and cart items properly persist across all routes and page refreshes.\n\n**Status:**  RESOLVED\n**Impact:** HIGH (affects all cart functionality)\n**Priority:** CRITICAL (blocking checkout)\n**Deployed:** Pending testing and deployment\n\n---\n\n**Generated:** 2024-11-24\n**Author:** Claude Code\n**Related Issue:** Cart not persisting after localStorage  cookie migration\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/fix-summaries/CART_COOKIE_FIX_SUMMARY.md",
              "name": "CART_COOKIE_FIX_SUMMARY.md",
              "size": 4293,
              "lastModified": "2026-01-14T21:35:39.886Z",
              "content": "# Cart Cookie Persistence Fix - Summary\n\n## Problem Statement\n\nAfter migrating from localStorage to cookie-based cart persistence, the shopping cart was not persisting data. Items added to cart disappeared when navigating between pages or refreshing the browser.\n\n## Root Causes Identified\n\n### 1. **Missing `path: '/'` in Cookie Configuration** (FIXED )\n- **Location**: `config/cookies.ts:26`\n- **Issue**: Cookie was scoped to creation path (e.g., `/products/*`) instead of site-wide\n- **Fix**: Added `path: '/'` to `CART_COOKIE_CONFIG`\n- **Impact**: Cookie now accessible from all routes\n\n### 2. **`watch: false` Preventing Cookie Updates** (FIXED )\n- **Location**: `config/cookies.ts:27`\n- **Issue**: With `watch: false`, changes to the cookie ref weren't synced to the browser cookie\n- **Fix**: Removed `watch: false` option to allow Nuxt's automatic synchronization\n- **Impact**: Cart changes now automatically persist to cookie\n\n### 3. **Cart Analytics Plugin Breaking Cart Initialization** (FIXED )\n- **Location**: `plugins/cart-analytics.client.ts:42-56`\n- **Issue**: Plugin called `useCartStore()` before cart plugin initialized, throwing `ReferenceError`\n- **Fix**: Added try-catch error handling and increased initialization delay to 500ms\n- **Impact**: Cart now initializes properly, analytics failure doesn't block cart functionality\n\n## Changes Made\n\n### `config/cookies.ts`\n```typescript\n// BEFORE\nexport const CART_COOKIE_CONFIG: CookieConfig = {\n  maxAge: 60 * 60 * 24 * 30,\n  sameSite: 'lax',\n  secure: process.env.NODE_ENV === 'production',\n  watch: 'shallow', //  Wrong: conflicts with manual watch\n  default: () => null\n}\n\n// AFTER\nexport const CART_COOKIE_CONFIG: CookieConfig = {\n  maxAge: 60 * 60 * 24 * 30, // 30 days\n  sameSite: 'lax',\n  secure: process.env.NODE_ENV === 'production',\n  path: '/', //  ADDED: Accessible from all routes\n  // watch removed - let Nuxt handle reactivity\n  default: () => null\n}\n```\n\n### `plugins/cart-analytics.client.ts`\n```typescript\n// BEFORE - Would crash if cart not ready\nif (to.path === \"/cart\") {\n  setTimeout(() => {\n    const cartAnalytics = useCartAnalytics();\n    const cartStore = useCartStore(); //  Throws error if not ready\n    // ...\n  }, 100);\n}\n\n// AFTER - Graceful error handling\nif (to.path === \"/cart\") {\n  setTimeout(() => {\n    try {\n      const cartAnalytics = useCartAnalytics();\n      try {\n        const cartStore = useCartStore();\n        // ... tracking code\n      } catch (storeError) {\n        //  Cart store not ready - skip tracking (non-critical)\n        return;\n      }\n    } catch (error) {\n      console.warn(\"Failed to track cart view:\", error);\n    }\n  }, 500); //  Increased delay to ensure cart plugin initializes first\n}\n```\n\n### `stores/cart/index.ts`\n- Removed 26 lines of dead code (non-functional lifecycle hooks)\n- Added debug logging (temporary - will be removed)\n\n## Test Results\n\n### Cart Cookie Configuration \n- **Name**: `moldova_direct_cart`\n- **Path**: `/` (site-wide - CORRECT)\n- **Expires**: ~30 days\n- **Size**: 573 bytes (with items), 192 bytes (empty)\n\n### Functionality \n- Cart cookie is created when items are added\n- Cookie persists across page refreshes\n- Cookie persists across different routes\n- Cookie persists across browser sessions (30-day expiration)\n\n## Remaining Issues\n\n### Cart Data Deserialization\n- Items are added successfully\n- Cookie is saved with correct data\n- BUT: Cart shows 0 items after navigation\n- **Next Step**: Investigate deserialization logic in `stores/cart/index.ts:128-154`\n\n## Related Files\n\n- `config/cookies.ts` - Cookie configuration\n- `stores/cart/index.ts` - Main cart store with persistence\n- `plugins/cart.client.ts` - Cart initialization\n- `plugins/cart-analytics.client.ts` - Cart analytics tracking\n- `test-cart-persistence.mjs` - Automated persistence test\n- `test-cart-manual.mjs` - Manual test with full console output\n\n## Testing\n\nRun cart persistence test:\n```bash\nnode test-cart-persistence.mjs\n```\n\nExpected output:\n```\n Cart cookie created\n Path is \"/\" (site-wide - CORRECT)\n Cart persists after refresh\n Cart cookie restored across browser sessions\n```\n\n---\n\n**Status**: Cart cookie persistence is WORKING \n**Next**: Fix cart data deserialization issue\n**Updated**: 2025-11-26\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8159985846345853,
          "recommendation": "Consider consolidating into CART_COOKIE_FIX_SUMMARY.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/checkout-reviews/CHECKOUT_BEFORE_AFTER_COMPARISON.md",
              "name": "CHECKOUT_BEFORE_AFTER_COMPARISON.md",
              "size": 13293,
              "lastModified": "2026-01-06T15:49:37.094Z",
              "content": "# Checkout UX - Before/After Code Comparison\n**Date:** 2025-12-23\n**Purpose:** Visual side-by-side comparison of recommended refactorings\n\n---\n\n## Refactoring #1: Validation Logic Consolidation\n\n### Problem: Repetitive Switch Cases\n\nThe current validation method repeats nearly identical logic 6 times, making it hard to maintain and update.\n\n### BEFORE: 32 Lines\n```typescript\nconst validateField = (fieldName: string) => {\n  const value = localAddress.value[fieldName as keyof Address]\n\n  // Unnecessary inner function with complex type logic\n  const getStringValue = (val: any): string => {\n    if (typeof val === 'string') return val\n    if (val != null && typeof val !== 'boolean' && typeof val !== 'number') return String(val)\n    return ''\n  }\n\n  // Repetitive switch with identical patterns\n  switch (fieldName) {\n    case 'firstName':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.firstName = t('checkout.validation.firstNameRequired', 'First name is required')\n      }\n      break\n    case 'lastName':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.lastName = t('checkout.validation.lastNameRequired', 'Last name is required')\n      }\n      break\n    case 'street':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.street = t('checkout.validation.streetRequired', 'Street address is required')\n      }\n      break\n    case 'city':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.city = t('checkout.validation.cityRequired', 'City is required')\n      }\n      break\n    case 'postalCode':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.postalCode = t('checkout.validation.postalCodeRequired', 'Postal code is required')\n      }\n      break\n    case 'country':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.country = t('checkout.validation.countryRequired', 'Country is required')\n      }\n      break\n  }\n}\n```\n\n### AFTER: 8 Lines\n```typescript\n// Configuration object at top of script section\nconst REQUIRED_FIELD_TRANSLATIONS: Record<string, string> = {\n  firstName: 'checkout.validation.firstNameRequired',\n  lastName: 'checkout.validation.lastNameRequired',\n  street: 'checkout.validation.streetRequired',\n  city: 'checkout.validation.cityRequired',\n  postalCode: 'checkout.validation.postalCodeRequired',\n  country: 'checkout.validation.countryRequired',\n}\n\n// Single, clear validation logic\nconst validateField = (fieldName: string) => {\n  const value = localAddress.value[fieldName as keyof Address]\n  const stringValue = typeof value === 'string' ? value : ''\n\n  if (fieldName in REQUIRED_FIELD_TRANSLATIONS && !stringValue.trim()) {\n    fieldErrors.value[fieldName] = t(REQUIRED_FIELD_TRANSLATIONS[fieldName], '')\n  }\n}\n```\n\n### Analysis\n| Aspect | Before | After |\n|--------|--------|-------|\n| Lines | 32 | 8 |\n| Cyclomatic Complexity | 8 (switch + 6 branches) | 1 (single if) |\n| Maintainability | Hard - add field needs 6 lines | Easy - add to config object |\n| Readability | Low - pattern not obvious | High - clear structure |\n| Reusability | No | Yes - can inspect REQUIRED_FIELD_TRANSLATIONS elsewhere |\n\n---\n\n## Refactoring #2: Field Error Clearing\n\n### Problem: Over-engineered Object Manipulation\n\n### BEFORE: 11 Lines\n```typescript\nconst clearFieldError = (fieldName: string) => {\n  if (fieldErrors.value[fieldName]) {\n    // Unnecessary object destructuring for single field removal\n    const { [fieldName]: _removed, ...rest } = fieldErrors.value\n    fieldErrors.value = rest\n  }\n}\n\nconst clearAllErrors = () => {\n  fieldErrors.value = {}\n}\n```\n\n### AFTER: 6 Lines\n```typescript\nconst clearFieldError = (fieldName: string) => {\n  // Direct mutation is appropriate in Vue Ref context\n  delete fieldErrors.value[fieldName]\n}\n\nconst clearAllErrors = () => {\n  fieldErrors.value = {}\n}\n```\n\n### Comparison\n| Aspect | Before | After |\n|--------|--------|-------|\n| Lines | 11 | 6 |\n| Clarity | Low - creates new object | High - direct deletion |\n| Performance | Slightly worse - creates new object | Slightly better - direct mutation |\n| Intent | Unclear why destructuring needed | Clear - just delete the field |\n\n---\n\n## Refactoring #3: Address Display Logic\n\n### Problem: Verbose Template with Repetitive Conditional Rendering\n\n### BEFORE: 15 Lines (8 template + 7 data)\n**Template:**\n```vue\n<div class=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n  <p>{{ shippingInfo.address.firstName }} {{ shippingInfo.address.lastName }}</p>\n  <p v-if=\"shippingInfo.address.company\">{{ shippingInfo.address.company }}</p>\n  <p>{{ shippingInfo.address.street }}</p>\n  <p>{{ shippingInfo.address.city }}, {{ shippingInfo.address.postalCode }}</p>\n  <p v-if=\"shippingInfo.address.province\">{{ shippingInfo.address.province }}</p>\n  <p>{{ shippingInfo.address.country }}</p>\n  <p v-if=\"shippingInfo.address.phone\">{{ shippingInfo.address.phone }}</p>\n</div>\n```\n\n### AFTER: 11 Lines (4 template + 7 script)\n**Script:**\n```typescript\nconst addressLines = computed(() => {\n  if (!props.shippingInfo) return []\n\n  const addr = props.shippingInfo.address\n  return [\n    `${addr.firstName} ${addr.lastName}`,\n    addr.company,\n    addr.street,\n    `${addr.city}, ${addr.postalCode}`,\n    addr.province,\n    addr.country,\n    addr.phone,\n  ].filter(Boolean)\n})\n```\n\n**Template:**\n```vue\n<div class=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n  <p v-for=\"(line, idx) in addressLines\" :key=\"idx\">\n    {{ line }}\n  </p>\n</div>\n```\n\n### Benefits Breakdown\n| Aspect | Before | After |\n|--------|--------|-------|\n| Template Lines | 8 | 4 |\n| Conditional Rendering | 3 conditional branches | 1 filter |\n| Reusability | Template-only | Accessible as computed property |\n| Extensibility | Add line needs template change | Add line needs config change |\n| Logic Clarity | Spread across template | Centralized in script |\n\n---\n\n## Refactoring #4: Type Guard Simplification\n\n### Problem: Complex Conditional Logic for Simple Type Check\n\n### BEFORE: 9 Lines\n```typescript\nconst getStringValue = (val: any): string => {\n  if (typeof val === 'string') return val\n  // Complex logic: \"if not null AND not boolean AND not number\"\n  // This is backwards thinking - should be: \"if it could be a string\"\n  if (val != null && typeof val !== 'boolean' && typeof val !== 'number') return String(val)\n  return ''\n}\n```\n\n### AFTER: 3 Lines\n```typescript\n// In validateField, inline where used:\nconst stringValue = typeof value === 'string' ? value : ''\n```\n\n### Why This Is Better\n1. **Simpler Logic:** Direct check instead of multiple negations\n2. **Clearer Intent:** \"Convert to string if not already\" is obvious\n3. **Fewer Functions:** No need for intermediate helper\n4. **Easier to Test:** Logic is explicit, not hidden in helper\n\n| Aspect | Before | After |\n|--------|--------|-------|\n| Conditions | 3 | 1 |\n| Negations | 2 | 0 |\n| Clarity | Low | High |\n| Reusability | Limited (only in validation) | N/A - inline is fine |\n\n---\n\n## Refactoring #5: Layout Placeholder Removal\n\n### Problem: Empty Div Used as Layout Spacer\n\n### BEFORE: 26 Lines\n```vue\n<div\n  class=\"flex flex-col sm:flex-row justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700 space-y-3 sm:space-y-0\"\n>\n  <NuxtLink\n    v-if=\"backTo\"\n    :to=\"localePath(backTo)\"\n    class=\"inline-flex items-center px-6 py-3 text-base font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors min-h-[48px]\"\n  >\n    <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\n    </svg>\n    {{ backLabel || $t('checkout.backToCart') }}\n  </NuxtLink>\n  <div v-else></div>  <!-- UNNECESSARY -->\n\n  <Button>\n    <!-- button content -->\n  </Button>\n</div>\n```\n\n### AFTER: 24 Lines (2 lines saved)\n```vue\n<div\n  class=\"flex flex-col sm:flex-row justify-between items-center gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\"\n>\n  <NuxtLink\n    v-if=\"backTo\"\n    :to=\"localePath(backTo)\"\n    class=\"inline-flex items-center px-6 py-3 text-base font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors min-h-[48px]\"\n  >\n    <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\n    </svg>\n    {{ backLabel || $t('checkout.backToCart') }}\n  </NuxtLink>\n\n  <Button>\n    <!-- button content -->\n  </Button>\n</div>\n```\n\n### Changes Made\n1. `space-y-3 sm:space-y-0`  `gap-3` (more modern, works better with flex)\n2. Remove `<div v-else></div>` placeholder\n\n| Aspect | Before | After |\n|--------|--------|-------|\n| DOM Nodes | 3 wrappers | 2 wrappers |\n| CSS Approach | space utilities | gap utility |\n| Clarity | Confusing empty div | Clean layout |\n| Responsiveness | Same | Same |\n\n---\n\n## Refactoring #6: Type Safety Improvement\n\n### Problem: Loose Type Definition Hinders Autocomplete\n\n### BEFORE: 9 Lines\n```typescript\nconst getLocalizedText = (text: any): string => {\n  if (!text) return ''\n  if (typeof text === 'string') return text\n  // 'any' type means no IDE hints\n  const localeText = text[locale.value]\n  if (localeText) return localeText\n  const esText = text.es\n  if (esText) return esText\n  const values = Object.values(text).filter((v): v is string => typeof v === 'string')\n  return values[0] || ''\n}\n```\n\n### AFTER: 10 Lines\n```typescript\ntype LocalizedText = string | Record<string, string>\n\nconst getLocalizedText = (text: LocalizedText | null): string => {\n  if (!text) return ''\n  if (typeof text === 'string') return text\n\n  const localized = text as Record<string, string>\n  // Nullish coalescing is clearer than nested conditionals\n  return localized[locale.value] ?? localized.es ?? Object.values(localized)[0] ?? ''\n}\n```\n\n### Improvements\n| Aspect | Before | After |\n|--------|--------|-------|\n| Type Safety | `any` - no help | Explicit - IDE hints |\n| Fallback Logic | 4 conditions | 3 fallbacks with `??` |\n| Clarity | Multiple ifs | Single return with fallback |\n| IDE Support | None | Full autocomplete |\n\n---\n\n## Summary Table\n\n| Refactoring | Lines Saved | Complexity Reduction | Maintainability | Risk |\n|-------------|-------------|----------------------|-----------------|------|\n| Validation Consolidation | 24 | 88% | HIGH | LOW |\n| Error Clearing | 5 | 45% | MEDIUM | LOW |\n| Address Display | 4 | 50% | HIGH | LOW |\n| Type Guard | 6 | 66% | MEDIUM | LOW |\n| Layout Cleanup | 2 | 25% | MEDIUM | LOW |\n| Type Safety | 0 | 30% (clarity) | MEDIUM | LOW |\n| **TOTAL** | **~41** | **~50% overall** | **HIGH** | **LOW** |\n\n---\n\n## Impact on Codebase Health\n\n### Metrics Before\n- Total lines in 6 components: 1,159\n- Validation complexity: 32 lines, 8 paths\n- Template verbosity: Many conditional branches\n- Type safety: Some `any` types used\n\n### Metrics After\n- Total lines in 6 components: ~1,118 (-41 lines, -3.5%)\n- Validation complexity: 8 lines, 1 path (-75%)\n- Template verbosity: Reduced through computed properties\n- Type safety: Improved type definitions\n\n### Maintenance Impact\n- **Easier to add fields:** Just add to config objects\n- **Easier to modify logic:** Centralized in script, not template\n- **Easier to debug:** Clearer code paths\n- **Easier to test:** Less repetition means fewer test cases\n\n---\n\n## Implementation Difficulty\n\n```\nEasy (5-10 min per refactoring)\n Error Clearing\n Layout Cleanup\n Type Safety Improvement\n\nMedium (15-30 min per refactoring)\n Type Guard Simplification\n Address Display Consolidation\n\nComplex (30-60 min per refactoring)\n Validation Consolidation\n    Requires testing all 6 fields\n    Need to verify error messages display\n    Must test across all locales\n```\n\n---\n\n## Functional Equivalence\n\n### Validation Refactoring\n| Scenario | Before | After |\n|----------|--------|-------|\n| Empty required field | Shows error | Shows error  |\n| Filled required field | No error | No error  |\n| Optional field empty | No error | No error  |\n| Add new field | 6 lines code | 1 line config  |\n\n### Address Display Refactoring\n| Scenario | Before | After |\n|----------|--------|-------|\n| Full address | All lines show | All lines show  |\n| Missing company | Hides company | Hides company  |\n| Missing province | Hides province | Hides province  |\n| Missing phone | Hides phone | Hides phone  |\n\nAll refactorings preserve 100% functional equivalence.\n\n---\n\n## Conclusion\n\nThese refactorings demonstrate the principle of **\"same functionality, clearer code\"** by:\n\n1. **Removing duplication** - Config-driven validation instead of switch statement\n2. **Simplifying logic** - Straightforward checks instead of complex conditionals\n3. **Improving clarity** - Computed properties instead of template conditionals\n4. **Enhancing safety** - Proper types instead of `any`\n5. **Reducing complexity** - Half as many lines, clearer intent\n\n**Total improvement:** ~41 lines removed, 50% complexity reduction, 100% functionality preserved.\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/checkout-reviews/CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md",
              "name": "CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md",
              "size": 11598,
              "lastModified": "2026-01-06T15:49:37.095Z",
              "content": "# Checkout UX Simplification - Refactoring Guide\n**Date:** 2025-12-23\n**Purpose:** Practical code examples for implementing simplification recommendations\n**Status:** Ready for implementation\n\n---\n\n## Refactoring #1: AddressForm Validation Consolidation\n\n### Current State (32 lines)\n```typescript\nconst validateField = (fieldName: string) => {\n  const value = localAddress.value[fieldName as keyof Address]\n\n  const getStringValue = (val: any): string => {\n    if (typeof val === 'string') return val\n    if (val != null && typeof val !== 'boolean' && typeof val !== 'number') return String(val)\n    return ''\n  }\n\n  switch (fieldName) {\n    case 'firstName':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.firstName = t('checkout.validation.firstNameRequired', 'First name is required')\n      }\n      break\n    case 'lastName':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.lastName = t('checkout.validation.lastNameRequired', 'Last name is required')\n      }\n      break\n    case 'street':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.street = t('checkout.validation.streetRequired', 'Street address is required')\n      }\n      break\n    case 'city':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.city = t('checkout.validation.cityRequired', 'City is required')\n      }\n      break\n    case 'postalCode':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.postalCode = t('checkout.validation.postalCodeRequired', 'Postal code is required')\n      }\n      break\n    case 'country':\n      if (!getStringValue(value).trim()) {\n        fieldErrors.value.country = t('checkout.validation.countryRequired', 'Country is required')\n      }\n      break\n  }\n}\n```\n\n### Refactored Version (8 lines)\n```typescript\n// Configuration for required field validation\nconst REQUIRED_FIELD_TRANSLATIONS: Record<string, string> = {\n  firstName: 'checkout.validation.firstNameRequired',\n  lastName: 'checkout.validation.lastNameRequired',\n  street: 'checkout.validation.streetRequired',\n  city: 'checkout.validation.cityRequired',\n  postalCode: 'checkout.validation.postalCodeRequired',\n  country: 'checkout.validation.countryRequired',\n}\n\nconst validateField = (fieldName: string) => {\n  const value = localAddress.value[fieldName as keyof Address]\n  const stringValue = typeof value === 'string' ? value : ''\n\n  if (fieldName in REQUIRED_FIELD_TRANSLATIONS && !stringValue.trim()) {\n    fieldErrors.value[fieldName] = t(REQUIRED_FIELD_TRANSLATIONS[fieldName], '')\n  }\n}\n```\n\n### Benefits\n- Reduces code by 24 lines (75% reduction)\n- Centralizes field configuration for easier updates\n- Single validation logic path (no switch statement)\n- Same functionality, clearer intent\n- Easy to add new required fields (just add to config)\n\n### Implementation Steps\n1. Add `REQUIRED_FIELD_TRANSLATIONS` constant above `validateField` function\n2. Replace entire switch statement with new 5-line logic\n3. Remove internal `getStringValue` function\n4. Test validation behavior unchanged\n\n### Testing Checklist\n- [ ] All 6 required fields still validate correctly\n- [ ] Error messages display in correct locale\n- [ ] No regression in error clearing\n- [ ] Console shows no TypeScript errors\n\n---\n\n## Refactoring #2: AddressForm Field Error Clearing\n\n### Current State (11 lines)\n```typescript\nconst clearFieldError = (fieldName: string) => {\n  if (fieldErrors.value[fieldName]) {\n    const { [fieldName]: _removed, ...rest } = fieldErrors.value\n    fieldErrors.value = rest\n  }\n}\n\nconst clearAllErrors = () => {\n  fieldErrors.value = {}\n}\n```\n\n### Refactored Version (6 lines)\n```typescript\nconst clearFieldError = (fieldName: string) => {\n  delete fieldErrors.value[fieldName]\n}\n\nconst clearAllErrors = () => {\n  fieldErrors.value = {}\n}\n```\n\n### Benefits\n- Removes unnecessary object destructuring\n- More direct mutation (appropriate in Ref context)\n- Half the code, same functionality\n- Clearer intent: \"delete this field's error\"\n\n### Implementation Steps\n1. Replace `clearFieldError` implementation\n2. Delete pattern remains unchanged\n\n### Testing Checklist\n- [ ] Clicking field still clears its error\n- [ ] Clear all errors still works\n- [ ] No console warnings about object mutation\n- [ ] Error state updates properly in UI\n\n---\n\n## Refactoring #3: ReviewShippingSection Address Display\n\n### Current State (8 lines + 7 lines data)\n```vue\n<div class=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n  <p>{{ shippingInfo.address.firstName }} {{ shippingInfo.address.lastName }}</p>\n  <p v-if=\"shippingInfo.address.company\">{{ shippingInfo.address.company }}</p>\n  <p>{{ shippingInfo.address.street }}</p>\n  <p>{{ shippingInfo.address.city }}, {{ shippingInfo.address.postalCode }}</p>\n  <p v-if=\"shippingInfo.address.province\">{{ shippingInfo.address.province }}</p>\n  <p>{{ shippingInfo.address.country }}</p>\n  <p v-if=\"shippingInfo.address.phone\">{{ shippingInfo.address.phone }}</p>\n</div>\n```\n\n### Refactored Version (4 lines + 11 lines script)\n**Script section (add to bottom of `<script setup>`):**\n```typescript\nconst addressLines = computed(() => {\n  if (!props.shippingInfo) return []\n\n  const addr = props.shippingInfo.address\n  return [\n    `${addr.firstName} ${addr.lastName}`,\n    addr.company,\n    addr.street,\n    `${addr.city}, ${addr.postalCode}`,\n    addr.province,\n    addr.country,\n    addr.phone,\n  ].filter(Boolean) // Remove empty/falsy lines\n})\n```\n\n**Template:**\n```vue\n<div class=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n  <p v-for=\"(line, idx) in addressLines\" :key=\"idx\">\n    {{ line }}\n  </p>\n</div>\n```\n\n### Benefits\n- Template reduced from 8 lines to 4 lines\n- Consolidates all address formatting logic\n- Handles optional fields naturally with `filter(Boolean)`\n- Easier to reuse address formatting elsewhere\n- Cleaner template, more maintainable script\n\n### Implementation Steps\n1. Add `addressLines` computed property to script\n2. Replace `<div>` contents with single `v-for` loop\n3. Delete all individual `<p>` elements\n\n### Testing Checklist\n- [ ] Full address displays correctly\n- [ ] Optional fields (company, province, phone) hidden when empty\n- [ ] Optional fields shown when present\n- [ ] No empty lines in display\n- [ ] Responsive layout still works\n- [ ] Dark mode contrast maintained\n\n---\n\n## Refactoring #4: CheckoutNavigation Empty Div Removal\n\n### Current State (25 lines)\n```vue\n<div class=\"flex flex-col sm:flex-row justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700 space-y-3 sm:space-y-0\">\n  <NuxtLink\n    v-if=\"backTo\"\n    :to=\"localePath(backTo)\"\n    class=\"inline-flex items-center px-6 py-3 text-base font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors min-h-[48px]\"\n  >\n    <!-- Back button content -->\n  </NuxtLink>\n  <div v-else></div>  <!-- Empty placeholder -->\n\n  <Button ...>\n  </Button>\n</div>\n```\n\n### Refactored Version (More CSS-based layout)\n```vue\n<div class=\"flex flex-col sm:flex-row justify-between items-center gap-3 pt-6 border-t border-gray-200 dark:border-gray-700\">\n  <NuxtLink\n    v-if=\"backTo\"\n    :to=\"localePath(backTo)\"\n    class=\"inline-flex items-center px-6 py-3 text-base font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors min-h-[48px]\"\n  >\n    <!-- Back button content -->\n  </NuxtLink>\n\n  <Button\n    :disabled=\"!canProceed || processing\"\n    size=\"lg\"\n    class=\"inline-flex items-center px-8 h-12 text-base font-medium min-w-[180px] justify-center\"\n    @click=\"$emit('proceed')\"\n  >\n    <!-- Button content -->\n  </Button>\n</div>\n```\n\n### Changes\n- Replace `space-y-3 sm:space-y-0` with `gap-3` (gap works better with flex)\n- Remove `<div v-else></div>` placeholder\n- Keep flexbox `justify-between` for spacing\n\n### Benefits\n- Removes unnecessary DOM node\n- Cleaner template structure\n- `gap` CSS is more modern than space utilities\n- Same visual result with less markup\n\n### Implementation Steps\n1. Change outer div class from `space-y-3 sm:space-y-0` to `gap-3`\n2. Delete the `<div v-else></div>` line\n\n### Testing Checklist\n- [ ] Layout unchanged on mobile\n- [ ] Layout unchanged on desktop\n- [ ] Back button and next button properly spaced\n- [ ] No layout shifts on conditional render\n\n---\n\n## Refactoring #5: ReviewCartSection Type Safety\n\n### Current State\n```typescript\nconst getLocalizedText = (text: any): string => {\n  if (!text) return ''\n  if (typeof text === 'string') return text\n  const localeText = text[locale.value]\n  if (localeText) return localeText\n  const esText = text.es\n  if (esText) return esText\n  const values = Object.values(text).filter((v): v is string => typeof v === 'string')\n  return values[0] || ''\n}\n```\n\n### Refactored Version\n```typescript\ntype LocalizedText = string | Record<string, string>\n\nconst getLocalizedText = (text: LocalizedText | null): string => {\n  if (!text) return ''\n  if (typeof text === 'string') return text\n\n  const localized = text as Record<string, string>\n  return localized[locale.value] ?? localized.es ?? Object.values(localized)[0] ?? ''\n}\n```\n\n### Benefits\n- Explicit type definition improves IDE autocomplete\n- Uses nullish coalescing (`??`) instead of conditional checks\n- More concise fallback chain\n- Better type safety (TypeScript aware of expected structure)\n\n### Implementation Steps\n1. Add type definition before function\n2. Update function signature with `LocalizedText | null`\n3. Replace conditional chain with nullish coalescing\n\n### Testing Checklist\n- [ ] Product names display in current locale\n- [ ] Falls back to Spanish when locale unavailable\n- [ ] Falls back to any locale if Spanish missing\n- [ ] Empty string returned for null/undefined\n- [ ] TypeScript no longer complains about `any` type\n\n---\n\n## Implementation Order (Recommended)\n\n### Phase 1 (High Impact, Low Risk)\n1. **Validation Consolidation** (AddressForm) - Most impactful\n2. **Address Display Consolidation** (ReviewShippingSection) - Clear improvement\n\n### Phase 2 (Medium Impact, Low Risk)\n3. **Field Error Clearing** (AddressForm) - Simple change\n4. **Navigation Layout** (CheckoutNavigation) - CSS cleanup\n\n### Phase 3 (Nice-to-Have, Medium Risk)\n5. **Type Safety Improvement** (ReviewCartSection) - Requires testing with different locales\n\n---\n\n## Testing Strategy\n\n### Unit-Level Testing\n- Validation logic still catches required fields\n- Error clearing removes errors properly\n- Address display filters optional fields\n- Localization fallbacks work correctly\n\n### Integration Testing\n- Full checkout flow works unchanged\n- Navigation between steps functional\n- Form submission still works\n- No console errors or warnings\n\n### Browser Testing\n- Desktop layout unchanged\n- Mobile layout unchanged\n- Dark mode contrast maintained\n- Accessibility features (aria-labels, role=\"alert\") still present\n\n---\n\n## Rollback Plan\n\nIf issues occur:\n1. Each refactoring is independent (can rollback individually)\n2. `git checkout` specific component if needed\n3. All changes preserve functionality, only structure changes\n4. No data model changes, safe to test\n\n---\n\n## Summary\n\n**Total Code Reduction:** ~40 lines\n**Complexity Reduction:** High\n**Functionality Preserved:** 100%\n**Testing Required:** Medium\n**Risk Level:** Low\n\nThese refactorings follow the principle of **\"same functionality, clearer code\"** without changing any user-facing behavior or component APIs.\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8581785657595868,
          "recommendation": "Consider consolidating into CHECKOUT_SIMPLIFICATION_REFACTOR_GUIDE.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/completed-specs/customer-order-history/design.md",
              "name": "design.md",
              "size": 14526,
              "lastModified": "2026-01-06T15:49:37.097Z",
              "content": "# Design Document\n\n## Overview\n\nThe Customer Order History feature provides a comprehensive interface for authenticated users to view, track, and manage their purchase history. The design leverages the existing Nuxt 3 architecture with Supabase backend, following established patterns for authentication, API design, and component structure.\n\nThe feature integrates seamlessly with the existing account dashboard and maintains consistency with the current UI/UX patterns while providing enhanced functionality for order management and tracking.\n\n## Architecture\n\n### High-Level Architecture\n\n```mermaid\ngraph TB\n    A[User Interface] --> B[Composables Layer]\n    B --> C[API Layer]\n    C --> D[Supabase Database]\n    \n    A --> E[Pinia Store]\n    E --> B\n    \n    F[Real-time Updates] --> E\n    F --> D\n    \n    subgraph \"UI Components\"\n        A1[Order List Page]\n        A2[Order Detail Page]\n        A3[Order Status Components]\n        A4[Search & Filter Components]\n    end\n    \n    subgraph \"Business Logic\"\n        B1[useOrders Composable]\n        B2[useOrderTracking Composable]\n        B3[useOrderActions Composable]\n    end\n    \n    subgraph \"Data Layer\"\n        C1[Orders API Endpoints]\n        C2[Tracking API Endpoints]\n        C3[Actions API Endpoints]\n    end\n```\n\n### Component Architecture\n\nThe feature follows the existing component structure with clear separation of concerns:\n\n- **Pages**: Route-level components for order list and detail views\n- **Components**: Reusable UI components for order display and interactions\n- **Composables**: Business logic and state management\n- **Stores**: Global state management with Pinia\n- **API**: Server-side endpoints for data operations\n\n## Components and Interfaces\n\n### Core Components\n\n#### 1. Order List Page (`pages/account/orders/index.vue`)\n- **Purpose**: Display paginated list of user orders with filtering and search\n- **Key Features**:\n  - Responsive grid/list layout\n  - Pagination controls\n  - Status filtering\n  - Search functionality\n  - Empty state handling\n  - Loading states\n\n#### 2. Order Detail Page (`pages/account/orders/[id].vue`)\n- **Purpose**: Show comprehensive order information and tracking\n- **Key Features**:\n  - Complete order information display\n  - Order timeline/status tracking\n  - Item details with images\n  - Address information\n  - Action buttons (reorder, return, support)\n  - Mobile-optimized layout\n\n#### 3. Order Card Component (`components/order/OrderCard.vue`)\n- **Purpose**: Reusable order summary display\n- **Props**: `order`, `compact`, `showActions`\n- **Features**:\n  - Order summary information\n  - Status badge\n  - Quick actions\n  - Responsive design\n\n#### 4. Order Status Component (`components/order/OrderStatus.vue`)\n- **Purpose**: Visual status indicator and timeline\n- **Props**: `status`, `timeline`, `showTimeline`\n- **Features**:\n  - Status badge with color coding\n  - Progress timeline\n  - Estimated delivery dates\n\n#### 5. Order Actions Component (`components/order/OrderActions.vue`)\n- **Purpose**: Action buttons for order management\n- **Props**: `order`, `availableActions`\n- **Features**:\n  - Conditional action display\n  - Reorder functionality\n  - Return initiation\n  - Support contact\n\n#### 6. Order Search Component (`components/order/OrderSearch.vue`)\n- **Purpose**: Search and filter interface\n- **Features**:\n  - Text search input\n  - Status filter dropdown\n  - Date range picker\n  - Clear filters button\n\n### Interface Definitions\n\n```typescript\n// Core Order Types\ninterface Order {\n  id: number\n  orderNumber: string\n  userId: string\n  status: OrderStatus\n  paymentMethod: PaymentMethod\n  paymentStatus: PaymentStatus\n  paymentIntentId?: string\n  subtotalEur: number\n  shippingCostEur: number\n  taxEur: number\n  totalEur: number\n  shippingAddress: Address\n  billingAddress: Address\n  customerNotes?: string\n  adminNotes?: string\n  shippedAt?: string\n  deliveredAt?: string\n  createdAt: string\n  updatedAt: string\n  items: OrderItem[]\n  tracking?: TrackingInfo\n}\n\ninterface OrderItem {\n  id: number\n  orderId: number\n  productId: number\n  productSnapshot: ProductSnapshot\n  quantity: number\n  priceEur: number\n  totalEur: number\n}\n\ninterface ProductSnapshot {\n  id: number\n  sku: string\n  nameTranslations: Record<string, string>\n  descriptionTranslations: Record<string, string>\n  images: string[]\n  attributes: Record<string, any>\n}\n\ninterface TrackingInfo {\n  trackingNumber?: string\n  carrier?: string\n  status: TrackingStatus\n  estimatedDelivery?: string\n  lastUpdate: string\n  events: TrackingEvent[]\n}\n\ninterface TrackingEvent {\n  timestamp: string\n  status: string\n  location?: string\n  description: string\n}\n\n// Enums\nenum OrderStatus {\n  PENDING = 'pending',\n  PROCESSING = 'processing',\n  SHIPPED = 'shipped',\n  DELIVERED = 'delivered',\n  CANCELLED = 'cancelled'\n}\n\nenum PaymentStatus {\n  PENDING = 'pending',\n  PAID = 'paid',\n  FAILED = 'failed',\n  REFUNDED = 'refunded'\n}\n\nenum TrackingStatus {\n  LABEL_CREATED = 'label_created',\n  IN_TRANSIT = 'in_transit',\n  OUT_FOR_DELIVERY = 'out_for_delivery',\n  DELIVERED = 'delivered',\n  EXCEPTION = 'exception'\n}\n\n// API Response Types\ninterface OrdersResponse {\n  success: boolean\n  data: {\n    orders: Order[]\n    pagination: {\n      page: number\n      limit: number\n      total: number\n      totalPages: number\n    }\n  }\n}\n\ninterface OrderDetailResponse {\n  success: boolean\n  data: Order\n}\n\n// Filter and Search Types\ninterface OrderFilters {\n  status?: OrderStatus\n  dateFrom?: string\n  dateTo?: string\n  search?: string\n  page: number\n  limit: number\n}\n\ninterface OrderSearchParams {\n  query?: string\n  status?: OrderStatus\n  dateRange?: {\n    start: string\n    end: string\n  }\n}\n```\n\n## Data Models\n\n### Database Schema Extensions\n\nThe existing database schema already includes the necessary tables. We'll extend with additional fields for tracking:\n\n```sql\n-- Add tracking fields to orders table\nALTER TABLE orders ADD COLUMN IF NOT EXISTS tracking_number TEXT;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS carrier TEXT;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS estimated_delivery TIMESTAMP WITH TIME ZONE;\n\n-- Create order tracking events table\nCREATE TABLE IF NOT EXISTS order_tracking_events (\n  id SERIAL PRIMARY KEY,\n  order_id INTEGER REFERENCES orders(id) ON DELETE CASCADE,\n  status TEXT NOT NULL,\n  location TEXT,\n  description TEXT NOT NULL,\n  timestamp TIMESTAMP WITH TIME ZONE NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Add RLS policy for tracking events\nALTER TABLE order_tracking_events ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can view own order tracking\" ON order_tracking_events\n  FOR SELECT USING (\n    EXISTS (\n      SELECT 1 FROM orders \n      WHERE orders.id = order_tracking_events.order_id \n      AND orders.user_id = auth.uid()\n    )\n  );\n\n-- Create indexes for performance\nCREATE INDEX order_tracking_events_order_id_idx ON order_tracking_events(order_id);\nCREATE INDEX order_tracking_events_timestamp_idx ON order_tracking_events(timestamp);\n```\n\n### Composables Design\n\n#### useOrders Composable\n```typescript\ninterface UseOrdersReturn {\n  // State\n  orders: Ref<Order[]>\n  loading: Ref<boolean>\n  error: Ref<string | null>\n  pagination: Ref<PaginationInfo>\n  filters: Ref<OrderFilters>\n  \n  // Actions\n  fetchOrders: (params?: OrderFilters) => Promise<void>\n  refreshOrders: () => Promise<void>\n  searchOrders: (query: string) => Promise<void>\n  filterByStatus: (status: OrderStatus) => Promise<void>\n  clearFilters: () => void\n  \n  // Computed\n  hasOrders: ComputedRef<boolean>\n  filteredOrdersCount: ComputedRef<number>\n}\n```\n\n#### useOrderDetail Composable\n```typescript\ninterface UseOrderDetailReturn {\n  // State\n  order: Ref<Order | null>\n  loading: Ref<boolean>\n  error: Ref<string | null>\n  tracking: Ref<TrackingInfo | null>\n  \n  // Actions\n  fetchOrder: (id: number) => Promise<void>\n  refreshTracking: () => Promise<void>\n  reorder: () => Promise<void>\n  initiateReturn: () => Promise<void>\n  contactSupport: () => void\n  \n  // Computed\n  canReorder: ComputedRef<boolean>\n  canReturn: ComputedRef<boolean>\n  isDelivered: ComputedRef<boolean>\n}\n```\n\n## Error Handling\n\n### Error Types and Handling Strategy\n\n1. **Network Errors**: Connection issues, timeouts\n   - Display retry button with exponential backoff\n   - Show offline indicator when appropriate\n   - Cache last successful data\n\n2. **Authentication Errors**: Invalid or expired tokens\n   - Redirect to login page\n   - Preserve intended destination\n   - Clear sensitive data\n\n3. **Authorization Errors**: Access to orders not owned by user\n   - Show 404 page instead of 403 to prevent information leakage\n   - Log security events\n\n4. **Validation Errors**: Invalid filter parameters, malformed requests\n   - Show inline error messages\n   - Reset to valid state\n   - Provide helpful suggestions\n\n5. **Server Errors**: Database issues, service unavailable\n   - Show generic error message\n   - Provide contact information\n   - Log detailed error information\n\n### Error Recovery Patterns\n\n```typescript\n// Composable error handling pattern\nconst handleApiError = (error: any, context: string) => {\n  if (error.statusCode === 401) {\n    // Redirect to login\n    navigateTo('/auth/login')\n  } else if (error.statusCode === 404) {\n    // Show not found state\n    showNotFound.value = true\n  } else if (error.statusCode >= 500) {\n    // Show retry option\n    showRetryOption.value = true\n  } else {\n    // Show generic error\n    errorMessage.value = error.message || 'An error occurred'\n  }\n  \n  // Log error for monitoring\n  console.error(`${context} error:`, error)\n}\n```\n\n## Testing Strategy\n\n### Unit Testing\n- **Composables**: Test business logic, state management, and API interactions\n- **Components**: Test rendering, user interactions, and prop handling\n- **Utilities**: Test helper functions and data transformations\n\n### Integration Testing\n- **API Endpoints**: Test request/response handling and database operations\n- **Component Integration**: Test component communication and data flow\n- **Authentication Flow**: Test protected routes and user permissions\n\n### End-to-End Testing\n- **Order List Flow**: Navigate to orders, apply filters, view results\n- **Order Detail Flow**: View order details, track status, perform actions\n- **Mobile Experience**: Test responsive design and touch interactions\n- **Error Scenarios**: Test error handling and recovery\n\n### Performance Testing\n- **Load Testing**: Test with large order histories\n- **Pagination Performance**: Test with various page sizes\n- **Search Performance**: Test search with different query types\n- **Mobile Performance**: Test on slower devices and connections\n\n### Test Data Strategy\n```typescript\n// Mock order data for testing\nconst mockOrders: Order[] = [\n  {\n    id: 1,\n    orderNumber: 'MD-2024-001',\n    status: OrderStatus.DELIVERED,\n    totalEur: 89.99,\n    createdAt: '2024-01-15T10:00:00Z',\n    items: [\n      {\n        id: 1,\n        productSnapshot: {\n          nameTranslations: { es: 'Producto Test', en: 'Test Product' },\n          images: ['/test-image.jpg']\n        },\n        quantity: 2,\n        priceEur: 44.99\n      }\n    ]\n  }\n  // Additional test orders...\n]\n```\n\n## Performance Considerations\n\n### Optimization Strategies\n\n1. **Pagination**: Implement server-side pagination to handle large order histories\n2. **Lazy Loading**: Load order details on demand\n3. **Caching**: Cache order lists and implement smart refresh strategies\n4. **Image Optimization**: Use responsive images and lazy loading for product images\n5. **Search Optimization**: Implement debounced search with minimum query length\n\n### Caching Strategy\n```typescript\n// Order caching implementation\nconst orderCache = new Map<string, { data: Order[], timestamp: number }>()\nconst CACHE_DURATION = 5 * 60 * 1000 // 5 minutes\n\nconst getCachedOrders = (key: string) => {\n  const cached = orderCache.get(key)\n  if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\n    return cached.data\n  }\n  return null\n}\n```\n\n### Mobile Optimization\n- **Virtual Scrolling**: For large order lists on mobile\n- **Touch Gestures**: Swipe navigation between order details\n- **Offline Support**: Cache critical order information\n- **Progressive Loading**: Load essential information first\n\n## Security Considerations\n\n### Data Protection\n1. **Row Level Security**: Ensure users can only access their own orders\n2. **Input Validation**: Validate all search and filter parameters\n3. **Rate Limiting**: Prevent abuse of search and API endpoints\n4. **Sensitive Data**: Mask payment information in order history\n\n### Privacy Compliance\n1. **Data Minimization**: Only display necessary order information\n2. **Retention Policies**: Implement order data retention rules\n3. **User Rights**: Support data export and deletion requests\n4. **Audit Logging**: Log access to sensitive order information\n\n### API Security\n```typescript\n// Security middleware for order endpoints\nconst validateOrderAccess = async (event: H3Event, orderId: number) => {\n  const user = await getCurrentUser(event)\n  if (!user) {\n    throw createError({ statusCode: 401, statusMessage: 'Unauthorized' })\n  }\n  \n  const hasAccess = await checkOrderOwnership(user.id, orderId)\n  if (!hasAccess) {\n    throw createError({ statusCode: 404, statusMessage: 'Order not found' })\n  }\n  \n  return user\n}\n```\n\n## Integration Points\n\n### Existing System Integration\n1. **Authentication**: Leverage existing auth store and middleware\n2. **Navigation**: Integrate with account dashboard navigation\n3. **Internationalization**: Use existing i18n setup for translations\n4. **Theming**: Follow existing dark/light theme patterns\n5. **Toast Notifications**: Use existing toast system for feedback\n\n### External Service Integration\n1. **Shipping Carriers**: Integrate with carrier APIs for tracking\n2. **Payment Providers**: Link to payment history and receipts\n3. **Customer Support**: Integration with support ticket system\n4. **Analytics**: Track user interactions and order patterns\n\n### Real-time Updates\n```typescript\n// Supabase real-time subscription for order updates\nconst subscribeToOrderUpdates = (userId: string) => {\n  return supabase\n    .channel('order-updates')\n    .on(\n      'postgres_changes',\n      {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'orders',\n        filter: `user_id=eq.${userId}`\n      },\n      (payload) => {\n        updateOrderInStore(payload.new as Order)\n        showOrderUpdateNotification(payload.new as Order)\n      }\n    )\n    .subscribe()\n}\n```",
              "category": "archive"
            },
            {
              "path": "docs/specs/admin-order-management/design.md",
              "name": "design.md",
              "size": 16722,
              "lastModified": "2025-12-04T10:27:33.895Z",
              "content": "# Design Document\n\n## Overview\n\nThe Admin Order Management system provides administrators with comprehensive tools to manage the complete order lifecycle from placement to delivery. The system integrates seamlessly with the existing Nuxt.js/Supabase architecture, following established patterns from the admin dashboard and product management systems.\n\nThe design emphasizes efficient order processing workflows, real-time status tracking, and comprehensive order analytics. The system supports both individual order management and bulk operations, with robust error handling and audit trails for all administrative actions.\n\n## Architecture\n\n### System Components\n\n```mermaid\ngraph TB\n    A[Admin Dashboard] --> B[Order Management Interface]\n    B --> C[Order List View]\n    B --> D[Order Detail View]\n    B --> E[Bulk Operations]\n    B --> F[Order Analytics]\n    \n    C --> G[Filtering & Search]\n    C --> H[Status Management]\n    D --> I[Fulfillment Workflow]\n    D --> J[Customer Communication]\n    E --> K[Batch Processing]\n    F --> L[Reporting Engine]\n    \n    G --> M[Supabase - Orders]\n    H --> N[Status Tracking]\n    I --> O[Shipping Integration]\n    J --> P[Email Service]\n    K --> Q[Background Jobs]\n    L --> R[Analytics Database]\n    \n    N --> S[Real-time Updates]\n    O --> T[Shipping Providers]\n    P --> U[Email Templates]\n```\n\n### Data Flow Architecture\n\nThe order management system follows a structured data flow:\n\n1. **Order Retrieval**  Database queries with filtering and pagination\n2. **Status Updates**  Validation, database updates, and customer notifications\n3. **Fulfillment Actions**  Inventory updates, shipping label generation, tracking updates\n4. **Bulk Operations**  Queue-based processing with progress tracking\n5. **Analytics**  Real-time aggregation and reporting\n\n### Integration Points\n\n- **Existing Admin System**: Leverages admin authentication, layout, and navigation patterns\n- **Order Database**: Extends existing Order and OrderItem models\n- **Inventory System**: Integrates with product inventory for fulfillment tracking\n- **Email System**: Uses existing email infrastructure for customer notifications\n- **Analytics**: Connects to admin dashboard analytics for order metrics\n\n## Components and Interfaces\n\n### Core Page Components\n\n#### AdminOrdersIndex.vue\nMain order management page with list view and filtering capabilities.\n\n```typescript\ninterface AdminOrdersIndexProps {\n  initialFilters?: OrderFilters\n  initialPage?: number\n}\n\ninterface OrderListState {\n  orders: OrderWithDetails[]\n  filters: OrderFilters\n  pagination: PaginationState\n  selectedOrders: number[]\n  bulkOperationInProgress: boolean\n  loading: boolean\n}\n```\n\n#### AdminOrderDetail.vue\nDetailed order view with fulfillment workflow and management actions.\n\n```typescript\ninterface AdminOrderDetailProps {\n  orderId: number\n}\n\ninterface OrderDetailState {\n  order: OrderWithFullDetails | null\n  fulfillmentTasks: FulfillmentTask[]\n  statusHistory: OrderStatusChange[]\n  customerMessages: CustomerMessage[]\n  loading: boolean\n  updating: boolean\n}\n```\n\n### Specialized Components\n\n#### OrderStatusBadge.vue\nReusable status display component with color coding and transitions.\n\n```typescript\ninterface OrderStatusBadgeProps {\n  status: OrderStatus\n  size?: 'sm' | 'md' | 'lg'\n  showTransition?: boolean\n  clickable?: boolean\n}\n```\n\n#### OrderFulfillmentChecklist.vue\nInteractive fulfillment workflow component.\n\n```typescript\ninterface OrderFulfillmentChecklistProps {\n  orderId: number\n  currentStatus: OrderStatus\n  fulfillmentTasks: FulfillmentTask[]\n}\n\ninterface FulfillmentTask {\n  id: string\n  name: string\n  description: string\n  required: boolean\n  completed: boolean\n  completedAt?: Date\n  completedBy?: string\n  dependencies: string[]\n}\n```\n\n#### BulkOrderActions.vue\nBulk operation interface for multiple order management.\n\n```typescript\ninterface BulkOrderActionsProps {\n  selectedOrderIds: number[]\n  availableActions: BulkAction[]\n}\n\ninterface BulkAction {\n  id: string\n  name: string\n  description: string\n  icon: string\n  requiresConfirmation: boolean\n  validStatuses: OrderStatus[]\n}\n```\n\n### Store Integration\n\n#### AdminOrdersStore (Pinia)\nManages order data, filtering, and administrative actions.\n\n```typescript\ninterface AdminOrdersStoreState {\n  orders: OrderWithDetails[]\n  currentOrder: OrderWithFullDetails | null\n  filters: OrderFilters\n  pagination: PaginationState\n  selectedOrders: number[]\n  bulkOperationInProgress: boolean\n  loading: boolean\n  error: string | null\n  lastRefresh: Date | null\n}\n\ninterface AdminOrdersStoreActions {\n  fetchOrders(): Promise<void>\n  fetchOrderById(id: number): Promise<OrderWithFullDetails>\n  updateOrderStatus(orderId: number, status: OrderStatus, notes?: string): Promise<void>\n  updateShippingInfo(orderId: number, trackingNumber: string, carrier: string): Promise<void>\n  processRefund(orderId: number, amount: number, reason: string): Promise<void>\n  bulkUpdateStatus(orderIds: number[], status: OrderStatus): Promise<void>\n  generateShippingLabels(orderIds: number[]): Promise<void>\n  sendCustomerMessage(orderId: number, message: string, template?: string): Promise<void>\n}\n```\n\n## Data Models\n\n### Enhanced Order Types\n\n#### OrderWithDetails\nExtended order interface for list views with additional admin data.\n\n```typescript\ninterface OrderWithDetails extends Order {\n  customer: {\n    id?: string\n    name: string\n    email: string\n    phone?: string\n    totalOrders: number\n    lifetimeValue: number\n  }\n  itemCount: number\n  fulfillmentProgress: number\n  urgencyLevel: 'low' | 'medium' | 'high'\n  estimatedShipDate: Date\n  daysSinceOrder: number\n  profitMargin: number\n}\n```\n\n#### OrderWithFullDetails\nComplete order interface for detail views.\n\n```typescript\ninterface OrderWithFullDetails extends OrderWithDetails {\n  items: OrderItemWithProduct[]\n  statusHistory: OrderStatusChange[]\n  fulfillmentTasks: FulfillmentTask[]\n  customerMessages: CustomerMessage[]\n  shippingDetails?: ShippingDetails\n  paymentDetails: PaymentDetails\n  refunds: RefundRecord[]\n}\n```\n\n#### OrderStatusChange\nAudit trail for status changes.\n\n```typescript\ninterface OrderStatusChange {\n  id: number\n  orderId: number\n  fromStatus: OrderStatus\n  toStatus: OrderStatus\n  changedBy: string\n  changedAt: Date\n  notes?: string\n  automated: boolean\n}\n```\n\n#### CustomerMessage\nCustomer communication tracking.\n\n```typescript\ninterface CustomerMessage {\n  id: number\n  orderId: number\n  direction: 'inbound' | 'outbound'\n  message: string\n  sentBy?: string\n  sentAt: Date\n  template?: string\n  readAt?: Date\n}\n```\n\n### Database Schema Extensions\n\n#### Order Management Tables\n\n```sql\n-- Enhanced orders table with admin fields\nALTER TABLE orders ADD COLUMN IF NOT EXISTS admin_notes TEXT;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS priority_level INTEGER DEFAULT 1;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS estimated_ship_date DATE;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS tracking_number TEXT;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS shipping_carrier TEXT;\nALTER TABLE orders ADD COLUMN IF NOT EXISTS fulfillment_progress INTEGER DEFAULT 0;\n\n-- Order status history table\nCREATE TABLE order_status_history (\n  id SERIAL PRIMARY KEY,\n  order_id INTEGER REFERENCES orders(id) ON DELETE CASCADE,\n  from_status TEXT,\n  to_status TEXT NOT NULL,\n  changed_by UUID REFERENCES auth.users(id),\n  changed_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  notes TEXT,\n  automated BOOLEAN DEFAULT FALSE\n);\n\n-- Customer messages table\nCREATE TABLE order_customer_messages (\n  id SERIAL PRIMARY KEY,\n  order_id INTEGER REFERENCES orders(id) ON DELETE CASCADE,\n  direction TEXT NOT NULL CHECK (direction IN ('inbound', 'outbound')),\n  message TEXT NOT NULL,\n  sent_by UUID REFERENCES auth.users(id),\n  sent_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  template TEXT,\n  read_at TIMESTAMP WITH TIME ZONE\n);\n\n-- Fulfillment tasks table\nCREATE TABLE order_fulfillment_tasks (\n  id SERIAL PRIMARY KEY,\n  order_id INTEGER REFERENCES orders(id) ON DELETE CASCADE,\n  task_type TEXT NOT NULL,\n  task_name TEXT NOT NULL,\n  description TEXT,\n  required BOOLEAN DEFAULT TRUE,\n  completed BOOLEAN DEFAULT FALSE,\n  completed_at TIMESTAMP WITH TIME ZONE,\n  completed_by UUID REFERENCES auth.users(id),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Indexes for performance\nCREATE INDEX idx_orders_status ON orders(status);\nCREATE INDEX idx_orders_created_at ON orders(created_at);\nCREATE INDEX idx_orders_admin_priority ON orders(priority_level, created_at);\nCREATE INDEX idx_order_status_history_order_id ON order_status_history(order_id);\nCREATE INDEX idx_order_messages_order_id ON order_customer_messages(order_id);\n```\n\n### API Interfaces\n\n#### Order Filtering and Search\n\n```typescript\ninterface OrderFilters {\n  search?: string // Order number, customer name, email\n  status?: OrderStatus[]\n  paymentStatus?: PaymentStatus[]\n  dateRange?: {\n    start: Date\n    end: Date\n  }\n  amountRange?: {\n    min: number\n    max: number\n  }\n  priority?: number[]\n  shippingMethod?: string[]\n  sortBy?: 'created_at' | 'total_eur' | 'status' | 'customer_name'\n  sortOrder?: 'asc' | 'desc'\n}\n\ninterface OrderListResponse {\n  orders: OrderWithDetails[]\n  pagination: PaginationState\n  aggregates: {\n    totalRevenue: number\n    averageOrderValue: number\n    statusCounts: Record<OrderStatus, number>\n  }\n}\n```\n\n## Error Handling\n\n### Error Categories\n\n1. **Validation Errors**: Invalid status transitions, missing required fields\n2. **Business Logic Errors**: Inventory conflicts, payment processing issues\n3. **Integration Errors**: Shipping provider API failures, email delivery issues\n4. **Concurrency Errors**: Multiple admin conflicts, stale data updates\n5. **System Errors**: Database failures, network timeouts\n\n### Error Handling Strategy\n\n#### Client-Side Error Handling\n\n```typescript\ninterface AdminOrderError {\n  type: 'validation' | 'business' | 'integration' | 'concurrency' | 'system'\n  code: string\n  message: string\n  field?: string\n  orderId?: number\n  retryable: boolean\n  suggestedAction?: string\n}\n\nclass AdminOrderErrorHandler {\n  handleError(error: AdminOrderError): void {\n    switch (error.type) {\n      case 'validation':\n        this.showValidationError(error)\n        break\n      case 'business':\n        this.showBusinessLogicError(error)\n        break\n      case 'integration':\n        this.showIntegrationError(error)\n        break\n      case 'concurrency':\n        this.handleConcurrencyError(error)\n        break\n      case 'system':\n        this.showSystemError(error)\n        break\n    }\n  }\n}\n```\n\n#### Server-Side Error Responses\n\n```typescript\ninterface AdminOrderApiResponse<T> {\n  success: boolean\n  data?: T\n  error?: {\n    type: string\n    code: string\n    message: string\n    details?: Record<string, any>\n    timestamp: string\n  }\n  warnings?: string[]\n}\n```\n\n### Recovery Mechanisms\n\n- **Optimistic Updates**: Immediate UI feedback with rollback on failure\n- **Conflict Resolution**: Merge strategies for concurrent admin actions\n- **Retry Logic**: Automatic retry for transient failures\n- **Fallback Options**: Alternative workflows when integrations fail\n\n## Testing Strategy\n\n### Unit Testing\n\n#### Component Testing\n- Order list filtering and sorting logic\n- Status update validation\n- Bulk operation state management\n- Error handling scenarios\n\n#### Store Testing\n- Order data management\n- API integration mocking\n- State synchronization\n- Pagination logic\n\n### Integration Testing\n\n#### Order Management Flow Testing\n```typescript\ndescribe('Admin Order Management Integration', () => {\n  test('Complete order fulfillment workflow', async () => {\n    // Test full workflow from pending to delivered\n  })\n  \n  test('Bulk status updates with validation', async () => {\n    // Test bulk operations with error handling\n  })\n  \n  test('Customer communication integration', async () => {\n    // Test message sending and tracking\n  })\n  \n  test('Shipping integration workflow', async () => {\n    // Test label generation and tracking updates\n  })\n})\n```\n\n#### Real-time Updates Testing\n- WebSocket connection handling\n- Status change propagation\n- Multi-admin conflict resolution\n- Data consistency validation\n\n### End-to-End Testing\n\n#### Critical Admin Workflows\n1. **Order Processing**: Complete fulfillment workflow\n2. **Bulk Operations**: Multi-order status updates\n3. **Customer Communication**: Message sending and tracking\n4. **Error Recovery**: Handling of various failure scenarios\n5. **Performance**: Large order list handling\n\n#### Performance Testing\n- Order list pagination with large datasets\n- Real-time update performance\n- Bulk operation processing times\n- Database query optimization\n\n## Implementation Considerations\n\n### Performance Optimization\n\n#### Client-Side Optimization\n- Virtual scrolling for large order lists\n- Debounced search and filtering\n- Optimistic UI updates\n- Efficient state management\n\n#### Server-Side Optimization\n- Database query optimization with proper indexing\n- Pagination with cursor-based navigation\n- Background job processing for bulk operations\n- Caching strategies for frequently accessed data\n\n### Security Measures\n\n#### Admin Access Control\n- Role-based permissions for order actions\n- Audit logging for all administrative actions\n- Session management and timeout handling\n- IP-based access restrictions\n\n#### Data Protection\n- Sensitive data encryption\n- PCI compliance for payment information\n- GDPR compliance for customer data\n- Secure API endpoints with rate limiting\n\n### Accessibility\n\n#### WCAG 2.1 AA Compliance\n- Keyboard navigation for all interfaces\n- Screen reader compatibility\n- High contrast mode support\n- Focus management in complex workflows\n\n#### Admin User Experience\n- Efficient keyboard shortcuts\n- Bulk operation progress indicators\n- Clear error messaging and recovery options\n- Responsive design for various screen sizes\n\n### Internationalization\n\n#### Multi-language Support\n- Localized admin interface\n- Translated status labels and messages\n- Regional date and currency formatting\n- Localized email templates for customer communication\n\n#### Regional Compliance\n- Local shipping regulations\n- Tax calculation compliance\n- Payment method availability\n- Legal requirement adherence\n\n## Current Implementation Status\n\n### Foundation Components\n-  Admin authentication and layout system\n-  Existing Order and OrderItem data models\n-  Admin dashboard infrastructure\n-  Pinia store patterns established\n-  Email notification system\n\n### Required New Components\n-  Admin order management pages\n-  Order filtering and search functionality\n-  Status update workflow components\n-  Fulfillment task management\n-  Bulk operation interfaces\n-  Customer communication system\n-  Order analytics and reporting\n\n### Database Extensions Needed\n-  Order status history tracking\n-  Customer message storage\n-  Fulfillment task definitions\n-  Admin action audit logs\n-  Performance optimization indexes\n\n## Integration Points\n\n### Existing Systems Integration\n\n#### Admin Dashboard Integration\n- Leverage existing admin layout and navigation\n- Integrate order metrics into dashboard statistics\n- Use established admin authentication patterns\n- Follow existing admin UI/UX conventions\n\n#### Email System Integration\n- Extend existing email templates for order notifications\n- Use current email service configuration\n- Implement order-specific email triggers\n- Maintain email delivery tracking\n\n#### Inventory System Integration\n- Connect fulfillment actions to inventory updates\n- Implement stock validation during order processing\n- Track inventory movements from order fulfillment\n- Handle backorder and allocation scenarios\n\n### External Service Integration\n\n#### Shipping Provider Integration\n```typescript\ninterface ShippingProvider {\n  name: string\n  apiEndpoint: string\n  authenticate(): Promise<string>\n  createLabel(order: Order, options: ShippingOptions): Promise<ShippingLabel>\n  trackPackage(trackingNumber: string): Promise<TrackingInfo>\n  calculateRates(order: Order): Promise<ShippingRate[]>\n}\n```\n\n#### Payment Processing Integration\n- Refund processing through existing payment providers\n- Payment status synchronization\n- Chargeback and dispute handling\n- Payment method validation\n\n## Future Enhancements\n\n### Advanced Features\n- AI-powered order prioritization\n- Automated fulfillment workflows\n- Advanced analytics and forecasting\n- Mobile admin application\n- Voice-activated order processing\n\n### Scalability Considerations\n- Microservice architecture migration\n- Event-driven order processing\n- Distributed caching strategies\n- Load balancing for high-volume periods",
              "category": "reference"
            }
          ],
          "similarity": 0.8050155038675287,
          "recommendation": "Consider consolidating into design.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/completed-specs/customer-order-history/requirements.md",
              "name": "requirements.md",
              "size": 5607,
              "lastModified": "2026-01-06T15:49:37.097Z",
              "content": "# Requirements Document\n\n## Introduction\n\nThe Customer Order History feature provides authenticated users with comprehensive access to their purchase history, including order details, tracking information, and real-time status updates. This feature enables customers to view past orders, track current shipments, and access order-related information through an intuitive interface within their account dashboard.\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** As a logged-in customer, I want to view a list of all my past orders, so that I can easily access my purchase history.\n\n#### Acceptance Criteria\n\n1. WHEN a customer navigates to the order history page THEN the system SHALL display a paginated list of all orders associated with their account\n2. WHEN displaying the order list THEN the system SHALL show order number, date, total amount, and current status for each order\n3. WHEN there are no orders THEN the system SHALL display an appropriate empty state message\n4. WHEN the customer has many orders THEN the system SHALL implement pagination with a maximum of 10 orders per page\n5. IF the order list fails to load THEN the system SHALL display an error message with retry option\n\n### Requirement 2\n\n**User Story:** As a customer, I want to view detailed information about a specific order, so that I can see exactly what I purchased and the order specifics.\n\n#### Acceptance Criteria\n\n1. WHEN a customer clicks on an order from the list THEN the system SHALL navigate to a detailed order view\n2. WHEN displaying order details THEN the system SHALL show all purchased items with names, quantities, prices, and images\n3. WHEN displaying order details THEN the system SHALL show shipping address, billing address, payment method, and order totals\n4. WHEN displaying order details THEN the system SHALL show order timeline with key status changes and dates\n5. IF the order details fail to load THEN the system SHALL display an error message and option to return to order list\n\n### Requirement 3\n\n**User Story:** As a customer, I want to track my orders in real-time, so that I can know the current status and expected delivery of my purchases.\n\n#### Acceptance Criteria\n\n1. WHEN viewing an order with tracking information THEN the system SHALL display current shipping status and location\n2. WHEN tracking information is available THEN the system SHALL show estimated delivery date and tracking number\n3. WHEN an order status changes THEN the system SHALL update the display without requiring page refresh\n4. WHEN tracking information is not available THEN the system SHALL display appropriate messaging\n5. IF tracking service is unavailable THEN the system SHALL show last known status with timestamp\n\n### Requirement 4\n\n**User Story:** As a customer, I want to receive notifications about order status changes, so that I stay informed about my purchases without constantly checking.\n\n#### Acceptance Criteria\n\n1. WHEN an order status changes THEN the system SHALL display a notification to the user if they are online\n2. WHEN a customer visits the order history page THEN the system SHALL show any recent status updates since their last visit\n3. WHEN an order is delivered THEN the system SHALL prominently display the delivery confirmation\n4. WHEN there are shipping delays THEN the system SHALL notify the customer with updated timeline\n5. IF notification delivery fails THEN the system SHALL ensure status is visible on next page visit\n\n### Requirement 5\n\n**User Story:** As a customer, I want to filter and search my order history, so that I can quickly find specific orders or purchases.\n\n#### Acceptance Criteria\n\n1. WHEN a customer wants to search orders THEN the system SHALL provide a search input that filters by order number, product name, or date range\n2. WHEN applying filters THEN the system SHALL allow filtering by order status, date range, and price range\n3. WHEN search or filter results are empty THEN the system SHALL display appropriate messaging\n4. WHEN clearing filters THEN the system SHALL return to the full order list\n5. IF search functionality is unavailable THEN the system SHALL disable the search input and show status message\n\n### Requirement 6\n\n**User Story:** As a customer, I want to perform actions on my orders, so that I can manage returns, reorders, or get support.\n\n#### Acceptance Criteria\n\n1. WHEN viewing an eligible order THEN the system SHALL display available actions such as \"Reorder\", \"Return Items\", or \"Contact Support\"\n2. WHEN a customer clicks \"Reorder\" THEN the system SHALL add all items from that order to their current cart\n3. WHEN a customer initiates a return THEN the system SHALL guide them through the return process\n4. WHEN contacting support about an order THEN the system SHALL pre-populate relevant order information\n5. IF an action is not available for an order THEN the system SHALL not display that action button\n\n### Requirement 7\n\n**User Story:** As a customer, I want the order history to work seamlessly on mobile devices, so that I can check my orders while on the go.\n\n#### Acceptance Criteria\n\n1. WHEN accessing order history on mobile THEN the system SHALL display a responsive layout optimized for small screens\n2. WHEN viewing order details on mobile THEN the system SHALL stack information vertically for easy scrolling\n3. WHEN using touch gestures THEN the system SHALL support swipe navigation between order details\n4. WHEN the mobile connection is slow THEN the system SHALL show loading states and optimize data usage\n5. IF the mobile layout breaks THEN the system SHALL fallback to a functional basic layout",
              "category": "archive"
            },
            {
              "path": "docs/archive/completed-specs/order-status-updates/requirements.md",
              "name": "requirements.md",
              "size": 7543,
              "lastModified": "2026-01-06T15:49:37.098Z",
              "content": "# Requirements Document\n\n## Introduction\n\nThe Order Status Updates feature provides customers with real-time visibility into their order progress from placement to delivery. This system automatically tracks order status changes and proactively communicates updates to customers through multiple channels, ensuring transparency and reducing customer service inquiries. The feature integrates with existing order management, shipping, and notification systems to provide a seamless experience.\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** As a customer, I want to receive automatic notifications when my order status changes, so that I stay informed about my order progress without having to check manually.\n\n#### Acceptance Criteria\n\n1. WHEN an order status changes THEN the system SHALL send a notification to the customer within 5 minutes\n2. WHEN a notification is sent THEN the system SHALL include order number, new status, estimated delivery date, and tracking information if available\n3. WHEN multiple notification channels are enabled THEN the system SHALL send updates via all configured channels (email, SMS, push notifications)\n4. IF a notification fails to send THEN the system SHALL retry up to 3 times with exponential backoff\n5. WHEN a customer has notification preferences set THEN the system SHALL respect those preferences for delivery method and frequency\n\n### Requirement 2\n\n**User Story:** As a customer, I want to view a detailed timeline of my order status history, so that I can track the complete journey of my order.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views their order details THEN the system SHALL display a chronological timeline of all status changes\n2. WHEN displaying status history THEN the system SHALL include timestamp, status description, location (if applicable), and any relevant notes\n3. WHEN an order has tracking information THEN the system SHALL integrate carrier tracking data into the timeline\n4. IF an order encounters delays or issues THEN the system SHALL display explanatory messages and updated delivery estimates\n5. WHEN viewing on mobile devices THEN the timeline SHALL be optimized for touch interaction and small screens\n\n### Requirement 3\n\n**User Story:** As a customer, I want to customize my notification preferences for order updates, so that I receive information in my preferred format and frequency.\n\n#### Acceptance Criteria\n\n1. WHEN a customer accesses notification settings THEN the system SHALL allow selection of delivery methods (email, SMS, push notifications)\n2. WHEN configuring preferences THEN the system SHALL allow customers to choose which status changes trigger notifications\n3. WHEN a customer opts out of certain notifications THEN the system SHALL still maintain the order history but skip those notification types\n4. IF a customer changes preferences THEN the system SHALL apply changes to all future orders immediately\n5. WHEN a customer has no preferences set THEN the system SHALL use default notification settings (email notifications for major status changes)\n\n### Requirement 4\n\n**User Story:** As a customer, I want to receive proactive updates about delivery delays or issues, so that I can plan accordingly and stay informed about problems.\n\n#### Acceptance Criteria\n\n1. WHEN a delivery delay is detected THEN the system SHALL notify the customer within 1 hour of detection\n2. WHEN notifying about delays THEN the system SHALL include the reason (if available), new estimated delivery date, and any available remediation options\n3. WHEN an order encounters an exception (damaged, lost, returned to sender) THEN the system SHALL immediately notify the customer and provide next steps\n4. IF weather or carrier issues affect delivery THEN the system SHALL proactively communicate potential delays before they occur\n5. WHEN providing delay notifications THEN the system SHALL offer options for customer action (reschedule delivery, change address, contact support)\n\n### Requirement 5\n\n**User Story:** As a customer, I want to track multiple orders from a single dashboard, so that I can easily monitor all my current orders in one place.\n\n#### Acceptance Criteria\n\n1. WHEN a customer has multiple active orders THEN the system SHALL display all orders in a unified dashboard view\n2. WHEN displaying multiple orders THEN the system SHALL show order number, current status, estimated delivery date, and quick action buttons\n3. WHEN an order status changes THEN the system SHALL update the dashboard in real-time without requiring a page refresh\n4. IF a customer has orders from different time periods THEN the system SHALL provide filtering options (date range, status, product type)\n5. WHEN viewing the dashboard on mobile THEN the system SHALL provide swipe gestures for quick actions and compact card layouts\n\n### Requirement 6\n\n**User Story:** As an administrator, I want to manage order status workflows and notification templates, so that I can customize the customer experience and handle different order types.\n\n#### Acceptance Criteria\n\n1. WHEN an administrator accesses the order status management interface THEN the system SHALL allow configuration of status workflows for different order types\n2. WHEN creating notification templates THEN the system SHALL support dynamic content insertion (customer name, order details, tracking info)\n3. WHEN modifying status workflows THEN the system SHALL validate that all required statuses are included and transitions are logical\n4. IF template changes are made THEN the system SHALL allow preview functionality before applying to live orders\n5. WHEN managing notification settings THEN the system SHALL provide analytics on delivery rates and customer engagement\n\n### Requirement 7\n\n**User Story:** As a customer service representative, I want to manually update order statuses and send custom notifications, so that I can handle exceptional cases and provide personalized customer service.\n\n#### Acceptance Criteria\n\n1. WHEN a CSR needs to update an order status THEN the system SHALL provide a manual override interface with reason code requirements\n2. WHEN manually updating status THEN the system SHALL log the change with timestamp, user ID, and reason for audit purposes\n3. WHEN sending custom notifications THEN the system SHALL allow CSRs to compose personalized messages while maintaining brand consistency\n4. IF a manual status change conflicts with automated updates THEN the system SHALL prioritize manual changes and flag for review\n5. WHEN CSRs access order status tools THEN the system SHALL enforce role-based permissions and require appropriate authentication\n\n### Requirement 8\n\n**User Story:** As a business stakeholder, I want to analyze order status update performance and customer engagement, so that I can optimize the notification system and improve customer satisfaction.\n\n#### Acceptance Criteria\n\n1. WHEN accessing analytics dashboard THEN the system SHALL display metrics on notification delivery rates, open rates, and customer engagement\n2. WHEN analyzing performance THEN the system SHALL provide insights on which status updates generate the most customer inquiries\n3. WHEN reviewing customer feedback THEN the system SHALL correlate notification effectiveness with customer satisfaction scores\n4. IF notification performance degrades THEN the system SHALL alert administrators and suggest optimization recommendations\n5. WHEN generating reports THEN the system SHALL allow export of data for further analysis and integration with business intelligence tools",
              "category": "archive"
            },
            {
              "path": "docs/specs/invoice-generation/requirements.md",
              "name": "requirements.md",
              "size": 7162,
              "lastModified": "2025-12-04T10:27:33.904Z",
              "content": "# Requirements Document\n\n## Introduction\n\nThe Invoice Generation feature enables automatic creation, management, and delivery of invoices for completed orders in the e-commerce platform. This system will provide customers with professional invoices for their purchases while giving administrators the tools to manage, regenerate, and track invoice delivery. The feature supports multiple formats, languages, and integrates with the existing order management and user authentication systems.\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** As a customer, I want to automatically receive an invoice when my order is completed, so that I have proper documentation for my purchase and can use it for expense tracking or returns.\n\n#### Acceptance Criteria\n\n1. WHEN an order status changes to \"completed\" THEN the system SHALL automatically generate an invoice for that order\n2. WHEN an invoice is generated THEN the system SHALL send the invoice via email to the customer's registered email address\n3. WHEN generating an invoice THEN the system SHALL include order details, customer information, itemized pricing, taxes, and payment method\n4. WHEN an invoice is created THEN the system SHALL assign a unique invoice number following the format \"INV-YYYY-NNNNNN\"\n\n### Requirement 2\n\n**User Story:** As a customer, I want to download my invoices from my account dashboard, so that I can access them anytime without relying on email.\n\n#### Acceptance Criteria\n\n1. WHEN a customer accesses their account dashboard THEN the system SHALL display a list of all their invoices\n2. WHEN a customer clicks on an invoice THEN the system SHALL allow them to download it as a PDF\n3. WHEN displaying invoices THEN the system SHALL show invoice number, order date, amount, and download status\n4. WHEN a customer has no orders THEN the system SHALL display an appropriate message indicating no invoices are available\n\n### Requirement 3\n\n**User Story:** As an administrator, I want to view and manage all invoices in the system, so that I can handle customer inquiries and resolve billing issues.\n\n#### Acceptance Criteria\n\n1. WHEN an admin accesses the invoice management section THEN the system SHALL display a searchable list of all invoices\n2. WHEN an admin searches for invoices THEN the system SHALL support filtering by customer name, invoice number, date range, and status\n3. WHEN an admin selects an invoice THEN the system SHALL allow them to view, download, or regenerate the invoice\n4. WHEN an admin regenerates an invoice THEN the system SHALL create a new version while maintaining the original invoice number\n\n### Requirement 4\n\n**User Story:** As an administrator, I want to resend invoices to customers, so that I can help customers who didn't receive their original invoice email.\n\n#### Acceptance Criteria\n\n1. WHEN an admin selects an invoice THEN the system SHALL provide an option to resend the invoice via email\n2. WHEN resending an invoice THEN the system SHALL send it to the customer's current email address\n3. WHEN an invoice is resent THEN the system SHALL log the resend action with timestamp and admin user\n4. WHEN resending fails THEN the system SHALL display an error message and log the failure reason\n\n### Requirement 5\n\n**User Story:** As a customer, I want invoices to be generated in my preferred language, so that I can understand all the details clearly.\n\n#### Acceptance Criteria\n\n1. WHEN generating an invoice THEN the system SHALL use the customer's selected language preference\n2. WHEN a customer has no language preference set THEN the system SHALL use the default language (English)\n3. WHEN generating invoices THEN the system SHALL support all languages available in the platform (English, Spanish, Romanian, Russian)\n4. WHEN switching languages THEN the system SHALL translate invoice labels and descriptions but maintain original product names\n\n### Requirement 6\n\n**User Story:** As a business owner, I want invoices to include proper tax calculations and compliance information, so that the business meets legal requirements and customers have accurate tax documentation.\n\n#### Acceptance Criteria\n\n1. WHEN generating an invoice THEN the system SHALL calculate and display applicable taxes based on customer location\n2. WHEN taxes are applied THEN the system SHALL show tax breakdown by type and rate\n3. WHEN generating invoices THEN the system SHALL include business tax identification numbers and legal information\n4. WHEN no taxes apply THEN the system SHALL clearly indicate \"Tax Exempt\" or \"No Tax Applied\"\n\n### Requirement 7\n\n**User Story:** As a customer, I want invoices to have a professional appearance with company branding, so that I receive official-looking documentation for my records.\n\n#### Acceptance Criteria\n\n1. WHEN generating an invoice THEN the system SHALL include company logo, name, and contact information\n2. WHEN creating invoice layout THEN the system SHALL use consistent formatting and professional typography\n3. WHEN displaying amounts THEN the system SHALL format currency according to the customer's locale\n4. WHEN generating PDFs THEN the system SHALL ensure proper page breaks and readable font sizes\n\n### Requirement 8\n\n**User Story:** As an administrator, I want to track invoice delivery status, so that I can identify and resolve delivery issues proactively.\n\n#### Acceptance Criteria\n\n1. WHEN an invoice email is sent THEN the system SHALL track and record the delivery status\n2. WHEN email delivery fails THEN the system SHALL log the failure reason and retry automatically\n3. WHEN viewing invoice lists THEN the system SHALL display delivery status indicators (sent, delivered, failed, pending)\n4. WHEN delivery fails multiple times THEN the system SHALL alert administrators and stop automatic retries\n\n### Requirement 9\n\n**User Story:** As a customer, I want to receive invoice notifications that don't look like spam, so that I can easily identify and trust the communication from the store.\n\n#### Acceptance Criteria\n\n1. WHEN sending invoice emails THEN the system SHALL use a recognizable sender name and email address\n2. WHEN composing invoice emails THEN the system SHALL include clear subject lines indicating invoice delivery\n3. WHEN sending emails THEN the system SHALL include both PDF attachment and HTML invoice preview\n4. WHEN customers reply to invoice emails THEN the system SHALL route responses to customer service\n\n### Requirement 10\n\n**User Story:** As an administrator, I want to generate invoices for orders that were completed before the invoice system was implemented, so that we can provide invoices for historical orders upon customer request.\n\n#### Acceptance Criteria\n\n1. WHEN an admin selects a completed order without an invoice THEN the system SHALL allow manual invoice generation\n2. WHEN generating historical invoices THEN the system SHALL use order data as it existed at completion time\n3. WHEN creating historical invoices THEN the system SHALL clearly mark them as \"Generated on [date]\" to distinguish from automatic invoices\n4. WHEN historical invoice generation fails THEN the system SHALL provide clear error messages indicating missing required data",
              "category": "reference"
            },
            {
              "path": "docs/specs/order-confirmation-emails/requirements.md",
              "name": "requirements.md",
              "size": 6187,
              "lastModified": "2025-12-04T10:27:33.905Z",
              "content": "# Requirements Document\n\n## Introduction\n\nThis feature implements automated order confirmation emails that are sent to customers immediately after they complete a purchase. The system will generate and send professional, branded emails containing order details, payment information, and next steps for the customer. This enhances the customer experience by providing immediate confirmation and serves as a receipt for their records.\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** As a customer, I want to receive an order confirmation email immediately after completing my purchase, so that I have proof of my transaction and can review my order details.\n\n#### Acceptance Criteria\n\n1. WHEN a customer completes checkout and payment is successful THEN the system SHALL send an order confirmation email within 30 seconds\n2. WHEN the order confirmation email is sent THEN it SHALL include the complete order number, order date, and estimated delivery date\n3. WHEN the order confirmation email is sent THEN it SHALL include itemized list of products with quantities, prices, and subtotals\n4. WHEN the order confirmation email is sent THEN it SHALL include shipping address, billing address, and payment method used\n5. WHEN the order confirmation email is sent THEN it SHALL include order total breakdown with subtotal, taxes, shipping costs, and final total\n6. IF the customer provided a valid email address THEN the system SHALL deliver the email to their inbox\n7. WHEN the email is sent THEN it SHALL use the customer's preferred language from their account settings\n\n### Requirement 2\n\n**User Story:** As a customer, I want the confirmation email to be well-formatted and branded, so that I can easily read the information and trust its authenticity.\n\n#### Acceptance Criteria\n\n1. WHEN the confirmation email is generated THEN it SHALL use a responsive HTML template that displays correctly on desktop and mobile devices\n2. WHEN the email is displayed THEN it SHALL include the company logo, brand colors, and consistent styling\n3. WHEN the email content is rendered THEN it SHALL have clear sections for order summary, shipping details, and customer service information\n4. WHEN the email is sent THEN it SHALL include a professional subject line format like \"Order Confirmation #[ORDER_NUMBER] - [COMPANY_NAME]\"\n5. WHEN the email template is used THEN it SHALL be accessible with proper alt text for images and semantic HTML structure\n6. WHEN the email is viewed THEN it SHALL include footer information with company contact details and unsubscribe options\n\n### Requirement 3\n\n**User Story:** As a customer, I want the confirmation email to include helpful next steps and tracking information, so that I know what to expect and how to track my order.\n\n#### Acceptance Criteria\n\n1. WHEN the confirmation email is sent THEN it SHALL include estimated processing time and shipping timeline\n2. WHEN tracking is available THEN the email SHALL include tracking number and link to carrier tracking page\n3. WHEN the email is generated THEN it SHALL include customer service contact information for questions or issues\n4. WHEN the email is sent THEN it SHALL include links to account dashboard where customers can view order status\n5. WHEN applicable THEN the email SHALL include return policy information and return instructions link\n6. WHEN the email is displayed THEN it SHALL include social media links and promotional content section (optional)\n\n### Requirement 4\n\n**User Story:** As an administrator, I want to ensure order confirmation emails are reliably delivered and tracked, so that I can monitor system performance and customer satisfaction.\n\n#### Acceptance Criteria\n\n1. WHEN an order confirmation email is sent THEN the system SHALL log the email delivery attempt with timestamp and recipient\n2. WHEN email delivery fails THEN the system SHALL retry sending up to 3 times with exponential backoff\n3. WHEN email delivery fails after all retries THEN the system SHALL log the failure and alert administrators\n4. WHEN an email is successfully delivered THEN the system SHALL record delivery confirmation if available from email service\n5. WHEN an email bounces or is rejected THEN the system SHALL log the bounce reason and update customer email status\n6. WHEN administrators access email logs THEN they SHALL be able to search by order number, customer email, or date range\n\n### Requirement 5\n\n**User Story:** As an administrator, I want to customize email templates and content, so that I can maintain brand consistency and update information as needed.\n\n#### Acceptance Criteria\n\n1. WHEN administrators access email settings THEN they SHALL be able to edit email template HTML and styling\n2. WHEN template changes are made THEN the system SHALL provide a preview function to test email appearance\n3. WHEN email content is updated THEN administrators SHALL be able to customize subject lines, header text, and footer content\n4. WHEN template modifications are saved THEN the system SHALL validate HTML structure and warn about potential rendering issues\n5. WHEN multiple languages are supported THEN administrators SHALL be able to manage templates for each supported locale\n6. WHEN email templates are modified THEN the system SHALL maintain version history for rollback capability\n\n### Requirement 6\n\n**User Story:** As a customer, I want to receive different types of order-related emails based on order status changes, so that I stay informed throughout the fulfillment process.\n\n#### Acceptance Criteria\n\n1. WHEN an order status changes to \"processing\" THEN the system SHALL send an order processing notification email\n2. WHEN an order is shipped THEN the system SHALL send a shipping confirmation email with tracking information\n3. WHEN an order is delivered THEN the system SHALL send a delivery confirmation email with review request\n4. WHEN an order is cancelled THEN the system SHALL send a cancellation notification with refund information\n5. WHEN an order encounters issues THEN the system SHALL send appropriate notification emails with resolution steps\n6. WHEN customers opt out of marketing emails THEN they SHALL still receive transactional order-related emails",
              "category": "reference"
            },
            {
              "path": "docs/specs/product-recommendations/requirements.md",
              "name": "requirements.md",
              "size": 8044,
              "lastModified": "2025-12-04T10:27:33.909Z",
              "content": "# Requirements Document\n\n## Introduction\n\nThe Product Recommendations feature will provide intelligent product suggestions to users throughout their shopping experience. \nThis system will enhance user engagement, increase sales conversion, \nand improve customer satisfaction by presenting relevant products based on various recommendation algorithms including collaborative filtering, \ncontent-based filtering, and behavioral analysis. The feature will integrate seamlessly into existing product pages, \nshopping cart, and user account areas.\n\n## Requirements\n\n### Requirement 1\n\n**User Story:** As a customer browsing products, I want to see related and similar products, so that I can discover items that match my interests and needs.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views a product detail page THEN the system SHALL display a \"Related Products\" section with at least 4 similar products\n2. WHEN a customer views a product detail page THEN the system SHALL display recommendations based on product category, attributes, and tags\n3. WHEN no related products are available THEN the system SHALL display popular products from the same category\n4. WHEN a customer clicks on a recommended product THEN the system SHALL track the interaction for analytics\n5. IF a customer is logged in THEN the system SHALL personalize recommendations based on their browsing and purchase history\n\n### Requirement 2\n\n**User Story:** As a customer adding items to my cart, I want to see frequently bought together suggestions, so that I can complete my purchase with complementary items.\n\n#### Acceptance Criteria\n\n1. WHEN a customer adds a product to their cart THEN the system SHALL display \"Frequently Bought Together\" recommendations\n2. WHEN displaying frequently bought together items THEN the system SHALL show bundle pricing and individual pricing\n3. WHEN a customer clicks \"Add Bundle to Cart\" THEN the system SHALL add all selected items to the cart\n4. WHEN no frequently bought together data exists THEN the system SHALL display complementary products from related categories\n5. IF bundle recommendations exist THEN the system SHALL prioritize them over individual complementary products\n\n### Requirement 3\n\n**User Story:** As a customer viewing my cart, I want to see additional product recommendations, so that I can discover items I might have missed.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views their shopping cart THEN the system SHALL display a \"You Might Also Like\" section\n2. WHEN displaying cart recommendations THEN the system SHALL exclude items already in the cart\n3. WHEN cart contains items from multiple categories THEN the system SHALL show recommendations from all represented categories\n4. WHEN a customer adds a recommended item to cart THEN the system SHALL update recommendations dynamically\n5. IF the cart is empty THEN the system SHALL display trending or featured products instead\n\n### Requirement 4\n\n**User Story:** As a customer, I want to see my recently viewed products, so that I can easily return to items I was considering.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views a product THEN the system SHALL add it to their recently viewed list\n2. WHEN displaying recently viewed products THEN the system SHALL show the most recent 10 items\n3. WHEN a customer is not logged in THEN the system SHALL store recently viewed items in browser storage\n4. WHEN a customer logs in THEN the system SHALL merge browser storage with their account history\n5. IF a product in recently viewed becomes unavailable THEN the system SHALL remove it from the list\n\n### Requirement 5\n\n**User Story:** As a customer on the homepage, I want to see personalized product recommendations, so that I can quickly find items that interest me.\n\n#### Acceptance Criteria\n\n1. WHEN a logged-in customer visits the homepage THEN the system SHALL display a \"Recommended for You\" section\n2. WHEN a customer is not logged in THEN the system SHALL display trending or featured products\n3. WHEN displaying personalized recommendations THEN the system SHALL use purchase history, browsing behavior, and preferences\n4. WHEN a customer has no purchase history THEN the system SHALL base recommendations on browsing behavior and popular items\n5. IF no personalized data exists THEN the system SHALL display category-based popular products\n\n### Requirement 6\n\n**User Story:** As a customer, I want recommendation explanations, so that I understand why certain products are suggested to me.\n\n#### Acceptance Criteria\n\n1. WHEN displaying recommendations THEN the system SHALL provide brief explanations for the suggestions\n2. WHEN showing related products THEN the system SHALL display reasons like \"Similar category\" or \"Customers also viewed\"\n3. WHEN showing personalized recommendations THEN the system SHALL use explanations like \"Based on your recent purchases\"\n4. WHEN displaying frequently bought together THEN the system SHALL show \"Customers who bought X also bought Y\"\n5. IF no specific reason exists THEN the system SHALL use generic explanations like \"Popular choice\"\n\n### Requirement 7\n\n**User Story:** As an admin, I want to configure recommendation settings, so that I can optimize the recommendation engine for business goals.\n\n#### Acceptance Criteria\n\n1. WHEN an admin accesses recommendation settings THEN the system SHALL provide configuration options for algorithm weights\n2. WHEN an admin updates recommendation rules THEN the system SHALL apply changes within 24 hours\n3. WHEN an admin views recommendation analytics THEN the system SHALL display click-through rates and conversion metrics\n4. WHEN an admin wants to feature specific products THEN the system SHALL allow manual promotion in recommendation lists\n5. IF recommendation performance drops below threshold THEN the system SHALL alert administrators\n\n### Requirement 8\n\n**User Story:** As a customer on mobile devices, I want optimized recommendation displays, so that I can easily browse suggestions on smaller screens.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views recommendations on mobile THEN the system SHALL display them in a horizontally scrollable format\n2. WHEN displaying mobile recommendations THEN the system SHALL show product images, titles, and prices clearly\n3. WHEN a customer swipes through recommendations THEN the system SHALL load additional items dynamically\n4. WHEN mobile screen space is limited THEN the system SHALL prioritize the most relevant recommendations\n5. IF the mobile connection is slow THEN the system SHALL optimize image loading and reduce recommendation count\n\n### Requirement 9\n\n**User Story:** As a customer, I want to dismiss or hide recommendations I'm not interested in, so that I can see more relevant suggestions.\n\n#### Acceptance Criteria\n\n1. WHEN a customer views recommendations THEN the system SHALL provide a \"Not Interested\" or dismiss option\n2. WHEN a customer dismisses a recommendation THEN the system SHALL remove it from current and future suggestions\n3. WHEN a customer dismisses multiple items from a category THEN the system SHALL reduce recommendations from that category\n4. WHEN a customer dismisses recommendations THEN the system SHALL learn and improve future suggestions\n5. IF a customer dismisses too many recommendations THEN the system SHALL ask for feedback to improve suggestions\n\n### Requirement 10\n\n**User Story:** As a system, I want to track recommendation performance, so that the business can measure the effectiveness of the recommendation engine.\n\n#### Acceptance Criteria\n\n1. WHEN a recommendation is displayed THEN the system SHALL log the impression event\n2. WHEN a customer clicks on a recommendation THEN the system SHALL track the click-through event\n3. WHEN a recommended product is purchased THEN the system SHALL record the conversion event\n4. WHEN generating analytics reports THEN the system SHALL calculate recommendation ROI and effectiveness metrics\n5. IF recommendation performance data is requested THEN the system SHALL provide real-time and historical analytics",
              "category": "explanation"
            }
          ],
          "similarity": 0.8176173892169022,
          "recommendation": "Consider consolidating into requirements.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/completed-specs/customer-order-history/tasks.md",
              "name": "tasks.md",
              "size": 9164,
              "lastModified": "2026-01-06T15:49:37.098Z",
              "content": "# Implementation Plan\n\n- [x] 1. Set up database schema extensions and API enhancements\n\n  - Create order tracking events table with proper RLS policies\n  - Add tracking fields to existing orders table\n  - Create database indexes for performance optimization\n  - _Requirements: 3.1, 3.2, 3.3_\n\n- [x] 2. Implement core order management composables\n- [x] 2.1 Create useOrders composable for order list management\n\n  - Implement order fetching with pagination and filtering\n  - Add search functionality with debouncing\n  - Handle loading states and error management\n  - _Requirements: 1.1, 1.2, 1.3, 5.1, 5.2, 5.3_\n\n- [x] 2.2 Create useOrderDetail composable for individual order management\n\n  - Implement order detail fetching and caching\n  - Add order tracking information retrieval\n  - Handle order actions (reorder, return, support)\n  - _Requirements: 2.1, 2.2, 2.3, 6.1, 6.2, 6.3_\n\n- [x] 2.3 Create useOrderTracking composable for real-time tracking\n\n  - Implement tracking status updates and notifications\n  - Add Supabase real-time subscription for order changes\n  - Handle tracking event timeline display\n  - _Requirements: 3.1, 3.2, 3.3, 4.1, 4.2, 4.3_\n\n- [ ]\\* 2.4 Write unit tests for composables\n\n  - Test order fetching and state management logic\n  - Test search and filtering functionality\n  - Test error handling and recovery scenarios\n  - _Requirements: 1.1, 2.1, 3.1, 5.1_\n\n- [x] 3. Create order-related UI components\n- [x] 3.1 Implement OrderCard component for order list display\n\n  - Create responsive order summary card layout\n  - Add status badges and quick action buttons\n  - Implement mobile-optimized touch interactions\n  - _Requirements: 1.1, 1.2, 7.1, 7.2_\n\n- [x] 3.2 Implement OrderStatus component for status visualization\n\n  - Create status badge with color coding system\n  - Add progress timeline for order tracking\n  - Display estimated delivery dates and updates\n  - _Requirements: 3.1, 3.2, 4.3_\n\n- [x] 3.3 Implement OrderActions component for order management\n\n  - Create conditional action buttons (reorder, return, support)\n  - Add confirmation dialogs for destructive actions\n  - Implement action handlers with proper error handling\n  - _Requirements: 6.1, 6.2, 6.3, 6.4_\n\n- [x] 3.4 Implement OrderSearch component for filtering interface\n\n  - Create search input with debounced functionality\n  - Add status filter dropdown and date range picker\n  - Implement clear filters functionality\n  - _Requirements: 5.1, 5.2, 5.3, 5.4_\n\n- [ ]\\* 3.5 Write component unit tests\n\n  - Test component rendering with various props\n  - Test user interactions and event handling\n  - Test responsive behavior and accessibility\n  - _Requirements: 1.1, 5.1, 6.1, 7.1_\n\n- [x] 4. Implement order list page functionality\n- [x] 4.1 Create orders index page with pagination\n\n  - Build responsive order list layout with grid/list toggle\n  - Implement pagination controls and navigation\n  - Add empty state handling for users with no orders\n  - _Requirements: 1.1, 1.2, 1.3, 1.4, 7.1_\n\n- [x] 4.2 Integrate search and filtering functionality\n\n  - Connect OrderSearch component to order fetching logic\n  - Implement URL state management for filters and pagination\n  - Add loading states during search and filter operations\n  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_\n\n- [x] 4.3 Add mobile optimization and touch gestures\n\n  - Implement swipe gestures for mobile navigation\n  - Add pull-to-refresh functionality for order updates\n  - Optimize layout for various screen sizes and orientations\n  - _Requirements: 7.1, 7.2, 7.3, 7.4_\n\n- [ ]\\* 4.4 Write integration tests for order list page\n\n  - Test pagination and navigation functionality\n  - Test search and filtering with various parameters\n  - Test mobile interactions and responsive behavior\n  - _Requirements: 1.1, 5.1, 7.1_\n\n- [x] 5. Implement order detail page functionality\n- [x] 5.1 Create order detail page with comprehensive information display\n\n  - Build detailed order information layout with all purchase data\n  - Display shipping and billing addresses with proper formatting\n  - Show order timeline with status changes and timestamps\n  - _Requirements: 2.1, 2.2, 2.3, 2.4_\n\n- [x] 5.2 Integrate order tracking and status updates\n\n  - Display real-time tracking information and carrier details\n  - Show estimated delivery dates and tracking timeline\n  - Handle tracking information unavailable scenarios\n  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_\n\n- [x] 5.3 Implement order actions and user interactions\n\n  - Add reorder functionality that adds items to current cart\n  - Implement return initiation with proper workflow\n  - Create support contact integration with pre-populated order data\n  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_\n\n- [x] 5.4 Add mobile-optimized detail view\n\n  - Create stacked layout for mobile screens with easy scrolling\n  - Implement swipe navigation between different order sections\n  - Add touch-friendly action buttons and interactions\n  - _Requirements: 7.1, 7.2, 7.3, 7.5_\n\n- [ ]\\* 5.5 Write integration tests for order detail page\n\n  - Test order detail loading and display functionality\n  - Test order actions and user interaction flows\n  - Test mobile-specific features and responsive behavior\n  - _Requirements: 2.1, 6.1, 7.1_\n\n- [x] 6. Enhance API endpoints for order history features\n- [x] 6.1 Extend orders API with advanced filtering and search\n\n  - Add search functionality to existing orders endpoint\n  - Implement date range filtering and status-based queries\n  - Optimize database queries for performance with large datasets\n  - _Requirements: 5.1, 5.2, 5.3, 1.4_\n\n- [x] 6.2 Create order tracking API endpoints\n\n  - Implement tracking information retrieval endpoint\n  - Add tracking event creation and update functionality\n  - Create carrier integration for external tracking data\n  - _Requirements: 3.1, 3.2, 3.3, 3.4_\n\n- [x] 6.3 Implement order action API endpoints\n\n  - Create reorder endpoint that processes cart addition\n  - Add return initiation endpoint with proper validation\n  - Implement support ticket creation with order context\n  - _Requirements: 6.1, 6.2, 6.3, 6.4_\n\n- [ ]\\* 6.4 Write API endpoint tests\n\n  - Test all order-related API endpoints with various scenarios\n  - Test authentication and authorization for order access\n  - Test error handling and edge cases\n  - _Requirements: 1.1, 2.1, 3.1, 5.1, 6.1_\n\n- [x] 7. Implement real-time notifications and updates\n- [x] 7.1 Set up Supabase real-time subscriptions for order updates\n\n  - Create real-time subscription for order status changes\n  - Implement notification display when orders are updated\n  - Handle connection management and reconnection logic\n  - _Requirements: 4.1, 4.2, 4.3, 4.4_\n\n- [x] 7.2 Create notification system for order status changes\n\n  - Display toast notifications for order updates when user is online\n  - Show recent status updates badge on orders page\n  - Implement delivery confirmation prominent display\n  - _Requirements: 4.1, 4.2, 4.3, 4.5_\n\n- [ ]\\* 7.3 Write real-time functionality tests\n\n  - Test real-time subscription setup and data flow\n  - Test notification display and user interaction\n  - Test connection handling and error scenarios\n  - _Requirements: 4.1, 4.2, 4.3_\n\n- [x] 8. Add internationalization and accessibility features\n- [x] 8.1 Implement i18n translations for order history\n\n  - Add translation keys for all order-related text content\n  - Translate order status labels and action button text\n  - Implement date and currency formatting for different locales\n  - _Requirements: 1.1, 2.1, 3.1, 5.1, 6.1_\n\n- [x] 8.2 Ensure accessibility compliance for order components\n\n  - Add proper ARIA labels and semantic HTML structure\n  - Implement keyboard navigation for all interactive elements\n  - Ensure color contrast compliance for status indicators\n  - _Requirements: 1.1, 2.1, 5.1, 6.1, 7.1_\n\n- [ ]\\* 8.3 Write accessibility and i18n tests\n\n  - Test screen reader compatibility and keyboard navigation\n  - Test translation loading and locale-specific formatting\n  - Test accessibility compliance across different components\n  - _Requirements: 1.1, 2.1, 5.1, 7.1_\n\n- [x] 9. Integrate with existing account dashboard and navigation\n- [x] 9.1 Update account navigation to include orders link\n\n  - Add orders navigation item to existing account sidebar\n  - Update navigation highlighting for orders section\n  - Ensure consistent styling with existing account pages\n  - _Requirements: 1.1, 2.1_\n\n- [x] 9.2 Add order summary to account dashboard\n\n  - Display recent orders count and quick access links\n  - Show order status summary with actionable items\n  - Integrate with existing dashboard layout and styling\n  - _Requirements: 1.1, 4.2_\n\n- [x] 9.3 Ensure consistent theming and styling\n\n  - Apply existing theme variables and component styles\n  - Ensure dark/light mode compatibility for all new components\n  - Maintain consistency with existing UI patterns and spacing\n  - _Requirements: 1.1, 2.1, 7.1_\n\n- [ ]\\* 9.4 Write integration tests for dashboard integration\n  - Test navigation between account sections\n  - Test dashboard summary display and interactions\n  - Test theme consistency across order components\n  - _Requirements: 1.1, 2.1_\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/completed-specs/order-status-updates/tasks.md",
              "name": "tasks.md",
              "size": 11174,
              "lastModified": "2026-01-06T15:49:37.098Z",
              "content": "# Implementation Plan\n\n- [ ] 1. Set up database schema and core data models\n  - Create database migration files for order status tracking tables\n  - Implement TypeScript interfaces for order status, notifications, and preferences\n  - Create database indexes for performance optimization\n  - _Requirements: 1.1, 2.1, 3.1, 5.1, 6.1, 7.1, 8.1_\n\n- [ ] 2. Implement core order status management service\n  - [ ] 2.1 Create OrderStatusService with status update logic\n    - Write service class with methods for updating order status\n    - Implement status transition validation and workflow rules\n    - Add status history tracking functionality\n    - _Requirements: 1.1, 2.1, 7.1_\n\n  - [ ] 2.2 Implement order timeline and tracking functionality\n    - Create methods to retrieve order status history\n    - Build timeline generation with status details and timestamps\n    - Implement tracking number integration and carrier information\n    - _Requirements: 2.1, 2.2, 2.3, 2.4_\n\n  - [ ]* 2.3 Write unit tests for order status service\n    - Create unit tests for status transition logic\n    - Test timeline generation with various order scenarios\n    - Test error handling for invalid status updates\n    - _Requirements: 1.1, 2.1, 7.1_\n\n- [ ] 3. Build notification preference management system\n  - [ ] 3.1 Create notification preferences data models and validation\n    - Implement NotificationPreferences interface and validation\n    - Create database operations for preference CRUD\n    - Add phone number verification functionality\n    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_\n\n  - [ ] 3.2 Implement preference management API endpoints\n    - Create GET/PUT endpoints for notification preferences\n    - Add phone verification endpoint with SMS integration\n    - Implement preference validation and error handling\n    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_\n\n  - [ ]* 3.3 Write unit tests for preference management\n    - Test preference validation and CRUD operations\n    - Test phone verification workflow\n    - Test default preference assignment for new users\n    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_\n\n- [ ] 4. Extend notification service for order status updates\n  - [ ] 4.1 Create order status notification templates\n    - Design HTML email templates for each order status\n    - Create SMS message templates with character limits\n    - Implement multi-language template support (es, en, ro, ru)\n    - _Requirements: 1.1, 1.2, 1.3, 4.1, 4.2_\n\n  - [ ] 4.2 Implement NotificationService extensions for order updates\n    - Extend existing email service for order status notifications\n    - Add SMS notification capability using external service\n    - Implement template rendering with order-specific variables\n    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_\n\n  - [ ] 4.3 Build notification queue and retry logic\n    - Implement notification queue with priority handling\n    - Add retry logic with exponential backoff for failed notifications\n    - Create notification logging and status tracking\n    - _Requirements: 1.1, 1.4, 4.1, 4.2, 4.3, 4.4, 4.5_\n\n  - [ ]* 4.4 Write unit tests for notification service\n    - Test template rendering with various order data\n    - Test notification delivery and retry mechanisms\n    - Test multi-channel notification coordination\n    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_\n\n- [ ] 5. Implement proactive delay and exception handling\n  - [ ] 5.1 Create delay detection and notification system\n    - Implement logic to detect delivery delays based on estimates\n    - Create exception handling for shipping problems\n    - Add proactive notification triggers for delays and issues\n    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_\n\n  - [ ] 5.2 Build customer action options for delivery issues\n    - Implement delivery reschedule functionality\n    - Add address change options for delivery problems\n    - Create support contact integration for complex issues\n    - _Requirements: 4.2, 4.3, 4.5_\n\n  - [ ]* 5.3 Write unit tests for delay and exception handling\n    - Test delay detection algorithms\n    - Test exception notification triggers\n    - Test customer action option workflows\n    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_\n\n- [ ] 6. Build customer order tracking dashboard\n  - [ ] 6.1 Create order timeline Vue component\n    - Build responsive timeline component showing order progress\n    - Implement status icons and progress indicators\n    - Add mobile-optimized touch interactions\n    - _Requirements: 2.1, 2.2, 2.3, 2.4, 5.1, 5.2, 5.3, 5.4, 5.5_\n\n  - [ ] 6.2 Implement multi-order dashboard view\n    - Create dashboard component displaying all active orders\n    - Add filtering and sorting functionality for orders\n    - Implement real-time updates without page refresh\n    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_\n\n  - [ ] 6.3 Build order tracking API endpoints\n    - Create GET endpoints for order status and timeline\n    - Add tracking by order number functionality\n    - Implement user-specific order filtering and permissions\n    - _Requirements: 2.1, 2.2, 2.3, 2.4, 5.1, 5.2, 5.3, 5.4_\n\n  - [ ]* 6.4 Write integration tests for dashboard functionality\n    - Test timeline component with various order states\n    - Test multi-order dashboard performance\n    - Test API endpoint security and data filtering\n    - _Requirements: 2.1, 2.2, 5.1, 5.2, 5.3, 5.4, 5.5_\n\n- [ ] 7. Implement admin management tools\n  - [ ] 7.1 Create admin order status management interface\n    - Build admin panel for manual status updates\n    - Implement status workflow configuration tools\n    - Add audit logging for all administrative actions\n    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 7.4, 7.5_\n\n  - [ ] 7.2 Build notification template management system\n    - Create admin interface for editing notification templates\n    - Implement template preview functionality\n    - Add template versioning and rollback capabilities\n    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_\n\n  - [ ] 7.3 Implement customer service representative tools\n    - Create CSR interface for manual status updates\n    - Add custom notification composition tools\n    - Implement role-based permissions and authentication\n    - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_\n\n  - [ ]* 7.4 Write unit tests for admin management tools\n    - Test admin status update functionality\n    - Test template management operations\n    - Test CSR permission validation and audit logging\n    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 7.4, 7.5_\n\n- [ ] 8. Build carrier integration and webhook handling\n  - [ ] 8.1 Implement carrier API integration service\n    - Create CarrierIntegrationService for major carriers (FedEx, UPS, DHL)\n    - Implement webhook signature validation and parsing\n    - Add carrier-specific tracking URL generation\n    - _Requirements: 2.3, 4.1, 4.2_\n\n  - [ ] 8.2 Create webhook endpoints for carrier updates\n    - Build secure webhook endpoints for each supported carrier\n    - Implement webhook payload validation and processing\n    - Add error handling and retry logic for webhook failures\n    - _Requirements: 1.1, 2.3, 4.1, 4.2_\n\n  - [ ] 8.3 Implement carrier polling fallback system\n    - Create background job system for polling carrier APIs\n    - Add intelligent polling frequency based on order status\n    - Implement fallback when webhook delivery fails\n    - _Requirements: 2.3, 4.1, 4.2_\n\n  - [ ]* 8.4 Write integration tests for carrier integration\n    - Test webhook processing with mock carrier payloads\n    - Test API polling functionality and error handling\n    - Test carrier-specific tracking URL generation\n    - _Requirements: 2.3, 4.1, 4.2_\n\n- [ ] 9. Implement real-time updates and WebSocket integration\n  - [ ] 9.1 Create real-time notification service\n    - Implement WebSocket server for real-time order updates\n    - Add Server-Sent Events fallback for older browsers\n    - Create client-side real-time update handling\n    - _Requirements: 5.3, 5.5_\n\n  - [ ] 9.2 Build push notification system\n    - Integrate Firebase Cloud Messaging for push notifications\n    - Implement device token management and registration\n    - Add push notification templates and delivery logic\n    - _Requirements: 1.1, 1.2, 1.3_\n\n  - [ ]* 9.3 Write integration tests for real-time functionality\n    - Test WebSocket connection handling and message delivery\n    - Test push notification registration and delivery\n    - Test real-time update synchronization across devices\n    - _Requirements: 1.1, 1.2, 1.3, 5.3, 5.5_\n\n- [ ] 10. Build analytics and reporting system\n  - [ ] 10.1 Implement notification analytics tracking\n    - Create analytics service for tracking notification performance\n    - Add delivery rate, open rate, and engagement metrics\n    - Implement customer satisfaction correlation tracking\n    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_\n\n  - [ ] 10.2 Create admin analytics dashboard\n    - Build dashboard showing notification performance metrics\n    - Add order status distribution and timing analytics\n    - Implement export functionality for business intelligence\n    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_\n\n  - [ ]* 10.3 Write unit tests for analytics functionality\n    - Test metrics calculation and aggregation\n    - Test dashboard data visualization components\n    - Test analytics data export functionality\n    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_\n\n- [ ] 11. Integrate with existing order creation workflow\n  - [ ] 11.1 Extend order creation API to trigger status notifications\n    - Modify existing order creation endpoint to send confirmation notifications\n    - Integrate with notification preference system\n    - Add guest checkout notification handling\n    - _Requirements: 1.1, 1.2, 1.5, 3.5_\n\n  - [ ] 11.2 Update order management pages with status tracking\n    - Integrate order timeline component into existing order pages\n    - Add status update functionality to admin order management\n    - Update customer account pages with order tracking dashboard\n    - _Requirements: 2.1, 2.2, 5.1, 5.2, 6.1, 7.1_\n\n  - [ ]* 11.3 Write end-to-end integration tests\n    - Test complete order creation to notification delivery flow\n    - Test status updates through admin interface\n    - Test customer experience across all touchpoints\n    - _Requirements: 1.1, 1.2, 2.1, 2.2, 5.1, 5.2, 6.1, 7.1_\n\n- [ ] 12. Implement security and performance optimizations\n  - [ ] 12.1 Add security measures for webhook and API endpoints\n    - Implement rate limiting on all public endpoints\n    - Add IP whitelisting for carrier webhook endpoints\n    - Create comprehensive audit logging for security events\n    - _Requirements: All security-related requirements_\n\n  - [ ] 12.2 Optimize database performance and caching\n    - Add database indexes for common query patterns\n    - Implement caching for notification templates and preferences\n    - Optimize timeline queries for large order histories\n    - _Requirements: Performance optimization for all features_\n\n  - [ ]* 12.3 Write performance and security tests\n    - Test API endpoint performance under load\n    - Test security measures and access controls\n    - Test database query performance with large datasets\n    - _Requirements: All performance and security requirements_",
              "category": "archive"
            }
          ],
          "similarity": 0.847850679892263,
          "recommendation": "Consider consolidating into tasks.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/completed-specs/order-status-updates/design.md",
              "name": "design.md",
              "size": 20927,
              "lastModified": "2026-01-06T15:49:37.098Z",
              "content": "# Order Status Updates Design Document\n\n## Overview\n\nThe Order Status Updates system provides comprehensive real-time order tracking and notification capabilities for customers and administrators. The system integrates with existing order management, shipping carriers, and notification infrastructure to deliver proactive status updates through multiple channels. It extends the current email service architecture and leverages the existing toast notification system for in-app updates.\n\n## Architecture\n\n### High-Level System Architecture\n\n```mermaid\ngraph TB\n    A[Order Management] -->|Status Changes| B[Order Status Engine]\n    C[Shipping Carriers] -->|Webhooks/API| D[Carrier Integration Service]\n    D --> B\n    B --> E[Notification Queue]\n    E --> F[Multi-Channel Notification Service]\n    F --> G[Email Service]\n    F --> H[SMS Service]\n    F --> I[Push Notification Service]\n    F --> J[In-App Notifications]\n    \n    K[Customer Portal] --> L[Status Dashboard]\n    L --> M[Real-time Updates]\n    M --> N[WebSocket/SSE]\n    \n    O[Admin Panel] --> P[Status Management]\n    P --> B\n    O --> Q[Template Manager]\n    Q --> F\n    \n    R[Analytics Engine] --> S[Performance Metrics]\n    B --> R\n    F --> R\n    \n    T[Database] --> U[Order Status History]\n    T --> V[Notification Logs]\n    T --> W[Customer Preferences]\n    \n    B --> T\n    F --> T\n```\n\n### System Components\n\n1. **Order Status Engine**: Core component that processes status changes and triggers notifications\n2. **Carrier Integration Service**: Handles communication with shipping carriers via APIs and webhooks\n3. **Multi-Channel Notification Service**: Manages notification delivery across different channels\n4. **Status Dashboard**: Customer-facing interface for order tracking\n5. **Real-time Updates**: WebSocket/Server-Sent Events for live status updates\n6. **Template Manager**: Manages notification templates and content\n7. **Analytics Engine**: Tracks performance metrics and customer engagement\n8. **Admin Management Interface**: Tools for managing workflows and templates\n\n## Components and Interfaces\n\n### Database Schema Extensions\n\n#### Order Status Tracking Tables\n\n```sql\n-- Order status history\nCREATE TABLE order_status_history (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    order_id UUID REFERENCES orders(id) ON DELETE CASCADE,\n    status VARCHAR(50) NOT NULL,\n    previous_status VARCHAR(50),\n    status_details TEXT,\n    location TEXT,\n    estimated_delivery TIMESTAMP WITH TIME ZONE,\n    tracking_number TEXT,\n    carrier TEXT,\n    notes TEXT,\n    created_by UUID REFERENCES auth.users(id),\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    \n    -- Indexes for performance\n    INDEX idx_order_status_history_order_id (order_id),\n    INDEX idx_order_status_history_status (status),\n    INDEX idx_order_status_history_created_at (created_at)\n);\n\n-- Customer notification preferences\nCREATE TABLE customer_notification_preferences (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,\n    email_notifications JSONB DEFAULT '{\n        \"order_confirmed\": true,\n        \"processing\": true,\n        \"shipped\": true,\n        \"out_for_delivery\": true,\n        \"delivered\": true,\n        \"delayed\": true,\n        \"exception\": true,\n        \"cancelled\": true\n    }',\n    sms_notifications JSONB DEFAULT '{\n        \"order_confirmed\": false,\n        \"processing\": false,\n        \"shipped\": true,\n        \"out_for_delivery\": true,\n        \"delivered\": true,\n        \"delayed\": true,\n        \"exception\": true,\n        \"cancelled\": false\n    }',\n    push_notifications JSONB DEFAULT '{\n        \"order_confirmed\": true,\n        \"processing\": false,\n        \"shipped\": true,\n        \"out_for_delivery\": true,\n        \"delivered\": true,\n        \"delayed\": true,\n        \"exception\": true,\n        \"cancelled\": true\n    }',\n    phone_number TEXT,\n    phone_verified BOOLEAN DEFAULT false,\n    language_preference TEXT DEFAULT 'es',\n    timezone TEXT DEFAULT 'Europe/Madrid',\n    quiet_hours_start TIME DEFAULT '22:00',\n    quiet_hours_end TIME DEFAULT '08:00',\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    \n    UNIQUE(user_id)\n);\n\n-- Order status notification log\nCREATE TABLE order_status_notifications (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    order_id UUID REFERENCES orders(id) ON DELETE CASCADE,\n    user_id UUID REFERENCES auth.users(id),\n    guest_email TEXT,\n    notification_type VARCHAR(50) NOT NULL,\n    channel VARCHAR(20) NOT NULL, -- 'email', 'sms', 'push', 'in_app'\n    status VARCHAR(20) DEFAULT 'pending', -- 'pending', 'sent', 'delivered', 'failed', 'clicked'\n    template_id TEXT,\n    subject TEXT,\n    content_preview TEXT,\n    recipient_address TEXT NOT NULL,\n    external_id TEXT,\n    error_message TEXT,\n    retry_count INTEGER DEFAULT 0,\n    scheduled_at TIMESTAMP WITH TIME ZONE,\n    sent_at TIMESTAMP WITH TIME ZONE,\n    delivered_at TIMESTAMP WITH TIME ZONE,\n    clicked_at TIMESTAMP WITH TIME ZONE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    \n    -- Indexes for performance and analytics\n    INDEX idx_order_notifications_order_id (order_id),\n    INDEX idx_order_notifications_user_id (user_id),\n    INDEX idx_order_notifications_type (notification_type),\n    INDEX idx_order_notifications_status (status),\n    INDEX idx_order_notifications_sent_at (sent_at)\n);\n\n-- Notification templates\nCREATE TABLE order_notification_templates (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name TEXT NOT NULL,\n    type VARCHAR(50) NOT NULL, -- 'order_confirmed', 'processing', 'shipped', etc.\n    channel VARCHAR(20) NOT NULL, -- 'email', 'sms', 'push'\n    language TEXT NOT NULL DEFAULT 'es',\n    subject TEXT,\n    content TEXT NOT NULL,\n    variables JSONB,\n    is_active BOOLEAN DEFAULT true,\n    is_default BOOLEAN DEFAULT false,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    \n    UNIQUE(type, channel, language, is_default) WHERE is_default = true\n);\n\n-- Carrier tracking integration\nCREATE TABLE carrier_tracking_info (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    order_id UUID REFERENCES orders(id) ON DELETE CASCADE,\n    tracking_number TEXT NOT NULL,\n    carrier TEXT NOT NULL,\n    carrier_service TEXT,\n    tracking_url TEXT,\n    last_sync TIMESTAMP WITH TIME ZONE,\n    sync_status VARCHAR(20) DEFAULT 'active', -- 'active', 'completed', 'failed'\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    \n    UNIQUE(order_id, tracking_number)\n);\n\n-- Status workflow configuration\nCREATE TABLE order_status_workflows (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name TEXT NOT NULL,\n    order_type TEXT DEFAULT 'standard', -- 'standard', 'digital', 'subscription'\n    status_flow JSONB NOT NULL, -- Array of status transitions\n    notification_rules JSONB NOT NULL, -- Rules for when to send notifications\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n```\n\n### API Endpoints\n\n#### Customer Status Tracking Endpoints\n- `GET /api/orders/:id/status` - Get order status and history\n- `GET /api/orders/:id/timeline` - Get detailed order timeline\n- `GET /api/orders/track/:trackingNumber` - Track order by tracking number\n- `GET /api/orders/user/active` - Get all active orders for user\n- `POST /api/orders/:id/delivery-preferences` - Update delivery preferences for specific order\n\n#### Notification Preference Endpoints\n- `GET /api/notifications/preferences` - Get user notification preferences\n- `PUT /api/notifications/preferences` - Update notification preferences\n- `POST /api/notifications/verify-phone` - Verify phone number for SMS\n- `GET /api/notifications/history` - Get notification history\n- `POST /api/notifications/test` - Send test notification\n\n#### Webhook Endpoints\n- `POST /api/webhooks/carriers/fedex` - FedEx tracking webhook\n- `POST /api/webhooks/carriers/ups` - UPS tracking webhook\n- `POST /api/webhooks/carriers/dhl` - DHL tracking webhook\n- `POST /api/webhooks/carriers/correos` - Correos Espaa webhook\n\n#### Admin Management Endpoints\n- `GET /api/admin/orders/status-overview` - Dashboard overview of order statuses\n- `POST /api/admin/orders/:id/status` - Manually update order status\n- `GET /api/admin/notifications/templates` - List notification templates\n- `POST /api/admin/notifications/templates` - Create notification template\n- `PUT /api/admin/notifications/templates/:id` - Update template\n- `GET /api/admin/notifications/analytics` - Get notification analytics\n- `POST /api/admin/notifications/bulk-send` - Send bulk notifications\n\n### Core Services\n\n#### OrderStatusService\n```typescript\ninterface OrderStatusService {\n  updateOrderStatus(orderId: string, status: OrderStatus, details?: StatusUpdateDetails): Promise<void>\n  getOrderTimeline(orderId: string): Promise<OrderTimeline>\n  getActiveOrdersForUser(userId: string): Promise<OrderSummary[]>\n  trackOrderByNumber(trackingNumber: string): Promise<TrackingInfo>\n  scheduleStatusCheck(orderId: string, checkTime: Date): Promise<void>\n  processCarrierUpdate(carrierData: CarrierWebhookData): Promise<void>\n}\n\ninterface StatusUpdateDetails {\n  location?: string\n  estimatedDelivery?: Date\n  trackingNumber?: string\n  carrier?: string\n  notes?: string\n  createdBy?: string\n}\n```\n\n#### NotificationService (Extended)\n```typescript\ninterface NotificationService {\n  sendOrderStatusNotification(notification: OrderStatusNotification): Promise<NotificationResult>\n  scheduleNotification(notification: OrderStatusNotification, sendAt: Date): Promise<void>\n  getUserPreferences(userId: string): Promise<NotificationPreferences>\n  updateUserPreferences(userId: string, preferences: Partial<NotificationPreferences>): Promise<void>\n  renderTemplate(templateId: string, variables: TemplateVariables): Promise<RenderedNotification>\n  logNotification(log: NotificationLog): Promise<void>\n  retryFailedNotifications(): Promise<void>\n}\n```\n\n#### CarrierIntegrationService\n```typescript\ninterface CarrierIntegrationService {\n  validateWebhook(carrier: string, payload: any, signature: string): boolean\n  parseTrackingUpdate(carrier: string, payload: any): TrackingUpdate\n  pollCarrierStatus(trackingNumber: string, carrier: string): Promise<TrackingUpdate>\n  getTrackingUrl(trackingNumber: string, carrier: string): string\n  registerTrackingNumber(orderId: string, trackingNumber: string, carrier: string): Promise<void>\n}\n```\n\n#### RealTimeService\n```typescript\ninterface RealTimeService {\n  subscribeToOrderUpdates(userId: string, orderId?: string): EventSource\n  broadcastStatusUpdate(orderId: string, update: StatusUpdate): Promise<void>\n  notifyUserDevices(userId: string, notification: PushNotification): Promise<void>\n}\n```\n\n## Data Models\n\n### Core Types\n\n```typescript\nenum OrderStatus {\n  PENDING = 'pending',\n  CONFIRMED = 'confirmed',\n  PROCESSING = 'processing',\n  SHIPPED = 'shipped',\n  OUT_FOR_DELIVERY = 'out_for_delivery',\n  DELIVERED = 'delivered',\n  DELAYED = 'delayed',\n  EXCEPTION = 'exception',\n  CANCELLED = 'cancelled',\n  RETURNED = 'returned'\n}\n\ninterface OrderTimeline {\n  orderId: string\n  orderNumber: string\n  currentStatus: OrderStatus\n  estimatedDelivery?: Date\n  trackingInfo?: TrackingInfo\n  statusHistory: StatusHistoryEntry[]\n  notifications: NotificationSummary[]\n}\n\ninterface StatusHistoryEntry {\n  id: string\n  status: OrderStatus\n  previousStatus?: OrderStatus\n  statusDetails?: string\n  location?: string\n  estimatedDelivery?: Date\n  trackingNumber?: string\n  carrier?: string\n  notes?: string\n  createdBy?: string\n  createdAt: Date\n}\n\ninterface TrackingInfo {\n  trackingNumber: string\n  carrier: string\n  carrierService?: string\n  trackingUrl: string\n  currentLocation?: string\n  estimatedDelivery?: Date\n  deliveryAttempts: DeliveryAttempt[]\n  lastSync: Date\n}\n\ninterface DeliveryAttempt {\n  attemptNumber: number\n  attemptDate: Date\n  status: 'attempted' | 'successful' | 'failed'\n  reason?: string\n  nextAttemptDate?: Date\n}\n\ninterface OrderStatusNotification {\n  orderId: string\n  userId?: string\n  guestEmail?: string\n  notificationType: OrderStatus\n  channels: NotificationChannel[]\n  templateVariables: TemplateVariables\n  scheduledAt?: Date\n  priority: 'low' | 'normal' | 'high' | 'urgent'\n}\n\ninterface NotificationPreferences {\n  userId: string\n  emailNotifications: Record<OrderStatus, boolean>\n  smsNotifications: Record<OrderStatus, boolean>\n  pushNotifications: Record<OrderStatus, boolean>\n  phoneNumber?: string\n  phoneVerified: boolean\n  languagePreference: string\n  timezone: string\n  quietHours: {\n    start: string // HH:MM format\n    end: string   // HH:MM format\n  }\n}\n\ninterface TemplateVariables {\n  customerName: string\n  orderNumber: string\n  orderDate: string\n  currentStatus: string\n  statusMessage: string\n  estimatedDelivery?: string\n  trackingNumber?: string\n  trackingUrl?: string\n  carrierName?: string\n  deliveryAddress: string\n  orderItems: OrderItemSummary[]\n  supportContact: string\n  accountUrl: string\n  unsubscribeUrl?: string\n}\n\ninterface OrderItemSummary {\n  name: string\n  quantity: number\n  image?: string\n}\n```\n\n## Error Handling\n\n### Status Update Errors\n- **Invalid Status Transition**: Validate status transitions according to workflow rules\n- **Concurrent Updates**: Handle race conditions with optimistic locking\n- **Missing Order**: Return appropriate error for non-existent orders\n- **Permission Denied**: Validate user permissions for status updates\n\n### Notification Delivery Errors\n- **Invalid Contact Information**: Mark as failed, disable future notifications\n- **Service Outages**: Implement circuit breaker pattern with fallback queuing\n- **Rate Limiting**: Implement exponential backoff and respect carrier limits\n- **Template Errors**: Use fallback templates, log errors for admin review\n\n### Carrier Integration Errors\n- **Authentication Failures**: Alert admin, disable carrier integration temporarily\n- **Invalid Tracking Numbers**: Log warnings, mark tracking as inactive\n- **Webhook Validation Failures**: Log security events, reject invalid requests\n- **API Rate Limits**: Implement intelligent backoff strategies\n\n### Real-time Communication Errors\n- **WebSocket Connection Failures**: Implement automatic reconnection with exponential backoff\n- **Push Notification Failures**: Handle device token invalidation gracefully\n- **Server-Sent Events Issues**: Provide fallback polling mechanism\n\n## Testing Strategy\n\n### Unit Tests\n- **Status Transition Logic**: Test all valid and invalid status transitions\n- **Notification Rendering**: Test template rendering with various data combinations\n- **Preference Management**: Test CRUD operations and validation\n- **Carrier Integration**: Test webhook parsing and API communication\n\n### Integration Tests\n- **End-to-End Status Flow**: Test complete status update to notification delivery\n- **Multi-Channel Notifications**: Test simultaneous delivery across channels\n- **Real-time Updates**: Test WebSocket and SSE functionality\n- **Database Transactions**: Test data consistency during concurrent operations\n\n### Performance Tests\n- **High Volume Processing**: Test with thousands of simultaneous status updates\n- **Notification Queue Performance**: Test queue processing under load\n- **Real-time Scalability**: Test WebSocket connections at scale\n- **Database Performance**: Test query performance with large datasets\n\n### User Experience Tests\n- **Cross-Device Synchronization**: Test status updates across multiple devices\n- **Notification Timing**: Test delivery timing and quiet hours functionality\n- **Mobile Responsiveness**: Test timeline and dashboard on mobile devices\n- **Accessibility**: Test screen reader compatibility and keyboard navigation\n\n## Security Considerations\n\n### Data Protection\n- **PII Encryption**: Encrypt phone numbers and sensitive customer data\n- **Access Control**: Implement role-based access for admin functions\n- **Audit Logging**: Log all status changes and administrative actions\n- **Data Retention**: Implement appropriate retention policies for notification logs\n\n### Webhook Security\n- **Signature Validation**: Validate all carrier webhook signatures using HMAC\n- **Rate Limiting**: Implement rate limiting on webhook endpoints\n- **IP Whitelisting**: Restrict webhook access to known carrier IP ranges\n- **Request Validation**: Validate all incoming webhook payloads\n\n### Communication Security\n- **TLS Encryption**: Ensure all external communications use TLS 1.2+\n- **API Key Management**: Secure storage and rotation of carrier API keys\n- **Token Validation**: Validate all authentication tokens for API access\n- **CORS Configuration**: Properly configure CORS for real-time endpoints\n\n## Performance Optimization\n\n### Database Optimization\n- **Indexing Strategy**: Optimize indexes for common query patterns\n- **Partitioning**: Consider partitioning large tables by date\n- **Connection Pooling**: Implement efficient database connection management\n- **Query Optimization**: Optimize complex timeline and analytics queries\n\n### Caching Strategy\n- **Template Caching**: Cache compiled notification templates\n- **User Preference Caching**: Cache frequently accessed preferences\n- **Status Caching**: Cache current order statuses for quick access\n- **CDN Integration**: Use CDN for static notification assets\n\n### Queue Management\n- **Priority Queues**: Implement priority-based notification processing\n- **Batch Processing**: Process notifications in batches for efficiency\n- **Dead Letter Queues**: Handle failed notifications appropriately\n- **Queue Monitoring**: Monitor queue depth and processing times\n\n### Real-time Optimization\n- **Connection Pooling**: Efficiently manage WebSocket connections\n- **Message Batching**: Batch real-time updates when appropriate\n- **Selective Updates**: Only send updates to interested clients\n- **Compression**: Compress real-time messages for bandwidth efficiency\n\n## Monitoring and Analytics\n\n### System Health Monitoring\n- **Notification Delivery Rates**: Track delivery success rates by channel\n- **Processing Latency**: Monitor time from status change to notification delivery\n- **Error Rates**: Track and alert on error rate increases\n- **Queue Performance**: Monitor queue depth and processing times\n- **Carrier API Health**: Monitor carrier API response times and availability\n\n### Business Analytics\n- **Customer Engagement**: Track notification open rates and click-through rates\n- **Status Distribution**: Analyze order status distribution and timing\n- **Channel Effectiveness**: Compare performance across notification channels\n- **Customer Satisfaction**: Correlate notification timing with satisfaction scores\n- **Operational Efficiency**: Track manual vs. automated status updates\n\n### Performance Metrics\n- **Response Times**: Monitor API response times for all endpoints\n- **Database Performance**: Track query execution times and connection usage\n- **Real-time Performance**: Monitor WebSocket connection counts and message latency\n- **Resource Utilization**: Monitor CPU, memory, and network usage\n\n## Internationalization\n\n### Multi-language Support\n- **Template Localization**: Support for Spanish, English, Romanian, and Russian\n- **Dynamic Content**: Localize status messages and carrier information\n- **Date/Time Formatting**: Format dates and times according to locale\n- **Timezone Handling**: Display times in customer's local timezone\n\n### Cultural Considerations\n- **Notification Timing**: Respect cultural differences in communication preferences\n- **Content Adaptation**: Adapt notification content for cultural context\n- **Carrier Integration**: Support local carriers for different regions\n- **Legal Compliance**: Ensure compliance with local notification regulations\n\n## Integration Points\n\n### Existing System Integration\n- **Order Management**: Integrate with existing order creation and management\n- **Email Service**: Extend current Resend-based email infrastructure\n- **Toast Notifications**: Integrate with existing toast notification system\n- **Authentication**: Use existing Supabase authentication system\n- **Database**: Extend current Supabase database schema\n\n### External Service Integration\n- **Shipping Carriers**: Integrate with FedEx, UPS, DHL, Correos Espaa APIs\n- **SMS Service**: Integrate with Twilio or similar SMS provider\n- **Push Notifications**: Integrate with Firebase Cloud Messaging\n- **Analytics**: Integrate with existing analytics infrastructure\n\n### Future Integration Possibilities\n- **Customer Service**: Integration with helpdesk systems\n- **Inventory Management**: Real-time inventory updates affecting delivery\n- **Marketing Automation**: Trigger marketing campaigns based on delivery status\n- **Business Intelligence**: Advanced analytics and reporting integration",
              "category": "archive"
            },
            {
              "path": "docs/specs/shipping-notifications/design.md",
              "name": "design.md",
              "size": 11139,
              "lastModified": "2025-12-04T10:27:33.910Z",
              "content": "# Shipping Notifications Design Document\n\n## Overview\n\nThe shipping notifications system provides automated, real-time updates to customers about their order shipping status. The system integrates with multiple shipping carriers through APIs and webhooks, processes status updates, and delivers personalized notifications via email and SMS based on customer preferences.\n\n## Architecture\n\n### High-Level Architecture\n\n```mermaid\ngraph TB\n    A[Shipping Carriers] -->|Webhooks/API| B[Webhook Handler]\n    B --> C[Event Processor]\n    C --> D[Notification Queue]\n    D --> E[Notification Engine]\n    E --> F[Email Service]\n    E --> G[SMS Service]\n    \n    H[Admin Panel] --> I[Template Manager]\n    I --> E\n    \n    J[Customer Portal] --> K[Preference Manager]\n    K --> L[Database]\n    \n    C --> L\n    E --> M[Analytics Logger]\n    M --> L\n    \n    N[Background Jobs] --> O[Carrier Polling]\n    O --> C\n```\n\n### System Components\n\n1. **Webhook Handler**: Receives real-time updates from shipping carriers\n2. **Event Processor**: Processes shipping events and determines notification actions\n3. **Notification Queue**: Manages notification delivery with retry logic\n4. **Notification Engine**: Renders templates and sends notifications\n5. **Template Manager**: Manages notification templates and content\n6. **Preference Manager**: Handles customer notification preferences\n7. **Analytics Logger**: Tracks notification performance and engagement\n8. **Background Jobs**: Handles carrier polling and maintenance tasks\n\n## Components and Interfaces\n\n### Database Schema\n\n#### Shipping Notifications Tables\n\n```sql\n-- Customer notification preferences\nCREATE TABLE notification_preferences (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID REFERENCES auth.users(id),\n    email_notifications JSONB DEFAULT '{\"shipped\": true, \"out_for_delivery\": true, \"delivered\": true, \"exception\": true}',\n    sms_notifications JSONB DEFAULT '{\"shipped\": false, \"out_for_delivery\": true, \"delivered\": true, \"exception\": true}',\n    phone_number TEXT,\n    phone_verified BOOLEAN DEFAULT false,\n    language_preference TEXT DEFAULT 'en',\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Shipping tracking information\nCREATE TABLE shipping_tracking (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    order_id UUID REFERENCES orders(id),\n    tracking_number TEXT NOT NULL,\n    carrier TEXT NOT NULL,\n    status TEXT NOT NULL,\n    status_details TEXT,\n    estimated_delivery TIMESTAMP WITH TIME ZONE,\n    actual_delivery TIMESTAMP WITH TIME ZONE,\n    delivery_location TEXT,\n    signature_required BOOLEAN DEFAULT false,\n    last_updated TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Notification log\nCREATE TABLE notification_log (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID REFERENCES auth.users(id),\n    order_id UUID REFERENCES orders(id),\n    tracking_id UUID REFERENCES shipping_tracking(id),\n    notification_type TEXT NOT NULL,\n    channel TEXT NOT NULL, -- 'email' or 'sms'\n    status TEXT NOT NULL, -- 'sent', 'failed', 'delivered', 'clicked'\n    template_id TEXT,\n    content_preview TEXT,\n    error_message TEXT,\n    sent_at TIMESTAMP WITH TIME ZONE,\n    delivered_at TIMESTAMP WITH TIME ZONE,\n    clicked_at TIMESTAMP WITH TIME ZONE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Notification templates\nCREATE TABLE notification_templates (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name TEXT NOT NULL,\n    type TEXT NOT NULL, -- 'shipped', 'out_for_delivery', 'delivered', 'exception'\n    channel TEXT NOT NULL, -- 'email' or 'sms'\n    language TEXT NOT NULL DEFAULT 'en',\n    subject TEXT,\n    content TEXT NOT NULL,\n    variables JSONB,\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Carrier webhook configurations\nCREATE TABLE carrier_webhooks (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    carrier TEXT NOT NULL,\n    webhook_url TEXT NOT NULL,\n    secret_key TEXT NOT NULL,\n    is_active BOOLEAN DEFAULT true,\n    last_received TIMESTAMP WITH TIME ZONE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n```\n\n### API Endpoints\n\n#### Webhook Endpoints\n- `POST /api/webhooks/shipping/fedex` - FedEx webhook handler\n- `POST /api/webhooks/shipping/ups` - UPS webhook handler  \n- `POST /api/webhooks/shipping/usps` - USPS webhook handler\n- `POST /api/webhooks/shipping/dhl` - DHL webhook handler\n\n#### Customer Preference Endpoints\n- `GET /api/notifications/preferences` - Get user notification preferences\n- `PUT /api/notifications/preferences` - Update notification preferences\n- `POST /api/notifications/verify-phone` - Verify phone number for SMS\n- `GET /api/notifications/history` - Get notification history\n\n#### Admin Management Endpoints\n- `GET /api/admin/notifications/templates` - List notification templates\n- `POST /api/admin/notifications/templates` - Create notification template\n- `PUT /api/admin/notifications/templates/:id` - Update template\n- `GET /api/admin/notifications/analytics` - Get notification analytics\n- `POST /api/admin/notifications/test` - Send test notification\n\n### Core Services\n\n#### NotificationService\n```typescript\ninterface NotificationService {\n  processShippingEvent(event: ShippingEvent): Promise<void>\n  sendNotification(notification: NotificationRequest): Promise<NotificationResult>\n  renderTemplate(templateId: string, variables: Record<string, any>): Promise<string>\n  getUserPreferences(userId: string): Promise<NotificationPreferences>\n  logNotification(log: NotificationLog): Promise<void>\n}\n```\n\n#### CarrierService\n```typescript\ninterface CarrierService {\n  validateWebhook(carrier: string, payload: any, signature: string): boolean\n  parseTrackingUpdate(carrier: string, payload: any): ShippingEvent\n  pollTrackingStatus(trackingNumber: string, carrier: string): Promise<ShippingEvent>\n  getTrackingUrl(trackingNumber: string, carrier: string): string\n}\n```\n\n#### TemplateService\n```typescript\ninterface TemplateService {\n  getTemplate(type: string, channel: string, language: string): Promise<NotificationTemplate>\n  renderTemplate(template: NotificationTemplate, variables: Record<string, any>): Promise<RenderedTemplate>\n  validateTemplate(template: NotificationTemplate): ValidationResult\n}\n```\n\n## Data Models\n\n### Core Types\n\n```typescript\ninterface ShippingEvent {\n  trackingNumber: string\n  carrier: string\n  status: ShippingStatus\n  statusDetails?: string\n  estimatedDelivery?: Date\n  actualDelivery?: Date\n  location?: string\n  signatureRequired?: boolean\n  timestamp: Date\n}\n\nenum ShippingStatus {\n  LABEL_CREATED = 'label_created',\n  PICKED_UP = 'picked_up',\n  IN_TRANSIT = 'in_transit',\n  OUT_FOR_DELIVERY = 'out_for_delivery',\n  DELIVERED = 'delivered',\n  EXCEPTION = 'exception',\n  RETURNED = 'returned'\n}\n\ninterface NotificationPreferences {\n  userId: string\n  emailNotifications: {\n    shipped: boolean\n    outForDelivery: boolean\n    delivered: boolean\n    exception: boolean\n  }\n  smsNotifications: {\n    shipped: boolean\n    outForDelivery: boolean\n    delivered: boolean\n    exception: boolean\n  }\n  phoneNumber?: string\n  phoneVerified: boolean\n  languagePreference: string\n}\n\ninterface NotificationRequest {\n  userId: string\n  orderId: string\n  trackingId: string\n  type: NotificationType\n  channel: NotificationChannel\n  templateVariables: Record<string, any>\n}\n\nenum NotificationType {\n  SHIPPED = 'shipped',\n  OUT_FOR_DELIVERY = 'out_for_delivery',\n  DELIVERED = 'delivered',\n  EXCEPTION = 'exception'\n}\n\nenum NotificationChannel {\n  EMAIL = 'email',\n  SMS = 'sms'\n}\n```\n\n## Error Handling\n\n### Webhook Processing Errors\n- **Invalid Signature**: Log security event, return 401\n- **Malformed Payload**: Log error, return 400 with details\n- **Unknown Carrier**: Log warning, return 404\n- **Processing Failure**: Log error, queue for retry, return 500\n\n### Notification Delivery Errors\n- **Invalid Email/Phone**: Mark as failed, disable future notifications\n- **Service Outage**: Queue for retry with exponential backoff\n- **Rate Limiting**: Implement circuit breaker, queue for later\n- **Template Errors**: Log error, use fallback template\n\n### Carrier API Errors\n- **Authentication Failure**: Alert admin, disable carrier integration\n- **Rate Limiting**: Implement backoff strategy\n- **Invalid Tracking Number**: Log warning, mark as invalid\n- **Service Unavailable**: Switch to polling mode\n\n### Retry Strategy\n```typescript\ninterface RetryConfig {\n  maxAttempts: number\n  initialDelay: number\n  maxDelay: number\n  backoffMultiplier: number\n  retryableErrors: string[]\n}\n\nconst notificationRetryConfig: RetryConfig = {\n  maxAttempts: 3,\n  initialDelay: 60000, // 1 minute\n  maxDelay: 3600000, // 1 hour\n  backoffMultiplier: 2,\n  retryableErrors: ['RATE_LIMIT', 'SERVICE_UNAVAILABLE', 'TIMEOUT']\n}\n```\n\n## Testing Strategy\n\n### Unit Tests\n- **Template Rendering**: Test variable substitution, error handling\n- **Preference Management**: Test CRUD operations, validation\n- **Webhook Validation**: Test signature verification, payload parsing\n- **Notification Logic**: Test delivery rules, deduplication\n\n### Integration Tests\n- **Carrier APIs**: Test webhook processing, polling mechanisms\n- **Email/SMS Services**: Test delivery with mock services\n- **Database Operations**: Test data persistence, migrations\n- **Queue Processing**: Test job execution, retry logic\n\n### End-to-End Tests\n- **Complete Notification Flow**: From shipping event to delivery\n- **Multi-language Support**: Test template rendering in different languages\n- **Preference Updates**: Test real-time preference changes\n- **Error Recovery**: Test system behavior during failures\n\n### Performance Tests\n- **High Volume Processing**: Test with thousands of simultaneous events\n- **Queue Performance**: Test job processing under load\n- **Database Performance**: Test query performance with large datasets\n- **Memory Usage**: Monitor memory consumption during processing\n\n### Monitoring and Alerting\n- **Notification Delivery Rates**: Alert if delivery rate drops below 95%\n- **Processing Latency**: Alert if events take longer than 5 minutes to process\n- **Error Rates**: Alert if error rate exceeds 1%\n- **Queue Depth**: Alert if queue depth exceeds threshold\n- **Carrier API Health**: Monitor API response times and error rates\n\n## Security Considerations\n\n### Webhook Security\n- Validate carrier webhook signatures using HMAC\n- Implement rate limiting on webhook endpoints\n- Log all webhook attempts for security monitoring\n- Use HTTPS only for webhook URLs\n\n### Data Protection\n- Encrypt sensitive data (phone numbers, API keys) at rest\n- Implement PII anonymization in logs\n- Use secure key management for carrier API credentials\n- Regular security audits of notification content\n\n### Access Control\n- Role-based access for admin functions\n- User authentication for preference management\n- API key rotation for carrier integrations\n- Audit logging for all administrative actions",
              "category": "reference"
            }
          ],
          "similarity": 0.8255706988743792,
          "recommendation": "Consider consolidating into design.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/fixes/ARCHITECTURAL_FIXES_SUMMARY.md",
              "name": "ARCHITECTURAL_FIXES_SUMMARY.md",
              "size": 18686,
              "lastModified": "2026-01-06T15:49:37.099Z",
              "content": "# Architectural Fixes Summary\n\n**Date:** 2024-11-24\n**Branch:** feat/checkout-smart-prepopulation\n**Status:**  Core architectural issues resolved\n\n---\n\n## Executive Summary\n\nFixed critical architectural issues identified by specialized analysis agents (architecture-strategist, pattern-recognition-specialist, data-integrity-guardian, code-simplicity-reviewer).\n\n**Issues Fixed:**\n1.  Duplicate conflicting Address type definitions\n2.  Broken encapsulation (removed readonly() wrappers)\n3.  Business logic in presentation component\n4.  Complex async coordination with watch() duplication\n\n**Results:**\n- Type-safe: Single source of truth for Address types\n- Encapsulated: Readonly wrappers restored with proper reactivity\n- Separation of Concerns: Business logic moved to parent/orchestrator\n- Simplified: Removed 30+ lines of duplicate coordination logic\n- Maintainable: Clear data flow from parent to child\n\n---\n\n## 1. Fixed Duplicate Address Type Definitions\n\n### Problem\n**4 conflicting Address type definitions** across codebase:\n- `types/checkout.ts` (OLD): `full_name`, `address`, string IDs\n- `types/address.ts` (NEW): `firstName`, `lastName`, `street`, number IDs\n- Local duplicates in components\n\n**28 files** imported the WRONG type, causing:\n- TypeScript compiles successfully but runtime failures\n- Code accessing `address.full_name` gets `undefined`\n- ID type mismatches (string vs number)\n\n### Solution\n\n#### types/checkout.ts\n```typescript\n/**\n * @deprecated Use Address from '~/types/address' instead\n * This type does not match the database schema and will be removed\n */\nexport interface OldAddress {\n  // ... old definition kept temporarily for backward compat\n}\n\n// Re-export correct Address type from unified source\nexport type { Address, AddressEntity, AddressFormData } from '~/types/address'\n```\n\n**Benefits:**\n- Single source of truth: `types/address.ts`\n- Automatic migration: Existing imports still work but get correct type\n- Type safety: TypeScript now enforces correct field names\n- Clear migration path: Deprecation warning guides developers\n\n#### Updated Imports\n\n**composables/useShippingAddress.ts** (line 14):\n```typescript\n// BEFORE:\nimport type { Address } from '~/types/checkout'\n\n// AFTER:\nimport type { Address } from '~/types/address'\n```\n\n**components/checkout/AddressForm.vue** (line 285):\n```typescript\n// BEFORE:\nimport type { Address } from '~/types/checkout'\n\n// AFTER:\nimport type { Address } from '~/types/address'\n```\n\n---\n\n## 2. Restored readonly() Wrappers with Proper Encapsulation\n\n### Problem\nRecent changes **removed readonly() wrappers** to \"fix reactivity issues\":\n\n```typescript\n// INCORRECT FIX:\nreturn {\n  shippingAddress,\n  savedAddresses,        //  Mutable! Consumers can break state\n  loading,               //  Mutable! Consumers can break loading state\n  error,                 //  Mutable! Consumers can break error state\n}\n```\n\n**Issues:**\n- Broke Single Responsibility Principle\n- Allowed direct state mutation, bypassing validation\n- Removed architectural intent documentation\n- Created potential for bugs\n\n**Reality:** readonly() doesn't break reactivity - it prevents direct mutation while still allowing reactive updates through composable methods.\n\n### Solution\n\n#### composables/useShippingAddress.ts (lines 207-226)\n```typescript\nreturn {\n  // Mutable: Components can update shipping address\n  shippingAddress,\n\n  // Readonly: Managed internally by composable\n  savedAddresses: readonly(savedAddresses),\n  defaultAddress,  // Already computed, naturally readonly\n  hasAddresses,     // Already computed, naturally readonly\n  loading: readonly(loading),\n  error: readonly(error),\n  isAddressValid,   // Already computed, naturally readonly\n\n  // Methods\n  loadSavedAddresses,\n  handleSaveAddress,\n  loadFromStore,\n  formatAddress,\n  reset\n}\n```\n\n**Benefits:**\n- Encapsulation restored: Internal state protected from direct mutation\n- Clear contract: Readonly communicates \"managed by composable\"\n- Type safety: TypeScript prevents `savedAddresses.value = []`\n- Vue best practices: Follows Vue 3 Composition API patterns\n\n**Comparison with other composables:**\n```typescript\n// useAuth.ts - CORRECT pattern (lines 251-260)\nreturn {\n  user: readonly(user),\n  isAuthenticated: readonly(isAuthenticated),\n  isLoading: readonly(isLoading)\n}\n```\n\n---\n\n## 3. Moved Auto-Selection Logic from Child to Parent\n\n### Problem\n**Business logic in presentation component** (AddressForm.vue):\n\n```typescript\n// BEFORE - CHILD COMPONENT (lines 454-486)\nonMounted(() => {\n  if (props.savedAddresses?.length) {\n    const defaultAddr = props.savedAddresses.find(addr => addr.isDefault)\n    selectedSavedAddressId.value = defaultAddr?.id || props.savedAddresses[0]?.id\n    if (selectedSavedAddressId.value) {\n      const address = props.savedAddresses.find(...)\n      if (address) {\n        selectSavedAddress(address)  // Emits updates\n      }\n    }\n  }\n})\n\nwatch(() => props.savedAddresses, (newAddresses) => {\n  // DUPLICATE of onMounted logic!\n  if (newAddresses?.length && selectedSavedAddressId.value === null) {\n    // ... same 14 lines again\n  }\n})\n```\n\n**Issues:**\n- Violated Smart/Dumb Component pattern\n- Business rule (\"select default address\") in presentation layer\n- Duplicated logic in both onMounted AND watch\n- Tight coupling between form and selection strategy\n- Hard to test selection logic in isolation\n- Reduced component reusability\n\n### Solution\n\n#### Moved to Parent (ShippingStep.vue lines 273-285)\n```typescript\n// Load saved addresses for authenticated users\nif (user.value) {\n  await loadSavedAddresses()\n\n  // Auto-select default address if no address is currently set\n  if (defaultAddress.value && !shippingAddress.value.street) {\n    shippingAddress.value = { ...defaultAddress.value }\n    // Load shipping methods since we have a valid address\n    if (shippingAddress.value.country && shippingAddress.value.postalCode) {\n      loadShippingMethods()\n    }\n  }\n}\n```\n\n#### Removed from Child (AddressForm.vue)\n-  Deleted 34 lines of auto-selection logic (onMounted + watch)\n-  Removed unused imports (`onMounted`, `watch`)\n\n**Benefits:**\n- Single Responsibility: Child handles display/input only\n- Testability: Business logic can be unit tested in parent\n- Reusability: AddressForm can be used in other contexts\n- Clarity: Selection strategy explicit in orchestrator component\n- Maintainability: Change selection rules in one place\n\n---\n\n## 4. Simplified Async Coordination\n\n### Problem\nComplex coordination between parent and child for async data loading:\n\n```typescript\n// Parent loads data\nawait loadSavedAddresses()\n\n// Child has onMounted that checks if data exists\nonMounted(() => {\n  if (props.savedAddresses?.length) {\n    // Auto-select logic\n  }\n})\n\n// Child ALSO has watch for late-arriving data\nwatch(() => props.savedAddresses, (newAddresses) => {\n  if (newAddresses?.length && selectedSavedAddressId.value === null) {\n    // Duplicate auto-select logic\n  }\n})\n```\n\n**Issues:**\n- Race conditions: Data might arrive before or after onMounted\n- Duplicate logic: onMounted and watch do the same thing\n- Complex mental model: Hard to reason about execution order\n- Over-engineering: watch() is band-aid for coordination problem\n\n### Solution\n\n**Parent controls everything** - no child coordination needed:\n\n```typescript\n// Parent (ShippingStep.vue)\nif (user.value) {\n  await loadSavedAddresses()  // Wait for data\n\n  // Then set address immediately\n  if (defaultAddress.value && !shippingAddress.value.street) {\n    shippingAddress.value = { ...defaultAddress.value }\n  }\n}\n\n// Pass pre-selected address to child\n<AddressForm :model-value=\"shippingAddress\" ... />\n```\n\n**Benefits:**\n- No race conditions: Data loaded before child renders\n- Single code path: No duplicate logic\n- Simpler mental model: Parent waits  decides  passes data  child displays\n- No watchers needed: Data flow is synchronous after async load\n\n---\n\n## 5. Code Reduction\n\n### Lines Removed\n\n| Location | Lines Removed | Reason |\n|----------|---------------|--------|\n| **AddressForm.vue** | 34 | Auto-selection logic (onMounted + watch) |\n| **AddressForm.vue** | 2 | Unused imports (onMounted, watch) |\n| **types/checkout.ts** | 0 | Kept but deprecated for migration |\n| **Total** | **36 lines** | Immediate reduction |\n\n### Additional Duplication Identified (Not Yet Fixed)\n\n| Code Block | Locations | Lines | Priority |\n|------------|-----------|-------|----------|\n| Address mapping | useShippingAddress.ts, addresses.post.ts | 32 | Medium |\n| Validation logic | AddressForm.vue, AddressFormModal.vue | 70 | Medium |\n| Auth helper | addresses.get.ts, addresses.post.ts | 24 | Low |\n\n**Potential total reduction:** ~160 lines when all duplication is eliminated.\n\n---\n\n## 6. Architecture Improvements\n\n### Before\n\n```\n\n   ShippingStep (Parent)             \n   - Loads addresses                 \n   - Passes raw list to child        \n   - No control over selection       \n\n                savedAddresses[]\n               \n\n   AddressForm (Child)               \n   - Watches for async data            Business logic\n   - Auto-selects default              in presentation\n   - Manages selection state           Tight coupling\n   - Emits selection changes         \n\n```\n\n### After\n\n```\n\n   ShippingStep (Parent)             \n   - Loads addresses                   Business logic\n   - Selects default address           in orchestrator\n   - Loads shipping methods          \n   - Passes selected address         \n\n                selectedAddress\n               \n\n   AddressForm (Child)               \n   - Displays address                  Pure presentation\n   - Validates input                   Single responsibility\n   - Emits changes                     Loose coupling\n\n```\n\n---\n\n## 7. Remaining Technical Debt\n\n### Identified but Not Yet Fixed\n\n1. **Address Mapping Duplication** (Medium Priority)\n   - Helper functions exist in `types/address.ts` but unused\n   - Manual mapping in composable and API endpoints\n   - Solution: Use `addressFromEntity()` and `addressToEntity()`\n\n2. **Validation Logic Duplication** (Medium Priority)\n   - 3 copies of same validation rules\n   - Comprehensive validation exists in `types/address.ts`\n   - Solution: Use `validateAddress()` from types/address.ts\n\n3. **Unused Code** (Low Priority)\n   - `loadFromStore()` never called\n   - `reset()` unclear when needed\n   - `formatAddress()` has duplicate in component\n   - Solution: Delete unused methods\n\n4. **Auth Helper Duplication** (Low Priority)\n   - `requireAuthenticatedUser()` in both GET and POST routes\n   - Solution: Extract to `server/utils/auth.ts`\n\n### Estimated Effort\n- Fix mapping duplication: 30 minutes\n- Fix validation duplication: 1 hour\n- Remove unused code: 30 minutes\n- Extract auth helper: 15 minutes\n- **Total:** ~2.5 hours\n\n---\n\n## 8. Testing Recommendations\n\n### Manual Testing Required\n\n1. **Type Safety Verification**\n   ```typescript\n   // Should NOT compile (prevents wrong field usage)\n   const addr: Address = {\n     full_name: 'Test',  //  Type error\n     address: '123 St'   //  Type error\n   }\n   ```\n\n2. **Readonly Enforcement**\n   ```typescript\n   const { savedAddresses } = useShippingAddress()\n   savedAddresses.value = []  //  Should be TypeScript error\n   ```\n\n3. **Auto-Selection Flow**\n   - Log in as user with saved addresses\n   - Add product to cart\n   - Go to checkout\n   - **Verify:** Default address is auto-selected\n   - **Verify:** Shipping methods load automatically\n   - **Verify:** Can switch to different saved address\n   - **Verify:** Can click \"Use New Address\" to show manual form\n\n4. **Guest Checkout**\n   - **Verify:** Manual form shows for guest users\n   - **Verify:** No auto-selection attempted\n   - **Verify:** Validation works correctly\n\n### Automated Testing\n\n```typescript\n// tests/unit/composables/useShippingAddress.test.ts\ndescribe('useShippingAddress', () => {\n  it('exports readonly refs for internal state', () => {\n    const { savedAddresses, loading } = useShippingAddress()\n    expect(isReadonly(savedAddresses)).toBe(true)\n    expect(isReadonly(loading)).toBe(true)\n  })\n\n  it('exports mutable ref for shipping address', () => {\n    const { shippingAddress } = useShippingAddress()\n    expect(isReadonly(shippingAddress)).toBe(false)\n  })\n})\n\n// tests/e2e/checkout-address-selection.spec.ts\ntest('auto-selects default address for logged-in user', async ({ page }) => {\n  await loginAsUser(page)\n  await addProductToCart(page)\n  await page.goto('/checkout')\n\n  // Address should be pre-filled\n  await expect(page.locator('input[name=\"street\"]')).toHaveValue(/\\w+/)\n\n  // Shipping methods should load automatically\n  await expect(page.locator('.shipping-method')).toBeVisible()\n})\n```\n\n---\n\n## 9. Migration Path for Other Files\n\n### Files Still Using Wrong Import (22 remaining)\n\n**Priority 1 (User-facing):**\n- `components/profile/AddressFormModal.vue`\n- `stores/checkout/session.ts`\n- `pages/account/profile.vue`\n\n**Priority 2 (Checkout flow):**\n- All files in `stores/checkout/` directory\n- All files in `components/checkout/` directory\n\n**Priority 3 (Less critical):**\n- Test files\n- Utility files\n\n### Migration Steps\n\n1. **Search and replace** in each file:\n   ```typescript\n   // Find:\n   import type { Address } from '~/types/checkout'\n\n   // Replace with:\n   import type { Address } from '~/types/address'\n   ```\n\n2. **Test file** after each change\n\n3. **Commit incrementally** - one file or small group per commit\n\n4. **Monitor for errors** - watch TypeScript compiler\n\n5. **After all files migrated** - Remove `OldAddress` from types/checkout.ts\n\n---\n\n## 10. Key Learnings\n\n### What Went Wrong\n\n1. **Quick fixes compound:** Removing readonly() to \"fix reactivity\" actually created more problems\n2. **Type duplication:** Creating new types instead of refactoring existing ones\n3. **Child component logic:** Adding business logic to presentation components \"because it's convenient\"\n4. **Watch as band-aid:** Using watchers to coordinate async loading instead of proper orchestration\n\n### What Went Right\n\n1. **Agent analysis:** Specialized agents caught architectural issues human review missed\n2. **Type system:** TypeScript caught issues after types were unified\n3. **Existing helpers:** types/address.ts already had all necessary utilities\n4. **Incremental fixes:** Small, focused changes are easier to test and review\n\n### Best Practices Reinforced\n\n1. **Single Source of Truth:** One canonical type definition\n2. **Readonly by Default:** Only make mutable what consumers need to mutate\n3. **Smart/Dumb Components:** Keep business logic in parents/composables\n4. **Sync after Async:** Wait for async data, then pass synchronously to children\n5. **Use Existing Utilities:** Don't reinvent - use helpers that already exist\n\n---\n\n## 11. Impact Assessment\n\n### Code Quality\n\n**Before:**\n-  4 conflicting type definitions\n-  28 files using wrong types\n-  False type safety (compiles but fails at runtime)\n-  Business logic scattered across components\n-  Complex async coordination\n-  103+ lines of duplication\n\n**After:**\n-  1 canonical type definition\n-  Type re-export for smooth migration\n-  True type safety (catches errors at compile time)\n-  Business logic in orchestrator layer\n-  Simple synchronous data flow\n-  36 lines removed immediately\n\n### Maintainability\n\n| Metric | Before | After | Improvement |\n|--------|--------|-------|-------------|\n| Type definitions | 4 | 1 | -75% |\n| Files with wrong import | 28 | 2 | -93% |\n| Lines of coordination code | 34 | 11 | -68% |\n| Async watchers | 1 | 0 | -100% |\n| Encapsulation violations | 5 | 0 | -100% |\n\n### Developer Experience\n\n**Before:**\n-  \"Which Address type should I use?\"\n-  \"Why is readonly() removed?\"\n-  \"Where does auto-selection happen?\"\n-  \"Why do we have onMounted AND watch?\"\n\n**After:**\n-  Import from `types/address.ts`\n-  Composable manages internal state with readonly()\n-  Parent orchestrates auto-selection\n-  Simple synchronous data flow\n\n---\n\n## 12. Conclusion\n\n**Status:** Core architectural issues resolved \n\n**Immediate Benefits:**\n- Type-safe codebase with single source of truth\n- Proper encapsulation with readonly() wrappers\n- Clear separation of concerns (parent orchestrates, child displays)\n- Simplified data flow (no complex async coordination)\n\n**Next Steps:**\n1. Manual testing of checkout flow\n2. Incremental migration of remaining 22 files\n3. Remove code duplication (mapping, validation, auth helpers)\n4. Add automated tests for type safety and readonly enforcement\n\n**Timeline:**\n-  **Today:** Core fixes implemented (3 hours)\n-  **This week:** Manual testing and verification (1 hour)\n-  **Next week:** Migrate remaining files (2-3 hours)\n-  **Following week:** Remove duplication (2-3 hours)\n\n---\n\n## Files Modified\n\n**types/checkout.ts:**\n- Deprecated old Address definition\n- Re-exported correct types from types/address.ts\n\n**composables/useShippingAddress.ts:**\n- Updated import to use types/address.ts\n- Restored readonly() wrappers for internal state\n\n**components/checkout/AddressForm.vue:**\n- Updated import to use types/address.ts\n- Removed auto-selection logic (onMounted + watch)\n- Removed unused imports\n\n**components/checkout/ShippingStep.vue:**\n- Added auto-selection logic after loading addresses\n- Auto-loads shipping methods when default address selected\n\n---\n\n**Reviewed by:** Architecture Analysis Agents\n**Approved for:** Production deployment\n**Risk Level:** LOW (maintains backward compatibility, gradual migration path)",
              "category": "archive"
            },
            {
              "path": "docs/archive/fixes/FINAL_OPTIMIZATION_SUMMARY.md",
              "name": "FINAL_OPTIMIZATION_SUMMARY.md",
              "size": 10600,
              "lastModified": "2026-01-06T15:49:37.100Z",
              "content": "# Final Optimization Summary\n\n**Date:** 2024-11-24\n**Branch:** feat/checkout-smart-prepopulation\n**Status:**  All optimizations complete\n\n---\n\n## Overview\n\nCompleted comprehensive architectural refactoring based on multi-agent analysis (architecture-strategist, pattern-recognition-specialist, data-integrity-guardian, code-simplicity-reviewer).\n\n**Total Time:** ~2 hours\n**Lines Removed:** 70+ lines\n**Files Modified:** 5 core files\n**Type Safety:** Fully restored\n**Architecture:** Properly layered\n\n---\n\n## Optimizations Completed\n\n### 1.  Unified Type System (CRITICAL)\n\n**Problem:** 4 conflicting Address type definitions causing runtime errors\n\n**Solution:**\n- Deprecated old `Address` in `types/checkout.ts`\n- Re-exported correct type from `types/address.ts`\n- Updated imports in `composables/useShippingAddress.ts` and `components/checkout/AddressForm.vue`\n\n**Impact:**\n-  Single source of truth\n-  Type-safe field access\n-  Clear migration path for 22 remaining files\n\n---\n\n### 2.  Restored Proper Encapsulation (CRITICAL)\n\n**Problem:** Removed readonly() wrappers broke architectural boundaries\n\n**Solution:**\n- Restored `readonly()` for `savedAddresses`, `loading`, `error`\n- Kept `shippingAddress` mutable (user data)\n- Computed properties naturally readonly\n\n**Impact:**\n-  State protected from direct mutation\n-  Clear contract: \"composable manages this\"\n-  Follows Vue 3 best practices\n\n---\n\n### 3.  Fixed Separation of Concerns (HIGH)\n\n**Problem:** 34 lines of business logic in presentation component\n\n**Solution:**\n- Moved auto-selection from `AddressForm.vue` (child) to `ShippingStep.vue` (parent)\n- Removed `onMounted()` and `watch()` coordination\n- Child component now pure presentation\n\n**Impact:**\n-  Single responsibility restored\n-  36 lines removed\n-  Simpler testing\n-  Better reusability\n\n---\n\n### 4.  Simplified Async Coordination (MEDIUM)\n\n**Problem:** Complex watch() + onMounted() duplication\n\n**Solution:**\n- Parent waits for data with `await`\n- Parent selects address synchronously\n- Passes selected address to child\n- No watchers needed\n\n**Impact:**\n-  No race conditions\n-  Single code path\n-  Simpler mental model\n\n---\n\n### 5.  Eliminated Code Duplication (MEDIUM)\n\n**Problem:** Duplicate mapping functions in 3 places\n\n**Solution:**\n- Import `addressFromEntity` helper from `types/address.ts`\n- Replaced manual mapping in `composables/useShippingAddress.ts`\n- Replaced manual mapping in `server/api/checkout/addresses.post.ts`\n- Removed duplicate `mapAddressFromApi` and `mapAddressesFromApi` functions\n\n**Impact:**\n-  28 lines removed\n-  Single implementation\n-  Easier maintenance\n\n---\n\n### 6.  Removed Unused Code (LOW)\n\n**Problem:** Dead code and YAGNI violations\n\n**Solution:**\n- Removed `formatAddress()` (duplicate of `types/address.ts` version)\n- Removed `reset()` (never called)\n- Kept `loadFromStore()` (used in ShippingStep.vue)\n\n**Impact:**\n-  34 lines removed\n-  Cleaner API surface\n-  Less cognitive load\n\n---\n\n## Code Reduction Summary\n\n| File | Lines Removed | Type |\n|------|---------------|------|\n| `composables/useShippingAddress.ts` | 48 | Duplication + Unused |\n| `components/checkout/AddressForm.vue` | 36 | Business logic |\n| `server/api/checkout/addresses.post.ts` | 13 | Duplication |\n| **Total** | **97 lines** | **Code reduction** |\n\n---\n\n## Files Modified\n\n### 1. types/checkout.ts\n```typescript\n// Deprecated old Address type\nexport interface OldAddress { ... }\n\n// Re-export correct type\nexport type { Address, AddressEntity, AddressFormData } from '~/types/address'\n```\n\n### 2. composables/useShippingAddress.ts\n```typescript\n// Added import\nimport { addressFromEntity } from '~/types/address'\n\n// Removed duplicate mapping functions (28 lines)\n// Removed formatAddress (13 lines)\n// Removed reset (17 lines)\n\n// Restored readonly wrappers\nreturn {\n  shippingAddress,\n  savedAddresses: readonly(savedAddresses),\n  loading: readonly(loading),\n  error: readonly(error),\n  // ...\n}\n```\n\n### 3. components/checkout/AddressForm.vue\n```typescript\n// Updated import\nimport type { Address } from '~/types/address'\n\n// Removed auto-selection logic (34 lines)\n// Removed unused imports (onMounted, watch)\n```\n\n### 4. components/checkout/ShippingStep.vue\n```typescript\n// Added auto-selection after loading addresses\nif (user.value) {\n  await loadSavedAddresses()\n\n  if (defaultAddress.value && !shippingAddress.value.street) {\n    shippingAddress.value = { ...defaultAddress.value }\n    if (shippingAddress.value.country && shippingAddress.value.postalCode) {\n      loadShippingMethods()\n    }\n  }\n}\n```\n\n### 5. server/api/checkout/addresses.post.ts\n```typescript\n// Added import\nimport { addressFromEntity } from '~/types/address'\n\n// Replaced manual mapping\nreturn {\n  success: true,\n  address: addressFromEntity(address)  // Was 13 lines\n}\n```\n\n---\n\n## Architecture Before vs After\n\n### Before\n```\n 4 conflicting type definitions\n 28 files using wrong types\n No readonly protection\n Business logic in child component\n Complex async coordination (watch + onMounted)\n 97 lines of duplicated/unused code\n```\n\n### After\n```\n 1 canonical type definition\n 2 files using correct type (others migrated gradually)\n Proper encapsulation with readonly\n Business logic in parent orchestrator\n Simple synchronous data flow\n Minimal, clean code\n```\n\n---\n\n## Quality Metrics\n\n| Metric | Before | After | Improvement |\n|--------|--------|-------|-------------|\n| Type definitions | 4 | 1 | -75% |\n| Wrong imports | 28 | 2 | -93% |\n| Business logic in child | 34 lines | 0 | -100% |\n| Duplicate mapping | 3 copies | 1 | -67% |\n| Async watchers | 1 | 0 | -100% |\n| Unused methods | 2 | 0 | -100% |\n| Total lines | ~670 | ~573 | -14.5% |\n\n---\n\n## Testing Status\n\n### Dev Server\n No TypeScript errors\n No runtime errors\n Hot module replacement working\n\n### Manual Testing Required\n\n**Test Plan:**\n1. **Type Safety**\n   - TypeScript compiler should prevent wrong field names\n   - Should show errors for readonly mutations\n\n2. **Checkout Flow (with saved addresses)**\n   - Log in as user with saved addresses\n   - Add product to cart\n   - Navigate to `/checkout`\n   - **Verify:** Default address auto-selected\n   - **Verify:** Shipping methods load automatically\n   - **Verify:** Can switch to different saved address\n   - **Verify:** \"Use New Address\" shows manual form\n\n3. **Checkout Flow (guest user)**\n   - Log out\n   - Add product to cart\n   - Navigate to `/checkout`\n   - **Verify:** Manual form displays\n   - **Verify:** Can fill in new address\n   - **Verify:** Validation works\n\n4. **Address Management**\n   - Go to `/account/profile`\n   - **Verify:** Can add new address\n   - **Verify:** Can edit existing address\n   - **Verify:** Can set default address\n\n---\n\n## Known Remaining Work\n\n### Optional (Low Priority)\n\n1. **Migrate Remaining 22 Files** (~2-3 hours)\n   - Update imports from `types/checkout` to `types/address`\n   - Test each file after migration\n   - Priority: User-facing files first\n\n2. **Add E2E Tests** (~2 hours)\n   - Test auto-selection flow\n   - Test address management\n   - Test type safety at runtime\n\n3. **Remove Old Type Definition** (~15 min)\n   - After all files migrated\n   - Delete `OldAddress` from `types/checkout.ts`\n\n---\n\n## Risk Assessment\n\n**Production Readiness:**  HIGH\n\n**Risks Mitigated:**\n-  Type safety violations\n-  State mutation bugs\n-  Maintenance complexity\n-  Code duplication issues\n\n**Remaining Risks:**\n-  LOW: 22 files still use re-exported type (works correctly, just migration pending)\n-  LOW: No E2E test coverage yet (manual testing required)\n\n**Deployment Strategy:**\n1. Deploy current changes (all core fixes complete)\n2. Monitor for issues in production\n3. Gradually migrate remaining 22 files in follow-up PRs\n4. Add E2E tests in parallel\n\n---\n\n## Key Learnings\n\n### What Worked Well\n\n1. **Multi-Agent Analysis**\n   - Caught architectural issues human review missed\n   - Provided specific line numbers and examples\n   - Identified 4 severity levels accurately\n\n2. **Incremental Refactoring**\n   - Small, focused changes\n   - Test after each modification\n   - Easy to review and rollback\n\n3. **Existing Helper Functions**\n   - `types/address.ts` already had everything needed\n   - Just needed to import and use them\n   - Don't reinvent the wheel\n\n### What We Learned\n\n1. **Quick Fixes Compound**\n   - Removing readonly() seemed fast but created debt\n   - Always fix root cause, not symptoms\n\n2. **Type System Discipline**\n   - One canonical type definition\n   - Enforce with deprecation warnings\n   - Gradual migration safer than big bang\n\n3. **Smart/Dumb Components**\n   - Keep business logic in parents/composables\n   - Children should be pure presentation\n   - Makes testing and reuse easier\n\n---\n\n## Documentation Created\n\n1. **CHECKOUT_FIXES_SUMMARY.md** - Original fixes for readonly() removal\n2. **ARCHITECTURAL_FIXES_SUMMARY.md** - Comprehensive 450+ line architectural analysis\n3. **FINAL_OPTIMIZATION_SUMMARY.md** (this file) - Complete optimization summary\n\n---\n\n## Next Steps\n\n### Immediate (Now)\n1.  All code changes complete\n2.  **Run visual tests** (next task)\n3.  Manual testing of checkout flow\n4.  Commit changes with detailed message\n\n### Short Term (This Week)\n1. Monitor production for any issues\n2. Migrate high-priority files (profile, stores)\n3. Add E2E test coverage\n\n### Long Term (Next Sprint)\n1. Complete migration of all 22 files\n2. Remove deprecated `OldAddress` type\n3. Add TypeScript strict mode checks\n4. Document patterns in CLAUDE.md\n\n---\n\n## Success Criteria\n\n###  Achieved\n- [x] Type system unified\n- [x] Encapsulation restored\n- [x] Business logic properly layered\n- [x] Code duplication eliminated\n- [x] Unused code removed\n- [x] Dev server runs without errors\n- [x] HMR working correctly\n\n###  Pending\n- [ ] Visual tests pass\n- [ ] Manual testing complete\n- [ ] Changes committed\n- [ ] PR created and reviewed\n- [ ] Deployed to production\n\n---\n\n## Conclusion\n\nSuccessfully completed comprehensive architectural refactoring that:\n- Fixes critical type safety issues\n- Restores proper architectural boundaries\n- Eliminates 97+ lines of duplicate/unused code\n- Simplifies data flow and coordination\n- Maintains backward compatibility\n- Provides clear migration path\n\n**Ready for production deployment.**\n\n---\n\n**Last Updated:** 2024-11-24\n**Reviewed By:** Multi-agent analysis system\n**Approved For:** Production deployment\n**Risk Level:** LOW (backward compatible, incremental changes)",
              "category": "archive"
            }
          ],
          "similarity": 0.8415565791777954,
          "recommendation": "Consider consolidating into FINAL_OPTIMIZATION_SUMMARY.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/meta-old/DOCUMENTATION_UPDATES_LOG.md",
              "name": "DOCUMENTATION_UPDATES_LOG.md",
              "size": 6074,
              "lastModified": "2026-01-06T15:49:37.102Z",
              "content": "# Documentation Updates Log\n\nThis file tracks major documentation updates to the Moldova Direct project.\n\n## November 1, 2025 - Comprehensive Documentation Update\n\n### Summary\nMajor documentation update reflecting recent code changes, test coverage improvements, and comprehensive code review findings.\n\n### Files Updated\n\n#### Core Documentation\n1. **README.md**\n   - Added visual test coverage statistics (85%)\n   - Updated \"In Progress\" and \"Known Issues\" sections\n   - Enhanced testing documentation\n   - Added references to new analysis documents\n\n2. **QUICK_START_GUIDE.md** (NEW)\n   - Created comprehensive quick start guide\n   - 5-minute setup instructions\n   - Common tasks and troubleshooting\n   - Key documentation links\n\n3. **docs/DOCUMENTATION_UPDATE_2025-11-01.md** (NEW)\n   - Detailed summary of all documentation changes\n   - Metrics and statistics\n   - Action items for development team\n\n#### Project Status\n4. **.kiro/PROJECT_STATUS.md**\n   - Updated active work items with security priorities\n   - Added \"Critical Action Items\" section\n   - Updated project health status\n   - Reflected recent test coverage achievements\n\n5. **.kiro/DOCUMENTATION_UPDATES_LOG.md** (NEW - this file)\n   - Created log to track documentation changes over time\n\n#### Documentation Index\n6. **docs/README.md**\n   - Added November 2025 updates\n   - Added references to new documentation files\n   - Enhanced navigation structure\n\n7. **docs/CHANGELOG.md**\n   - Added November 2025 section\n   - Documented visual test coverage implementation\n   - Included code review findings\n   - Listed bug fixes and improvements\n\n### New Documentation Files\n\n1. **TEST_COVERAGE_ANALYSIS.md** (October 30, 2025)\n   - Comprehensive test coverage analysis\n   - 47 pages analyzed\n   - Gap identification and priorities\n   - Implementation recommendations\n\n2. **TEST_COVERAGE_IMPLEMENTATION.md** (October 31, 2025)\n   - Visual test implementation summary\n   - 47 new tests documented\n   - Bug fixes and improvements\n   - Running instructions and best practices\n\n3. **CODE_REVIEW_2025.md** (October 30, 2025)\n   - Deep code review with security analysis\n   - Health score: 7.5/10\n   - Prioritized recommendations\n   - Technical debt summary\n\n### Key Metrics Updated\n\n#### Test Coverage\n- Visual coverage: 19%  85%\n- New visual tests: 47\n- Pages covered: 40/47\n\n#### Code Quality\n- Products page: 915 lines (needs refactoring)\n- Auth store: 1,172 lines (needs splitting)\n- Code removed (Oct 2025): ~850 lines\n\n#### Security\n- Critical issues identified: 3\n- High priority issues: 4\n- Immediate action items: 3\n\n### Impact\n\n#### For Developers\n- Clear understanding of current project state\n- Prioritized action items\n- Comprehensive test coverage visibility\n- Security issues documented\n\n#### For Project Management\n- Updated project health status\n- Clear roadmap for improvements\n- Risk assessment documented\n- Effort estimates provided\n\n#### For QA/Testing\n- Detailed test coverage reports\n- Visual regression test suite documented\n- Testing best practices established\n- Gap analysis completed\n\n### Next Steps\n\n1. **Immediate (This Week)**\n   - Re-enable admin authentication middleware\n   - Implement rate limiting\n   - Add server-side price verification\n\n2. **Short-term (Next 2 Weeks)**\n   - Refactor products page\n   - Split auth store\n   - Add API authorization checks\n\n3. **Medium-term (Next Month)**\n   - Expand unit test coverage\n   - Improve mobile UX\n   - Implement cart encryption\n\n### Related Pull Requests\n- (To be added when changes are committed)\n\n### Review Status\n-  Documentation updated\n-  Cross-references verified\n-  Metrics validated\n-  Action items prioritized\n-  Awaiting team review\n\n---\n\n## October 12, 2025 - Code Cleanup Documentation\n\n### Summary\nDocumented major code cleanup removing PayPal integration and unused features.\n\n### Files Updated\n1. **README.md** - Updated payment processing information\n2. **docs/CHANGELOG.md** - Added October 2025 cleanup entry\n3. **docs/CHECKOUT_FLOW.md** - Reflected Stripe-only payment\n4. **.env.example** - Removed PayPal variables\n\n### Impact\n- ~850 lines of code removed\n- Cleaner dependency tree\n- Focused payment processing (Stripe only)\n\n---\n\n## September 8, 2025 - Cart System Documentation\n\n### Summary\nComprehensive documentation of cart system architecture and analytics.\n\n### Files Updated\n1. **docs/CART_SYSTEM_ARCHITECTURE.md** - Cart technical architecture\n2. **docs/CART_ANALYTICS.md** - Analytics system documentation\n3. **docs/AUTHENTICATION_ARCHITECTURE.md** - Auth system details\n4. **README.md** - Updated with cart features\n\n### Impact\n- Better understanding of cart system\n- Analytics implementation documented\n- Authentication patterns established\n\n---\n\n## August 31, 2025 - shadcn-vue Migration\n\n### Summary\nDocumented migration to shadcn-vue UI component library.\n\n### Files Updated\n1. **docs/SHADCN_MIGRATION.md** - Migration guide\n2. **README.md** - Updated tech stack\n3. **.kiro/PROJECT_STATUS.md** - Reflected UI migration\n\n### Impact\n- Modern UI component system\n- Improved developer experience\n- Better accessibility\n\n---\n\n## Documentation Standards\n\n### When to Update\n1. **After major features** - Update README, CHANGELOG, PROJECT_STATUS\n2. **After code reviews** - Document findings and action items\n3. **After test additions** - Update test coverage documentation\n4. **Monthly** - Review and update PROJECT_STATUS\n5. **Before releases** - Comprehensive documentation review\n\n### What to Include\n1. **Summary** - Brief overview of changes\n2. **Files Updated** - List of modified files\n3. **Impact** - How changes affect the project\n4. **Metrics** - Quantifiable improvements\n5. **Next Steps** - Action items and priorities\n\n### Format Standards\n- Use Markdown for all documentation\n- Include dates in YYYY-MM-DD format\n- Use emoji indicators consistently (, , , )\n- Cross-reference related documents\n- Include code examples where relevant\n\n---\n\n**Maintained by:** Development Team\n**Last Updated:** November 1, 2025\n**Next Review:** After critical security fixes\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/meta-old/DOCUMENTATION_UPDATE_2025-11-01.md",
              "name": "DOCUMENTATION_UPDATE_2025-11-01.md",
              "size": 6552,
              "lastModified": "2026-01-06T15:49:37.102Z",
              "content": "# Documentation Update Summary - November 1, 2025\n\n## Overview\n\nThis document summarizes the comprehensive documentation updates made on November 1, 2025, reflecting recent code changes, test coverage improvements, and code review findings.\n\n## Files Updated\n\n### 1. README.md (Main Project Documentation)\n**Changes:**\n- Added visual test coverage statistics (85% coverage achieved)\n- Updated \"In Progress\" section with security hardening priorities\n- Added \"Known Issues\" section highlighting critical findings from code review\n- Updated \"Recent Changes\" to include November 2025 updates\n- Enhanced testing section with visual test coverage details\n- Added references to new documentation files (TEST_COVERAGE_ANALYSIS.md, TEST_COVERAGE_IMPLEMENTATION.md, CODE_REVIEW_2025.md)\n\n**Key Additions:**\n- Visual test coverage: 40/47 pages (85%)\n- 47 new visual regression tests added\n- Critical security issues documented\n- Code refactoring priorities identified\n\n### 2. docs/CHANGELOG.md\n**Changes:**\n- Added November 2025 section with two major updates:\n  - Visual Test Coverage Implementation (November 1, 2025)\n  - Deep Code Review (October 30, 2025)\n- Documented 47 new visual tests across admin, account, and checkout flows\n- Listed bug fixes (dashboard routing, authentication fixtures)\n- Included key findings from code review\n- Added recommendations for immediate, short-term, and long-term improvements\n\n**Key Additions:**\n- Coverage improvement: 19%  85%\n- Critical security findings documented\n- Technical debt identified and prioritized\n\n### 3. docs/README.md (Documentation Index)\n**Changes:**\n- Updated \"Recent Updates\" section with November 2025 entries\n- Added references to new documentation files\n- Maintained chronological order of updates\n\n**Key Additions:**\n- Visual test coverage implementation (Nov 1, 2025)\n- Deep code review completion (Oct 30, 2025)\n- Test coverage analysis (Oct 30, 2025)\n\n### 4. .kiro/PROJECT_STATUS.md\n**Changes:**\n- Updated \"Active Work Items\" with prioritized security and development tasks\n- Added \"Recent Updates (November 2025)\" section\n- Created new \"Critical Action Items\" section with immediate priorities\n- Updated project status and health indicators\n- Changed last updated date to 2025-11-01\n\n**Key Additions:**\n- Critical security items requiring immediate attention\n- Code quality improvements prioritized\n- Testing expansion roadmap\n- Status changed to \"Action Required\" with \"Good\" health rating\n\n## New Documentation Files Referenced\n\n### 1. TEST_COVERAGE_ANALYSIS.md\n**Purpose:** Comprehensive analysis of test coverage across all pages\n**Content:**\n- Executive summary of coverage statistics\n- Detailed breakdown by page type\n- Identification of gaps and priorities\n- Recommendations for test implementation\n- Metrics and estimated effort\n\n### 2. TEST_COVERAGE_IMPLEMENTATION.md\n**Purpose:** Summary of visual test implementation work\n**Content:**\n- Overview of new test files created\n- Pages tested and features implemented\n- Bug fixes applied\n- Test statistics and running instructions\n- Best practices and next steps\n\n### 3. CODE_REVIEW_2025.md\n**Purpose:** Deep code review with security and architecture analysis\n**Content:**\n- Executive summary with health score (7.5/10)\n- Part 1: User-facing code review\n- Part 2: Admin-facing code review\n- Prioritized recommendations (Critical, High, Medium, Low)\n- Technical debt summary\n- Estimated effort for improvements\n\n## Key Metrics\n\n### Test Coverage\n- **Before:** 9 pages with visual tests (19%)\n- **After:** 40 pages with visual tests (85%)\n- **New Tests:** 47 visual regression tests\n- **Remaining:** 7 low-priority dev/test pages (15%)\n\n### Code Quality\n- **Products Page:** 915 lines (needs refactoring to <400)\n- **Auth Store:** 1,172 lines (needs splitting to <500)\n- **Code Removed (Oct 2025):** ~850 lines (PayPal, unused composables)\n\n### Security Findings\n- **Critical Issues:** 3 (disabled middleware, missing rate limiting, client-side pricing)\n- **High Priority Issues:** 4 (input sanitization, localStorage security, etc.)\n- **Medium Priority Issues:** Multiple (error handling, mobile UX, etc.)\n\n## Action Items for Development Team\n\n### Immediate (This Week)\n1.  Documentation updated\n2.  Re-enable admin authentication middleware\n3.  Implement rate limiting for auth endpoints\n4.  Add server-side price verification\n\n### Short-term (Next 2 Weeks)\n1. Refactor products page (split into smaller components)\n2. Split auth store into focused modules\n3. Add API-level authorization checks\n4. Implement cart data encryption\n\n### Medium-term (Next Month)\n1. Expand unit test coverage to 80%\n2. Add comprehensive E2E tests for auth flows\n3. Improve mobile UX consistency\n4. Implement global error boundary\n\n## Documentation Standards Applied\n\n### Consistency\n- All dates in YYYY-MM-DD format\n- Consistent use of emoji indicators (, , , )\n- Standardized section headers across files\n- Cross-references between related documents\n\n### Completeness\n- Executive summaries for quick scanning\n- Detailed breakdowns for deep dives\n- Metrics and statistics for tracking progress\n- Action items with priorities and timelines\n\n### Maintainability\n- Clear last updated dates\n- Version history preserved\n- References to source files\n- Estimated effort for tasks\n\n## Next Documentation Updates\n\n### When to Update\n1. **After security fixes:** Update status from \"Action Required\" to \"On Track\"\n2. **After refactoring:** Update code quality metrics\n3. **After test expansion:** Update coverage statistics\n4. **Monthly:** Review and update PROJECT_STATUS.md\n\n### What to Update\n1. README.md - Current status and recent changes\n2. CHANGELOG.md - New entries for significant changes\n3. PROJECT_STATUS.md - Active work items and health status\n4. Test coverage docs - As new tests are added\n\n## References\n\n### Updated Files\n- [README.md](../README.md)\n- [docs/CHANGELOG.md](./CHANGELOG.md)\n- [docs/README.md](./README.md)\n- [.kiro/PROJECT_STATUS.md](../.kiro/PROJECT_STATUS.md)\n\n### New Documentation\n- [TEST_COVERAGE_ANALYSIS.md](../TEST_COVERAGE_ANALYSIS.md)\n- [TEST_COVERAGE_IMPLEMENTATION.md](../TEST_COVERAGE_IMPLEMENTATION.md)\n- [CODE_REVIEW_2025.md](../CODE_REVIEW_2025.md)\n\n### Related Documentation\n- [.kiro/ROADMAP.md](../.kiro/ROADMAP.md)\n- [.kiro/PROGRESS.md](../.kiro/PROGRESS.md)\n- [tests/AUTH_TESTING_GUIDE.md](../tests/AUTH_TESTING_GUIDE.md)\n\n---\n\n**Prepared by:** Kiro AI Assistant\n**Date:** November 1, 2025\n**Purpose:** Documentation update summary for development team\n**Status:**  Complete\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8267289735274626,
          "recommendation": "Consider consolidating into DOCUMENTATION_UPDATES_LOG.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/test-reports/visual-regression-20251123/README.md",
              "name": "README.md",
              "size": 4699,
              "lastModified": "2026-01-06T15:49:37.106Z",
              "content": "# Visual Regression Test Results\n## Checkout Smart Pre-Population Feature\n\n**Test Date:** 2025-11-23  \n**Feature Branch:** feat/checkout-smart-prepopulation  \n**Commits:** 5869cd9, 57e4f63\n\n---\n\n## Quick Links\n\n###  Test Reports\n- **[Test Summary](./TEST_SUMMARY.md)** - Quick overview and status\n- **[Full Report](./VISUAL_REGRESSION_TEST_REPORT.md)** - Comprehensive analysis\n- **[Test Results JSON](./test-results.json)** - Machine-readable results\n- **[Manual Test Checklist](./MANUAL_TEST_CHECKLIST.md)** - For manual verification\n\n###  Screenshots (10 files)\n- `01a-signin-form-filled.png` - Sign-in form with credentials\n- `01b-authenticated.png` - Successfully authenticated\n- `02a-products-page.png` - Products listing\n- `02b-product-detail-page.png` - Product detail page\n- `02c-after-add-to-cart.png` - After add to cart\n- `03-checkout-page-loaded.png` - Checkout page (redirected to cart)\n- `04-no-express-checkout-banner.png` - Cart page (expected checkout)\n- `04-checkout-page-html.html` - Full HTML for analysis\n- `05-shipping-form.png` - Form elements\n- `error-state.png` - Error state capture\n\n---\n\n## Test Status\n\n **INCONCLUSIVE** - Manual testing required\n\n### What Worked \n- User authentication\n- Product navigation\n- Error handling\n- No server errors detected\n\n### What Couldn't Be Tested \n- Express Checkout Banner visibility\n- Form pre-population\n- Address selection\n- Smart defaults\n\n### Why?\nCart state didn't persist in headless browser, preventing access to actual checkout page.\n\n---\n\n## Key Findings\n\n1. **Component Exists**\n   - Location: `/components/checkout/ExpressCheckoutBanner.vue`\n   - Code appears well-implemented\n   - Conditional rendering based on saved addresses\n\n2. **Cart Redirect Works**\n   - Empty cart properly redirects to cart page\n   - Appropriate error message shown\n   - No application crashes\n\n3. **Test Limitation**\n   - Headless browser cart persistence issue\n   - Couldn't verify Express Checkout Banner\n   - Need manual testing to confirm functionality\n\n---\n\n## Next Steps\n\n### Immediate Action\n**Run Manual Tests** using [MANUAL_TEST_CHECKLIST.md](./MANUAL_TEST_CHECKLIST.md)\n\nCritical items to verify:\n1. Express Checkout Banner appears for returning users\n2. Form pre-population works correctly\n3. \"Use Express Checkout\" button functional\n4. Address selection works (if multiple addresses)\n\n### Database Check\nVerify test user has saved addresses:\n```sql\nSELECT * FROM user_addresses \nWHERE user_id = (\n  SELECT id FROM auth.users \n  WHERE email = 'customer@moldovadirect.com'\n);\n```\n\n### Fix Automated Test\n1. Add API-based cart population\n2. Implement cart state verification\n3. Add explicit waits for cart synchronization\n\n---\n\n## File Structure\n\n```\nvisual-regression-test/\n README.md (this file)\n TEST_SUMMARY.md\n VISUAL_REGRESSION_TEST_REPORT.md\n MANUAL_TEST_CHECKLIST.md\n test-results.json\n 01a-signin-form-filled.png\n 01b-authenticated.png\n 02a-products-page.png\n 02b-product-detail-page.png\n 02c-after-add-to-cart.png\n 03-checkout-page-loaded.png\n 04-no-express-checkout-banner.png\n 04-checkout-page-html.html\n 05-shipping-form.png\n error-state.png\n```\n\n---\n\n## Recommendation\n\n**DO NOT MERGE** until manual testing confirms Express Checkout Banner functionality.\n\n**Confidence Level:** Medium\n- Core functionality works\n- No breaking errors\n- Feature implementation appears solid\n- Testing limitation prevented full verification\n\n**Risk Level:** Low\n- Application handles edge cases correctly\n- No evidence of broken functionality\n- Issue is test environment, not code\n\n---\n\n## Test Environment\n\n- **Base URL:** http://localhost:3000\n- **Browser:** Chromium (headless)\n- **Viewport:** 1920x1080\n- **Locale:** es-ES\n- **Test User:** customer@moldovadirect.com\n- **Test Script:** visual-regression-test-final.py\n\n---\n\n## Component Location\n\n**Express Checkout Banner:**\n`/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/components/checkout/ExpressCheckoutBanner.vue`\n\n**Features:**\n- Gradient background (indigo to purple)\n- Lightning bolt icon\n- Saved address display\n- Preferred shipping method\n- \"Use Express Checkout\" button\n- \"Edit Details\" button\n- Dismissable\n\n---\n\n## Contact\n\nFor questions about these test results, refer to:\n- **Full Report:** VISUAL_REGRESSION_TEST_REPORT.md\n- **Test Script:** ../visual-regression-test-final.py\n- **Feature Commits:** 5869cd9, 57e4f63\n\n---\n\n**Generated By:** Claude Code (Visual Regression Testing Specialist)  \n**Test Duration:** ~2 minutes  \n**Screenshots:** 10 files  \n**Total Size:** ~2.4MB\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/test-reports/visual-regression-20251123/TEST_SUMMARY.md",
              "name": "TEST_SUMMARY.md",
              "size": 5110,
              "lastModified": "2026-01-06T15:49:37.106Z",
              "content": "# Visual Regression Test Summary\n## Checkout Smart Pre-Population Feature Testing\n\n---\n\n## Quick Status\n\n**Test Status:**  INCONCLUSIVE  \n**Reason:** Cart state issues prevented full checkout page access  \n**Recommendation:** Manual testing required\n\n---\n\n## What Was Tested\n\n### Successfully Verified \n1. **Authentication Flow**\n   - User login works correctly\n   - Credentials validated properly\n   - Redirect to account page successful\n\n2. **Navigation & Pages**\n   - Products page loads correctly\n   - Product detail pages accessible\n   - No server errors (500) detected\n\n3. **Error Handling**\n   - Empty cart properly redirects to cart page\n   - Appropriate error message displayed\n   - No application crashes\n\n### Could Not Verify \n1. **Express Checkout Banner**\n   - Component exists at: `/components/checkout/ExpressCheckoutBanner.vue`\n   - Could not reach checkout page due to empty cart\n   - Unknown if test user has saved addresses\n\n2. **Smart Pre-Population**\n   - Form auto-fill behavior not tested\n   - Address selection not tested\n   - Shipping method preference not tested\n\n---\n\n## Key Findings\n\n### Critical Discovery\nThe automated test encountered a **cart persistence issue** in headless browser mode:\n- Items added to cart did not persist\n- Checkout page redirected to cart with \"empty cart\" message\n- This prevented testing the actual checkout page and Express Checkout Banner\n\n### Component Verification\n**Express Checkout Banner Component Found:**\n- **Location:** `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/components/checkout/ExpressCheckoutBanner.vue`\n- **Props:** `defaultAddress`, `preferredShippingMethod`\n- **Conditional Rendering:** `v-if=\"showBanner\"`\n- **Features:**\n  - Shows saved address details\n  - \"Use Express Checkout\" button\n  - \"Edit Details\" option\n  - Dismissable banner\n\n**Rendering Condition:** Banner only shows when:\n1. User is on checkout page\n2. User has a default address\n3. Banner hasn't been dismissed\n\n---\n\n## Screenshots Captured\n\nAll screenshots available at:\n`/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/`\n\n**Key Screenshots:**\n1. `01b-authenticated.png` - Successfully authenticated user\n2. `02b-product-detail-page.png` - Product detail page\n3. `03-checkout-page-loaded.png` - **Cart page with empty cart message**\n4. `04-no-express-checkout-banner.png` - Same as #3 (redirected to cart)\n5. `04-checkout-page-html.html` - Full HTML of cart page for analysis\n\n---\n\n## Next Steps Required\n\n### Immediate Action Items\n\n1. **Manual Testing (Priority 1)**\n   ```\n   Steps to manually test:\n   1. Open browser to http://localhost:3000\n   2. Sign in as: customer@moldovadirect.com / Customer123!@#\n   3. Add product to cart\n   4. Navigate to checkout\n   5. Verify Express Checkout Banner appears\n   6. Test \"Use Express Checkout\" button\n   7. Verify form pre-population works\n   ```\n\n2. **Database Verification (Priority 2)**\n   ```sql\n   -- Check if test user has saved addresses\n   SELECT * FROM user_addresses \n   WHERE user_id = (\n     SELECT id FROM auth.users \n     WHERE email = 'customer@moldovadirect.com'\n   );\n   ```\n\n3. **Fix Automated Test (Priority 3)**\n   - Add API-based cart population\n   - Implement wait for cart state synchronization\n   - Add database state verification before checkout navigation\n\n---\n\n## Test Environment Details\n\n**Configuration:**\n- Base URL: http://localhost:3000\n- Browser: Chromium (headless)\n- Viewport: 1920x1080\n- Locale: es-ES\n- Test User: customer@moldovadirect.com\n\n**Test Limitations:**\n- Cart state management in headless mode\n- LocalStorage/Cookie persistence\n- Client-side hydration timing\n\n---\n\n## Risk Level\n\n**Overall Risk:** LOW\n\n**Rationale:**\n- No breaking errors detected\n- Application handles edge cases correctly\n- Component code exists and appears well-implemented\n- Issue is test environment limitation, not application bug\n\n---\n\n## Recommendation\n\n**PROCEED WITH MANUAL TESTING** before merging feature branch.\n\nThe automated tests provide confidence that:\n- No critical errors were introduced\n- Basic functionality works correctly\n- Application handles edge cases properly\n\nHowever, manual verification is required to confirm:\n- Express Checkout Banner renders correctly\n- Form pre-population works as designed\n- User experience meets requirements\n\n---\n\n## Files Generated\n\n1. **Test Results JSON:**\n   `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/test-results.json`\n\n2. **Full Report:**\n   `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/VISUAL_REGRESSION_TEST_REPORT.md`\n\n3. **This Summary:**\n   `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/TEST_SUMMARY.md`\n\n4. **Screenshots:** (10 files)\n   All PNG/HTML files in visual-regression-test directory\n\n---\n\n**Test Execution Date:** 2025-11-23  \n**Test Duration:** ~2 minutes  \n**Screenshots Captured:** 10  \n**Test Script:** visual-regression-test-final.py\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/test-reports/visual-regression-20251123/VISUAL_REGRESSION_TEST_REPORT.md",
              "name": "VISUAL_REGRESSION_TEST_REPORT.md",
              "size": 11489,
              "lastModified": "2026-01-06T15:49:37.106Z",
              "content": "# Visual Regression Test Report\n## Checkout Smart Pre-Population Feature\n\n**Test Date:** 2025-11-23  \n**Test Environment:** http://localhost:3000  \n**Feature Branch:** feat/checkout-smart-prepopulation  \n**Commits Tested:** 5869cd9, 57e4f63\n\n---\n\n## Executive Summary\n\n**Overall Status:**  PARTIAL PASS (with findings)\n\nThe visual regression testing successfully validated the authentication flow and basic navigation. However, the Express Checkout Banner could not be verified due to cart state issues during automated testing.\n\n**Key Findings:**\n1.  Authentication works correctly\n2.  Product pages load successfully\n3.  No server errors (500) detected\n4.  Express Checkout Banner not visible (requires investigation)\n5.  Empty cart redirect prevented full checkout flow testing\n\n---\n\n## Test Execution Details\n\n### Step 1: Authentication Test \n**Status:** PASSED  \n**Screenshots:** \n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/01a-signin-form-filled.png`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/01b-authenticated.png`\n\n**Findings:**\n- User successfully authenticated with credentials: customer@moldovadirect.com\n- Redirected to: http://localhost:3000/account (expected behavior)\n- No authentication errors detected\n- Form validation working correctly\n\n**Confidence Level:** High\n\n---\n\n### Step 2: Add Product to Cart \n**Status:** PARTIAL  \n**Screenshots:**\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/02a-products-page.png`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/02b-product-detail-page.png`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/02c-after-add-to-cart.png`\n\n**Findings:**\n- Products page loaded successfully\n- Product detail page (PROD-1763645506847-17) accessible\n- Add to cart button clicked (force click due to overlay)\n- **Issue:** Cart state not properly persisted during headless browser testing\n\n**Confidence Level:** Medium\n\n---\n\n### Step 3: Navigate to Checkout \n**Status:** REDIRECTED  \n**Expected URL:** http://localhost:3000/checkout  \n**Actual URL:** http://localhost:3000/cart?message=empty-cart-checkout  \n**Screenshots:**\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/03-checkout-page-loaded.png`\n\n**Findings:**\n- Checkout page redirected to cart due to empty cart state\n- Error message displayed: \"Tu carrito est vaco\" (Your cart is empty)\n- No server errors (500) detected - application handled empty cart gracefully\n- Cart validation working as intended\n\n**Confidence Level:** High (for cart validation logic)\n\n---\n\n### Step 4: CRITICAL - Express Checkout Banner \n**Status:** NOT FOUND  \n**Screenshots:**\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/04-no-express-checkout-banner.png`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/04-checkout-page-html.html` (full page HTML)\n\n**Detection Attempts:**\n1.  Text content search for \"pago express\", \"express checkout\"\n2.  CSS class pattern matching for \"express\" classes\n3.  Data attribute search for `[data-testid=\"express-checkout-banner\"]`\n4.  Button text search for \"usar\", \"use\", \"utilizar\"\n\n**Root Cause Analysis:**\n- User was redirected to cart page instead of checkout page\n- Express Checkout Banner only renders on actual checkout page\n- Test could not reach the checkout page due to empty cart\n\n**Required Investigation:**\n1. Verify test user (customer@moldovadirect.com) has saved addresses in database\n2. Manually test checkout flow with items in cart\n3. Check if Express Checkout Banner renders for users with saved addresses\n4. Verify component mounting logic on checkout page\n\n**Confidence Level:** Low (test could not reach target state)\n\n---\n\n### Step 5: Shipping Form Verification \n**Status:** PARTIAL  \n**Screenshot:**\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/05-shipping-form.png`\n\n**Findings:**\n- Only newsletter form detected on cart page\n- Actual shipping form not visible (page was cart, not checkout)\n- Form field found: email input with placeholder \"Tu correo electrnico\"\n\n**Confidence Level:** Low (wrong page context)\n\n---\n\n### Step 6: Console Error Check \n**Status:** MINOR ISSUES  \n**Screenshot:**\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/error-state.png`\n\n**Console Errors:**\n- 1 error detected: \"Page.query_selector_all: Execution context was destroyed, most likely because of a navigation\"\n\n**Network Errors:**\n- No 5xx server errors\n- No 4xx client errors during core functionality\n\n**Warnings:**\n- Express Checkout Banner not detected (expected due to cart redirect)\n\n**Confidence Level:** Medium\n\n---\n\n## Captured Screenshots Summary\n\nAll screenshots saved to:\n`/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/`\n\n1. **01a-signin-form-filled.png** (371KB) - Sign-in form with credentials filled\n2. **01b-authenticated.png** (101KB) - Account page after successful login\n3. **02a-products-page.png** (341KB) - Products listing page\n4. **02b-product-detail-page.png** (349KB) - Product detail page for PROD-1763645506847-17\n5. **02c-after-add-to-cart.png** (349KB) - Page state after add to cart click\n6. **03-checkout-page-loaded.png** (83KB) - Cart page with empty cart message\n7. **04-no-express-checkout-banner.png** (83KB) - Cart page (expected checkout)\n8. **04-checkout-page-html.html** (569KB) - Full HTML dump for analysis\n9. **05-shipping-form.png** (83KB) - Cart page newsletter form\n10. **error-state.png** (81KB) - Error state screenshot\n\n---\n\n## Test Environment Issues\n\n### Cart State Persistence\n**Issue:** Cart items not persisting in headless browser environment  \n**Impact:** Prevented full checkout flow testing  \n**Possible Causes:**\n- LocalStorage/Cookie issues in headless mode\n- Timing issue between add-to-cart action and cart state update\n- Client-side cart plugin not fully initialized\n\n**Recommendation:** \n- Add explicit waits after cart actions\n- Verify cart state via API before proceeding to checkout\n- Consider using Supabase direct cart insertion for E2E tests\n\n### Test User Data\n**Issue:** Unknown if test user has saved addresses in database  \n**Impact:** Cannot verify if Express Checkout Banner should appear  \n**Recommendation:**\n- Create seed data with test user having saved addresses\n- Document expected database state for testing\n- Add database verification steps to test suite\n\n---\n\n## Recommendations\n\n### Immediate Actions\n1. **Manual Testing Required:** Manually test checkout flow with:\n   - Items in cart\n   - User with saved addresses\n   - User without saved addresses\n   - Verify Express Checkout Banner appears/disappears correctly\n\n2. **Database Verification:**\n   - Check if customer@moldovadirect.com exists in auth.users\n   - Verify if user has saved addresses in user_addresses table\n   - Add seed data if missing\n\n3. **Test Enhancement:**\n   - Add API-based cart population before checkout navigation\n   - Implement database state verification steps\n   - Add explicit cart state checks before proceeding\n\n### Code Review Suggestions\n1. Review Express Checkout Banner component mounting logic\n2. Verify conditional rendering based on user_addresses\n3. Check for any console errors in browser DevTools (manual test)\n4. Validate RLS policies for user_addresses table\n\n### Future Test Improvements\n1. **Baseline Establishment:** Once manual testing confirms functionality:\n   - Capture baseline screenshots of Express Checkout Banner\n   - Document expected vs actual behavior\n   - Create pixel-diff comparison suite\n\n2. **Test Data Management:**\n   - Create dedicated test fixtures\n   - Implement database seeding for E2E tests\n   - Add cleanup procedures\n\n3. **Enhanced Validation:**\n   - Add component-level visual regression tests\n   - Implement Storybook for isolated component testing\n   - Create visual diff reports with highlighted changes\n\n---\n\n## Comparison Analysis\n\n### Expected Behavior (from feature description)\n User authenticates successfully  \n Express Checkout Banner appears for users with saved addresses  \n \"Use this address\" button functional  \n Shipping form renders  \n No server errors\n\n### Actual Behavior (from test)\n User authenticated successfully  \n Express Checkout Banner not visible (test couldn't reach checkout)  \n Could not verify button (banner not present)  \n Shipping form on cart page, not checkout (wrong context)  \n No server errors detected\n\n---\n\n## Risk Assessment\n\n### Critical Risks\n- **None identified** - No evidence of broken functionality\n\n### Medium Risks\n1. **Unverified Feature:** Express Checkout Banner could not be validated\n   - **Mitigation:** Perform manual testing immediately\n   - **Impact:** Feature may not work as intended\n\n2. **Cart State Management:** Cart not persisting in headless tests\n   - **Mitigation:** Fix test approach or cart implementation\n   - **Impact:** E2E testing reliability compromised\n\n### Low Risks\n1. **Minor Console Error:** Navigation-related error during test\n   - **Mitigation:** Review error context\n   - **Impact:** Likely test artifact, not production issue\n\n---\n\n## Next Steps\n\n### Priority 1 (Immediate)\n- [ ] Manual checkout flow test with items in cart\n- [ ] Verify Express Checkout Banner visibility\n- [ ] Check test user database state\n- [ ] Document manual test results\n\n### Priority 2 (Short-term)\n- [ ] Fix automated test to properly populate cart\n- [ ] Add database state verification\n- [ ] Create test fixtures with saved addresses\n- [ ] Re-run automated tests with fixes\n\n### Priority 3 (Long-term)\n- [ ] Establish visual regression baselines\n- [ ] Implement pixel-diff comparison\n- [ ] Add Storybook for component isolation\n- [ ] Create comprehensive E2E test suite\n\n---\n\n## Conclusion\n\nThe visual regression test successfully validated core application functionality (authentication, navigation, error handling) but could not fully verify the Express Checkout Banner feature due to cart state management issues in the automated testing environment.\n\n**Recommendation:** Proceed with **manual testing** to verify the Express Checkout Banner functionality before merging the feature branch. The automated tests provide confidence that basic flows work correctly and no critical errors were introduced.\n\n**Test Reliability:** Medium - Tests accurately captured application state but encountered environment-specific limitations.\n\n**Feature Confidence:** Pending manual verification\n\n---\n\n**Test Results Location:**\n- Screenshots: `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/`\n- JSON Report: `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/test-results.json`\n- This Report: `/Users/vladislavcaraseli/Documents/MoldovaDirect.worktrees/products-improvments/visual-regression-test/VISUAL_REGRESSION_TEST_REPORT.md`\n\n**Tested By:** Claude Code (Visual Regression Testing Specialist)  \n**Report Generated:** 2025-11-23\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8599233947233506,
          "recommendation": "Consider consolidating into README.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/testing/BRANCH_COMPARISON_SUMMARY.md",
              "name": "BRANCH_COMPARISON_SUMMARY.md",
              "size": 7562,
              "lastModified": "2026-01-06T15:49:37.107Z",
              "content": "# Branch Comparison Summary\n## test/e2e-review-and-fixes vs codex/simplify-test-infrastructure-and-remove-unused-code\n\n**Date:** 2025-12-05\n**Status:** Reviewed\n**Recommendation:** Keep current branch + apply selective cleanup\n\n---\n\n## Quick Facts\n\n| Metric | Current Branch | Codex Branch | Recommended |\n|--------|---------------|--------------|-------------|\n| **Philosophy** | Comprehensive coverage | Minimalist start-fresh | Hybrid approach |\n| **Test Files** | 30 files | 3 files | ~23 files |\n| **Test LOC** | 8,615 lines | 26 lines | ~6,500-7,000 lines |\n| **Playwright Projects** | 15 projects | 1 project | 6 projects |\n| **Pre-commit Tests** | 3 tests (2 passing) | 3 tests (minimal) | 3 tests (optimized) |\n| **Test Coverage** | High | Minimal | Medium-High |\n\n---\n\n## Test Results\n\n### Current Branch - Pre-Commit Tests:\n```\n homepage loads without errors (7.8s)\n can navigate to products page (1.4s)\n can add product to cart (12.8s) - Cart badge timing issue\n\nResult: 2/3 passing (66%)\nTotal Time: ~22s (within 30s target)\n```\n\n**Analysis:** Pre-commit tests are working well. The cart test failure is a timing issue, not a critical bug.\n\n---\n\n## Codex Branch Changes\n\n### What Codex Deleted:\n- **All 50+ E2E test specs** (~13,000 lines)\n- **All test infrastructure** (~3,935 lines)\n  - Cart helpers (445 lines)\n  - Page objects (212 lines)\n  - Test helpers (135 lines)\n  - Base fixtures (151 lines)\n  - Global setup/teardown (249 lines)\n- **Playwright config** (reduced from 140 lines  30 lines)\n- **15  1 Playwright project**\n\n### What Codex Added:\n- 3 minimal smoke tests (26 lines total)\n- Simple Playwright config (30 lines)\n- Updated documentation\n\n**Total Deletion:** 16,935 lines (95% of test code)\n\n---\n\n## Decision Matrix\n\n### Why NOT to Adopt Codex Branch:\n\n| Reason | Impact |\n|--------|--------|\n| **Lose ALL test coverage** | No auth, cart, checkout, admin tests |\n| **Lose multi-locale testing** | Can't verify 4-language support |\n| **Lose mobile testing** | Can't verify responsive design |\n| **Lose months of work** | 8,615 lines of valuable tests |\n| **Not greenfield project** | You have production features to test |\n\n### Why TO Learn from Codex Branch:\n\n| Principle | How to Apply |\n|-----------|--------------|\n| **Extract helpers after 3+ duplications** | Audit current helpers, delete unused |\n| **Pre-commit < 30s** |  Already achieved (22s) |\n| **Start simple, add complexity** | Apply to NEW tests going forward |\n| **Delete unused code** | Delete 5-10 low-value test files |\n| **1 browser for dev** | Reduce from 15  6 Playwright projects |\n\n---\n\n## Recommended Action Plan\n\n###  KEEP: Current Branch\n\n**Reasons:**\n1. Tests are actively maintained (recent commits)\n2. Pre-commit tests working (2/3 passing)\n3. Critical tests exist for all major features\n4. Multi-locale/browser coverage valuable\n5. Too far along to start over\n\n###  IMPROVE: Apply Codex Principles\n\n**Phase 1 - Immediate (This Week):**\n```bash\n# 1. Delete 3-5 obsolete tests\ngit rm tests/e2e/home.spec.ts\ngit rm tests/e2e/hero-video.spec.ts\ngit rm tests/e2e/test-user-personas.spec.ts\n\n# 2. Run tests to verify\npnpm run test:pre-commit\n\n# 3. Commit\ngit commit -m \"chore: delete obsolete tests per cleanup plan\"\n```\n\n**Phase 2 - Configuration (Next Week):**\n```typescript\n// Simplify playwright.config.ts\n// Reduce: 15 projects  6 projects\n\nprojects: [\n  { name: 'pre-commit', ... },     // < 30s\n  { name: 'critical', ... },       // < 5min\n  { name: 'chromium-es', ... },    // Full suite (default)\n  { name: 'chromium-en', ... },    // English locale\n  { name: 'firefox-es', ... },     // Cross-browser\n  { name: 'mobile', ... },         // Responsive\n]\n```\n\n**Phase 3 - Helpers (Ongoing):**\n- Extract helpers ONLY after seeing 3+ duplications\n- Delete unused helpers\n- Keep tests readable\n\n---\n\n## Expected Outcomes\n\n### Before Cleanup:\n- 30 test files\n- 8,615 lines\n- 15 Playwright projects\n- ~90s pre-commit time\n\n### After Cleanup:\n- 23-25 test files (-17-23%)\n- 6,500-7,000 lines (-19-24%)\n- 6 Playwright projects (-60%)\n- ~25s pre-commit time (-72%)\n\n**Net Result:** Simpler, faster, still comprehensive\n\n---\n\n## Integration Strategy\n\n###  DO NOT Merge Codex Branch\n\n**Command:**\n```bash\n# DON'T DO THIS:\ngit merge codex/simplify-test-infrastructure-and-remove-unused-code\n```\n\n**Why:** Incompatible philosophies, would delete all your tests\n\n###  DO Cherry-Pick Principles\n\n**What to Take:**\n1. Philosophy: YAGNI, extract when needed\n2. Target: Pre-commit < 30s  (already met)\n3. Target: Critical < 5min (need to measure)\n4. Approach: Delete unused code ruthlessly\n\n**What to Leave:**\n- Deleting all existing tests\n- Removing multi-locale testing\n- Removing multi-browser testing\n- Starting from 3 minimal tests\n\n---\n\n## Files Created\n\nThis analysis generated 3 comprehensive documents:\n\n1. **TEST_CLEANUP_PLAN.md** - Full cleanup plan with phases, timeline, success criteria\n2. **TESTS_TO_DELETE.md** - Specific tests to delete with rationale and commands\n3. **BRANCH_COMPARISON_SUMMARY.md** (this file) - Executive summary of review\n\n**Location:** `docs/testing/`\n\n---\n\n## Next Steps\n\n### This Week:\n1.  Review all 3 documents\n2.  Get team alignment on approach\n3.  Delete 3-5 low-value test files\n4.  Run full test suite to verify\n5.  Commit changes to `test/e2e-review-and-fixes`\n\n### Next Week:\n1. Simplify `playwright.config.ts`\n2. Update CI configuration\n3. Run comprehensive tests in CI\n4. Monitor for regressions\n\n### Week 3:\n1. Review results\n2. Delete additional low-value tests if identified\n3. Extract helpers if 3+ duplications found\n4. Document final state\n5. Merge to main\n\n---\n\n## Key Learnings\n\n### From Codex Branch:\n- **YAGNI is powerful** for greenfield projects\n- **Simplicity reduces maintenance** burden\n- **Extract helpers when needed**, not preemptively\n- **Start minimal, grow as needed** is smart\n\n### From Current Branch:\n- **Comprehensive tests have value** for production apps\n- **Multi-locale testing is critical** for international apps\n- **3-tier approach works** (pre-commit, critical, full)\n- **Active maintenance matters** (recent commits show care)\n\n### Hybrid Approach:\n- **Best of both worlds**: Keep valuable tests + simplify infrastructure\n- **Selective deletion**: Remove low-value tests, keep high-value\n- **Config simplification**: Reduce projects without losing coverage\n- **Helper discipline**: Extract only when duplicating 3+ times\n\n---\n\n## Conclusion\n\n**Decision:** Keep `test/e2e-review-and-fixes` branch \n\n**Rationale:**\n- You're not starting fresh (greenfield)\n- Tests provide value (catch regressions)\n- Multi-locale/browser coverage needed\n- Too much work to throw away\n\n**But also:** Learn from Codex's minimalist philosophy and apply selectively.\n\n**Result:** A simpler, faster, still-comprehensive test suite.\n\n---\n\n## Team Communication\n\n**For Team Meeting:**\n\n> We reviewed the codex branch's \"delete everything and start fresh\" approach. While their minimalist philosophy is excellent for NEW projects, we're too far along to adopt it wholesale. Instead, we're taking a hybrid approach:\n>\n> 1. Keep our valuable tests (auth, cart, checkout, admin)\n> 2. Delete 5-10 low-value tests (~800-1,000 lines)\n> 3. Simplify Playwright config (15  6 projects)\n> 4. Maintain fast pre-commit tests (< 30s) \n>\n> This gives us 60% faster test runs with minimal risk.\n\n---\n\n**Status:**  Analysis Complete\n**Documents:** 3 created\n**Recommendation:** Approved for implementation\n**Timeline:** 3 weeks\n\n**Last Updated:** 2025-12-05\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/testing/IMPLEMENTATION_SUMMARY.md",
              "name": "IMPLEMENTATION_SUMMARY.md",
              "size": 10411,
              "lastModified": "2026-01-06T15:49:37.107Z",
              "content": "# Test Infrastructure Review & Cleanup - Implementation Summary\n**Date:** 2025-12-05\n**Branch:** test/e2e-review-and-fixes\n**Status:**  Phase 1 Complete\n\n---\n\n## Executive Summary\n\nSuccessfully completed comprehensive test infrastructure review comparing current branch vs `codex/simplify-test-infrastructure-and-remove-unused-code` branch. Implemented Phase 1 of cleanup plan: deleted 3 obsolete test files while preserving valuable coverage.\n\n---\n\n## What Was Delivered\n\n###  1. Comprehensive Analysis (3 Documents)\n\n#### `BRANCH_COMPARISON_SUMMARY.md` (7.4KB)\n- **Decision Matrix:** Keep current branch vs adopt codex branch\n- **Recommendation:** Keep current + apply selective cleanup\n- **Rationale:** Too much valuable coverage to delete\n- **Key Metrics:** Expected 60% faster test runs\n\n#### `TEST_CLEANUP_PLAN.md` (8.6KB)\n- **3-Phase Plan:** Over 3 weeks\n- **Phase 1:** Delete obsolete tests (this week) \n- **Phase 2:** Simplify Playwright config (next week)\n- **Phase 3:** Extract helpers only when needed (ongoing)\n\n#### `TESTS_TO_DELETE.md` (11KB)\n- **5 files** for immediate deletion with rationale\n- **4 files** for review with decision criteria\n- **Bash scripts** for safe deletion\n- **Verification checklists**\n\n###  2. Phase 1 Implementation Complete\n\n#### Files Deleted:\n1.  `tests/e2e/home.spec.ts` (~31 lines)\n   - Superseded by `tests/pre-commit/smoke.spec.ts`\n\n2.  `tests/e2e/hero-video.spec.ts` (~46 lines)\n   - Low-value feature test\n\n3.  `tests/e2e/test-user-personas.spec.ts` (~183 lines)\n   - Overly complex fixture usage\n\n#### Impact:\n- **Test files:** 30  27 (-10%)\n- **Test LOC:** 8,615  8,355 (-3%)\n- **No broken imports:**  Verified\n- **Tests still pass:**  Pre-commit smoke tests running\n\n###  3. Additional Fixes\n\n#### `components/home/SocialProofSection.vue`\n- Fixed `useHead` reactivity by using function form\n- Resolves Vue warnings about lifecycle hooks\n\n#### `tests/e2e/auth/auth-mobile-responsive.spec.ts`\n- Removed device iteration loop\n- Now uses Playwright projects from config\n- Cleaner, more maintainable\n\n---\n\n## Test Results\n\n### Pre-Commit Smoke Tests (Latest Run):\n```\n homepage loads without errors (7.8s)\n can navigate to products page (1.4s)\n  can add product to cart (12.8s) - Cart badge timing (acceptable)\n\nResult: 2/3 passing (66%)\nTotal Time: ~22s (under 30s target )\n```\n\n**Analysis:** Tests work well after deletions. Cart test timing issue is acceptable for smoke tests.\n\n---\n\n## Key Decisions Made\n\n###  KEEP Current Branch\n\n**Reasons:**\n1. Tests provide value (auth, cart, checkout, admin all covered)\n2. Actively maintained (recent commits show care)\n3. Multi-locale/browser testing needed\n4. Pre-commit tests already fast (22s)\n5. 8,615 lines of valuable test code\n\n###  DO NOT Adopt Codex Branch\n\n**Reasons:**\n1. Would delete 16,935 lines (95% of tests)\n2. Would lose all test coverage\n3. Designed for greenfield projects\n4. You're too far along to start over\n\n###  DO Learn from Codex Principles\n\n**Applying:**\n- Delete unused/duplicate tests  (3 done, 4 to review)\n- Simplify Playwright config (15  6 projects)\n- Extract helpers only after 3+ duplications\n- Maintain fast pre-commit tests  (22s achieved)\n\n---\n\n## Commits Made\n\n### 1. Documentation Commit\n```\n3ec2784 docs: add comprehensive test cleanup plan and analysis\n- Added BRANCH_COMPARISON_SUMMARY.md\n- Added TEST_CLEANUP_PLAN.md\n- Added TESTS_TO_DELETE.md\n```\n\n### 2. Deletion Commit\n```\n038112e chore: delete 3 obsolete test files per cleanup plan\n- Deleted tests/e2e/home.spec.ts\n- Deleted tests/e2e/hero-video.spec.ts\n- Deleted tests/e2e/test-user-personas.spec.ts\n```\n\n### 3. Fixes Commit\n```\n<pending> fix: refactor mobile responsive tests and fix useHead reactivity\n- Fixed SocialProofSection.vue useHead\n- Simplified auth-mobile-responsive.spec.ts\n```\n\n---\n\n## Metrics\n\n### Before Cleanup:\n| Metric | Value |\n|--------|-------|\n| Test files | 30 |\n| Test LOC | 8,615 |\n| Playwright projects | 15 |\n| Pre-commit time | ~90s (estimated) |\n\n### After Phase 1:\n| Metric | Value | Change |\n|--------|-------|--------|\n| Test files | 27 | -10% |\n| Test LOC | 8,355 | -3% |\n| Playwright projects | 15 | 0% (Phase 2) |\n| Pre-commit time | ~22s |  Under target |\n\n### After All Phases (Projected):\n| Metric | Target | Change |\n|--------|--------|--------|\n| Test files | 23-25 | -17-23% |\n| Test LOC | 6,500-7,000 | -19-24% |\n| Playwright projects | 6 | -60% |\n| Pre-commit time | ~25s | -72% |\n\n---\n\n## Next Steps\n\n### Week 1 (Dec 5-12):  DONE\n- [x] Audit current tests\n- [x] Create comprehensive documentation\n- [x] Delete 3 low-value test files\n- [x] Verify tests still pass\n- [ ] Review 4 medium-confidence files for deletion\n\n### Week 2 (Dec 13-20): PENDING\n- [ ] Simplify `playwright.config.ts` (15  6 projects)\n- [ ] Update CI configuration\n- [ ] Run comprehensive tests in CI\n- [ ] Monitor for regressions\n\n### Week 3 (Dec 21-27): PENDING\n- [ ] Final cleanup based on learnings\n- [ ] Extract helpers if 3+ duplications found\n- [ ] Document final state\n- [ ] Merge to main\n\n---\n\n## Files to Review Next (Medium Confidence)\n\n### 1. `tests/e2e/security-gdpr.spec.ts` (~399 lines)\n**Decision Criteria:**\n- Keep if serving EU customers\n- Delete if no EU customers\n- OR: Move to integration tests\n\n### 2. `tests/e2e/address-crud.spec.ts` (~344 lines)\n**Decision Criteria:**\n- Keep if standalone address management is critical\n- Delete if checkout tests cover it\n- OR: Simplify to critical paths only\n\n### 3. `tests/e2e/products-pagination.spec.ts` (~271 lines)\n**Decision Criteria:**\n- Keep if >100 products\n- Delete if <50 products\n\n### 4. `tests/e2e/auth/auth-accessibility.spec.ts` (~458 lines)\n**Decision Criteria:**\n- Keep if legal requirement (WCAG)\n- Run weekly instead of daily\n- OR: Run manually before releases\n\n---\n\n## Backup Strategy\n\n### Backup Branch Created:\n```bash\nbackup/before-test-deletion-20251205\n```\n\n**Contains:**\n- All 3 deleted test files\n- All documentation before cleanup\n- Complete working state\n\n**Recovery:**\n```bash\n# If needed, restore deleted files\ngit checkout backup/before-test-deletion-20251205 -- tests/e2e/home.spec.ts\ngit checkout backup/before-test-deletion-20251205 -- tests/e2e/hero-video.spec.ts\ngit checkout backup/before-test-deletion-20251205 -- tests/e2e/test-user-personas.spec.ts\n```\n\n---\n\n## Lessons Learned\n\n### From Codex Branch:\n1. **YAGNI is powerful** for greenfield projects\n2. **Simplicity reduces maintenance** burden\n3. **Extract helpers when needed**, not preemptively\n4. **Start minimal, grow as needed** is smart for new projects\n\n### From Current Branch:\n1. **Comprehensive tests have value** for production apps\n2. **Multi-locale testing is critical** for international apps\n3. **3-tier approach works** (pre-commit, critical, full)\n4. **Active maintenance matters** (recent commits show care)\n\n### Best Practice Adopted:\n**Extract helpers after 3+ duplications**\n- DON'T extract after 1st duplication\n- DON'T extract after 2nd duplication\n- DO extract after 3rd duplication\n- Prevents premature abstraction\n\n---\n\n## Risk Mitigation\n\n###  Risks Addressed:\n1. **Backup created** before deletions\n2. **Tests verified** after deletions\n3. **No broken imports** confirmed\n4. **Reversible changes** (git revert available)\n5. **Documentation** for all decisions\n\n###  Remaining Risks:\n1. **Medium-confidence files** need review (4 files)\n2. **Playwright config changes** could break workflows (Phase 2)\n3. **Helper extraction** might create wrong abstractions (Phase 3)\n\n**Mitigation:** Review each change carefully, test thoroughly, document decisions\n\n---\n\n## Success Criteria\n\n### Phase 1:  ACHIEVED\n- [x] Pre-commit tests < 30s (achieved: 22s)\n- [x] Delete 3-5 low-value tests (done: 3)\n- [x] No regressions in passing tests\n- [x] Comprehensive documentation created\n- [x] Team can execute next phases\n\n### Overall (Pending):\n- [ ] Pre-commit tests < 30s  (already achieved)\n- [ ] Critical tests < 5min (to measure)\n- [ ] Full suite < 20min (to measure)\n- [ ] Test count reduced >10% (achieved: 10%)\n- [ ] Config simplified (6 projects)\n- [ ] Team confidence maintained\n\n---\n\n## Team Communication\n\n### For Standup:\n\n> Completed Phase 1 of test cleanup:\n> - Deleted 3 obsolete test files (260 lines)\n> - Created comprehensive cleanup plan (27KB docs)\n> - Tests still passing after deletions \n> - Next: Review 4 more files, then simplify Playwright config\n>\n> No blocking issues. On track for 60% faster test runs.\n\n### For PR Description:\n\n```markdown\n## Test Infrastructure Cleanup - Phase 1\n\n### Summary\nComprehensive review of test infrastructure comparing our branch vs\ncodex's \"delete everything and start fresh\" approach.\n\n**Decision:** Keep our valuable tests + apply selective cleanup.\n\n### Changes\n-  Deleted 3 obsolete tests (260 lines)\n-  Fixed useHead reactivity in SocialProofSection\n-  Simplified mobile responsive tests\n-  Created 3 comprehensive docs (27KB)\n\n### Impact\n- Test files: 30  27 (-10%)\n- Pre-commit time: 22s (under 30s target )\n- No regressions \n\n### Next Steps\n- Phase 2: Simplify Playwright config (15  6 projects)\n- Phase 3: Extract helpers when needed (not before)\n```\n\n---\n\n## References\n\n### Documentation:\n- `docs/testing/BRANCH_COMPARISON_SUMMARY.md`\n- `docs/testing/TEST_CLEANUP_PLAN.md`\n- `docs/testing/TESTS_TO_DELETE.md`\n- `docs/testing/IMPLEMENTATION_SUMMARY.md` (this file)\n\n### Branches:\n- Current: `test/e2e-review-and-fixes`\n- Codex: `codex/simplify-test-infrastructure-and-remove-unused-code`\n- Backup: `backup/before-test-deletion-20251205`\n\n### External:\n- YAGNI Principle: https://martinfowler.com/bliki/Yagni.html\n- Playwright Docs: https://playwright.dev/docs/intro\n\n---\n\n## Conclusion\n\n**Phase 1 Status:**  COMPLETE\n\nSuccessfully balanced the codex branch's minimalist philosophy with the practical reality of a production application with valuable test coverage.\n\n**Key Achievement:** Reduced test count by 10% while maintaining comprehensive coverage and fast pre-commit tests (22s).\n\n**Philosophy Going Forward:**\n- Start simple for new tests\n- Extract helpers only after 3+ duplications\n- Keep pre-commit tests fast\n- Delete ruthlessly when safe\n\n**Ready for Phase 2:** Simplify Playwright configuration next week.\n\n---\n\n**Last Updated:** 2025-12-05 18:35 UTC\n**Status:**  Phase 1 Complete, Ready for Phase 2\n**Next Review:** 2025-12-12\n",
              "category": "archive"
            }
          ],
          "similarity": 0.842060651056816,
          "recommendation": "Consider consolidating into BRANCH_COMPARISON_SUMMARY.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/archive/testing/checkout/CHECKOUT-TEST-COVERAGE-ANALYSIS.md",
              "name": "CHECKOUT-TEST-COVERAGE-ANALYSIS.md",
              "size": 11951,
              "lastModified": "2026-01-06T15:49:37.109Z",
              "content": "# Checkout Test Coverage Analysis - Option D Flows\n\n**Date:** 2025-12-26\n**Branch:** `claude/improve-checkout-ux-aNjjK`\n**Analysis Scope:** Validate test coverage for Option D (Hybrid Progressive Checkout) flows\n\n---\n\n## Option D: Three User Flows (from checkout-ux-proposals.html)\n\n### 1. **Returning User** - Express Checkout \nOne-click checkout for users with saved address and payment information.\n\n### 2. **Edit Mode** - Full Checkout Form \nFull form displayed when returning user wants to modify their saved information.\n\n### 3. **New User** - Guest Checkout \nSimplified checkout form for first-time or guest users.\n\n---\n\n## Current Test Coverage Summary\n\n| Flow Type | E2E Tests | Visual Tests | Reaches Confirmation | Coverage Score |\n|-----------|-----------|--------------|---------------------|----------------|\n| **Returning User (Express)** |  FULL |  FULL |  YES | **95%** |\n| **Edit Mode (Returning)** |  PARTIAL |  FULL |  NO | **70%** |\n| **New User (Guest)** |  PARTIAL |  FULL |  NO | **70%** |\n\n**Overall Coverage:** 78% - **NEEDS IMPROVEMENT**\n\n---\n\n## Detailed Breakdown\n\n### 1. Returning User - Express Checkout \n\n**File:** `tests/e2e/checkout-full-flow.spec.ts` (lines 203-257)\n\n**Test Name:** `Express checkout for returning user with saved address`\n\n**Flow Coverage:**\n-  Login with saved address\n-  Add product to cart\n-  Navigate to checkout\n-  Verify express checkout banner visible\n-  Verify saved address displayed\n-  Click \"Use Express Checkout\" button\n-  **Navigate to confirmation page** (line 250)\n-  Verify on `/checkout/confirmation`\n\n**Visual Regression Tests:**\n-  `express checkout banner for returning user - desktop` (line 554)\n-  `express checkout dismissed - show full form` (line 595)\n-  `express checkout banner - mobile` (line 624)\n\n**Status:**  **FULLY TESTED** - This is the only flow that goes all the way to confirmation page!\n\n**Issues:**\n-  Test skipped by default (requires `TEST_USER_WITH_ADDRESS` env var)\n-  No multi-locale express checkout tests\n\n---\n\n### 2. Edit Mode - Full Form (Returning User) \n\n**File:** `tests/e2e/checkout-full-flow.spec.ts` (lines 43-137)\n\n**Test Name:** `Complete checkout flow as authenticated user`\n\n**Flow Coverage:**\n-  Login as authenticated user\n-  Add product to cart\n-  Navigate to checkout\n-  Detect express checkout banner\n-  **Dismiss express banner to show full form** (line 92)\n-  Fill shipping address\n-  Select shipping method (progressive disclosure)\n-  Verify payment section appears\n-  Select payment method (cash)\n-  Accept terms and privacy\n-  Verify place order button visible\n-  **STOPS HERE** - Does NOT place order (lines 132-134 commented out)\n\n**Visual Regression Tests:**\n-  `express checkout dismissed - show full form` (line 595)\n-  All guest checkout screenshots apply (since edit mode shows same form)\n\n**Status:**  **PARTIALLY TESTED** - Stops before order placement\n\n**Missing Coverage:**\n1.  No test that actually places order and reaches confirmation\n2.  No test for editing saved payment method\n3.  No test for switching between saved addresses\n4.  No multi-locale edit mode tests\n\n---\n\n### 3. New User - Guest Checkout \n\n**File:** `tests/e2e/checkout-full-flow.spec.ts` (lines 139-201)\n\n**Test Name:** `Complete checkout flow as guest user`\n\n**Flow Coverage:**\n-  Add product to cart (not logged in)\n-  Navigate to checkout\n-  Verify NO express checkout banner (guests don't have saved data)\n-  See guest checkout prompt\n-  Click \"Continue as Guest\"\n-  Fill guest email\n-  Fill shipping address\n-  Select shipping method\n-  Select payment method (cash)\n-  Accept terms\n-  Verify place order button visible\n-  **STOPS HERE** - Does NOT place order (line 200)\n\n**Visual Regression Tests:**\n-  `guest checkout prompt - desktop EN` (line 118)\n-  `guest checkout initial state - desktop` (line 135)\n-  `guest checkout initial state - mobile` (line 153)\n-  `address form filled - desktop` (line 170)\n-  `shipping methods loaded - desktop` (line 191)\n-  `shipping method selected - desktop` (line 221)\n-  `payment method selected - desktop` (line 250)\n-  `ready to place order - desktop` (line 281)\n-  `ready to place order - mobile` (line 314)\n\n**Status:**  **PARTIALLY TESTED** - Stops before order placement\n\n**Missing Coverage:**\n1.  No test that actually places order and reaches confirmation\n2.  No test for guest with marketing consent checkbox\n3.  No test for guest order confirmation email\n4.  Limited multi-locale guest flow tests\n\n---\n\n## Critical Test Coverage Gaps\n\n###  HIGH PRIORITY\n\n1. **No End-to-End Tests to Confirmation** (Except Express Checkout)\n   - **Issue:** Tests stop at \"ready to place order\" for guest and edit mode\n   - **Impact:** Cannot verify order creation, confirmation page, email sending\n   - **Files Affected:**\n     - `tests/e2e/checkout-full-flow.spec.ts` line 132-134 (authenticated/edit mode)\n     - `tests/e2e/checkout-full-flow.spec.ts` line 200 (guest checkout)\n   - **Reason:** Commented out to avoid creating real orders in test DB\n\n2. **No Visual Regression Tests for Confirmation Page**\n   - **Issue:** 0 screenshots of confirmation page\n   - **Impact:** Cannot catch visual regressions on success page\n   - **Missing Scenarios:**\n     - Order confirmation with order number\n     - Order confirmation in all 4 locales\n     - Email confirmation message display\n     - \"Continue Shopping\" / \"View Order\" buttons\n\n3. **Guest Checkout Email Validation**\n   - **Issue:** No test verifies guest receives confirmation email\n   - **Impact:** Cannot verify critical post-order flow\n   - **Missing:** Email delivery test for guest orders\n\n###  MEDIUM PRIORITY\n\n4. **Multi-Locale Coverage Incomplete**\n   - **Current:** Only 1 visual test per locale (desktop only)\n   - **Missing:** Mobile + Tablet screenshots per locale\n   - **Missing:** Full checkout flow per locale\n\n5. **Payment Method Variety**\n   - **Current:** Only cash payment tested\n   - **Missing:** Credit card payment flow (requires Stripe test mode)\n   - **Missing:** PayPal payment flow\n   - **Missing:** Bank transfer flow\n\n6. **Saved Payment Methods**\n   - **Missing:** Tests for saving payment method during checkout\n   - **Missing:** Tests for selecting saved payment method\n   - **Missing:** Tests for editing saved payment method\n\n###  LOW PRIORITY\n\n7. **Progressive Disclosure Edge Cases**\n   - **Missing:** Test for manually collapsing/expanding sections\n   - **Missing:** Test for editing completed section\n   - **Missing:** Test for section-to-section navigation\n\n8. **Cart Lock During Checkout**\n   - **Missing:** Test for concurrent checkout detection\n   - **Missing:** Test for cart lock warning toast\n\n---\n\n## Test Infrastructure Available\n\n###  Tools We Have\n\n1. **Page Object Model**\n   - `tests/e2e/page-objects/CheckoutPage.ts` - Comprehensive page object\n   - `placeOrder()` method available (line 430)\n   - `isOnConfirmationPage()` method available (line 232)\n\n2. **Test Helpers**\n   - `tests/e2e/critical/helpers/critical-test-helpers.ts`\n   - Cart management, user login, navigation helpers\n\n3. **Visual Regression Setup**\n   - `tests/visual-regression/checkout-flow.spec.ts` - 22 tests, 28 screenshots\n   - Multi-viewport (desktop, tablet, mobile)\n   - Multi-locale (en, es, ro, ru)\n   - Dynamic content masking (prices, timestamps)\n\n4. **Test Data**\n   - `tests/e2e/critical/constants.ts` - Test addresses, selectors\n   - `tests/e2e/fixtures/` - Test fixtures and helpers\n\n---\n\n## Recommendations\n\n###  Immediate Actions (This Week)\n\n1. **Enable Full End-to-End Tests**\n   - **Action:** Uncomment order placement in tests\n   - **Solution:** Use test database or order cleanup strategy\n   - **Files:**\n     - `tests/e2e/checkout-full-flow.spec.ts` lines 132-134 (edit mode)\n     - `tests/e2e/checkout-full-flow.spec.ts` line 200 (guest checkout)\n   - **Implementation:**\n     ```typescript\n     // Remove skip, enable order placement\n     await checkoutPage.placeOrder()\n     await expect(page).toHaveURL(/\\/checkout\\/confirmation/, { timeout: 15000 })\n     console.log(' Order placed, on confirmation page')\n     ```\n\n2. **Add Confirmation Page Visual Regression Tests**\n   - **Action:** Add 8 new screenshots\n   - **Scenarios:**\n     - Confirmation page - desktop (en, es, ro, ru) = 4 screenshots\n     - Confirmation page - mobile (en, es) = 2 screenshots\n     - Confirmation page - tablet (en) = 1 screenshot\n     - Confirmation with express checkout = 1 screenshot\n   - **Total:** +8 screenshots (36 total)\n\n3. **Add Order Cleanup Utility**\n   - **Action:** Create test order cleanup script\n   - **Purpose:** Delete test orders after E2E tests complete\n   - **Location:** `tests/fixtures/order-cleanup.ts`\n\n###  Medium Term (Next 2 Weeks)\n\n4. **Multi-Locale Full Flow Tests**\n   - Add guest checkout test for each locale (4 tests)\n   - Add edit mode test for each locale (4 tests)\n   - **Total:** +8 E2E tests\n\n5. **Payment Method Coverage**\n   - Add Stripe test mode credit card test (1 test)\n   - Add PayPal sandbox test (1 test) - if PayPal is implemented\n   - **Total:** +2 E2E tests\n\n6. **Email Delivery Tests**\n   - Add email confirmation test for guest checkout\n   - Add email confirmation test for authenticated user\n   - **Total:** +2 E2E tests\n\n---\n\n## Current Test Suite Statistics\n\n### E2E Tests\n- **Total E2E Tests:** 24 critical checkout tests\n- **Passing:** 24/24 \n- **Coverage:** 70% (stops before confirmation for 2/3 flows)\n\n### Visual Regression Tests\n- **Total Visual Tests:** 22 tests\n- **Total Screenshots:** 28 screenshots\n- **Status:**  Generating baselines (in progress)\n- **Viewports:** 3 (desktop 1920x1080, tablet 768x1024, mobile 375x667)\n- **Locales:** 4 (en, es, ro, ru)\n\n### Unit Tests\n- **Total Unit Tests:** 1,390 passing\n- **Checkout Stores:**  Fully covered\n- **Payment Processing:**  Fully covered\n- **Session Management:**  Fully covered\n\n---\n\n## Action Items Summary\n\n| Priority | Action | Estimated Effort | Files to Modify |\n|----------|--------|-----------------|-----------------|\n|  HIGH | Enable order placement in tests | 2 hours | `checkout-full-flow.spec.ts` |\n|  HIGH | Add confirmation page visual tests | 3 hours | `checkout-flow.spec.ts` |\n|  HIGH | Add order cleanup utility | 2 hours | `tests/fixtures/order-cleanup.ts` (new) |\n|  MEDIUM | Multi-locale full flow tests | 4 hours | `checkout-full-flow.spec.ts` |\n|  MEDIUM | Payment method variety tests | 6 hours | `checkout-payment.spec.ts` (new) |\n|  MEDIUM | Email delivery tests | 4 hours | `checkout-email.spec.ts` (new) |\n\n**Total Estimated Effort:** 21 hours (~3 days)\n\n---\n\n## Conclusion\n\n **What's Working Well:**\n- Express checkout flow is fully tested end-to-end \n- Visual regression infrastructure is excellent (22 tests, 28 screenshots) \n- Page Object Model is comprehensive and well-structured \n- Critical paths are tested (guest access, auth access, form validation) \n\n **What Needs Improvement:**\n- Guest checkout and Edit mode flows stop before confirmation \n- No confirmation page visual tests (0 screenshots) \n- Limited multi-locale coverage for full flows \n- No email delivery verification \n\n**Recommended Next Steps:**\n1. Generate visual regression baselines (in progress)\n2. Review the 28 screenshots to validate UI/UX\n3. Enable order placement in existing tests (2 hours)\n4. Add confirmation page visual tests (3 hours)\n5. Run full test suite to verify 100% end-to-end coverage\n\n**Overall Assessment:** Test coverage is **GOOD but INCOMPLETE**. The infrastructure is excellent, but critical flows don't reach the confirmation page. Recommend addressing HIGH priority items before considering checkout feature \"fully tested.\"\n",
              "category": "archive"
            },
            {
              "path": "docs/archive/testing/checkout/END-TO-END-TESTING-COMPLETE.md",
              "name": "END-TO-END-TESTING-COMPLETE.md",
              "size": 12516,
              "lastModified": "2026-01-06T15:49:37.109Z",
              "content": "# End-to-End Testing Implementation - Complete \n\n**Date:** 2025-12-26\n**Branch:** `claude/improve-checkout-ux-aNjjK`\n**Status:**  **COMPLETE** - All 3 Option D flows now fully tested to confirmation page\n\n---\n\n##  Summary\n\nSuccessfully implemented **complete end-to-end testing** for all three Option D (Hybrid Progressive Checkout) user flows:\n\n| Flow | Before | After | Status |\n|------|--------|-------|--------|\n| **Returning User (Express)** |  95% |  100% | **COMPLETE** |\n| **Edit Mode (Returning)** |  70% |  100% | **COMPLETE** |\n| **New User (Guest)** |  70% |  100% | **COMPLETE** |\n\n**Overall Coverage:** 78%  **100%** \n\n---\n\n##  Changes Made\n\n### 1.  Enabled Order Placement in E2E Tests\n\n**File:** `tests/e2e/checkout-full-flow.spec.ts`\n\n#### Authenticated User / Edit Mode (lines 130-140)\n```typescript\n// BEFORE: Stopped at \"Place Order\" button\nawait expect(checkoutPage.placeOrderButton).toBeVisible({ timeout: 5000 })\nconsole.log(' Step 8: Place order button visible')\n// COMMENTED OUT: await checkoutPage.placeOrder()\n\n// AFTER: Complete flow to confirmation page\nawait expect(checkoutPage.placeOrderButton).toBeVisible({ timeout: 5000 })\nconsole.log(' Step 8: Place order button visible')\n\nawait checkoutPage.placeOrder()\nawait expect(page).toHaveURL(/\\/checkout\\/confirmation/, { timeout: 15000 })\nconsole.log(' Step 9: Order placed, on confirmation page')\n\n// Verify confirmation page elements\nconst confirmationTitle = page.locator('h1, h2').filter({ hasText: /order.*confirmed|pedido.*confirmado|.*|comand.*confirmat/i })\nawait expect(confirmationTitle).toBeVisible({ timeout: 5000 })\nconsole.log(' Step 10: Confirmation title visible')\n```\n\n**Impact:** Authenticated users can now complete full checkout flow from login  confirmation\n\n#### Guest User Flow (lines 204-214)\n```typescript\n// BEFORE: Stopped at \"Place Order\" button\nawait expect(checkoutPage.placeOrderButton).toBeVisible({ timeout: 5000 })\nconsole.log(' Guest checkout flow validated successfully!')\n\n// AFTER: Complete flow to confirmation page\nawait expect(checkoutPage.placeOrderButton).toBeVisible({ timeout: 5000 })\n\nawait checkoutPage.placeOrder()\nawait expect(page).toHaveURL(/\\/checkout\\/confirmation/, { timeout: 15000 })\nconsole.log(' Step 10: Order placed, on confirmation page')\n\n// Verify confirmation page elements\nconst confirmationTitle = page.locator('h1, h2').filter({ hasText: /order.*confirmed|pedido.*confirmado|.*|comand.*confirmat/i })\nawait expect(confirmationTitle).toBeVisible({ timeout: 5000 })\nconsole.log(' Step 11: Confirmation title visible')\n```\n\n**Impact:** Guest users can now complete full checkout flow from cart  confirmation\n\n---\n\n### 2.  Confirmation Page Visual Regression Tests (Future Work)\n\n**Status:** Removed - tests were entirely skipped due to known issue\n\n**Issue:** The checkout store's `calculateOrderData` shows 0.00 subtotal during test execution,\npreventing shipping methods from loading. This requires investigation into how cart state\nis synced to checkout store during SSR/hydration.\n\n**TODO:** Re-implement when cartcheckout state sync is fixed for SSR/hydration\n\n**Planned Coverage:** 10 screenshot tests across guest, multi-locale, and express checkout flows\n\n---\n\n### 3.  Created Checkout Helpers for Visual Tests\n\n**File:** `tests/e2e/visual-regression/helpers.ts` (NEW - 178 lines)\n\n**Purpose:** Reusable helper methods for visual regression tests\n\n**Methods:**\n```typescript\nclass CheckoutHelpers {\n  addProductAndGoToCheckout()    // Add product + navigate to checkout\n  continueAsGuest()               // Handle guest prompt\n  fillGuestEmail(email)           // Fill guest email field\n  fillAddress(address)            // Fill shipping address form\n  waitForShippingMethods()        // Wait for shipping options to load\n  selectShippingMethod(index)    // Select shipping method by index\n  selectCashPayment()             // Select cash payment option\n  acceptTerms()                   // Accept terms and privacy\n  placeOrder()                    // Click \"Place Order\" button\n}\n```\n\n**Benefits:**\n- Consistent checkout flow across all visual tests\n- Easy to maintain and update\n- Reduces code duplication\n- Handles timing and waits automatically\n\n---\n\n### 4.  Created Order Cleanup Utility\n\n**File:** `tests/fixtures/order-cleanup.ts` (NEW - 240 lines)\n\n**Purpose:** Automatically clean up test orders from the database\n\n**Features:**\n-  Identifies test orders by email patterns\n-  Identifies test orders by ID patterns\n-  Only deletes orders older than specified hours (default: 24h)\n-  Dry-run mode for safety\n-  Verbose logging\n-  Handles foreign key constraints (deletes items first)\n\n**Usage:**\n\n```bash\n# Dry run (see what would be deleted)\nnpx tsx tests/fixtures/order-cleanup.ts --dry-run\n\n# Delete test orders older than 24 hours\nnpx tsx tests/fixtures/order-cleanup.ts\n\n# Delete test orders older than 1 hour\nnpx tsx tests/fixtures/order-cleanup.ts --hours 1\n\n# Delete specific order\nnpx tsx tests/fixtures/order-cleanup.ts ORDER_ID_OR_NUMBER\n```\n\n**Test Email Patterns Detected:**\n- `test@example.com`\n- `teste2e@example.com`\n- `test-visual@example.com`\n- `test-visual-mobile@example.com`\n- `test-visual-tablet@example.com`\n- `test-en@example.com`\n- `test-es@example.com`\n- `test-ro@example.com`\n- `test-ru@example.com`\n- `test-summary@example.com`\n- `guest.test@example.com`\n- `caraseli02@gmail.com` (hardcoded test email)\n\n**Order ID Patterns Detected:**\n- Starts with `test_`\n- Starts with `e2e_`\n- Starts with `visual_`\n\n---\n\n### 5.  Generated Visual Regression Baselines\n\n**Location:** `tests/visual-regression/checkout-flow.spec.ts-snapshots/`\n\n**Status:** 9 of 28 screenshots generated successfully\n\n**Generated Screenshots:**\n1.  `checkout-empty-redirect-desktop.png` - Empty cart redirect (desktop)\n2.  `checkout-empty-redirect-mobile.png` - Empty cart redirect (mobile)\n3.  `checkout-guest-initial-desktop.png` - Guest checkout initial state (desktop)\n4.  `checkout-guest-initial-mobile.png` - Guest checkout initial state (mobile)\n5.  `checkout-initial-desktop-en.png` - Checkout in English (desktop)\n6.  `checkout-initial-desktop-es.png` - Checkout in Spanish (desktop)\n7.  `checkout-initial-desktop-ro.png` - Checkout in Romanian (desktop)\n8.  `checkout-initial-desktop-ru.png` - Checkout in Russian (desktop)\n9.  `checkout-initial-tablet.png` - Checkout initial state (tablet)\n\n** Known Issue:** 19 tests failed with timeout errors on `fullName` field\n- Tests trying to fill address form are timing out\n- Likely related to guest prompt handling or form visibility\n- **Recommended:** Investigate and fix in follow-up task\n\n---\n\n##  Test Suite Statistics\n\n### E2E Tests\n- **Total Checkout Tests:** 24 critical tests\n- **Passing:** 24/24 \n- **Coverage:** **100%** - All flows reach confirmation page \n\n### Visual Regression Tests\n- **Checkout Flow Tests:** 22 passing, 3 skipped (Express Checkout requires auth)\n- **Confirmation Page Tests:** 9 tests skipped (pending orderData sync fix)\n- **Status:**  All checkout flow baselines generated correctly\n- **Action Required:** Investigate orderData calculation issue for confirmation tests\n\n### Unit Tests\n- **Total:** 1,390 passing \n- **Checkout Coverage:** 100% \n\n---\n\n##  Verification Steps\n\n### Test E2E Flows\n\n```bash\n# Run full E2E checkout tests (now with order placement)\nnpx playwright test tests/e2e/checkout-full-flow.spec.ts\n\n# Run critical checkout tests\nnpx playwright test tests/e2e/critical/checkout-critical.spec.ts\n```\n\n**Expected Result:** All tests pass, orders created in database\n\n### Clean Up Test Orders\n\n```bash\n# See what would be deleted (dry run)\nnpx tsx tests/fixtures/order-cleanup.ts --dry-run\n\n# Actually delete test orders\nnpx tsx tests/fixtures/order-cleanup.ts\n```\n\n**Expected Result:** Test orders older than 24h deleted from database\n\n---\n\n##  Known Issues & Follow-Up Tasks\n\n### HIGH PRIORITY\n\n1. **Confirmation Page Visual Tests Skipped** (10 tests)\n   - **Issue:** Cart state not syncing to checkout store during test execution\n   - **Root Cause:** Pinia cart state not persisted during `page.goto()` navigation\n   - **Workaround:** Use client-side navigation via `CheckoutHelpers.addProductAndGoToCheckout()`\n   - **Tracking:** See PR #324 for investigation notes\n   - **Re-enable when:** Cart  Checkout state sync is fixed for SSR/hydration\n\n### RESOLVED \n\n2. **~~Fix Visual Regression Timeout Issues~~**  RESOLVED\n   - Silent catch blocks were hiding failures in test helpers\n   - Fixed by adding proper error throwing in:\n     - `waitForCartUpdate()` - throws when no cart indicator found\n     - `selectShippingMethod()` - throws when no shipping options found\n     - `waitForShippingMethods()` - improved logging\n\n3. **~~Extract Duplicate Navigation Logic~~**  RESOLVED\n   - Added `navigateToCheckoutClientSide()` and `addProductAndNavigateToCheckout()` to CriticalTestHelpers\n   - Reduced code duplication in 4 beforeEach blocks\n\n4. **~~Add Verification Assertions~~**  RESOLVED\n   - Added `expect(checkbox).toBeChecked()` assertions in `acceptTerms()`\n\n### MEDIUM PRIORITY\n\n5. **Review Generated Baselines** (9 screenshots)\n   - **Action:** Manually review the 9 generated screenshots\n   - **Purpose:** Validate UI/UX looks correct across viewports and locales\n   - **Location:** `tests/visual-regression/checkout-flow.spec.ts-snapshots/`\n\n6. **Add to CI/CD Pipeline**\n   - Add `order-cleanup.ts` to test teardown in CI\n   - Ensure test orders don't accumulate in staging/test databases\n   - Add visual regression tests to CI (with baseline comparison)\n\n5. **Payment Method Variety**\n   - Add Stripe test mode credit card tests\n   - Add PayPal sandbox tests (if implemented)\n   - Currently only cash payment is tested\n\n---\n\n##  Documentation Created\n\n1.  `CHECKOUT-TEST-COVERAGE-ANALYSIS.md` - Comprehensive test coverage analysis\n2.  `END-TO-END-TESTING-COMPLETE.md` - This file (implementation summary)\n3.  `tests/fixtures/order-cleanup.ts` - Utility with usage documentation\n\n---\n\n##  Success Metrics\n\n| Metric | Before | After | Improvement |\n|--------|--------|-------|-------------|\n| **E2E Coverage** | 78% | **100%** | +22%  |\n| **Flows to Confirmation** | 1/3 | **3/3** | +200%  |\n| **Visual Test Count** | 22 | **32** | +45%  |\n| **Screenshot Assertions** | 28 | **38** | +36%  |\n| **Test Infrastructure** | Good | **Excellent** |  |\n| **Order Cleanup** | Manual | **Automated** |  |\n\n---\n\n##  Summary\n\n### What We Achieved\n\n **100% end-to-end test coverage** for all 3 Option D flows:\n- Returning User (Express Checkout)\n- Edit Mode (Returning User editing details)\n- New User (Guest Checkout)\n\n **All flows now reach confirmation page:**\n- Orders are created in database\n- Confirmation page is verified\n- Order numbers displayed correctly\n\n **10 new confirmation page visual tests:**\n- 3 viewports (desktop, tablet, mobile)\n- 4 locales (en, es, ro, ru)\n- Express checkout variant\n- Component-level testing\n\n **Automated order cleanup:**\n- Prevents test data accumulation\n- Configurable retention period\n- Dry-run mode for safety\n\n **Improved test infrastructure:**\n- Reusable checkout helpers\n- Consistent test patterns\n- Better documentation\n\n### What's Left\n\n **Fix 19 timeout issues** in visual regression tests\n- Investigate fullName field visibility\n- Update helpers with better waits\n- Regenerate all 28 baselines\n\n **Generate confirmation baselines** (10 screenshots)\n- Run visual tests to create baselines\n- Review screenshots for UI/UX validation\n\n **Future enhancements:**\n- Multi-payment method tests (Stripe, PayPal)\n- Express checkout with authenticated users\n- Error state testing (payment failures, validation errors)\n\n---\n\n##  Next Steps for User\n\n1. **Review this document** - Understand what changed\n2. **Review 9 generated screenshots** - Validate UI looks correct\n   - Location: `tests/visual-regression/checkout-flow.spec.ts-snapshots/`\n3. **Decide on next priority:**\n   - Option A: Fix timeout issues first (recommended)\n   - Option B: Generate confirmation baselines first\n   - Option C: Run E2E tests to verify order placement works\n\n---\n\n**Status:**  Ready for testing and validation\n**Recommendation:** Fix timeout issues, then generate all baselines, then run full test suite\n",
              "category": "archive"
            }
          ],
          "similarity": 0.8264752879818152,
          "recommendation": "Consider consolidating into CHECKOUT-TEST-COVERAGE-ANALYSIS.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/development/code-conventions.md",
              "name": "code-conventions.md",
              "size": 11736,
              "lastModified": "2025-12-04T10:27:33.863Z",
              "content": "---\ninclude: prompt\nweight: 40\n---\n\n# Code Conventions\n\n## TypeScript Standards\n\n### Code Style\n- Use **double quotes** for strings consistently\n- Always use **semicolons** to terminate statements\n- Use consistent indentation (2 spaces)\n- Add trailing commas in multi-line objects and arrays\n\n### Type Definitions\n- Use `interface` for object types that may be extended\n- Use `type` for unions, intersections, and computed types\n- Prefer explicit return types for public functions\n- Use `unknown` instead of `any` when type is uncertain\n\n```typescript\n// Preferred - Note the consistent use of double quotes and semicolons\ninterface User {\n  id: number;\n  email: string;\n  preferences: UserPreferences;\n}\n\ntype Status = \"pending\" | \"approved\" | \"rejected\";\n\n// Function with explicit return type\nfunction getUser(id: number): Promise<User | null> {\n  // implementation\n}\n```\n\n### Import/Export Conventions\n- Use named imports for utilities and specific functions\n- Use default exports for Vue components and main module exports\n- Group imports: external libraries first, then internal modules\n- Use `import type` for type-only imports\n\n```typescript\n// External libraries\nimport { ref, computed } from \"vue\";\nimport { z } from \"zod\";\n\n// Internal utilities\nimport { formatPrice } from \"~/utils/currency\";\nimport { useCart } from \"~/composables/useCart\";\n\n// Type imports\nimport type { Product, CartItem } from \"~/types\";\n```\n\n## Vue Component Standards\n\n### Component Structure\nFollow this order in `<script setup>`:\n\n1. Type imports\n2. Library imports (Vue, Nuxt, etc.)\n3. Component imports\n4. Utility imports\n5. Props definition\n6. Emits definition\n7. Composables\n8. Reactive state\n9. Computed properties\n10. Methods/functions\n11. Lifecycle hooks\n\n```vue\n<script setup lang=\"ts\">\n// 1. Type imports\nimport type { Product } from \"~/types\";\n\n// 2. Library imports\nimport { ref, computed, onMounted } from \"vue\";\n\n// 3. Component imports\nimport ProductCard from \"~/components/ProductCard.vue\";\n\n// 4. Utility imports\nimport { formatPrice } from \"~/utils/currency\";\n\n// 5. Props\ninterface Props {\n  product: Product;\n  showDetails?: boolean;\n}\nconst props = withDefaults(defineProps<Props>(), {\n  showDetails: false,\n});\n\n// 6. Emits\ninterface Emits {\n  addToCart: [product: Product, quantity: number];\n}\nconst emit = defineEmits<Emits>();\n\n// 7. Composables\nconst { addItem } = useCart();\n\n// 8. Reactive state\nconst quantity = ref(1);\nconst isLoading = ref(false);\n\n// 9. Computed properties\nconst formattedPrice = computed(() => formatPrice(props.product.price));\n\n// 10. Methods\nconst handleAddToCart = async () => {\n  isLoading.value = true;\n  await addItem(props.product, quantity.value);\n  emit(\"addToCart\", props.product, quantity.value);\n  isLoading.value = false;\n};\n\n// 11. Lifecycle hooks\nonMounted(() => {\n  // initialization logic\n});\n</script>\n```\n\n### Props and Emits\n- Always use TypeScript interfaces for props\n- Provide default values for optional props using `withDefaults`\n- Use descriptive emit names that indicate the action\n- Include payload types in emit definitions\n\n### Template Conventions\n- Use semantic HTML elements\n- Prefer `v-show` for frequently toggled elements\n- Prefer `v-if` for conditional rendering\n- Use `data-testid` attributes for testing selectors\n- Avoid inline styles; use Tailwind classes\n\n```vue\n<template>\n  <article class=\"product-card\" data-testid=\"product-card\">\n    <header class=\"product-header\">\n      <h2 class=\"text-xl font-semibold\">{{ product.name }}</h2>\n    </header>\n    \n    <main class=\"product-content\">\n      <p v-if=\"showDescription\" class=\"text-gray-600\">\n        {{ product.description }}\n      </p>\n    </main>\n    \n    <footer class=\"product-actions\">\n      <button \n        type=\"button\"\n        :disabled=\"isLoading\"\n        class=\"btn btn-primary\"\n        data-testid=\"add-to-cart-btn\"\n        @click=\"handleAddToCart\"\n      >\n        {{ $t('products.addToCart') }}\n      </button>\n    </footer>\n  </article>\n</template>\n```\n\n## API Route Standards\n\n### File Organization\n- Group related endpoints in folders\n- Use HTTP method suffixes in filenames\n- Implement consistent error handling\n- Use Zod for request validation\n\n```typescript\n// server/api/products/[id].get.ts\nexport default defineEventHandler(async (event) => {\n  try {\n    const id = getRouterParam(event, \"id\");\n    const productId = z.string().parse(id);\n    \n    const product = await getProductById(parseInt(productId));\n    \n    if (!product) {\n      throw createError({\n        statusCode: 404,\n        statusMessage: \"Product not found\",\n      });\n    }\n    \n    return product;\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      throw createError({\n        statusCode: 400,\n        statusMessage: \"Invalid product ID\",\n      });\n    }\n    throw error;\n  }\n});\n```\n\n### Request/Response Patterns\n- Validate input with Zod schemas\n- Return consistent response formats\n- Use appropriate HTTP status codes\n- Include error details in development only\n\n```typescript\n// Response format\ninterface ApiResponse<T> {\n  data: T;\n  message?: string;\n}\n\ninterface ApiError {\n  statusCode: number;\n  statusMessage: string;\n  details?: any; // Only in development\n}\n```\n\n## Database Conventions\n\n### Schema Design\n- Use singular table names (`user`, `product`, not `users`, `products`)\n- Primary keys should be `id` (integer, auto-increment)\n- Foreign keys use descriptive names (`userId`, `categoryId`)\n- Use `createdAt` and `updatedAt` for timestamps\n- Use JSON columns for translations and flexible data\n\n```typescript\n// schema/products.ts\nexport const product = sqliteTable(\"product\", {\n  id: integer(\"id\").primaryKey({ autoIncrement: true }),\n  slug: text(\"slug\").notNull().unique(),\n  nameTranslations: text(\"name_translations\", { mode: \"json\" })\n    .$type<Record<string, string>>()\n    .notNull(),\n  price: integer(\"price\").notNull(), // Store as cents\n  stock: integer(\"stock\").notNull().default(0),\n  categoryId: integer(\"category_id\").references(() => category.id),\n  createdAt: text(\"created_at\").default(sql`CURRENT_TIMESTAMP`),\n  updatedAt: text(\"updated_at\").default(sql`CURRENT_TIMESTAMP`),\n});\n```\n\n### Query Patterns\n- Use Drizzle ORM for type safety\n- Implement proper error handling\n- Use transactions for related operations\n- Index frequently queried columns\n\n```typescript\n// Good: Type-safe query with error handling\nasync function getProductWithCategory(productId: number): Promise<ProductWithCategory | null> {\n  try {\n    const result = await db\n      .select()\n      .from(product)\n      .leftJoin(category, eq(product.categoryId, category.id))\n      .where(eq(product.id, productId))\n      .limit(1);\n    \n    if (result.length === 0) return null;\n    \n    return {\n      ...result[0].product,\n      category: result[0].category,\n    };\n  } catch (error) {\n    console.error(\"Failed to get product:\", error);\n    throw new Error(\"Database query failed\");\n  }\n}\n```\n\n## Testing Standards\n\n### Test Organization\n- Group tests by feature/component\n- Use descriptive test names\n- Follow AAA pattern (Arrange, Act, Assert)\n- Use Page Object Model for E2E tests\n\n```typescript\n// tests/e2e/shopping-cart.spec.ts\ntest.describe(\"Shopping Cart\", () => {\n  test(\"should add product to cart and update count\", async ({ page }) => {\n    // Arrange\n    await page.goto(\"/products/test-product\");\n    \n    // Act\n    await page.click('[data-testid=\"add-to-cart-btn\"]');\n    \n    // Assert\n    await expect(page.locator('[data-testid=\"cart-count\"]')).toHaveText(\"1\");\n    await expect(page.locator(\".toast\")).toContainText(\"Product added to cart\");\n  });\n});\n```\n\n### Data Attributes\n- Use `data-testid` for test selectors\n- Make selectors stable and meaningful\n- Avoid coupling tests to styling classes\n\n```vue\n<!-- Good: Stable test selectors -->\n<button data-testid=\"add-to-cart-btn\" class=\"btn btn-primary\">\n  Add to Cart\n</button>\n\n<div data-testid=\"cart-item\" data-product-id=\"{{ product.id }}\">\n  <!-- cart item content -->\n</div>\n```\n\n## Error Handling\n\n### Client-Side Errors\n- Use composables for error state management\n- Provide user-friendly error messages\n- Log errors for debugging\n- Implement retry mechanisms for network errors\n\n```typescript\n// composables/useErrorHandler.ts\nexport const useErrorHandler = () => {\n  const handleApiError = (error: any) => {\n    if (error.statusCode >= 500) {\n      // Server error - show generic message\n      showToast({\n        type: \"error\",\n        message: \"Something went wrong. Please try again later.\",\n      });\n    } else if (error.statusCode >= 400) {\n      // Client error - show specific message\n      showToast({\n        type: \"error\",\n        message: error.statusMessage || \"Invalid request\",\n      });\n    }\n    \n    // Log for debugging\n    console.error(\"API Error:\", error);\n  };\n  \n  return { handleApiError };\n};\n```\n\n### Server-Side Errors\n- Use consistent error response format\n- Log errors with context\n- Don't expose sensitive information\n- Use appropriate HTTP status codes\n\n```typescript\n// server/utils/errorHandler.ts\nexport function handleDatabaseError(error: any) {\n  console.error('Database error:', {\n    message: error.message,\n    stack: error.stack,\n    timestamp: new Date().toISOString()\n  })\n  \n  throw createError({\n    statusCode: 500,\n    statusMessage: 'Internal server error'\n  })\n}\n```\n\n## Performance Guidelines\n\n### Component Performance\n- Use `computed` for derived data\n- Implement `v-memo` for expensive list items\n- Lazy load heavy components\n- Optimize image loading with Nuxt Image\n\n```vue\n<script setup>\n// Use computed for expensive calculations\nconst expensiveCalculation = computed(() => {\n  return props.items.reduce((sum, item) => sum + item.price * item.quantity, 0)\n})\n\n// Memoize list items that don't change often\nconst memoizedItems = computed(() => {\n  return props.items.map(item => ({\n    ...item,\n    formattedPrice: formatPrice(item.price)\n  }))\n})\n</script>\n\n<template>\n  <!-- Use v-memo for expensive list rendering -->\n  <div\n    v-for=\"item in memoizedItems\"\n    v-memo=\"[item.id, item.quantity, item.price]\"\n    :key=\"item.id\"\n  >\n    <!-- item content -->\n  </div>\n</template>\n```\n\n### API Performance\n- Implement response caching\n- Use database indexes\n- Batch related queries\n- Implement pagination for large datasets\n\n```typescript\n// Cache responses appropriately\nexport default defineEventHandler(async (event) => {\n  // Cache product list for 5 minutes\n  return await cachedFunction(async () => {\n    return await getProducts()\n  }, {\n    maxAge: 300, // 5 minutes\n    name: 'products-list'\n  })()\n})\n```\n\n## Security Guidelines\n\n### Input Validation\n- Validate all user inputs with Zod\n- Sanitize data before database operations\n- Use parameterized queries (Drizzle handles this)\n- Validate file uploads\n\n### Authentication\n- Use JWT with appropriate expiration\n- Implement refresh token rotation\n- Store tokens securely (httpOnly cookies)\n- Validate permissions on every request\n\n### Data Protection\n- Never log sensitive information\n- Use environment variables for secrets\n- Implement rate limiting\n- Validate CORS settings\n\n```typescript\n// Secure JWT handling\nexport const useAuth = () => {\n  const login = async (credentials: LoginCredentials) => {\n    const { accessToken, refreshToken } = await $fetch('/api/auth/login', {\n      method: 'POST',\n      body: credentials\n    })\n    \n    // Store refresh token in httpOnly cookie\n    const refreshCookie = useCookie('refresh-token', {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'strict',\n      maxAge: 60 * 60 * 24 * 7 // 7 days\n    })\n    \n    refreshCookie.value = refreshToken\n    \n    // Store access token in memory/state\n    authStore.setAccessToken(accessToken)\n  }\n}\n```",
              "category": "reference"
            },
            {
              "path": "docs/notebooklm/05_CODE_CONVENTIONS.md",
              "name": "05_CODE_CONVENTIONS.md",
              "size": 6486,
              "lastModified": "2026-01-06T15:49:37.115Z",
              "content": "# Moldova Direct - Code Conventions\n\n## TypeScript Standards\n\n### Code Style\n- Double quotes for strings\n- Semicolons to terminate statements\n- 2-space indentation\n- Trailing commas in multi-line objects/arrays\n\n### Type Definitions\n- `interface` for extendable object types\n- `type` for unions, intersections, computed types\n- Explicit return types for public functions\n- `unknown` instead of `any` when type is uncertain\n\n```typescript\ninterface User {\n  id: number;\n  email: string;\n  preferences: UserPreferences;\n}\n\ntype Status = \"pending\" | \"approved\" | \"rejected\";\n\nfunction getUser(id: number): Promise<User | null> {\n  // implementation\n}\n```\n\n### Import Conventions\n- Named imports for utilities\n- Default exports for Vue components\n- Group imports: external  internal  types\n- Use `import type` for type-only imports\n\n```typescript\n// External libraries\nimport { ref, computed } from \"vue\";\nimport { z } from \"zod\";\n\n// Internal utilities\nimport { formatPrice } from \"~/utils/currency\";\nimport { useCart } from \"~/composables/useCart\";\n\n// Type imports\nimport type { Product, CartItem } from \"~/types\";\n```\n\n## Vue Component Standards\n\n### Component Structure Order\n1. Type imports\n2. Library imports (Vue, Nuxt)\n3. Component imports\n4. Utility imports\n5. Props definition\n6. Emits definition\n7. Composables\n8. Reactive state\n9. Computed properties\n10. Methods/functions\n11. Lifecycle hooks\n\n```vue\n<script setup lang=\"ts\">\n// 1. Type imports\nimport type { Product } from \"~/types\";\n\n// 2. Library imports\nimport { ref, computed, onMounted } from \"vue\";\n\n// 3. Component imports\nimport ProductCard from \"~/components/ProductCard.vue\";\n\n// 4. Utility imports\nimport { formatPrice } from \"~/utils/currency\";\n\n// 5. Props\ninterface Props {\n  product: Product;\n  showDetails?: boolean;\n}\nconst props = withDefaults(defineProps<Props>(), {\n  showDetails: false,\n});\n\n// 6. Emits\ninterface Emits {\n  addToCart: [product: Product, quantity: number];\n}\nconst emit = defineEmits<Emits>();\n\n// 7. Composables\nconst { addItem } = useCart();\n\n// 8. Reactive state\nconst quantity = ref(1);\n\n// 9. Computed properties\nconst formattedPrice = computed(() => formatPrice(props.product.price));\n\n// 10. Methods\nconst handleAddToCart = async () => {\n  await addItem(props.product, quantity.value);\n  emit(\"addToCart\", props.product, quantity.value);\n};\n\n// 11. Lifecycle hooks\nonMounted(() => {\n  // initialization\n});\n</script>\n```\n\n### Template Conventions\n- Semantic HTML elements\n- `v-show` for frequently toggled elements\n- `v-if` for conditional rendering\n- `data-testid` attributes for testing\n- Tailwind classes instead of inline styles\n\n```vue\n<template>\n  <article class=\"product-card\" data-testid=\"product-card\">\n    <header class=\"product-header\">\n      <h2 class=\"text-xl font-semibold\">{{ product.name }}</h2>\n    </header>\n\n    <main class=\"product-content\">\n      <p v-if=\"showDescription\" class=\"text-gray-600\">\n        {{ product.description }}\n      </p>\n    </main>\n\n    <footer class=\"product-actions\">\n      <button\n        type=\"button\"\n        :disabled=\"isLoading\"\n        class=\"btn btn-primary\"\n        data-testid=\"add-to-cart-btn\"\n        @click=\"handleAddToCart\"\n      >\n        {{ $t('products.addToCart') }}\n      </button>\n    </footer>\n  </article>\n</template>\n```\n\n## Naming Conventions\n\n### Files & Directories\n- **Components**: PascalCase (`ProductCard.vue`)\n- **Pages**: kebab-case (`track-order.vue`)\n- **API Routes**: RESTful with method suffix (`products.get.ts`)\n- **Stores**: camelCase (`cart.ts`)\n- **Composables**: camelCase with `use` prefix (`useCart.ts`)\n- **Types**: PascalCase interfaces (`ProductWithRelations`)\n\n### Code\n- **Variables**: camelCase\n- **Constants**: UPPER_SNAKE_CASE\n- **CSS Classes**: Tailwind utilities\n- **Database**: snake_case for tables/columns\n\n## API Route Standards\n\n### File Organization\n```\nserver/api/\n auth/              # Authentication endpoints\n products/          # Product-related endpoints\n categories/        # Category endpoints\n admin/             # Admin-only endpoints\n upload/            # File upload endpoints\n```\n\n### Route Naming\n- `index.get.ts`  GET /api/resource\n- `[id].get.ts`  GET /api/resource/:id\n- `create.post.ts`  POST /api/resource\n- `[id].patch.ts`  PATCH /api/resource/:id\n- `[id].delete.ts`  DELETE /api/resource/:id\n\n### Request Handling\n```typescript\nexport default defineEventHandler(async (event) => {\n  try {\n    const id = getRouterParam(event, \"id\");\n    const productId = z.string().parse(id);\n\n    const product = await getProductById(parseInt(productId));\n\n    if (!product) {\n      throw createError({\n        statusCode: 404,\n        statusMessage: \"Product not found\",\n      });\n    }\n\n    return product;\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      throw createError({\n        statusCode: 400,\n        statusMessage: \"Invalid product ID\",\n      });\n    }\n    throw error;\n  }\n});\n```\n\n## Testing Standards\n\n### Test Organization\n- Group tests by feature/component\n- Descriptive test names starting with \"should\"\n- AAA pattern (Arrange, Act, Assert)\n- Page Object Model for E2E\n\n```typescript\ntest.describe(\"Shopping Cart\", () => {\n  test(\"should add product to cart and update count\", async ({ page }) => {\n    // Arrange\n    await page.goto(\"/products/test-product\");\n\n    // Act\n    await page.click('[data-testid=\"add-to-cart-btn\"]');\n\n    // Assert\n    await expect(page.locator('[data-testid=\"cart-count\"]')).toHaveText(\"1\");\n  });\n});\n```\n\n### Data Attributes\n```vue\n<!-- Use stable test selectors -->\n<button data-testid=\"add-to-cart-btn\">Add to Cart</button>\n<div data-testid=\"cart-item\" :data-product-id=\"product.id\">\n```\n\n## Error Handling\n\n### Client-Side\n- Use composables for error state\n- User-friendly messages\n- Log errors for debugging\n- Retry for network errors\n\n### Server-Side\n- Consistent error format\n- Log with context\n- Don't expose sensitive info\n- Appropriate HTTP status codes\n\n## Critical Rules\n\n### Admin Panel\n1. **Static imports only** - Dynamic imports cause 500 errors\n2. **Both middlewares required** - `auth` and `admin`\n3. **Clear cache after changes** - `rm -rf .nuxt node_modules/.vite`\n\n### Internationalization\n- All UI text must have translations in ALL 4 locales\n- Use `$t('key')` in templates\n- Use `t('key')` in script\n\n### Git\n- Never skip git hooks (`--no-verify`)\n- Fix failing hooks instead of bypassing\n- Descriptive commit messages\n",
              "category": "reference"
            }
          ],
          "similarity": 0.8054795885165896,
          "recommendation": "Consider consolidating into 05_CODE_CONVENTIONS.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/guides/TESTING.md",
              "name": "TESTING.md",
              "size": 9972,
              "lastModified": "2025-12-04T10:27:33.891Z",
              "content": "#  Testing Guide - Moldova Direct\n\nComprehensive testing setup using Playwright for end-to-end testing with multi-language support and visual regression testing.\n\n## Overview\n\nThe testing framework provides:\n- **End-to-End Testing**: Complete user journey validation\n- **Multi-Language Testing**: All 4 locales (ES, EN, RO, RU)\n- **Visual Regression**: Screenshot comparison testing\n- **Responsive Testing**: Mobile and desktop viewports\n- **CI/CD Integration**: Automated testing on GitHub Actions\n\n## Test Structure\n\n```\ntests/\n e2e/                    # End-to-end test specs\n    auth.spec.ts       # Authentication flows\n    basic.spec.ts      # Basic navigation and routing\n    checkout.spec.ts   # Shopping cart and checkout\n    i18n.spec.ts       # Internationalization features\n    products.spec.ts   # Product catalog functionality\n    ui-current.spec.ts # Current UI visual validation\n fixtures/              # Test utilities and helpers\n    base.ts           # Base test class with common setup\n    helpers.ts        # Utility functions\n    pages.ts          # Page object models\n visual/               # Visual regression tests\n    ui-validation.spec.ts      # UI component validation\n    visual-regression.spec.ts  # Full page comparisons\n global-setup.ts       # Global test environment setup\n global-teardown.ts    # Cleanup after test runs\n```\n\n## Running Tests\n\n### Local Development\n\n```bash\n# Install dependencies (if not already done)\nnpm install\n\n# Run all tests\nnpm run test\n\n# Run tests with UI (interactive mode)\nnpm run test:ui\n\n# Run specific test file\nnpx playwright test auth.spec.ts\n\n# Run tests in headed mode (see browser)\nnpx playwright test --headed\n\n# Debug specific test\nnpx playwright test auth.spec.ts --debug\n```\n\n### Test Commands\n\n```bash\n# Run all E2E tests\nnpm run test:e2e\n\n# Run visual regression tests\nnpm run test:visual\n\n# Update visual baselines (when UI changes are intentional)\nnpm run test:update-snapshots\n\n# Generate test report\nnpx playwright show-report\n```\n\n## Test Configuration\n\n### Playwright Config (`playwright.config.ts`)\n\n```typescript\nexport default defineConfig({\n  testDir: './tests',\n  fullyParallel: true,\n  forbidOnly: !!process.env.CI,\n  retries: process.env.CI ? 2 : 0,\n  workers: process.env.CI ? 1 : undefined,\n  reporter: [\n    ['html'],\n    ['junit', { outputFile: 'test-results/junit.xml' }],\n    ['json', { outputFile: 'test-results/results.json' }]\n  ],\n  use: {\n    baseURL: 'http://localhost:3000',\n    trace: 'on-first-retry',\n    screenshot: 'only-on-failure'\n  },\n  projects: [\n    {\n      name: 'chromium',\n      use: { ...devices['Desktop Chrome'] }\n    },\n    {\n      name: 'firefox',\n      use: { ...devices['Desktop Firefox'] }\n    },\n    {\n      name: 'webkit',\n      use: { ...devices['Desktop Safari'] }\n    },\n    {\n      name: 'Mobile Chrome',\n      use: { ...devices['Pixel 5'] }\n    }\n  ],\n  webServer: {\n    command: 'npm run dev',\n    url: 'http://localhost:3000',\n    reuseExistingServer: !process.env.CI\n  }\n});\n```\n\n## Test Categories\n\n### 1. Authentication Tests (`auth.spec.ts`)\n\nTests user authentication flows:\n\n```typescript\ntest.describe('Authentication', () => {\n  test('user can register with valid credentials', async ({ page }) => {\n    await page.goto('/auth/register');\n    await page.fill('[name=\"email\"]', 'test@example.com');\n    await page.fill('[name=\"password\"]', 'password123');\n    await page.fill('[name=\"confirmPassword\"]', 'password123');\n    await page.click('button[type=\"submit\"]');\n    \n    await expect(page).toHaveURL('/account');\n  });\n\n  test('user can login with valid credentials', async ({ page }) => {\n    // Test implementation\n  });\n\n  test('user can logout', async ({ page }) => {\n    // Test implementation\n  });\n});\n```\n\n### 2. Internationalization Tests (`i18n.spec.ts`)\n\nTests multi-language functionality:\n\n```typescript\nconst locales = ['es', 'en', 'ro', 'ru'];\n\nfor (const locale of locales) {\n  test(`homepage loads in ${locale}`, async ({ page }) => {\n    await page.goto(`/${locale === 'es' ? '' : locale}`);\n    \n    // Verify language-specific content\n    const expectedTitle = translations[locale].home.title;\n    await expect(page.locator('h1')).toContainText(expectedTitle);\n  });\n}\n```\n\n### 3. Visual Regression Tests (`ui-current.spec.ts`)\n\nCaptures and compares screenshots:\n\n```typescript\ntest('homepage visual snapshot', async ({ page }) => {\n  await page.goto('/');\n  await expect(page).toHaveScreenshot('homepage-current-full.png', {\n    fullPage: true\n  });\n});\n\ntest('mobile homepage snapshot', async ({ page }) => {\n  await page.setViewportSize({ width: 375, height: 667 });\n  await page.goto('/');\n  await expect(page).toHaveScreenshot('homepage-mobile-current.png');\n});\n```\n\n### 4. Product Catalog Tests (`products.spec.ts`)\n\nTests product browsing and search:\n\n```typescript\ntest('product search functionality', async ({ page }) => {\n  await page.goto('/products');\n  await page.fill('[data-testid=\"search-input\"]', 'wine');\n  await page.keyboard.press('Enter');\n  \n  // Verify search results\n  await expect(page.locator('[data-testid=\"product-card\"]')).toHaveCount(3);\n});\n```\n\n## Test Data and Fixtures\n\n### Base Test Class (`fixtures/base.ts`)\n\n```typescript\nimport { test as base } from '@playwright/test';\n\nexport const test = base.extend<{\n  authenticatedPage: Page;\n}>({\n  authenticatedPage: async ({ page }, use) => {\n    // Login user before test\n    await page.goto('/auth/login');\n    await page.fill('[name=\"email\"]', 'test@example.com');\n    await page.fill('[name=\"password\"]', 'password123');\n    await page.click('button[type=\"submit\"]');\n    await page.waitForURL('/account');\n    \n    await use(page);\n  },\n});\n```\n\n### Test Helpers (`fixtures/helpers.ts`)\n\n```typescript\nexport async function seedDatabase() {\n  // Database seeding for tests\n}\n\nexport async function clearDatabase() {\n  // Database cleanup\n}\n\nexport function generateTestUser() {\n  return {\n    email: `test${Date.now()}@example.com`,\n    password: 'password123',\n    name: 'Test User'\n  };\n}\n```\n\n## CI/CD Integration\n\n### GitHub Actions (`.github/workflows/e2e-tests.yml`)\n\n```yaml\nname: E2E Tests\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  e2e-tests:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n          cache: 'npm'\n          \n      - name: Install dependencies\n        run: npm ci\n        \n      - name: Install Playwright browsers\n        run: npx playwright install --with-deps\n        \n      - name: Build application\n        run: npm run build\n        \n      - name: Run E2E tests\n        run: npm run test:e2e\n        \n      - name: Upload test results\n        uses: actions/upload-artifact@v4\n        if: always()\n        with:\n          name: playwright-report\n          path: playwright-report/\n          retention-days: 30\n```\n\n## Visual Testing Guidelines\n\n### When to Update Screenshots\n\n1. **Intentional UI changes**: Run `npm run test:update-snapshots`\n2. **New components**: Add visual tests for new UI elements\n3. **Responsive breakpoints**: Test different viewport sizes\n\n### Screenshot Naming Convention\n\n```\n{page-name}-{variant}-{browser}.png\n\nExamples:\n- homepage-current-full-chromium-es-darwin.png\n- login-page-current-chromium-es-darwin.png\n- products-page-mobile-webkit-en-linux.png\n```\n\n## Debugging Tests\n\n### Local Debugging\n\n```bash\n# Run with browser visible\nnpx playwright test --headed\n\n# Debug specific test with step-by-step execution\nnpx playwright test auth.spec.ts --debug\n\n# Run tests with trace viewer\nnpx playwright test --trace on\nnpx playwright show-trace trace.zip\n```\n\n### Test Reports\n\n```bash\n# Generate HTML report\nnpx playwright show-report\n\n# View test results in browser\nopen playwright-report/index.html\n```\n\n## Best Practices\n\n### 1. Test Isolation\n- Each test should be independent\n- Use fresh data for each test\n- Clean up after tests\n\n### 2. Reliable Selectors\n```typescript\n//  Good - data-testid attributes\nawait page.click('[data-testid=\"submit-button\"]');\n\n//  Good - semantic selectors\nawait page.click('button[type=\"submit\"]');\n\n//  Avoid - fragile CSS selectors\nawait page.click('.btn.btn-primary.mt-4');\n```\n\n### 3. Wait Strategies\n```typescript\n//  Wait for navigation\nawait page.waitForURL('/dashboard');\n\n//  Wait for element\nawait page.waitForSelector('[data-testid=\"success-message\"]');\n\n//  Wait for API calls\nawait page.waitForResponse('**/api/auth/login');\n```\n\n### 4. Error Handling\n```typescript\ntest('handles login error gracefully', async ({ page }) => {\n  await page.goto('/auth/login');\n  await page.fill('[name=\"email\"]', 'invalid@example.com');\n  await page.fill('[name=\"password\"]', 'wrongpassword');\n  await page.click('button[type=\"submit\"]');\n  \n  await expect(page.locator('[data-testid=\"error-message\"]'))\n    .toBeVisible();\n});\n```\n\n## Maintenance\n\n### Regular Tasks\n\n1. **Update snapshots** when UI changes are intentional\n2. **Review test reports** after each CI/CD run\n3. **Clean up test data** regularly\n4. **Update test dependencies** monthly\n\n### Performance Monitoring\n\n- Monitor test execution time\n- Parallel test execution for faster feedback\n- Use appropriate timeouts for different operations\n\n---\n\n## Getting Started Checklist\n\n- [ ] Install Playwright: `npm install`\n- [ ] Install browsers: `npx playwright install`\n- [ ] Run initial tests: `npm run test`\n- [ ] Review test report: `npx playwright show-report`\n- [ ] Set up CI/CD pipeline\n- [ ] Configure visual regression baselines\n\nFor more information, see [Playwright documentation](https://playwright.dev/) and [Testing Best Practices](https://playwright.dev/docs/best-practices).",
              "category": "how-to"
            },
            {
              "path": "docs/notebooklm/07_TESTING_GUIDE.md",
              "name": "07_TESTING_GUIDE.md",
              "size": 7711,
              "lastModified": "2026-01-06T15:49:37.115Z",
              "content": "# Moldova Direct - Testing Guide\n\n## Testing Overview\n\nThe project uses a comprehensive testing strategy with:\n- **Unit Tests**: Vitest for composables, utilities, components\n- **E2E Tests**: Playwright for user flows\n- **Visual Tests**: Screenshot comparison for UI regression\n\n## Test Coverage\n\n| Type | Coverage | Tools |\n|------|----------|-------|\n| Visual | 85% (40/47 pages) | Playwright |\n| E2E | 51% (24/47 pages) | Playwright |\n| Unit | 137 tests passing | Vitest |\n\n## Quick Commands\n\n```bash\n# Run all tests\npnpm test\n\n# Unit tests\npnpm test:unit\npnpm test:unit:watch     # Watch mode\npnpm test:unit:ui        # With UI\npnpm test:coverage       # With coverage\n\n# E2E tests\npnpm test:e2e\npnpm test:headed         # See browser\npnpm test:debug          # Debug mode\n\n# Browser-specific\npnpm test:chromium\npnpm test:firefox\npnpm test:webkit\npnpm test:mobile\n\n# Feature-specific\npnpm test:auth\npnpm test:products\npnpm test:checkout\npnpm test:i18n\n\n# Visual tests\npnpm test:visual\npnpm test:visual:update  # Update snapshots\n\n# Reports\npnpm test:report\n```\n\n## Unit Testing (Vitest)\n\n### Setup\n```bash\npnpm test:unit\n```\n\n### Writing Unit Tests\n\n```typescript\n// tests/unit/composables/useCart.spec.ts\nimport { describe, it, expect, beforeEach } from 'vitest'\nimport { useCart } from '~/composables/useCart'\n\ndescribe('useCart', () => {\n  beforeEach(() => {\n    // Reset cart state\n  })\n\n  it('should add item to cart', () => {\n    const { addItem, items } = useCart()\n\n    addItem({ id: '1', name: 'Product', price: 10 }, 1)\n\n    expect(items.value).toHaveLength(1)\n    expect(items.value[0].quantity).toBe(1)\n  })\n\n  it('should calculate total correctly', () => {\n    const { addItem, total } = useCart()\n\n    addItem({ id: '1', price: 10 }, 2)\n    addItem({ id: '2', price: 15 }, 1)\n\n    expect(total.value).toBe(35)\n  })\n})\n```\n\n### Coverage Targets\n- Global: 70% branches, 75% functions, 80% lines\n- Critical paths (checkout, stripe): 85-90%\n\n## E2E Testing (Playwright)\n\n### Test Structure\n```\ntests/\n e2e/                    # E2E tests\n    auth.spec.ts       # Authentication\n    products.spec.ts   # Product browsing\n    checkout.spec.ts   # Checkout flow\n    i18n.spec.ts       # Internationalization\n visual/                 # Visual regression\n fixtures/              # Test utilities\n    base.ts           # Base configuration\n    helpers.ts        # Helper functions\n    pages.ts          # Page objects\n setup/                 # Setup files\n global-setup.ts       # Global setup\n global-teardown.ts    # Global cleanup\n```\n\n### Writing E2E Tests\n\n```typescript\n// tests/e2e/auth.spec.ts\nimport { test, expect } from '../fixtures/base'\n\ntest.describe('Authentication', () => {\n  test('should login successfully', async ({ page }) => {\n    // Arrange\n    await page.goto('/auth/login')\n\n    // Act\n    await page.fill('[data-testid=\"email-input\"]', 'test@example.com')\n    await page.fill('[data-testid=\"password-input\"]', 'Password123!')\n    await page.click('[data-testid=\"login-button\"]')\n\n    // Assert\n    await expect(page).toHaveURL('/account')\n    await expect(page.locator('[data-testid=\"user-menu\"]')).toBeVisible()\n  })\n\n  test('should show error for invalid credentials', async ({ page }) => {\n    await page.goto('/auth/login')\n\n    await page.fill('[data-testid=\"email-input\"]', 'wrong@example.com')\n    await page.fill('[data-testid=\"password-input\"]', 'wrongpassword')\n    await page.click('[data-testid=\"login-button\"]')\n\n    await expect(page.locator('[data-testid=\"error-message\"]')).toBeVisible()\n  })\n})\n```\n\n### Using Page Objects\n\n```typescript\n// tests/fixtures/pages.ts\nexport class ProductPage {\n  constructor(private page: Page) {}\n\n  async goto(slug: string) {\n    await this.page.goto(`/products/${slug}`)\n  }\n\n  async addToCart(quantity = 1) {\n    await this.page.fill('[data-testid=\"quantity-input\"]', String(quantity))\n    await this.page.click('[data-testid=\"add-to-cart-btn\"]')\n  }\n\n  async getPrice() {\n    return this.page.locator('[data-testid=\"product-price\"]').textContent()\n  }\n}\n\n// Usage in test\ntest('should add product to cart', async ({ page }) => {\n  const productPage = new ProductPage(page)\n  await productPage.goto('wine-cabernet')\n  await productPage.addToCart(2)\n\n  await expect(page.locator('[data-testid=\"cart-count\"]')).toHaveText('2')\n})\n```\n\n### Multi-Locale Testing\n\nTests run across all 4 languages automatically:\n\n```typescript\n// playwright.config.ts projects include locale matrix\ntest('should display correct language', async ({ page }) => {\n  await page.goto('/en/products')\n  await expect(page.locator('h1')).toContainText('Products')\n\n  await page.goto('/es/products')\n  await expect(page.locator('h1')).toContainText('Productos')\n})\n```\n\n## Visual Regression Testing\n\n### Directory Structure\n```\n.visual-testing/\n baselines/          # Reference screenshots (git tracked)\n snapshots/          # Current test run (gitignored)\n reports/            # HTML reports (gitignored)\n utils.ts            # Shared utilities\n```\n\n### Writing Visual Tests\n\n```typescript\n// tests/visual/products.spec.ts\nimport { test, expect } from '@playwright/test'\n\ntest('product page matches snapshot', async ({ page }) => {\n  await page.goto('/products/wine-cabernet')\n\n  // Wait for images to load\n  await page.waitForLoadState('networkidle')\n\n  // Mask dynamic content\n  await expect(page).toHaveScreenshot('product-page.png', {\n    fullPage: true,\n    mask: [\n      page.locator('[data-testid=\"timestamp\"]'),\n      page.locator('[data-testid=\"stock-count\"]')\n    ]\n  })\n})\n```\n\n### Updating Snapshots\n```bash\n# Update all visual snapshots\npnpm test:visual:update\n\n# Update specific test\npnpm test:visual -- --update-snapshots products.spec.ts\n```\n\n## Test Data Management\n\n### Database Seeding\nTests use isolated test data:\n\n```typescript\n// tests/fixtures/seed.ts\nexport async function seedTestProducts() {\n  return [\n    { id: 'test-1', name: 'Test Wine', price: 15.99 },\n    { id: 'test-2', name: 'Test Food', price: 8.99 }\n  ]\n}\n```\n\n### Test Users\n```env\n# .env.test\nTEST_USER_EMAIL=test@example.com\nTEST_USER_PASSWORD=TestPassword123!\nTEST_ADMIN_EMAIL=admin@example.com\nTEST_ADMIN_PASSWORD=AdminPassword123!\n```\n\n### Authentication States\n\n```typescript\n// Pre-authenticated user fixture\ntest('should access account page', async ({ authenticatedPage }) => {\n  await authenticatedPage.goto('/account')\n  await expect(authenticatedPage.locator('h1')).toContainText('My Account')\n})\n```\n\n## CI/CD Integration\n\n### GitHub Actions\nTests run automatically on:\n- Push to main/develop\n- Pull requests to main\n- Manual dispatch\n\n### Matrix Testing\n- Browsers: Chrome, Firefox, Safari\n- Locales: ES, EN, RO, RU\n- Viewports: Desktop, Mobile\n\n## Best Practices\n\n### Element Selection\nUse `data-testid` for stable selectors:\n```vue\n<button data-testid=\"submit-button\">Submit</button>\n```\n\n### Waiting\nWait for network idle before assertions:\n```typescript\nawait page.waitForLoadState('networkidle')\n```\n\n### Dynamic Content\nMask timestamps and dynamic content in visual tests:\n```typescript\nmask: [page.locator('[data-testid=\"timestamp\"]')]\n```\n\n### Independence\nKeep tests isolated:\n```typescript\ntest.beforeEach(async ({ page }) => {\n  // Reset state\n  await page.goto('/')\n  await clearCart(page)\n})\n```\n\n## Troubleshooting Tests\n\n### Browser Installation\n```bash\npnpm test:setup\n```\n\n### Debug Mode\n```bash\npnpm test:debug -- tests/e2e/auth.spec.ts\n```\n\n### View Test Report\n```bash\npnpm test:report\n```\n\n### Clear Cache\n```bash\nrm -rf node_modules/.cache\npnpm install\n```\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8176498117472318,
          "recommendation": "Consider consolidating into 07_TESTING_GUIDE.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/issues/full-app-unit-test-coverage.md",
              "name": "full-app-unit-test-coverage.md",
              "size": 37490,
              "lastModified": "2025-10-30T22:26:52.245Z",
              "content": "#  Comprehensive Unit Test Coverage for Full Application\n\n## Overview\n\nEstablish comprehensive unit test coverage across the entire MoldovaDirect application to improve code quality, catch bugs early, and enable confident refactoring. Currently, the application has excellent E2E and integration test coverage (53 test files), but significant gaps exist in unit test coverage for individual components, composables, stores, middleware, and API routes.\n\n**Current State:**\n-  53 existing test files (22 unit, 9 integration, 19 E2E, 3 server)\n-  Strong E2E coverage with Playwright (multi-locale, cross-browser)\n-  Auth module comprehensively tested\n-  150+ files without unit tests\n-  No unit tests for most components, composables, stores\n-  Limited API endpoint testing\n\n**Target State:**\n-  80%+ overall test coverage\n-  90%+ coverage for critical paths (checkout, payment, auth)\n-  60%+ coverage for supporting features\n-  Comprehensive test documentation\n-  Fast test execution (<5 minutes for full suite)\n\n## Problem Statement\n\n### Business Impact\n\n**Risk Factors:**\n- **Regression Risk:** Changes to shared components/utilities can break features silently\n- **Refactoring Difficulty:** Fear of breaking existing functionality slows down improvements\n- **Bug Discovery:** Issues found late in E2E tests are more expensive to fix\n- **Development Velocity:** Lack of unit tests increases debugging time and reduces confidence\n- **Onboarding Friction:** New developers lack clear examples of expected behavior\n\n**Benefits of Comprehensive Testing:**\n- **Early Bug Detection:** Unit tests catch issues in milliseconds vs minutes (E2E)\n- **Living Documentation:** Tests serve as executable specifications\n- **Refactoring Confidence:** Safe to improve code with safety net\n- **Faster CI/CD:** Unit tests are 100-1000x faster than E2E tests\n- **Better Architecture:** Testable code is typically better designed\n\n### Technical Context\n\n**Tech Stack:**\n- **Framework:** Nuxt 3.17+ with Vue 3.5 Composition API\n- **Language:** TypeScript with strict type checking\n- **State Management:** Pinia stores\n- **Backend:** Supabase (PostgreSQL + Auth)\n- **Testing:** Vitest (unit/integration) + Playwright (E2E)\n- **UI:** shadcn-vue + Tailwind CSS v4\n\n**Current Test Infrastructure:**\n```\ntests/\n unit/          # 22 unit test files (mostly auth + cart)\n integration/   # 9 integration test files\n e2e/           # 19 E2E test files (comprehensive)\n visual/        # 2 visual regression tests\n fixtures/      # Test fixtures and helpers\n setup/         # Global test setup\n\nConfiguration:\n vitest.config.ts         # Unit/integration test config\n playwright.config.ts     # E2E test config\n tests/setup/vitest.setup.ts  # Global mocks\n```\n\n## Proposed Solution\n\nImplement a **phased approach** to systematically add unit tests across all application layers, starting with highest-impact areas and progressing to full coverage.\n\n### High-Level Approach\n\n**Testing Strategy:** Follow the Testing Trophy model\n```\n        E2E (existing, comprehensive)\n    Integration (partial coverage)\n       Unit (PRIORITY - major gaps)\n  Static Analysis (TypeScript + ESLint)\n```\n\n**Prioritization:** Risk  Impact  Effort\n1. **Critical Paths** (checkout, payment, orders) - High risk, high impact\n2. **Core Features** (products, cart, auth extensions) - High usage\n3. **Supporting Features** (admin, analytics, profile) - Medium priority\n4. **Utilities & Helpers** (formatters, validators) - Quick wins\n\n## Technical Approach\n\n### Architecture\n\n**Test Organization:**\n```\nsrc/\n components/\n    checkout/\n       PaymentForm.vue\n       PaymentForm.test.ts        # Co-located unit tests\n    product/\n        Card.vue\n        Card.test.ts\n\n composables/\n    useProductCatalog.ts\n    useProductCatalog.test.ts      # Co-located tests\n\n stores/\n    products.ts\n    products.test.ts               # Co-located tests\n\n middleware/\n     admin.ts\n     admin.test.ts                  # Co-located tests\n\nserver/\n api/\n     products/\n        index.get.ts\n        index.get.test.ts          # Co-located tests\n```\n\n**Test Patterns:**\n\n1. **Component Testing:**\n```typescript\n// components/product/Card.test.ts\nimport { mount } from '@vue/test-utils'\nimport { createTestingPinia } from '@pinia/testing'\nimport ProductCard from './Card.vue'\n\ndescribe('ProductCard', () => {\n  const mockProduct = {\n    id: 1,\n    name: 'Test Product',\n    price: 29.99,\n    image: '/images/test.jpg'\n  }\n\n  it('renders product information correctly', () => {\n    const wrapper = mount(ProductCard, {\n      props: { product: mockProduct },\n      global: {\n        plugins: [createTestingPinia()]\n      }\n    })\n\n    expect(wrapper.find('[data-testid=\"product-name\"]').text()).toBe('Test Product')\n    expect(wrapper.find('[data-testid=\"product-price\"]').text()).toContain('29.99')\n  })\n\n  it('emits add-to-cart event when button clicked', async () => {\n    const wrapper = mount(ProductCard, {\n      props: { product: mockProduct }\n    })\n\n    await wrapper.find('[data-testid=\"add-to-cart-btn\"]').trigger('click')\n    expect(wrapper.emitted('add-to-cart')).toBeTruthy()\n    expect(wrapper.emitted('add-to-cart')?.[0]).toEqual([mockProduct])\n  })\n})\n```\n\n2. **Composable Testing:**\n```typescript\n// composables/useProductCatalog.test.ts\nimport { setActivePinia, createPinia } from 'pinia'\nimport { useProductCatalog } from './useProductCatalog'\n\ndescribe('useProductCatalog', () => {\n  beforeEach(() => {\n    setActivePinia(createPinia())\n  })\n\n  it('fetches products on mount', async () => {\n    const { products, isLoading, fetchProducts } = useProductCatalog()\n\n    expect(isLoading.value).toBe(false)\n    await fetchProducts()\n\n    expect(products.value).toHaveLength(10)\n    expect(isLoading.value).toBe(false)\n  })\n\n  it('filters products by category', async () => {\n    const { filteredProducts, filterByCategory } = useProductCatalog()\n\n    filterByCategory('electronics')\n    expect(filteredProducts.value.every(p => p.category === 'electronics')).toBe(true)\n  })\n})\n```\n\n3. **Store Testing:**\n```typescript\n// stores/products.test.ts\nimport { setActivePinia, createPinia } from 'pinia'\nimport { useProductsStore } from './products'\n\ndescribe('Products Store', () => {\n  beforeEach(() => {\n    setActivePinia(createPinia())\n  })\n\n  it('initializes with empty state', () => {\n    const store = useProductsStore()\n    expect(store.products).toEqual([])\n    expect(store.isLoading).toBe(false)\n  })\n\n  it('fetches and stores products', async () => {\n    const store = useProductsStore()\n    await store.fetchProducts()\n\n    expect(store.products).toHaveLength(10)\n    expect(store.isLoading).toBe(false)\n  })\n\n  it('filters products by search query', () => {\n    const store = useProductsStore()\n    store.products = [\n      { id: 1, name: 'Laptop', price: 999 },\n      { id: 2, name: 'Mouse', price: 29 }\n    ]\n\n    expect(store.searchProducts('laptop')).toHaveLength(1)\n    expect(store.searchProducts('laptop')[0].name).toBe('Laptop')\n  })\n})\n```\n\n4. **Middleware Testing:**\n```typescript\n// middleware/admin.test.ts\nimport { describe, it, expect, vi } from 'vitest'\nimport adminMiddleware from './admin'\n\nconst mockNavigateTo = vi.fn()\nglobal.navigateTo = mockNavigateTo\n\ndescribe('Admin Middleware', () => {\n  it('allows admin users to access route', async () => {\n    const mockUser = { role: 'admin' }\n    global.useSupabaseUser = vi.fn(() => ({ value: mockUser }))\n\n    await adminMiddleware()\n    expect(mockNavigateTo).not.toHaveBeenCalled()\n  })\n\n  it('redirects non-admin users to home', async () => {\n    const mockUser = { role: 'user' }\n    global.useSupabaseUser = vi.fn(() => ({ value: mockUser }))\n\n    await adminMiddleware()\n    expect(mockNavigateTo).toHaveBeenCalledWith('/')\n  })\n\n  it('redirects unauthenticated users to login', async () => {\n    global.useSupabaseUser = vi.fn(() => ({ value: null }))\n\n    await adminMiddleware()\n    expect(mockNavigateTo).toHaveBeenCalledWith('/auth/login')\n  })\n})\n```\n\n5. **API Route Testing:**\n```typescript\n// server/api/products/index.get.test.ts\nimport { describe, it, expect, vi } from 'vitest'\nimport handler from './index.get'\n\ndescribe('GET /api/products', () => {\n  it('returns list of products', async () => {\n    const mockEvent = createMockEvent()\n    const response = await handler(mockEvent)\n\n    expect(response.products).toBeInstanceOf(Array)\n    expect(response.products.length).toBeGreaterThan(0)\n    expect(response.products[0]).toHaveProperty('id')\n    expect(response.products[0]).toHaveProperty('name')\n    expect(response.products[0]).toHaveProperty('price')\n  })\n\n  it('filters products by category query', async () => {\n    const mockEvent = createMockEvent({ query: { category: 'electronics' } })\n    const response = await handler(mockEvent)\n\n    expect(response.products.every(p => p.category === 'electronics')).toBe(true)\n  })\n\n  it('handles invalid category gracefully', async () => {\n    const mockEvent = createMockEvent({ query: { category: 'invalid' } })\n    const response = await handler(mockEvent)\n\n    expect(response.products).toEqual([])\n  })\n})\n```\n\n### Implementation Phases\n\n#### Phase 1: Foundation & Critical Paths (Weeks 1-2)\n\n**Goals:**\n- Set up testing patterns and documentation\n- Test critical business logic\n- Achieve 90%+ coverage on checkout flow\n\n**Tasks:**\n\n**1.1 Test Infrastructure Setup**\n- [ ] Create test template files with examples\n  - `tests/templates/component.test.template.ts`\n  - `tests/templates/composable.test.template.ts`\n  - `tests/templates/store.test.template.ts`\n  - `tests/templates/middleware.test.template.ts`\n  - `tests/templates/api.test.template.ts`\n\n- [ ] Create shared test utilities\n  - `tests/utils/createTestUser.ts`\n  - `tests/utils/createTestProduct.ts`\n  - `tests/utils/createTestOrder.ts`\n  - `tests/utils/mockSupabase.ts`\n  - `tests/utils/mockStripe.ts`\n\n- [ ] Update vitest.config.ts for coverage reporting\n  ```typescript\n  coverage: {\n    thresholds: {\n      global: {\n        branches: 70,\n        functions: 75,\n        lines: 80,\n        statements: 80\n      }\n    }\n  }\n  ```\n\n**1.2 Checkout Components (Priority: CRITICAL)**\n- [ ] `components/checkout/PaymentForm.vue` - Payment validation & Stripe integration\n- [ ] `components/checkout/PaymentForm.test.ts`\n- [ ] `components/checkout/ShippingStep.vue` - Address validation\n- [ ] `components/checkout/ShippingStep.test.ts`\n- [ ] `components/checkout/PaymentStep.vue` - Payment method selection\n- [ ] `components/checkout/PaymentStep.test.ts`\n- [ ] `components/checkout/CheckoutProgressIndicator.vue` - Step tracking\n- [ ] `components/checkout/CheckoutProgressIndicator.test.ts`\n- [ ] `components/checkout/CheckoutNavigation.vue` - Navigation logic\n- [ ] `components/checkout/CheckoutNavigation.test.ts`\n- [ ] `components/checkout/GuestCheckoutPrompt.vue` - Guest flow\n- [ ] `components/checkout/GuestCheckoutPrompt.test.ts`\n- [ ] `components/checkout/GuestInfoForm.vue` - Guest form validation\n- [ ] `components/checkout/GuestInfoForm.test.ts`\n- [ ] `components/checkout/ShippingInstructions.vue` - Instructions display\n- [ ] `components/checkout/ShippingInstructions.test.ts`\n- [ ] All `components/checkout/review/*` components\n- [ ] Tests for review components\n\n**1.3 Critical Composables**\n- [ ] `composables/useShippingMethods.ts` - Shipping calculation\n- [ ] `composables/useShippingMethods.test.ts`\n- [ ] `composables/useShippingAddress.ts` - Address management\n- [ ] `composables/useShippingAddress.test.ts`\n- [ ] `composables/useStripe.ts` - Payment integration\n- [ ] `composables/useStripe.test.ts`\n- [ ] `composables/useGuestCheckout.ts` - Guest flow logic\n- [ ] `composables/useGuestCheckout.test.ts`\n\n**Success Metrics:**\n-  Checkout flow has 90%+ unit test coverage\n-  All payment validation logic tested\n-  Test templates documented and published\n-  Shared test utilities created\n-  CI pipeline runs unit tests in <3 minutes\n\n**Estimated Effort:** 80 hours (2 developers  2 weeks)\n\n---\n\n#### Phase 2: Core Features (Weeks 3-4)\n\n**Goals:**\n- Test product catalog functionality\n- Test order management\n- Achieve 80%+ coverage on core features\n\n**Tasks:**\n\n**2.1 Product Components**\n- [ ] `components/product/Card.vue` - Product display card\n- [ ] `components/product/Card.test.ts`\n- [ ] `components/product/CategoryNavigation.vue` - Category navigation\n- [ ] `components/product/CategoryNavigation.test.ts`\n- [ ] `components/product/AttributeCheckboxGroup.vue` - Attribute filters\n- [ ] `components/product/AttributeCheckboxGroup.test.ts`\n- [ ] `components/product/CategoryTree/*` - Category tree components\n- [ ] Tests for category tree components\n- [ ] `components/product/Filter/*` - Product filtering\n- [ ] Tests for filter components\n- [ ] `components/product/Mobile/*` - Mobile-specific views\n- [ ] Tests for mobile components\n\n**2.2 Order Components**\n- [ ] `components/order/OrderCard.vue` - Order summary card\n- [ ] `components/order/OrderCard.test.ts`\n- [ ] `components/order/OrderStatus.vue` - Status indicator\n- [ ] `components/order/OrderStatus.test.ts`\n- [ ] `components/order/OrderTrackingSection.vue` - Tracking display\n- [ ] `components/order/OrderTrackingSection.test.ts`\n- [ ] `components/order/OrderItemsSection.vue` - Order items list\n- [ ] `components/order/OrderItemsSection.test.ts`\n- [ ] `components/order/OrderSummarySection.vue` - Order summary\n- [ ] `components/order/OrderSummarySection.test.ts`\n- [ ] All remaining order components (13 total)\n- [ ] Tests for remaining order components\n\n**2.3 Product Composables & Stores**\n- [ ] `composables/useProductCatalog.ts` - Product fetching & filtering\n- [ ] `composables/useProductCatalog.test.ts`\n- [ ] `composables/useOrders.ts` - Order management\n- [ ] `composables/useOrders.test.ts`\n- [ ] `composables/useOrderDetail.ts` - Order detail logic\n- [ ] `composables/useOrderDetail.test.ts`\n- [ ] `composables/useOrderTracking.ts` - Tracking logic\n- [ ] `composables/useOrderTracking.test.ts`\n- [ ] `stores/products.ts` - Product state management\n- [ ] `stores/products.test.ts`\n- [ ] `stores/categories.ts` - Category state management\n- [ ] `stores/categories.test.ts`\n- [ ] `stores/search.ts` - Search state management\n- [ ] `stores/search.test.ts`\n\n**2.4 Critical Middleware**\n- [ ] `middleware/admin.ts` - Admin route protection\n- [ ] `middleware/admin.test.ts`\n- [ ] `middleware/checkout.ts` - Checkout flow protection\n- [ ] `middleware/checkout.test.ts`\n- [ ] `middleware/verified.ts` - Email verification check\n- [ ] `middleware/verified.test.ts`\n- [ ] `middleware/locale-redirect.global.ts` - i18n routing\n- [ ] `middleware/locale-redirect.global.test.ts`\n\n**Success Metrics:**\n-  Product catalog has 80%+ unit test coverage\n-  Order management has 80%+ unit test coverage\n-  All middleware routes tested\n-  Critical user flows documented\n\n**Estimated Effort:** 80 hours (2 developers  2 weeks)\n\n---\n\n#### Phase 3: Supporting Features (Weeks 5-6)\n\n**Goals:**\n- Test admin functionality\n- Test home/landing page components\n- Achieve 60%+ coverage on supporting features\n\n**Tasks:**\n\n**3.1 Home Page Components**\n- [ ] `components/home/HeroSection.vue` - Hero section\n- [ ] `components/home/HeroSection.test.ts`\n- [ ] `components/home/FeaturedProductsSection.vue` - Featured products\n- [ ] `components/home/FeaturedProductsSection.test.ts`\n- [ ] `components/home/CategoryGrid.vue` - Category grid\n- [ ] `components/home/CategoryGrid.test.ts`\n- [ ] `components/home/StorySection.vue` - Brand story\n- [ ] `components/home/StorySection.test.ts`\n- [ ] `components/home/HowItWorksSection.vue` - Process explanation\n- [ ] `components/home/HowItWorksSection.test.ts`\n- [ ] `components/home/CollectionsShowcase.vue` - Collections display\n- [ ] `components/home/CollectionsShowcase.test.ts`\n- [ ] `components/home/ServicesSection.vue` - Services info\n- [ ] `components/home/ServicesSection.test.ts`\n- [ ] `components/home/SocialProofSection.vue` - Testimonials\n- [ ] `components/home/SocialProofSection.test.ts`\n- [ ] `components/home/NewsletterSignup.vue` - Newsletter form\n- [ ] `components/home/NewsletterSignup.test.ts`\n- [ ] `components/home/FaqPreviewSection.vue` - FAQ preview\n- [ ] `components/home/FaqPreviewSection.test.ts`\n\n**3.2 Admin Components**\n- [ ] Extend existing admin dashboard tests\n- [ ] Extend existing admin inventory tests\n- [ ] Test admin order management components\n- [ ] Test admin user management components\n- [ ] Test admin product management components\n\n**3.3 Supporting Composables**\n- [ ] `composables/useAnalytics.ts` - Analytics tracking\n- [ ] `composables/useAnalytics.test.ts`\n- [ ] `composables/useDevice.ts` - Device detection\n- [ ] `composables/useDevice.test.ts`\n- [ ] `composables/useHapticFeedback.ts` - Mobile haptics\n- [ ] `composables/useHapticFeedback.test.ts`\n- [ ] `composables/useHomeContent.ts` - Home page data\n- [ ] `composables/useHomeContent.test.ts`\n- [ ] `composables/useInventory.ts` - Inventory management\n- [ ] `composables/useInventory.test.ts`\n- [ ] `composables/usePullToRefresh.ts` - Pull-to-refresh\n- [ ] `composables/usePullToRefresh.test.ts`\n- [ ] `composables/useStoreI18n.ts` - Store i18n helpers\n- [ ] `composables/useStoreI18n.test.ts`\n- [ ] `composables/useSwipeGestures.ts` - Swipe handling\n- [ ] `composables/useSwipeGestures.test.ts`\n- [ ] `composables/useTheme.ts` - Theme management\n- [ ] `composables/useTheme.test.ts`\n- [ ] `composables/useToast.ts` - Toast notifications\n- [ ] `composables/useToast.test.ts`\n- [ ] `composables/useTouchEvents.ts` - Touch event handling\n- [ ] `composables/useTouchEvents.test.ts`\n\n**3.4 Admin Stores**\n- [ ] `stores/adminDashboard.ts` - Dashboard state\n- [ ] `stores/adminDashboard.test.ts`\n- [ ] `stores/adminProducts.ts` - Product management state\n- [ ] `stores/adminProducts.test.ts`\n- [ ] `stores/adminUsers.ts` - User management state\n- [ ] `stores/adminUsers.test.ts`\n- [ ] `stores/toast.ts` - Toast state management\n- [ ] `stores/toast.test.ts`\n\n**Success Metrics:**\n-  Home page components have 60%+ coverage\n-  Admin features have 60%+ coverage\n-  All UI composables tested\n\n**Estimated Effort:** 60 hours (2 developers  1.5 weeks)\n\n---\n\n#### Phase 4: API & Infrastructure (Weeks 7-8)\n\n**Goals:**\n- Test all API endpoints\n- Test layout components\n- Achieve comprehensive backend coverage\n\n**Tasks:**\n\n**4.1 API Endpoint Tests**\n- [ ] `server/api/products/index.get.ts` - List products\n- [ ] `server/api/products/index.get.test.ts`\n- [ ] `server/api/products/[slug].get.ts` - Product detail\n- [ ] `server/api/products/[slug].get.test.ts`\n- [ ] `server/api/products/featured.get.ts` - Featured products\n- [ ] `server/api/products/featured.get.test.ts`\n- [ ] `server/api/categories/*` - Category endpoints\n- [ ] Tests for category endpoints\n- [ ] `server/api/cart/*` - Cart endpoints\n- [ ] Tests for cart endpoints\n- [ ] `server/api/checkout/*` - Checkout endpoints\n- [ ] Tests for checkout endpoints\n- [ ] `server/api/payments/*` - Payment endpoints\n- [ ] Tests for payment endpoints\n- [ ] `server/api/shipping/*` - Shipping endpoints\n- [ ] Tests for shipping endpoints\n- [ ] `server/api/admin/*` - Admin endpoints\n- [ ] Tests for admin endpoints\n- [ ] `server/api/analytics/*` - Analytics endpoints\n- [ ] Tests for analytics endpoints\n- [ ] `server/api/search/*` - Search endpoints\n- [ ] Tests for search endpoints\n- [ ] `server/api/recommendations/*` - Recommendations endpoints\n- [ ] Tests for recommendations endpoints\n\n**4.2 Layout Components**\n- [ ] `components/layout/Header.vue` - Site header\n- [ ] `components/layout/Header.test.ts`\n- [ ] `components/layout/Footer.vue` - Site footer\n- [ ] `components/layout/Footer.test.ts`\n- [ ] `components/layout/Navigation.vue` - Main navigation\n- [ ] `components/layout/Navigation.test.ts`\n- [ ] `components/layout/Sidebar.vue` - Sidebar navigation\n- [ ] `components/layout/Sidebar.test.ts`\n- [ ] `components/layout/MobileMenu.vue` - Mobile menu\n- [ ] `components/layout/MobileMenu.test.ts`\n- [ ] `components/layout/Breadcrumbs.vue` - Breadcrumb navigation\n- [ ] `components/layout/Breadcrumbs.test.ts`\n- [ ] `components/layout/LanguageSwitcher.vue` - Language selector\n- [ ] `components/layout/LanguageSwitcher.test.ts`\n\n**4.3 Server Utilities**\n- [ ] Extend `server/utils/__tests__/emailRetryService.test.ts`\n- [ ] Extend `server/utils/__tests__/orderEmails.test.ts`\n- [ ] Test any additional server utilities\n\n**Success Metrics:**\n-  All API endpoints have 80%+ coverage\n-  Layout components have 70%+ coverage\n-  Server utilities fully tested\n\n**Estimated Effort:** 60 hours (2 developers  1.5 weeks)\n\n---\n\n## Alternative Approaches Considered\n\n### 1.  Big Bang Approach (Rejected)\n**Description:** Write all tests at once before merging\n\n**Pros:**\n- Complete coverage immediately\n- Single PR review\n\n**Cons:**\n- Massive PR impossible to review\n- Blocks other development\n- High risk of merge conflicts\n- No incremental value\n\n**Why Rejected:** Too risky and blocks progress\n\n### 2.  Test-Last Approach (Rejected)\n**Description:** Continue development, add tests later\n\n**Pros:**\n- Doesn't slow feature development\n- Tests written with full context\n\n**Cons:**\n- Tests never get written (technical debt)\n- Missing safety net during development\n- Harder to test poorly designed code\n\n**Why Rejected:** Perpetuates technical debt\n\n### 3.  100% Coverage Goal (Rejected)\n**Description:** Aim for 100% test coverage\n\n**Pros:**\n- Maximum confidence\n- No gaps\n\n**Cons:**\n- Diminishing returns beyond 80%\n- Tests trivial code (getters, constants)\n- Slows development velocity significantly\n- Focus on metrics over quality\n\n**Why Rejected:** Diminishing returns, better to focus on critical paths\n\n### 4.  Phased Incremental Approach (SELECTED)\n**Description:** Systematic phases prioritizing high-impact areas\n\n**Pros:**\n- Incremental value delivery\n- Manageable PR sizes\n- Immediate safety net for critical code\n- Can adjust based on learnings\n- Team can develop testing expertise gradually\n\n**Cons:**\n- Takes longer to achieve full coverage\n- Requires discipline to maintain momentum\n\n**Why Selected:** Best balance of risk, value, and practicality\n\n---\n\n## Acceptance Criteria\n\n### Functional Requirements\n\n**Phase 1 Completion:**\n- [ ] All checkout components have unit tests with 90%+ coverage\n- [ ] Critical composables (shipping, payment, guest) fully tested\n- [ ] Test templates created and documented\n- [ ] Shared test utilities available\n- [ ] CI runs unit tests and reports coverage\n\n**Phase 2 Completion:**\n- [ ] All product components have unit tests with 80%+ coverage\n- [ ] All order components have unit tests with 80%+ coverage\n- [ ] Product/order composables and stores fully tested\n- [ ] All middleware has unit tests\n\n**Phase 3 Completion:**\n- [ ] Home page components have 60%+ coverage\n- [ ] Admin components have 60%+ coverage\n- [ ] All UI composables tested\n- [ ] Admin stores tested\n\n**Phase 4 Completion:**\n- [ ] All API endpoints have integration tests with 80%+ coverage\n- [ ] Layout components have 70%+ coverage\n- [ ] Server utilities fully tested\n\n### Non-Functional Requirements\n\n**Performance:**\n- [ ] Unit test suite completes in <5 minutes\n- [ ] Individual test files run in <10 seconds\n- [ ] No flaky tests (deterministic, no timing dependencies)\n\n**Code Quality:**\n- [ ] All tests follow AAA pattern (Arrange-Act-Assert)\n- [ ] Test names clearly describe behavior\n- [ ] Tests use data-testid attributes for selectors\n- [ ] No implementation details tested (test behavior, not internals)\n- [ ] Minimal mocking (only external dependencies)\n\n**Documentation:**\n- [ ] Testing guide created (`docs/TESTING_GUIDE.md`)\n- [ ] Test templates documented\n- [ ] Coverage reports published\n- [ ] Examples of each test type provided\n\n**Maintainability:**\n- [ ] Tests co-located with source files\n- [ ] Shared test utilities in `tests/utils/`\n- [ ] Test fixtures in `tests/fixtures/`\n- [ ] Consistent naming conventions\n\n### Quality Gates\n\n**Per-Commit Standards:**\n- [ ] New code must have 90%+ coverage\n- [ ] Existing code coverage must not decrease\n- [ ] All tests must pass before merge\n- [ ] No skipped/disabled tests without GitHub issue\n\n**Phase Completion Criteria:**\n- [ ] Coverage thresholds met for phase scope\n- [ ] All tests passing\n- [ ] PR approved by 2 reviewers\n- [ ] Documentation updated\n\n**Final Acceptance:**\n- [ ] Overall coverage 80% (lines)\n- [ ] Critical paths 90% (checkout, payment, auth)\n- [ ] Supporting features 60% (admin, home)\n- [ ] Zero flaky tests\n- [ ] CI pipeline green\n- [ ] Testing documentation complete\n\n---\n\n## Success Metrics\n\n### Quantitative Metrics\n\n**Code Coverage:**\n```\nTarget Coverage by Area:\n Checkout & Payment: 90%+\n Product Catalog: 80%+\n Order Management: 80%+\n Cart System: 90%+ (already achieved)\n Authentication: 90%+ (already achieved)\n Admin Features: 60%+\n Home/Landing: 60%+\n Overall Application: 80%+\n```\n\n**Test Performance:**\n- Unit test suite: <5 minutes\n- Integration test suite: <10 minutes\n- Full test suite (including E2E): <30 minutes\n\n**Test Count:**\n- Current: 53 test files\n- Target: 200+ test files\n- Estimated: 1,500+ individual test cases\n\n**Bug Detection:**\n- 30% reduction in production bugs (industry benchmark for 80%+ coverage)\n- 50% faster bug identification (unit vs E2E)\n- 75% reduction in regression bugs\n\n### Qualitative Metrics\n\n**Developer Experience:**\n- Confidence in refactoring (survey score 4/5+)\n- Onboarding time reduced by 25%\n- Code review velocity increased\n- Documentation quality improved\n\n**Code Quality:**\n- Better component design (testable = maintainable)\n- Clearer API contracts\n- Reduced technical debt\n- Living documentation through tests\n\n---\n\n## Dependencies & Prerequisites\n\n### Technical Dependencies\n\n**Required:**\n-  Vitest 3.2.4+ (already installed)\n-  @vue/test-utils 2.4.6+ (already installed)\n-  @nuxt/test-utils 3.19.2+ (already installed)\n-  @pinia/testing (needs installation)\n-  jsdom 26.1.0+ (already installed)\n\n**Installation Required:**\n```bash\npnpm add -D @pinia/testing\n```\n\n### Team Prerequisites\n\n**Knowledge Requirements:**\n- Vue 3 Composition API expertise\n- Vitest/Jest testing experience\n- Testing best practices familiarity\n- Nuxt 3 composables understanding\n\n**Training Needed:**\n- Testing Trophy methodology (1 hour workshop)\n- @nuxt/test-utils usage (2 hour workshop)\n- Test pattern templates (1 hour review)\n- Coverage reporting tools (30 min demo)\n\n### External Dependencies\n\n**None** - All testing runs locally without external services\n\n**CI/CD Requirements:**\n- GitHub Actions already configured\n- Coverage reporting needs setup (Codecov or similar)\n\n---\n\n## Risk Analysis & Mitigation\n\n### Risk Matrix\n\n| Risk | Probability | Impact | Severity | Mitigation |\n|------|-------------|--------|----------|------------|\n| Tests become maintenance burden | Medium | High | **Critical** | Follow best practices (test behavior, not implementation) |\n| Coverage goals delay features | High | Medium | **High** | Flexible phase timelines, prioritize critical paths |\n| Flaky tests reduce confidence | Low | High | **High** | Mock time/random values, avoid timing dependencies |\n| Team resistance to TDD | Medium | Medium | **Medium** | Incremental adoption, showcase benefits early |\n| Test suite becomes too slow | Low | Medium | **Medium** | Monitor performance, optimize hot paths |\n| Difficulty testing legacy code | Medium | Medium | **Medium** | Refactor for testability, use characterization tests |\n\n### Mitigation Strategies\n\n**1. Prevent Brittle Tests**\n```typescript\n//  Bad - Tests implementation\nexpect(component.vm.internalMethod).toHaveBeenCalled()\n\n//  Good - Tests behavior\nexpect(component.text()).toContain('Expected output')\n```\n\n**Strategy:**\n- Test public API only\n- Use data-testid for selectors\n- Avoid testing internal state\n- Focus on user-observable behavior\n\n**2. Maintain Fast Tests**\n```typescript\n//  Bad - Real timers\nawait new Promise(resolve => setTimeout(resolve, 1000))\n\n//  Good - Fake timers\nvi.useFakeTimers()\nvi.advanceTimersByTime(1000)\n```\n\n**Strategy:**\n- Mock external dependencies\n- Use fake timers\n- Minimize DOM operations\n- Run tests in parallel\n\n**3. Avoid Coverage Theater**\n```typescript\n//  Bad - Coverage without assertions\ntest('component renders', () => {\n  render(Component)\n  // No expectations!\n})\n\n//  Good - Meaningful assertions\ntest('component displays user name', () => {\n  render(Component, { props: { user: { name: 'John' } } })\n  expect(screen.getByText('John')).toBeInTheDocument()\n})\n```\n\n**Strategy:**\n- Review coverage gaps, not percentages\n- Require meaningful assertions\n- Use mutation testing to verify test quality\n- Code review tests for value\n\n**4. Manage Test Technical Debt**\n- Treat test code with same rigor as production code\n- Refactor test utilities regularly\n- Delete obsolete tests\n- Document test patterns\n\n---\n\n## Resource Requirements\n\n### Team Allocation\n\n**Phase 1-2 (Critical Paths + Core Features):**\n- 2 senior developers\n- 4 weeks full-time\n- 160 total hours\n\n**Phase 3-4 (Supporting Features + API):**\n- 1-2 mid/senior developers\n- 3 weeks full-time\n- 120 total hours\n\n**Total:** 280 developer hours (7 weeks)\n\n### Training & Onboarding\n\n**Initial Training (Week 0):**\n- Testing Trophy methodology: 1 hour\n- @nuxt/test-utils deep dive: 2 hours\n- Test template walkthrough: 1 hour\n- Coverage tools demo: 30 minutes\n- **Total:** 4.5 hours\n\n**Ongoing:**\n- Weekly test review: 30 minutes\n- Pairing sessions: Ad-hoc\n\n### Infrastructure\n\n**CI/CD:**\n- GitHub Actions (already configured)\n- Coverage reporting service (Codecov recommended)\n- Test result visualization\n\n**Tooling:**\n- Vitest UI for debugging: `pnpm test:unit:ui`\n- Coverage reports: `pnpm test:coverage`\n\n**Estimated Cost:**\n- Codecov: $0 (free for open source) or $29/month (if private)\n- Infrastructure: $0 (using existing GitHub Actions minutes)\n\n---\n\n## Future Considerations\n\n### Post-Implementation Enhancements\n\n**1. Mutation Testing**\n- Tool: Stryker Mutator\n- Validates test quality (do tests catch bugs?)\n- Run monthly on critical modules\n\n**2. Visual Regression Testing**\n- Already exists (`tests/visual/`)\n- Expand coverage to all components\n- Integrate Percy or Chromatic\n\n**3. Contract Testing**\n- Test API contracts with Supabase\n- Ensure backend compatibility\n- Use Pact or similar tool\n\n**4. Performance Testing**\n- Test component render times\n- Profile store operations\n- Use vitest benchmarking\n\n### Extensibility\n\n**New Features:**\n- Template for new feature development:\n  ```\n  1. Write failing test (TDD)\n  2. Implement feature\n  3. Verify test passes\n  4. Add integration test\n  5. Update documentation\n  ```\n\n**Test Patterns:**\n- Document patterns as they emerge\n- Create custom test utilities\n- Share learnings in team wiki\n\n### Long-Term Maintenance\n\n**Quarterly Review:**\n- Analyze flaky tests\n- Review coverage gaps\n- Update test utilities\n- Optimize slow tests\n\n**Coverage Ratcheting:**\n- Gradually increase thresholds\n- Target: 85% overall by Q3 2025\n- Never decrease coverage\n\n---\n\n## Documentation Plan\n\n### Documentation Deliverables\n\n**1. Testing Guide (`docs/TESTING_GUIDE.md`)**\n- [ ] Overview of testing strategy (Testing Trophy)\n- [ ] How to run tests (unit, integration, E2E)\n- [ ] Test organization structure\n- [ ] Writing your first test\n- [ ] Component testing guide\n- [ ] Composable testing guide\n- [ ] Store testing guide\n- [ ] Middleware testing guide\n- [ ] API testing guide\n- [ ] Best practices and anti-patterns\n- [ ] Troubleshooting common issues\n- [ ] CI/CD integration\n\n**2. Test Templates (`tests/templates/`)**\n- [ ] `component.test.template.ts` - Vue component test template\n- [ ] `composable.test.template.ts` - Composable test template\n- [ ] `store.test.template.ts` - Pinia store test template\n- [ ] `middleware.test.template.ts` - Middleware test template\n- [ ] `api.test.template.ts` - API route test template\n\n**3. Shared Test Utilities (`tests/utils/README.md`)**\n- [ ] Document all utility functions\n- [ ] Usage examples\n- [ ] When to use each utility\n- [ ] How to create new utilities\n\n**4. Coverage Reports**\n- [ ] Automated HTML reports in CI\n- [ ] Badge in README.md showing coverage %\n- [ ] Per-PR coverage diff comments\n- [ ] Historical coverage tracking\n\n**5. Team Wiki Pages**\n- [ ] Testing philosophy\n- [ ] Common testing patterns\n- [ ] Code review checklist for tests\n- [ ] Testing FAQs\n\n### Documentation Standards\n\n**Test Documentation:**\n```typescript\n/**\n * Tests for PaymentForm component\n *\n * Coverage:\n * - Payment method selection\n * - Stripe integration\n * - Form validation\n * - Error handling\n *\n * Related:\n * - components/checkout/PaymentForm.vue\n * - composables/useStripe.ts\n * - Integration: tests/integration/checkout-flow.test.ts\n */\ndescribe('PaymentForm', () => {\n  // Tests...\n})\n```\n\n**README Updates:**\n- [ ] Add testing section to main README.md\n- [ ] Link to testing guide\n- [ ] Show test badges (coverage, build status)\n- [ ] Include quick start for testing\n\n---\n\n## References & Research\n\n### Internal References\n\n**Existing Test Files:**\n- Auth tests: `tests/unit/auth-*.test.ts` (strong patterns to follow)\n- Cart tests: `tests/unit/cart-*.test.ts` (comprehensive examples)\n- Integration tests: `tests/integration/auth-flows.test.ts` (full flow examples)\n- E2E tests: `tests/e2e/*.spec.ts` (complete user journeys)\n\n**Configuration Files:**\n- Vitest config: `vitest.config.ts:1`\n- Playwright config: `playwright.config.ts:1`\n- Test setup: `tests/setup/vitest.setup.ts:1`\n\n**Documentation:**\n- Existing test guide: `tests/AUTH_TESTING_GUIDE.md` (excellent reference)\n- Project README: `README.md:1` (testing section)\n\n### External References\n\n**Testing Methodology:**\n- Testing Trophy: https://kentcdodds.com/blog/the-testing-trophy-and-testing-classifications\n- Write Tests: https://kentcdodds.com/blog/write-tests\n- JavaScript Testing Best Practices: https://github.com/goldbergyoni/javascript-testing-best-practices\n- Google Testing Blog - Coverage: https://testing.googleblog.com/2020/08/code-coverage-best-practices.html\n\n**Framework Documentation:**\n- Nuxt Testing Guide: https://nuxt.com/docs/3.x/getting-started/testing\n- @nuxt/test-utils: https://nuxt.com/modules/test-utils\n- Vue 3 Testing: https://vuejs.org/guide/scaling-up/testing\n- @vue/test-utils: https://test-utils.vuejs.org/guide/\n- Pinia Testing: https://pinia.vuejs.org/cookbook/testing.html\n- Vitest Guide: https://vitest.dev/guide/\n- Playwright Docs: https://playwright.dev/docs/intro\n\n**Testing Patterns:**\n- AAA Pattern: https://automationpanda.com/2020/07/07/arrange-act-assert-a-pattern-for-writing-good-tests/\n- Mocking Best Practices: https://semaphore.io/community/tutorials/best-practices-for-spies-stubs-and-mocks-in-sinon-js\n- Test Isolation: https://dev.to/mmonfared/test-independence-done-right-how-to-write-truly-isolated-tests-363m\n\n**Tools & Libraries:**\n- Vitest vs Jest: https://betterstack.com/community/guides/scaling-nodejs/vitest-vs-jest/\n- Test Colocation: https://kentcdodds.com/blog/colocation\n\n### Related Issues\n\n*No related issues yet - this is the foundation*\n\n---\n\n## Implementation Checklist\n\n### Pre-Implementation\n- [ ] Team training completed (Testing Trophy, @nuxt/test-utils)\n- [ ] Test templates created and reviewed\n- [ ] Shared test utilities scaffolded\n- [ ] Coverage thresholds configured in vitest.config.ts\n- [ ] CI/CD pipeline updated for coverage reporting\n- [ ] Documentation structure created\n\n### Phase 1 (Weeks 1-2)\n- [ ] All Phase 1 tasks completed (see Phase 1 section)\n- [ ] Phase 1 PR reviewed and merged\n- [ ] Coverage report shows 90%+ for checkout\n- [ ] Team retrospective held\n- [ ] Lessons documented\n\n### Phase 2 (Weeks 3-4)\n- [ ] All Phase 2 tasks completed (see Phase 2 section)\n- [ ] Phase 2 PR reviewed and merged\n- [ ] Coverage report shows 80%+ for products/orders\n- [ ] Team retrospective held\n- [ ] Testing guide updated with learnings\n\n### Phase 3 (Weeks 5-6)\n- [ ] All Phase 3 tasks completed (see Phase 3 section)\n- [ ] Phase 3 PR reviewed and merged\n- [ ] Coverage report shows 60%+ for home/admin\n- [ ] Team retrospective held\n\n### Phase 4 (Weeks 7-8)\n- [ ] All Phase 4 tasks completed (see Phase 4 section)\n- [ ] Phase 4 PR reviewed and merged\n- [ ] Coverage report shows 80%+ for API routes\n- [ ] Final retrospective held\n\n### Post-Implementation\n- [ ] Overall coverage 80% verified\n- [ ] All documentation completed\n- [ ] Team training materials finalized\n- [ ] Success metrics captured\n- [ ] Celebration! \n\n---\n\n## ERD Diagram\n\n*Not applicable for this issue - no database schema changes*\n\n---\n\n## Labels\n\n`enhancement`, `testing`, `high-priority`, `documentation`, `good-first-issue` (for individual test files), `help-wanted`\n\n---\n\n## Assignees\n\nTBD - Recommend assigning:\n- Technical Lead (overall coordination)\n- 2 Senior Developers (implementation)\n- QA Lead (review and validation)\n\n---\n\n**Estimated Timeline:** 7-8 weeks\n**Estimated Effort:** 280 developer hours\n**Priority:** High\n**Complexity:** High\n\n---\n\n Generated with [Claude Code](https://claude.com/claude-code)\n",
              "category": "reference"
            },
            {
              "path": "docs/testing/TEST_COVERAGE_ANALYSIS.md",
              "name": "TEST_COVERAGE_ANALYSIS.md",
              "size": 13477,
              "lastModified": "2026-01-06T15:49:37.120Z",
              "content": "# MoldovaDirect Test Suite and Coverage Analysis\n\n**Analysis Date:** 2025-12-29  \n**Analyzed By:** Claude Code (Test Automation Expert)  \n**Project:** MoldovaDirect E-commerce Platform  \n**Tech Stack:** Nuxt 4 + Supabase + Vue 3 + Playwright + Vitest\n\n---\n\n## Executive Summary\n\n### Current State\n- **Total Source Files:** 652 files (components, pages, composables, API routes)\n- **Total Test Files:** 97 test files (88 in tests/, 9 in composables/)\n- **Total Test Cases:** ~9,320 test assertions across unit, integration, and E2E\n- **Code Coverage:** **6.64%** statements (5,922/89,073 lines)\n\n### Coverage Breakdown\n- **Statements:** 6.64% (5,922/89,073)\n- **Branches:** 78.77% (2,041/2,591) \n- **Functions:** 69.92% (993/1,420)\n- **Lines:** 6.64% (5,922/89,073)\n\n### Critical Gaps\n1. **Zero server/API route tests** (112 API routes, 0 integration tests)\n2. **Low component test coverage** (261 components, only 8 tested)\n3. **CI/CD tests disabled** (E2E tests not running in pipeline)\n4. **Missing performance tests** for critical flows\n5. **No contract testing** for API interfaces\n6. **No test data factories** (manual test data management)\n\n---\n\n## 1. Current Test Coverage Analysis\n\n### 1.1 Test Distribution by Type\n\n| Test Type | Count | Files Covered | Coverage % |\n|-----------|-------|---------------|------------|\n| **Unit Tests** | 26 files | Cart, Composables, Stores, Middleware | ~15% |\n| **Integration Tests** | 1 file | Admin auth flows only | <1% |\n| **E2E Tests** | 20 files | Critical flows, Auth, Products | ~30% |\n| **Visual Regression** | 2 files | Theme, UI validation | Minimal |\n| **API Tests** | 1 file | Products API only | <1% |\n\n### 1.2 Files with Lowest Coverage\n\n**Zero Coverage Areas:**\n- `/server/api/**` - All 112 API routes (0% coverage)\n- Component library (261 Vue components, only 8 tested)\n- `/middleware/` - 7 middleware files, only 5 tested\n- `/pages/` - 46 page components, mostly E2E only\n- Utility functions and helpers\n\n**Critical Paths Without Tests:**\n1. Payment processing (`server/api/checkout/`, `server/api/stripe/`)\n2. Order management (`server/api/orders/`, `server/api/admin/orders/`)\n3. Admin panel API routes (`server/api/admin/**`)\n4. Email system (`server/utils/orderEmails.ts`)\n5. Product management API (`server/api/admin/products/`)\n6. Authentication flows (`server/api/auth/delete-account.delete.ts`)\n\n---\n\n## 2. Test Quality Assessment\n\n### 2.1 Test Organization and Structure\n\n**Strengths:**\n-  Well-organized directory structure (`tests/unit/`, `tests/e2e/`, `tests/critical/`)\n-  Separate configs for unit (Vitest) and E2E (Playwright)\n-  Pre-commit smoke tests for fast feedback (<30 seconds)\n-  Critical test suite for deployment confidence (<5 minutes)\n-  Page Object Model pattern in E2E tests\n-  Test helpers and fixtures for reusability\n\n**Weaknesses:**\n-  Many exclusions in vitest.config.ts (integration tests, server tests)\n-  Inconsistent test naming (`.test.ts` vs `.spec.ts`)\n-  Some tests in `tests/manual/` not automated\n-  Mixed concerns (visual tests in multiple locations)\n\n### 2.2 Use of Mocks and Fixtures\n\n**Good Practices:**\n-  Comprehensive mocking (fetch, localStorage, browser APIs)\n-  Authentication state files (`tests/fixtures/.auth/`)\n-  Test user personas\n-  Page object helpers\n-  Cart helpers for E2E\n\n**Issues:**\n-  Server tests excluded due to \"Supabase import resolution issues\"\n-  Missing mock data factories for API testing\n-  No fixture management for database state\n\n### 2.3 Test Isolation\n\n**Unit Tests - Good Isolation:**\n```typescript\nbeforeEach(() => {\n  resetAnalyticsState()\n  mockLocalStorage.store = {}\n  vi.clearAllMocks()\n  vi.useFakeTimers()\n})\n```\n\n**E2E Tests - Fair Isolation:**\n- Playwright's built-in isolation (each test gets new context)\n- Global setup creates authenticated sessions\n- Tests clean up cart state but not database state\n\n**Issues:**\n-  No database transaction rollback for integration tests\n-  E2E tests may affect shared database state\n-  No order cleanup between tests (potential test pollution)\n\n### 2.4 Assertion Quality\n\n**High-Quality Examples:**\n```typescript\nexpect(cartAnalyticsState.value.events).toHaveLength(1)\nexpect(event.metadata?.productName).toBe('Test Wine')\n```\n\n**Gaps:**\n- Missing negative test cases\n- Limited boundary value testing\n- Few tests for error states and edge cases\n\n---\n\n## 3. Missing Test Categories\n\n### 3.1 Components Without Unit Tests (Priority)\n\n**Cart Components:**\n- CartDrawer.vue\n- CartSummary.vue\n- CartItem.vue\n\n**Product Components:**\n- ProductCard.vue\n- ProductFilters.vue\n- ProductGallery.vue\n\n**Admin Components:**\n- Dashboard/Overview.vue\n- Products/ProductList.vue\n- Orders/OrdersTable.vue\n- ~50+ admin panel components\n\n### 3.2 API Routes Without Integration Tests\n\n**HIGH PRIORITY (Checkout & Payments):**\n- `server/api/checkout/create-order.post.ts`\n- `server/api/stripe/create-payment-intent.post.ts`\n- `server/api/stripe/webhook.post.ts`\n\n**MEDIUM PRIORITY (Admin API):**\n- `server/api/admin/products/*.ts` (CRUD operations)\n- `server/api/admin/orders/*.ts` (all order management)\n- `server/api/admin/analytics/*.ts`\n\n**MEDIUM PRIORITY (Public API):**\n- `server/api/products/[slug].get.ts`\n- `server/api/products/related/[id].get.ts`\n\n### 3.3 Critical User Flows Without E2E Tests\n\n**Missing Coverage:**\n1. Guest checkout failure scenarios\n2. Payment failure handling\n3. Admin product creation/edit/delete workflow\n4. Account deletion flow\n5. Order history pagination\n6. Advanced filter combinations\n7. Language switching mid-checkout\n\n### 3.4 Edge Cases Not Covered\n\n**Cart & Checkout:**\n-  Cart with 100+ items (performance)\n-  Items removed from inventory while in cart\n-  Price changes during checkout\n-  Concurrent cart modifications (multiple tabs)\n\n**Authentication:**\n-  Session timeout during checkout\n-  Email verification link expiration\n-  Brute force login attempts\n\n**Products:**\n-  Product with no images\n-  Out-of-stock product handling\n-  Special characters in names/slugs\n\n---\n\n## 4. Test Infrastructure Analysis\n\n### 4.1 Test Configuration Quality\n\n**Vitest Issues:**\n-  Many test files excluded (integration, server tests)\n-  Negative thresholds (allowing uncovered lines to grow)\n-  Coverage thresholds too permissive (70% branches, 55% functions)\n\n**Playwright Strengths:**\n-  Multiple project configurations\n-  Cross-browser testing setup\n-  Mobile responsive testing\n-  Multi-locale testing\n\n### 4.2 CI/CD Test Pipeline - CRITICAL ISSUE\n\n**ALL E2E TESTS DISABLED IN CI/CD:**\n\n```yaml\njobs:\n  placeholder:\n    name: Tests Placeholder\n    steps:\n      - run: echo \"E2E tests are temporarily disabled\"\n```\n\n**Impact:**\n-  No automated E2E testing on pull requests\n-  No deployment confidence checks\n-  Regression risk on every merge\n\n### 4.3 Test Data Management\n\n**Current Gaps:**\n-  No database seeding scripts\n-  No transaction rollback mechanism\n-  Test pollution risk\n-  No test data factories\n-  No mock external services\n\n### 4.4 Flaky Test Identification\n\n**No Formal Tracking System:**\n-  No flaky test detection in CI/CD\n-  No retry/quarantine mechanism\n-  No test duration tracking\n\n**Evidence of Issues:**\n- Multiple waitForTimeout(2000) calls\n- Extended timeouts (30s for tests)\n- Debug screenshots committed to repo\n\n---\n\n## 5. Recommendations\n\n### 5.1 Priority Tests to Add (Next 30 Days)\n\n**CRITICAL (Week 1-2):**\n\n1. **API Integration Tests for Checkout**\n   - create-order.test.ts\n   - validate-cart.test.ts\n   - payment-intent.test.ts\n   - webhook-handling.test.ts\n\n2. **Admin API Tests**\n   - products.test.ts (CRUD)\n   - orders.test.ts\n   - authorization.test.ts\n   - audit-logs.test.ts\n\n3. **Core Component Unit Tests**\n   - CartDrawer.test.ts\n   - ProductCard.test.ts\n   - ProductFilters.test.ts\n   - Header.test.ts\n\n**HIGH PRIORITY (Week 3-4):**\n\n4. **E2E Critical Flows**\n   - payment-failure.spec.ts\n   - inventory-conflict.spec.ts\n   - admin-product-crud.spec.ts\n   - account-deletion.spec.ts\n\n5. **Performance Tests**\n   - product-listing.spec.ts (page load <2s)\n   - search-latency.spec.ts (search <500ms)\n   - cart-operations.spec.ts (updates <200ms)\n\n### 5.2 Test Refactoring Opportunities\n\n**1. Consolidate Test Patterns**\n```\ntests/utils/\n factories/\n    productFactory.ts\n    orderFactory.ts\n    userFactory.ts\n matchers/\n    toBeValidOrder.ts\n    toMatchSchema.ts\n builders/\n     CartBuilder.ts\n     CheckoutBuilder.ts\n```\n\n**2. Database Transaction Rollback**\n```typescript\nexport async function withTestTransaction(fn) {\n  const client = await supabase.connect()\n  await client.query('BEGIN')\n  try {\n    await fn(client)\n  } finally {\n    await client.query('ROLLBACK')\n  }\n}\n```\n\n**3. Test Naming Convention**\n- Use `.spec.ts` for E2E tests\n- Use `.test.ts` for unit/integration tests\n\n### 5.3 Testing Tools/Libraries to Adopt\n\n**API Testing:**\n- supertest - HTTP assertions\n- msw - Mock Service Worker\n- json-schema-faker - Test data generation\n\n**Component Testing:**\n- @nuxt/test-utils (already installed)\n- @testing-library/vue\n- @storybook/vue3\n\n**Database Testing:**\n- testcontainers - Real Postgres for tests\n- faker-js - Realistic test data\n\n**Performance Testing:**\n- lighthouse-ci - Performance budgets\n- autocannon - API load testing\n\n**Test Quality:**\n- stryker-mutator - Mutation testing\n- test-data-bot - Data builders\n\n### 5.4 Coverage Goals and Thresholds\n\n**Recommended Progressive Targets:**\n\n```typescript\ncoverage: {\n  thresholds: {\n    // Month 1\n    branches: 75,      // Up from 70%\n    functions: 70,     // Up from 55%\n    lines: 15,         // Up from 6.64%\n    statements: 15,    // Up from 6.64%\n  }\n}\n```\n\n**Coverage Targets by Area:**\n\n| Area | Current | 30 Days | 90 Days | 180 Days |\n|------|---------|---------|---------|----------|\n| Overall | 6.64% | 15% | 50% | 80% |\n| API Routes | 0% | 60% | 80% | 90% |\n| Components | 3% | 20% | 60% | 80% |\n| Stores | 40% | 70% | 85% | 90% |\n| Middleware | 71% | 85% | 90% | 95% |\n\n**Critical Path Coverage (Must be 100%):**\n-  Cart operations (~95% done)\n-  Checkout flow (target 100%)\n-  Payment processing (target 100%)\n-  Order creation (target 100%)\n\n---\n\n## 6. Test Debt Summary\n\n### High Priority Debt\n\n| Task | Effort | Impact | Priority |\n|------|--------|--------|----------|\n| Enable CI/CD E2E tests | 2 days | Critical | 1 |\n| API integration tests | 5 days | Critical | 2 |\n| Component unit tests | 8 days | High | 3 |\n| Test data factories | 3 days | High | 4 |\n| Admin API tests | 5 days | High | 5 |\n| Performance tests | 3 days | Medium | 6 |\n\n**Total Estimated Effort:** ~36 days (7-8 weeks)\n\n---\n\n## 7. Action Plan\n\n### Week 1: Immediate Actions\n\n1. **Enable CI/CD Testing**\n   - Configure test database in GitHub Actions\n   - Enable e2e-tests.yml workflow\n   - Set up Supabase test project\n\n2. **Fix High-Priority Gaps**\n   - Add checkout API integration tests\n   - Add payment processing tests with Stripe mocks\n   - Add admin authorization tests\n\n3. **Establish Baselines**\n   - Set up coverage tracking in CI/CD\n   - Create coverage badge for README\n\n### Month 1: Short-Term Goals\n\n1. **Increase Coverage to 15%**\n   - Focus on server/api routes\n   - Add component tests for cart and products\n   - Complete middleware test coverage\n\n2. **Implement Test Infrastructure**\n   - Test data factories\n   - Database transaction handling\n   - Custom test utilities\n\n### Months 2-3: Medium-Term Goals\n\n1. **Reach 50% Coverage**\n   - Comprehensive component testing\n   - All API routes covered\n   - Critical user flows tested\n\n2. **Add Performance Testing**\n   - Lighthouse CI integration\n   - API response time budgets\n\n### Months 4-6: Long-Term Goals\n\n1. **Achieve 80% Coverage**\n   - Complete component library coverage\n   - All edge cases covered\n   - Full E2E test suite\n\n2. **Test Automation Excellence**\n   - Visual regression for all pages\n   - Accessibility testing expansion\n\n---\n\n## 8. Quick Wins (< 1 day each)\n\n1. Enable E2E tests in CI/CD\n2. Add test IDs to components (only 15/261 have them)\n3. Fix vitest import exclusions\n4. Add API test for checkout\n5. Increase coverage thresholds\n6. Add performance budgets\n7. Create component test template\n8. Add pre-commit test hook\n9. Set up coverage badge\n\n---\n\n## Appendix: Test File Inventory\n\n### Unit Tests (26 files)\n\n**Cart Tests (9 files):**\n- analytics.test.ts, auto-save.test.ts, persistence.test.ts\n- cookie-persistence.test.ts, security.test.ts, validation.test.ts\n- advanced.test.ts, cart-store.test.ts, cart-locking.test.ts\n\n**Composable Tests (13 files):**\n- useToast, useProductSearch, useProductStory, useStoreI18n\n- useShippingAddress, useProductStructuredData, useGuestCheckout\n- useMobileProductInteractions, useStripe, useProductPagination\n- useShippingMethods, useKeyboardShortcuts, useProductFilters\n\n**Store Tests (4 files):**\n- checkout-shipping, categories, products, search\n\n### E2E Tests (20 files)\n\n**Critical Tests (6 files):**\n- cart-critical, checkout-critical, auth-critical\n- products-critical, search-critical, admin-critical\n\n**Full E2E (14 files):**\n- Auth (2): accessibility, i18n\n- Admin (4): dashboard, analytics, email, products\n- Other (8): cart, checkout, pagination, security, etc.\n\n---\n\n**Report Generated:** 2025-12-29  \n**Next Review:** 2025-01-29\n",
              "category": "reference"
            }
          ],
          "similarity": 0.8124815225635826,
          "recommendation": "Consider consolidating into TEST_COVERAGE_ANALYSIS.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/meta/AI_ERA_DOCUMENTATION_PROPOSAL.md",
              "name": "AI_ERA_DOCUMENTATION_PROPOSAL.md",
              "size": 20328,
              "lastModified": "2026-01-14T22:11:39.871Z",
              "content": "# AI-Era Documentation Proposal - Moldova Direct\n\n**Date**: January 14, 2026  \n**Status**: Proposal  \n**Priority**: High - Future-Proofing Documentation\n\n---\n\n## The Problem: Documentation for AI Assistants\n\nYou're absolutely right to think about this! When AI writes or modifies code, **you** (the human) need to understand:\n- What the AI changed and why\n- How the system works now\n- What context the AI had when making decisions\n- How to guide the AI better next time\n\n**Current Issue**: Our docs are optimized for humans reading linearly, not for:\n- AI assistants understanding the codebase\n- Humans understanding AI-generated code\n- Quick context retrieval for AI tools\n- Maintaining context as the project grows\n\n---\n\n## Research Summary: AI-Friendly Documentation (2024-2025)\n\n### Key Findings\n\n#### 1. **The Context Crisis**\n- 65% of developers experience missing context during refactoring\n- 60% struggle with context during test generation\n- AI tools rely entirely on available context (unlike humans who accumulate knowledge)\n- **Problem**: \"Context rot\" - AI loses understanding as codebase grows\n\n#### 2. **llms.txt Standard** (September 2024)\nNew web standard for AI-friendly documentation:\n- Markdown file at `/llms.txt` in project root\n- Provides structured overview for LLMs\n- Links to detailed documentation\n- Think \"sitemap.xml for AI\"\n\n#### 3. **Context Engineering > Prompt Engineering**\n- Focus shifted from crafting perfect prompts to providing systematic context\n- AI needs: architecture, patterns, conventions, dependencies\n- Documentation should be machine-readable AND human-readable\n\n#### 4. **Five Core Practices for LLM-Ready Docs**\n1. **Consistent heading hierarchy** - AI navigates by structure\n2. **Avoid vague pronouns** - \"it\", \"this\", \"that\" confuse AI\n3. **Text alternatives for media** - Describe diagrams, screenshots\n4. **Consistent terminology** - Same concept = same word\n5. **Properly formatted code** - Clear language tags, complete examples\n\n---\n\n## Proposed Solution: Dual-Layer Documentation\n\n### Layer 1: Human-Friendly (Ditaxis Structure)\n```\ndocs/\n tutorials/      # Learning-oriented\n how-to/        # Problem-oriented\n reference/     # Information-oriented\n explanation/   # Understanding-oriented\n```\n\n### Layer 2: AI-Friendly (Context Files)\n\n```\n/\n llms.txt                          # AI entry point (NEW)\n .cursorrules                      # Cursor AI rules (NEW)\n .github/\n    copilot-instructions.md      # GitHub Copilot context (NEW)\n\n docs/\n     ai-context/                   # AI-specific docs (NEW)\n        AGENTS.md                # Project context for AI\n        ARCHITECTURE_SUMMARY.md  # High-level system design\n        PATTERNS.md              # Code patterns & conventions\n        DEPENDENCIES.md          # Dependency graph\n        CONVENTIONS.md           # Naming, structure, style\n    \n     [existing structure]\n```\n\n---\n\n## Implementation: The llms.txt File\n\n### What is llms.txt?\n\nA markdown file at your project root that gives AI assistants a structured overview of your project.\n\n**Example for Moldova Direct:**\n\n```markdown\n# Moldova Direct\n\n> E-commerce platform for authentic Moldovan food and wine products. Built with Nuxt 4, Vue 3, Supabase, and Stripe. Multi-language support (ES/EN/RO/RU).\n\n## Project Overview\n\n- **Stack**: Nuxt 4.2.2, Vue 3.5, TypeScript, Supabase, Stripe\n- **Architecture**: SSR/CSR hybrid, modular monolith\n- **State**: Pinia stores with TypeScript\n- **Auth**: Supabase Auth with MFA for admins\n- **Payments**: Stripe (webhooks implemented)\n- **Testing**: Playwright E2E, Vitest unit tests\n\n## Core Documentation\n\n- [Architecture Overview](docs/ai-context/ARCHITECTURE_SUMMARY.md): System design and key decisions\n- [Code Patterns](docs/ai-context/PATTERNS.md): How we structure code\n- [API Reference](docs/reference/api/README.md): All API endpoints\n- [Authentication](docs/architecture/AUTHENTICATION_ARCHITECTURE.md): Auth flow and security\n- [Cart System](docs/architecture/CART_SYSTEM_ARCHITECTURE.md): Shopping cart internals\n- [Checkout Flow](docs/architecture/CHECKOUT_FLOW.md): Multi-step checkout process\n\n## Development Guides\n\n- [Getting Started](docs/tutorials/01-getting-started.md): Setup development environment\n- [Testing Guide](docs/guides/TESTING.md): How to write and run tests\n- [Deployment](docs/guides/DEPLOYMENT_GUIDE.md): Deploy to production\n\n## Code Conventions\n\n- [TypeScript Patterns](docs/ai-context/PATTERNS.md#typescript): Type safety guidelines\n- [Vue 3 Patterns](docs/ai-context/PATTERNS.md#vue3): Component structure\n- [Nuxt 4 Patterns](docs/ai-context/PATTERNS.md#nuxt4): Server routes, composables\n- [Testing Patterns](docs/ai-context/PATTERNS.md#testing): E2E and unit test structure\n\n## Key Concepts\n\n- **Modular Stores**: Cart and auth stores split into focused modules\n- **Dual Persistence**: Cookie + localStorage for cart reliability\n- **Server-Side Validation**: All prices verified server-side\n- **Atomic Operations**: Inventory updates in single transaction\n- **Progressive Enhancement**: Works without JavaScript\n\n## Optional\n\n- [Codebase Audit Report](docs/CODEBASE_AUDIT_REPORT.md): Detailed code quality assessment\n- [Architecture Review Archive](docs/archive/architecture-reviews/): Historical reviews\n- [Visual Regression Tests](docs/testing/VISUAL-REGRESSION-SUMMARY.md): Screenshot testing\n```\n\n**Benefits**:\n-  AI gets project overview in seconds\n-  Consistent context across all AI tools\n-  Humans can read it too (it's markdown!)\n-  Easy to maintain (one file)\n\n---\n\n## Implementation: AGENTS.md File\n\n### What is AGENTS.md?\n\nDetailed context specifically for AI coding agents. More technical than llms.txt.\n\n**Example Structure:**\n\n```markdown\n# Moldova Direct - AI Agent Context\n\n## Project Identity\n\n**Name**: Moldova Direct  \n**Type**: E-commerce Platform  \n**Domain**: Authentic Moldovan food and wine  \n**Target Market**: Spain (primary), expanding to EU\n\n## Technical Stack\n\n### Frontend\n- **Framework**: Nuxt 4.2.2 (Vue 3.5 Composition API)\n- **Language**: TypeScript (strict mode)\n- **Styling**: Tailwind CSS v4 with CSS variables\n- **State**: Pinia stores (modular architecture)\n- **UI**: Custom components (migrated from shadcn-vue)\n\n### Backend\n- **Runtime**: Nitro (Nuxt server)\n- **Database**: Supabase PostgreSQL with RLS\n- **Auth**: Supabase Auth (JWT + MFA for admins)\n- **Payments**: Stripe (webhooks implemented)\n- **Email**: Resend for transactional emails\n\n### Infrastructure\n- **Hosting**: Vercel (edge functions)\n- **CI/CD**: GitHub Actions\n- **Testing**: Playwright (E2E), Vitest (unit)\n- **Monitoring**: Vercel Analytics\n\n## Architecture Patterns\n\n### State Management\n```typescript\n// Modular store pattern (PREFERRED)\nstores/\n cart/\n    index.ts      // Main coordinator\n    core.ts       // State & operations\n    persistence.ts // Storage logic\n    types.ts      // TypeScript definitions\n```\n\n### API Routes\n```typescript\n// Server route pattern (REQUIRED)\nexport default defineEventHandler(async (event) => {\n  // 1. Validate origin (CSRF protection)\n  const originResult = validateOrigin(event)\n  if (!originResult.valid) {\n    throw createError({ statusCode: 403 })\n  }\n  \n  // 2. Get authenticated user\n  const user = await getUser(event)\n  \n  // 3. Validate input\n  const body = await readBody(event)\n  \n  // 4. Server-side validation (CRITICAL)\n  // Never trust client prices!\n  \n  // 5. Return response\n  return { success: true, data }\n})\n```\n\n### Component Structure\n```vue\n<!-- Vue 3 Composition API pattern (PREFERRED) -->\n<script setup lang=\"ts\">\n// 1. Props with TypeScript\ninterface Props {\n  product: Product\n  quantity?: number\n}\nconst props = withDefaults(defineProps<Props>(), {\n  quantity: 1\n})\n\n// 2. Emits with types\nconst emit = defineEmits<{\n  add: [product: Product, quantity: number]\n}>()\n\n// 3. Composables\nconst cart = useCart()\nconst { t } = useI18n()\n\n// 4. Reactive state\nconst loading = ref(false)\n\n// 5. Methods\nasync function handleAdd() {\n  loading.value = true\n  try {\n    await cart.addItem(props.product, props.quantity)\n    emit('add', props.product, props.quantity)\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n```\n\n## Critical Security Rules\n\n### NEVER Do This\n```typescript\n//  WRONG: Trust client prices\nconst total = body.subtotal + body.shipping\n\n//  WRONG: Direct database access without validation\nawait supabase.from('orders').insert({ total: body.total })\n\n//  WRONG: Skip CSRF validation\nexport default defineEventHandler(async (event) => {\n  const body = await readBody(event)\n  // ... process without validation\n})\n```\n\n### ALWAYS Do This\n```typescript\n//  CORRECT: Verify prices server-side\nconst { data: product } = await supabase\n  .from('products')\n  .select('price_eur')\n  .eq('id', productId)\n  .single()\n\nconst serverTotal = product.price_eur * quantity\n\n//  CORRECT: Validate origin\nconst originResult = validateOrigin(event)\nif (!originResult.valid) {\n  throw createError({ statusCode: 403 })\n}\n\n//  CORRECT: Use atomic operations\nawait supabase.rpc('create_order_with_inventory', {\n  order_data,\n  order_items_data\n})\n```\n\n## Code Conventions\n\n### Naming\n- **Files**: kebab-case (`user-profile.vue`, `create-order.post.ts`)\n- **Components**: PascalCase (`UserProfile`, `ProductCard`)\n- **Composables**: camelCase with `use` prefix (`useCart`, `useAuth`)\n- **Types**: PascalCase (`Product`, `CartItem`, `OrderData`)\n- **Constants**: SCREAMING_SNAKE_CASE (`MAX_CART_ITEMS`, `API_BASE_URL`)\n\n### File Organization\n```\ncomponents/\n ui/              # Reusable UI components\n checkout/        # Feature-specific components\n admin/           # Admin-only components\n\ncomposables/\n useCart.ts       # Business logic\n useAuth.ts       # Authentication\n useToast.ts      # UI utilities\n\nserver/\n api/             # API endpoints\n utils/           # Server utilities\n middleware/      # Server middleware\n```\n\n### Testing\n```typescript\n// E2E test pattern (Playwright)\ntest('user can add product to cart', async ({ page }) => {\n  await page.goto('/products/wine-1')\n  await page.click('[data-testid=\"add-to-cart\"]')\n  await expect(page.locator('[data-testid=\"cart-count\"]')).toHaveText('1')\n})\n\n// Unit test pattern (Vitest)\ndescribe('useCart', () => {\n  it('adds item to cart', async () => {\n    const { addItem, items } = useCart()\n    await addItem(mockProduct, 2)\n    expect(items.value).toHaveLength(1)\n    expect(items.value[0].quantity).toBe(2)\n  })\n})\n```\n\n## Common Tasks\n\n### Adding a New API Endpoint\n1. Create file: `server/api/[feature]/[action].post.ts`\n2. Add CSRF validation\n3. Validate input with Zod schema\n4. Use service role client for database access\n5. Return typed response\n6. Add tests\n\n### Adding a New Component\n1. Create file: `components/[feature]/[Name].vue`\n2. Use `<script setup lang=\"ts\">`\n3. Define props with TypeScript\n4. Add data-testid attributes\n5. Add to Storybook (if applicable)\n6. Add tests\n\n### Modifying Database Schema\n1. Create migration: `supabase/migrations/[timestamp]_[description].sql`\n2. Update RLS policies\n3. Update TypeScript types\n4. Update API endpoints\n5. Add tests\n6. Document in architecture docs\n\n## Dependencies\n\n### Critical Dependencies\n- `nuxt`: 4.2.2 (framework)\n- `vue`: 3.5.18 (UI library)\n- `@supabase/supabase-js`: Database & auth\n- `stripe`: Payment processing\n- `pinia`: State management\n\n### Development Dependencies\n- `@playwright/test`: E2E testing\n- `vitest`: Unit testing\n- `typescript`: Type checking\n- `eslint`: Linting\n\n## Known Issues & Workarounds\n\n### Issue: Cart Persistence on Safari\n**Problem**: Safari clears cookies aggressively  \n**Workaround**: Dual persistence (cookie + localStorage)  \n**Location**: `stores/cart/index.ts`\n\n### Issue: Stripe Webhook Timing\n**Problem**: Webhook may arrive before order creation  \n**Workaround**: Idempotent webhook handler with retry  \n**Location**: `server/api/webhooks/stripe.post.ts`\n\n## Recent Changes\n\n### January 2026\n- Security hardening (PR #337): CSP, CSRF, rate limiting\n- Custom component system (PR #346): Replaced shadcn-vue\n- Auth store modularization: Split into focused modules\n- Cart initialization simplified: Use `import.meta.client`\n\n### November 2025\n- Stripe webhook implementation: Payment status automation\n- Admin MFA enforcement: Enhanced security\n- WCAG 2.1 AA compliance: Accessibility improvements\n\n## Future Plans\n\n### Short-term (Next Month)\n- Complete Stripe production configuration\n- Enhance transactional email system\n- Add admin analytics dashboard\n\n### Long-term (Next Quarter)\n- Implement repository pattern for database access\n- Refactor large components (PaymentForm, HybridCheckout)\n- Add comprehensive unit test coverage\n\n## Questions to Ask Before Coding\n\n1. **Security**: Does this handle user input?  Validate server-side\n2. **Pricing**: Does this involve money?  Verify prices server-side\n3. **Inventory**: Does this modify stock?  Use atomic operations\n4. **Authentication**: Does this need auth?  Check user permissions\n5. **Testing**: How will this be tested?  Add test cases\n\n## Resources\n\n- [Full Documentation](docs/README.md)\n- [Architecture Docs](docs/architecture/)\n- [API Reference](docs/reference/api/)\n- [Testing Guide](docs/guides/TESTING.md)\n```\n\n---\n\n## Implementation: .cursorrules File\n\nFor Cursor AI specifically:\n\n```markdown\n# Moldova Direct - Cursor AI Rules\n\n## Project Context\nE-commerce platform for Moldovan products. Nuxt 4 + Vue 3 + Supabase + Stripe.\n\n## Code Style\n- TypeScript strict mode\n- Vue 3 Composition API with `<script setup>`\n- Tailwind CSS for styling\n- Pinia for state management\n\n## Critical Rules\n1. NEVER trust client-sent prices - always verify server-side\n2. ALWAYS validate origin for state-changing operations (CSRF)\n3. ALWAYS use atomic operations for inventory updates\n4. ALWAYS add data-testid attributes to interactive elements\n\n## File Patterns\n- Components: `components/[feature]/[Name].vue`\n- API routes: `server/api/[feature]/[action].[method].ts`\n- Composables: `composables/use[Feature].ts`\n- Tests: `tests/[type]/[feature].spec.ts`\n\n## When Creating Components\n- Use TypeScript for props\n- Add proper emits typing\n- Include accessibility attributes\n- Add loading/error states\n\n## When Creating API Routes\n1. Validate origin (CSRF)\n2. Authenticate user\n3. Validate input\n4. Verify prices server-side\n5. Use service role client\n6. Return typed response\n\n## Testing Requirements\n- Add E2E test for user-facing features\n- Add unit test for business logic\n- Use data-testid for selectors\n- Mock external services\n\n## Documentation\n- Update relevant architecture docs\n- Add JSDoc comments for complex logic\n- Update API reference if adding endpoints\n```\n\n---\n\n## Benefits of AI-Era Documentation\n\n### For You (Human Developer)\n **Understand AI changes faster**\n- Clear context about what AI knows\n- Patterns AI should follow\n- Security rules AI must respect\n\n **Guide AI better**\n- Consistent conventions\n- Clear examples\n- Known patterns\n\n **Onboard faster**\n- AI can explain the codebase\n- Quick context retrieval\n- Structured learning path\n\n### For AI Assistants\n **Better code generation**\n- Understands project patterns\n- Follows security rules\n- Uses correct conventions\n\n **Fewer mistakes**\n- Clear \"never do this\" examples\n- Security guardrails\n- Consistent style\n\n **Faster context loading**\n- Structured information\n- Clear hierarchy\n- Machine-readable format\n\n### For the Project\n **Maintainability**\n- Consistent code style\n- Clear patterns\n- Easy to understand\n\n **Security**\n- AI follows security rules\n- Server-side validation enforced\n- CSRF protection required\n\n **Quality**\n- Testing requirements clear\n- Accessibility built-in\n- Performance patterns documented\n\n---\n\n## Implementation Plan\n\n### Phase 1: Core AI Context (Week 1)\n\n**Day 1-2: Create llms.txt**\n- [ ] Create `/llms.txt` with project overview\n- [ ] Link to key documentation\n- [ ] Add code conventions summary\n- [ ] Test with Claude/ChatGPT\n\n**Day 3-4: Create AGENTS.md**\n- [ ] Document architecture patterns\n- [ ] Add security rules\n- [ ] Include code examples\n- [ ] Add common tasks guide\n\n**Day 5: Create .cursorrules**\n- [ ] Add Cursor-specific rules\n- [ ] Include critical patterns\n- [ ] Add file structure conventions\n\n### Phase 2: Enhanced Context (Week 2)\n\n**Day 1-2: Architecture Summary**\n- [ ] Create `docs/ai-context/ARCHITECTURE_SUMMARY.md`\n- [ ] High-level system design\n- [ ] Key decisions and rationale\n- [ ] Component relationships\n\n**Day 3-4: Patterns Documentation**\n- [ ] Create `docs/ai-context/PATTERNS.md`\n- [ ] TypeScript patterns\n- [ ] Vue 3 patterns\n- [ ] API route patterns\n- [ ] Testing patterns\n\n**Day 5: Dependencies & Conventions**\n- [ ] Create `docs/ai-context/DEPENDENCIES.md`\n- [ ] Create `docs/ai-context/CONVENTIONS.md`\n- [ ] Document naming conventions\n- [ ] Document file organization\n\n### Phase 3: Validation & Iteration (Week 3)\n\n**Day 1-2: Test with AI Tools**\n- [ ] Test with Cursor AI\n- [ ] Test with GitHub Copilot\n- [ ] Test with Claude/ChatGPT\n- [ ] Collect feedback\n\n**Day 3-4: Refine Based on Feedback**\n- [ ] Update llms.txt\n- [ ] Enhance AGENTS.md\n- [ ] Add missing patterns\n- [ ] Fix unclear sections\n\n**Day 5: Documentation & Training**\n- [ ] Document the AI context system\n- [ ] Create guide for maintaining AI docs\n- [ ] Train team on using AI context\n\n---\n\n## Measuring Success\n\n### Quantitative Metrics\n-  **Time to understand AI changes**: Target <5 minutes\n-  **AI code quality**: Fewer security issues, consistent style\n-  **Context retrieval speed**: AI finds info in <10 seconds\n-  **Iteration speed**: Faster development with AI assistance\n\n### Qualitative Metrics\n-  **Developer satisfaction**: \"AI understands our patterns\"\n-  **AI effectiveness**: \"AI generates production-ready code\"\n-  **Documentation clarity**: \"Easy to understand what AI knows\"\n-  **Security confidence**: \"AI follows security rules\"\n\n---\n\n## Example: Before & After\n\n### Before (Current)\n\n**You**: \"Add a payment method to checkout\"\n\n**AI**: *Generates code that:*\n-  Trusts client-sent prices\n-  Skips CSRF validation\n-  Uses wrong component pattern\n-  Missing TypeScript types\n\n**You**: *Spend 30 minutes fixing AI code* \n\n### After (With AI Context)\n\n**You**: \"Add a payment method to checkout\"\n\n**AI**: *Reads llms.txt and AGENTS.md, then generates code that:*\n-  Validates prices server-side\n-  Includes CSRF protection\n-  Uses correct component pattern\n-  Proper TypeScript types\n-  Includes tests\n\n**You**: *Review and merge in 5 minutes* \n\n---\n\n## Maintenance\n\n### Weekly\n- [ ] Update llms.txt if major features added\n- [ ] Review AI-generated code for pattern compliance\n\n### Monthly\n- [ ] Update AGENTS.md with new patterns\n- [ ] Add new security rules if discovered\n- [ ] Update dependencies list\n\n### Quarterly\n- [ ] Full review of AI context docs\n- [ ] Gather team feedback\n- [ ] Update based on AI tool improvements\n\n---\n\n## Resources\n\n### Standards & Specifications\n- [llms.txt Official Spec](https://llmstxt.org/) - Standard for AI-friendly docs\n- [AGENTS.md Specification](https://github.com/propelcode/agents-md) - Context for AI agents\n\n### Tools\n- [llms-txt validator](https://llmstxt.org/validator) - Validate your llms.txt\n- [Context Engineering Guide](https://contextengineering.ai/) - Best practices\n\n### Examples\n- [FastHTML llms.txt](https://fastht.ml/llms.txt) - Well-structured example\n- [Supabase docs](https://supabase.com/docs) - AI-friendly documentation\n\n---\n\n## Next Steps\n\n1. **Review this proposal** with the team\n2. **Start with llms.txt** (2 hours to create)\n3. **Test with AI tools** (Cursor, Copilot, Claude)\n4. **Iterate based on results**\n5. **Expand to full AI context** if successful\n\n---\n\n**Questions?** Let's discuss how AI-era documentation can help you understand and guide AI-generated code better!\n\n---\n\n**Prepared by**: Kiro AI Assistant  \n**Based on**: 2024-2025 AI documentation research  \n**Status**: Ready for implementation\n",
              "category": "explanation"
            },
            {
              "path": "docs/meta/QUICK_START_DUAL_LAYER_DOCS.md",
              "name": "QUICK_START_DUAL_LAYER_DOCS.md",
              "size": 11082,
              "lastModified": "2026-01-14T22:27:43.433Z",
              "content": "# Quick Start: Dual-Layer Documentation\n\n**Goal**: Get dual-layer documentation working in 1 hour  \n**For**: Immediate value without full restructure\n\n---\n\n## What You'll Get\n\n AI assistants understand your project  \n Better code generation from AI  \n Faster onboarding for developers  \n Clear security rules enforced\n\n---\n\n## 1-Hour Implementation\n\n### Step 1: Verify llms.txt (5 min)\n\n**File**: `/llms.txt` (already created!)\n\n**Test it**:\n1. Open Cursor/Copilot/Claude\n2. Ask: \"What is this project about?\"\n3. AI should give accurate answer using llms.txt\n\n**If it works**:  Move to Step 2  \n**If not**: Update llms.txt with more context\n\n---\n\n### Step 2: Create .cursorrules (15 min)\n\n**File**: `/.cursorrules`\n\n**Copy this**:\n```markdown\n# Moldova Direct - Cursor AI Rules\n\n## Project Context\nE-commerce platform for Moldovan products. Nuxt 4 + Vue 3 + Supabase + Stripe.\n\n## Critical Security Rules\n1. NEVER trust client-sent prices - always verify server-side\n2. ALWAYS validate origin for state-changing operations (CSRF)\n3. ALWAYS use atomic operations for inventory updates\n4. ALWAYS add data-testid attributes to interactive elements\n\n## Code Style\n- TypeScript strict mode\n- Vue 3 Composition API with `<script setup>`\n- Tailwind CSS for styling\n- Pinia for state management\n\n## Component Pattern\n```vue\n<script setup lang=\"ts\">\ninterface Props {\n  product: Product\n  quantity?: number\n}\nconst props = withDefaults(defineProps<Props>(), {\n  quantity: 1\n})\n\nconst emit = defineEmits<{\n  add: [product: Product, quantity: number]\n}>()\n</script>\n```\n\n## API Route Pattern\n```typescript\nexport default defineEventHandler(async (event) => {\n  // 1. Validate origin (CSRF)\n  const originResult = validateOrigin(event)\n  if (!originResult.valid) {\n    throw createError({ statusCode: 403 })\n  }\n  \n  // 2. Get authenticated user\n  const user = await getUser(event)\n  \n  // 3. Validate input\n  const body = await readBody(event)\n  \n  // 4. Verify prices server-side (CRITICAL)\n  const { data: product } = await supabase\n    .from('products')\n    .select('price_eur')\n    .eq('id', productId)\n    .single()\n  \n  // 5. Use atomic operations\n  await supabase.rpc('create_order_with_inventory', {\n    order_data,\n    order_items_data\n  })\n  \n  return { success: true, data }\n})\n```\n\n## File Patterns\n- Components: `components/[feature]/[Name].vue`\n- API routes: `server/api/[feature]/[action].[method].ts`\n- Composables: `composables/use[Feature].ts`\n- Tests: `tests/[type]/[feature].spec.ts`\n\n## Testing Requirements\n- Add E2E test for user-facing features\n- Add unit test for business logic\n- Use data-testid for selectors\n- Mock external services\n```\n\n**Save as**: `/.cursorrules`\n\n---\n\n### Step 3: Create AGENTS.md (20 min)\n\n**File**: `/AGENTS.md`\n\n**Copy this template and customize**:\n```markdown\n# Moldova Direct - AI Agent Context\n\n## Project Identity\n**Name**: Moldova Direct  \n**Type**: E-commerce Platform  \n**Stack**: Nuxt 4.2.2, Vue 3.5, TypeScript, Supabase, Stripe\n\n## Critical Security Rules\n\n### NEVER Do This\n```typescript\n//  WRONG: Trust client prices\nconst total = body.subtotal + body.shipping\n\n//  WRONG: Skip CSRF validation\nexport default defineEventHandler(async (event) => {\n  const body = await readBody(event)\n  // ... process without validation\n})\n\n//  WRONG: Direct inventory update\nawait supabase\n  .from('products')\n  .update({ stock_quantity: newStock })\n  .eq('id', productId)\n```\n\n### ALWAYS Do This\n```typescript\n//  CORRECT: Verify prices server-side\nconst { data: product } = await supabase\n  .from('products')\n  .select('price_eur')\n  .eq('id', productId)\n  .single()\n\nconst serverTotal = product.price_eur * quantity\n\n//  CORRECT: Validate origin\nconst originResult = validateOrigin(event)\nif (!originResult.valid) {\n  throw createError({ statusCode: 403 })\n}\n\n//  CORRECT: Use atomic operations\nawait supabase.rpc('create_order_with_inventory', {\n  order_data,\n  order_items_data\n})\n```\n\n## Architecture Patterns\n\n### Modular Store Pattern\n```typescript\nstores/\n cart/\n    index.ts      // Main coordinator\n    core.ts       // State & operations\n    persistence.ts // Storage logic\n    types.ts      // TypeScript definitions\n```\n\n### Component Pattern\n```vue\n<script setup lang=\"ts\">\n// 1. Props with TypeScript\ninterface Props {\n  product: Product\n  quantity?: number\n}\nconst props = withDefaults(defineProps<Props>(), {\n  quantity: 1\n})\n\n// 2. Emits with types\nconst emit = defineEmits<{\n  add: [product: Product, quantity: number]\n}>()\n\n// 3. Composables\nconst cart = useCart()\nconst { t } = useI18n()\n\n// 4. Reactive state\nconst loading = ref(false)\n\n// 5. Methods\nasync function handleAdd() {\n  loading.value = true\n  try {\n    await cart.addItem(props.product, props.quantity)\n    emit('add', props.product, props.quantity)\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n```\n\n### API Route Pattern\n```typescript\nexport default defineEventHandler(async (event) => {\n  // 1. Validate origin (CSRF protection)\n  const originResult = validateOrigin(event)\n  if (!originResult.valid) {\n    throw createError({ statusCode: 403 })\n  }\n  \n  // 2. Get authenticated user\n  const user = await getUser(event)\n  \n  // 3. Validate input\n  const body = await readBody(event)\n  \n  // 4. Server-side validation (CRITICAL)\n  // Never trust client prices!\n  \n  // 5. Return response\n  return { success: true, data }\n})\n```\n\n## Code Conventions\n\n### Naming\n- **Files**: kebab-case (`user-profile.vue`)\n- **Components**: PascalCase (`UserProfile`)\n- **Composables**: camelCase with `use` prefix (`useCart`)\n- **Types**: PascalCase (`Product`, `CartItem`)\n- **Constants**: SCREAMING_SNAKE_CASE (`MAX_CART_ITEMS`)\n\n### File Organization\n```\ncomponents/\n ui/              # Reusable UI components\n checkout/        # Feature-specific components\n admin/           # Admin-only components\n\ncomposables/\n useCart.ts       # Business logic\n useAuth.ts       # Authentication\n useToast.ts      # UI utilities\n\nserver/\n api/             # API endpoints\n utils/           # Server utilities\n middleware/      # Server middleware\n```\n\n## Common Tasks\n\n### Adding a New API Endpoint\n1. Create file: `server/api/[feature]/[action].post.ts`\n2. Add CSRF validation\n3. Validate input\n4. Use service role client\n5. Return typed response\n6. Add tests\n\n### Adding a New Component\n1. Create file: `components/[feature]/[Name].vue`\n2. Use `<script setup lang=\"ts\">`\n3. Define props with TypeScript\n4. Add data-testid attributes\n5. Add tests\n\n## Recent Changes (January 2026)\n- Security hardening: CSP, CSRF, rate limiting\n- Custom component system: Replaced shadcn-vue\n- Auth store modularization: Split into focused modules\n- Cart initialization simplified: Use `import.meta.client`\n\n## Resources\n- [Full Documentation](docs/README.md)\n- [Architecture Docs](docs/architecture/)\n- [Testing Guide](docs/guides/TESTING.md)\n```\n\n**Save as**: `/AGENTS.md`\n\n---\n\n### Step 4: Test with AI (10 min)\n\n**Test 1: Project Understanding**\n```\nAsk AI: \"What is this project about?\"\nExpected: Accurate description from llms.txt\n```\n\n**Test 2: Security Rules**\n```\nAsk AI: \"How should I handle payment processing?\"\nExpected: Mentions server-side price verification\n```\n\n**Test 3: Code Generation**\n```\nAsk AI: \"Create a new API endpoint for updating user profile\"\nExpected: Includes CSRF validation, proper pattern\n```\n\n**Test 4: Pattern Following**\n```\nAsk AI: \"Create a new Vue component for product card\"\nExpected: Uses <script setup lang=\"ts\">, proper props\n```\n\n---\n\n### Step 5: Document for Team (10 min)\n\n**Create**: `docs/guides/USING_AI_CONTEXT.md`\n\n```markdown\n# Using AI Context in Moldova Direct\n\n## For Developers\n\n### When Using AI Tools (Cursor, Copilot, Claude)\n\nThe AI has access to project context through:\n- `/llms.txt` - Project overview\n- `/.cursorrules` - Cursor-specific rules\n- `/AGENTS.md` - Detailed patterns and conventions\n\n### What AI Knows\n\n **Security Rules**\n- Never trust client prices\n- Always validate CSRF\n- Use atomic operations\n\n **Code Patterns**\n- Vue 3 Composition API\n- TypeScript strict mode\n- Modular store structure\n\n **File Organization**\n- Component structure\n- API route patterns\n- Test organization\n\n### How to Get Better AI Suggestions\n\n1. **Be Specific**\n   ```\n    \"Add payment\"\n    \"Add Stripe payment endpoint with server-side price verification\"\n   ```\n\n2. **Reference Patterns**\n   ```\n    \"Create a component following our Vue 3 pattern\"\n    \"Add API route with CSRF validation like other endpoints\"\n   ```\n\n3. **Ask for Explanations**\n   ```\n    \"Why did you use atomic operations here?\"\n    \"Explain the security considerations\"\n   ```\n\n### Maintaining AI Context\n\nWhen you add new patterns or rules:\n1. Update `/AGENTS.md`\n2. Update `/.cursorrules` if Cursor-specific\n3. Update `/llms.txt` if major change\n4. Test with AI to verify\n\n### Common Issues\n\n**AI doesn't follow patterns**\n Check if pattern is documented in AGENTS.md\n\n**AI suggests insecure code**\n Verify security rules are in .cursorrules\n\n**AI doesn't understand project**\n Update llms.txt with more context\n```\n\n---\n\n## Verification Checklist\n\nAfter 1 hour, you should have:\n\n- [ ] `/llms.txt` - Tested and working\n- [ ] `/.cursorrules` - Created and saved\n- [ ] `/AGENTS.md` - Created with patterns\n- [ ] Tested with AI tool (4 tests passed)\n- [ ] Team guide created\n\n---\n\n## What's Next?\n\n### This Week\n- [ ] Add more patterns to AGENTS.md as you discover them\n- [ ] Update security rules based on code reviews\n- [ ] Collect team feedback on AI code quality\n\n### Next Week\n- [ ] Create `docs/ai-context/` folder with detailed docs\n- [ ] Add diagrams to AGENTS.md\n- [ ] Expand llms.txt with more links\n\n### This Month\n- [ ] Implement full Ditaxis structure (human-friendly layer)\n- [ ] Measure improvement in AI code quality\n- [ ] Train team on maintaining AI context\n\n---\n\n## Success Metrics\n\nTrack these to measure effectiveness:\n\n### Week 1\n-  Time AI takes to understand context: <10 seconds\n-  AI code follows patterns: >80%\n-  AI respects security rules: 100%\n\n### Month 1\n-  Developer satisfaction: \"AI is more helpful\"\n-  Development speed: Faster with AI\n-  Code quality: Fewer pattern violations\n\n---\n\n## Troubleshooting\n\n### AI Doesn't Read llms.txt\n**Solution**: Make sure file is at project root (`/llms.txt`)\n\n### Cursor Doesn't Use .cursorrules\n**Solution**: Restart Cursor after creating file\n\n### AI Still Makes Mistakes\n**Solution**: Add specific examples to AGENTS.md\n\n### Team Confused\n**Solution**: Share the team guide, do a quick demo\n\n---\n\n## Resources\n\n- [Full Implementation Guide](./DUAL_LAYER_DOCS_IMPLEMENTATION_PROMPT.md)\n- [AI-Era Documentation Proposal](./AI_ERA_DOCUMENTATION_PROPOSAL.md)\n- [llms.txt Standard](https://llmstxt.org/)\n\n---\n\n**Done in 1 hour?** You now have AI-friendly documentation! \n\n**Want more?** Use the full implementation prompt for complete dual-layer system.\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8081364213100849,
          "recommendation": "Consider consolidating into QUICK_START_DUAL_LAYER_DOCS.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/optimization/date-fns-optimization-report.md",
              "name": "date-fns-optimization-report.md",
              "size": 6798,
              "lastModified": "2025-11-11T21:50:30.732Z",
              "content": "# Date-fns Import Optimization Report\n\n## Executive Summary\n\nSuccessfully optimized date-fns imports across the codebase by replacing simple date formatting operations with native `Intl.DateTimeFormat` and custom helper functions. This optimization reduces bundle size and improves tree-shaking efficiency.\n\n## Changes Summary\n\n### Files Modified: 4 files\n\n1. **components/admin/Utils/UserTableRow.vue**\n   - Removed: `import { format } from 'date-fns'`\n   - Added: Native `Intl.DateTimeFormat` for \"MMM dd, yyyy\" format\n   - Impact: 3 format calls replaced\n\n2. **pages/admin/orders/analytics.vue**\n   - Removed: `format` from date-fns imports (kept `subDays`)\n   - Added: Custom `formatDateISO` helper for \"yyyy-MM-dd\" format\n   - Impact: 3 format calls replaced\n\n3. **components/admin/Dashboard/Overview.vue**\n   - Removed: `format` from date-fns imports (kept `subDays`)\n   - Added: Native `Intl.DateTimeFormat` for weekday formatting\n   - Impact: 1 format call in loop replaced\n\n4. **server/api/admin/orders/analytics.get.ts**\n   - Removed: `format` from date-fns imports (kept `subDays`, `startOfDay`, `endOfDay`)\n   - Added: Custom `formatDateISO` helper\n   - Impact: 1 format call replaced\n\n### Files Unchanged (Optimally Configured)\n\n- **components/admin/Charts/Base.vue**\n  - Kept: `import 'chartjs-adapter-date-fns'`\n  - Reason: Required by Chart.js for time scale functionality\n\n## Current Date-fns Usage (Post-Optimization)\n\n### Remaining Imports:\n```typescript\n// Only essential functions that provide complex date operations\n- subDays (3 files)\n- startOfDay (1 file)\n- endOfDay (1 file)\n- chartjs-adapter-date-fns (1 file - Chart.js integration)\n```\n\n### Total Functions: 3 unique functions + 1 adapter\n**Previous**: ~8 functions (including multiple `format` calls)\n**Current**: 3 functions + 1 adapter\n\n## Implementation Details\n\n### 1. Native Intl.DateTimeFormat Usage\n\n**UserTableRow.vue** - Date display formatting:\n```typescript\n// Native date formatter for better performance\nconst dateFormatter = new Intl.DateTimeFormat('en-US', {\n  year: 'numeric',\n  month: 'short',\n  day: '2-digit'\n})\n\n// Usage in computed properties\nconst formattedRegistration = computed(() => {\n  if (!props.user.created_at) return 'Unknown'\n  return dateFormatter.format(new Date(props.user.created_at))\n})\n```\n\n**Dashboard/Overview.vue** - Weekday formatting:\n```typescript\n// Native formatter for day of week (replaces date-fns format)\nconst dayFormatter = new Intl.DateTimeFormat('en-US', { weekday: 'short' })\n\nfor (let index = days - 1; index >= 0; index--) {\n  const date = subDays(today, index)\n  categories.push(dayFormatter.format(date))\n}\n```\n\n### 2. Custom Helper Functions\n\n**ISO Date Formatting** (used in analytics.vue and analytics.get.ts):\n```typescript\n// Helper function to format date as yyyy-MM-dd (native alternative to date-fns format)\nconst formatDateISO = (date: Date): string => {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  return `${year}-${month}-${day}`\n}\n```\n\n## Bundle Size Impact\n\n### Estimated Reduction:\n- **date-fns format function**: ~2-3 KB (gzipped)\n- **Total removed imports**: 8 function references reduced to 3\n- **Estimated savings**: 5-8 KB (gzipped)\n\n### Tree-Shaking Improvements:\n- Before: 5 different date-fns functions imported across files\n- After: 3 essential functions + 1 required adapter\n- **Reduction**: ~40% fewer date-fns imports\n\n## Performance Benefits\n\n1. **Faster Initial Load**\n   - Smaller JavaScript bundle\n   - Less code to parse and execute\n\n2. **Better Caching**\n   - Native `Intl` API is built into browsers\n   - No external library code for simple operations\n\n3. **Improved Tree-Shaking**\n   - Only complex date operations still use date-fns\n   - Simple formatting uses native APIs\n\n## Testing Results\n\n **All Unit Tests Passed**: 222 passed | 64 skipped | 4 todo (290)\n **Type Safety Maintained**: No new TypeScript errors introduced\n **Functionality Preserved**: All date formatting works as expected\n\n## Migration Patterns\n\n### Pattern 1: Simple Date Display (MMM dd, yyyy)\n```typescript\n//  Before\nimport { format } from 'date-fns'\nconst formatted = format(new Date(), 'MMM dd, yyyy')\n\n//  After\nconst dateFormatter = new Intl.DateTimeFormat('en-US', {\n  year: 'numeric',\n  month: 'short',\n  day: '2-digit'\n})\nconst formatted = dateFormatter.format(new Date())\n```\n\n### Pattern 2: ISO Date Format (yyyy-MM-dd)\n```typescript\n//  Before\nimport { format } from 'date-fns'\nconst formatted = format(new Date(), 'yyyy-MM-dd')\n\n//  After\nconst formatDateISO = (date: Date): string => {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  return `${year}-${month}-${day}`\n}\nconst formatted = formatDateISO(new Date())\n```\n\n### Pattern 3: Day of Week\n```typescript\n//  Before\nimport { format } from 'date-fns'\nconst day = format(date, 'EEE')\n\n//  After\nconst dayFormatter = new Intl.DateTimeFormat('en-US', { weekday: 'short' })\nconst day = dayFormatter.format(date)\n```\n\n## What to Keep from date-fns\n\nKeep using date-fns for:\n-  Complex date calculations (`subDays`, `addMonths`, etc.)\n-  Date range operations (`startOfDay`, `endOfDay`, etc.)\n-  Date comparisons with timezone handling\n-  Chart.js time scale adapter\n\n## Recommendations\n\n### Short-term:\n1.  Monitor bundle size in production builds\n2.  Verify date formatting across different locales (if internationalization is needed)\n3.  Consider creating a shared `utils/dateFormatters.ts` file for reusable formatters\n\n### Long-term:\n1. **Consider Temporal API**: When widely supported, migrate to native Temporal API for all date operations\n2. **Create Date Utility Module**: Centralize all date formatting and manipulation logic\n3. **Document Patterns**: Add to coding standards for future date handling\n\n## Browser Compatibility\n\nAll native replacements use widely supported APIs:\n- `Intl.DateTimeFormat`: Supported in all modern browsers (IE11+)\n- `String.padStart()`: Supported in all modern browsers (IE: polyfill available)\n\n## Conclusion\n\nThis optimization successfully reduces date-fns bundle size by ~40% while maintaining full functionality. The migration to native APIs improves performance, reduces bundle size, and simplifies the codebase for simple date formatting operations.\n\n### Key Metrics:\n- **Files Modified**: 4\n- **Import Reduction**: 5 function references removed\n- **Tests Passing**:  100% (222/222 passing tests)\n- **Estimated Bundle Savings**: 5-8 KB gzipped\n- **Type Safety**:  Maintained\n- **Breaking Changes**:  None\n\n---\n\n**Generated**: 2025-11-11\n**Status**:  Completed and Verified\n",
              "category": "reference"
            },
            {
              "path": "docs/optimization/date-fns-quick-reference.md",
              "name": "date-fns-quick-reference.md",
              "size": 2911,
              "lastModified": "2025-11-11T21:50:30.733Z",
              "content": "# Date-fns Optimization Quick Reference\n\n## Summary\n\nOptimized date-fns imports by replacing simple `format()` calls with native JavaScript alternatives.\n\n## What Changed\n\n###  Optimized (Removed date-fns format)\n\n| File | Before | After | Savings |\n|------|--------|-------|---------|\n| `UserTableRow.vue` | `format(date, 'MMM dd, yyyy')` | `Intl.DateTimeFormat` | ~2 KB |\n| `analytics.vue` | `format(date, 'yyyy-MM-dd')` | Custom `formatDateISO()` | ~2 KB |\n| `Overview.vue` | `format(date, 'EEE')` | `Intl.DateTimeFormat` | ~2 KB |\n| `analytics.get.ts` | `format(date, 'yyyy-MM-dd')` | Custom `formatDateISO()` | ~2 KB |\n\n###  Kept (Essential Functions)\n\n| Function | Usage | Why Keep |\n|----------|-------|----------|\n| `subDays` | 3 files | Complex date arithmetic |\n| `startOfDay` | 1 file | Timezone-aware date boundaries |\n| `endOfDay` | 1 file | Timezone-aware date boundaries |\n| `chartjs-adapter-date-fns` | 1 file | Required by Chart.js |\n\n## Cheat Sheet\n\n### Replace Simple Date Formats\n\n```typescript\n//  DON'T: Import format for simple patterns\nimport { format } from 'date-fns'\nconst date = format(new Date(), 'MMM dd, yyyy')\n\n//  DO: Use Intl.DateTimeFormat\nconst formatter = new Intl.DateTimeFormat('en-US', {\n  year: 'numeric',\n  month: 'short',\n  day: '2-digit'\n})\nconst date = formatter.format(new Date())\n```\n\n### ISO Date Formatting\n\n```typescript\n//  DON'T: Use date-fns for ISO dates\nimport { format } from 'date-fns'\nconst iso = format(new Date(), 'yyyy-MM-dd')\n\n//  DO: Use simple helper\nconst formatDateISO = (date: Date): string => {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  return `${year}-${month}-${day}`\n}\nconst iso = formatDateISO(new Date())\n```\n\n### Keep date-fns for Complex Operations\n\n```typescript\n//  GOOD: Use date-fns for date arithmetic\nimport { subDays, addMonths, startOfDay } from 'date-fns'\n\nconst lastWeek = subDays(new Date(), 7)\nconst nextMonth = addMonths(new Date(), 1)\nconst today = startOfDay(new Date())\n```\n\n## Results\n\n- **Bundle Size Reduction**: ~5-8 KB gzipped\n- **Import Count**: 8  3 functions\n- **Tests**:  All passing (222/222)\n- **Breaking Changes**:  None\n\n## When to Use What\n\n| Use Case | Solution | Example |\n|----------|----------|---------|\n| Display dates | `Intl.DateTimeFormat` | \"Jan 15, 2025\" |\n| ISO dates | Custom helper | \"2025-01-15\" |\n| Date calculations | `date-fns` | Last 7 days |\n| Time zones | `date-fns` | Start of day |\n| Chart.js dates | `chartjs-adapter-date-fns` | Time series |\n\n## Files Modified\n\n1. `/components/admin/Utils/UserTableRow.vue` -  Optimized\n2. `/pages/admin/orders/analytics.vue` -  Optimized\n3. `/components/admin/Dashboard/Overview.vue` -  Optimized\n4. `/server/api/admin/orders/analytics.get.ts` -  Optimized\n\n---\n\n**Last Updated**: 2025-11-11\n",
              "category": "reference"
            }
          ],
          "similarity": 0.8968504425232269,
          "recommendation": "Consider consolidating into date-fns-quick-reference.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/research/README.md",
              "name": "README.md",
              "size": 13458,
              "lastModified": "2025-11-09T17:52:02.977Z",
              "content": "# Hero Section Technical Research - Documentation Index\n\n**Project**: Moldova Direct\n**Research Date**: 2025-11-09\n**Scope**: Nuxt 3 Hero Section Implementation\n**Status**:  Complete\n\n---\n\n## Overview\n\nThis directory contains comprehensive technical research for implementing an impressive, performant, and accessible hero section in Nuxt 3. The research covers image optimization, animation libraries, video techniques, performance optimization, and accessibility best practices.\n\n## Documentation Files\n\n### 1. [RESEARCH_SUMMARY.md](./RESEARCH_SUMMARY.md)\n**Start Here** - Executive summary of all research findings\n\n**Contents**:\n- Existing project assets analysis\n- Recommended additions\n- Core Web Vitals targets\n- Implementation strategy (3 phases)\n- Performance impact estimates\n- Browser support matrix\n- Security considerations\n\n**Best For**: Project managers, decision-makers, getting overview\n\n**Reading Time**: 10-15 minutes\n\n---\n\n### 2. [hero-section-technical-implementation.md](./hero-section-technical-implementation.md)\n**Complete Technical Guide** - Production-ready code and best practices\n\n**Contents**:\n1. **Nuxt Image Optimization** (@nuxt/image module)\n   - NuxtImg vs NuxtPicture\n   - Responsive images\n   - Format optimization (WebP, AVIF)\n   - Placeholder strategies\n   - LCP optimization techniques\n\n2. **Vue 3 Animation Libraries**\n   - @vueuse/motion (v3.0.3 - installed)\n   - GSAP + ScrollTrigger\n   - Lottie animations (vue3-lottie)\n   - Comparison matrix\n\n3. **Video Optimization & Lazy Loading**\n   - HTML5 video best practices\n   - Format selection (WebM, MP4)\n   - Lazy loading with Intersection Observer\n   - YouTube embed optimization\n   - FFmpeg compression commands\n\n4. **Intersection Observer API**\n   - useIntersectionObserver composable\n   - Reveal-on-scroll patterns\n   - Staggered animations\n   - Progress-based animations\n\n5. **Tailwind CSS Animation Utilities**\n   - Built-in animations\n   - Custom keyframes (Tailwind v4)\n   - Transition utilities\n   - Hover effects\n   - Scroll-based CSS animations\n\n6. **Performance Optimization (LCP, CLS)**\n   - Core Web Vitals targets (2025)\n   - LCP optimization strategies\n   - CLS prevention techniques\n   - Font optimization\n   - Resource hints\n   - Performance monitoring composable\n\n7. **Accessibility Best Practices**\n   - WCAG 2.2 compliance\n   - Semantic HTML structure\n   - ARIA labels and roles\n   - Keyboard navigation\n   - Color contrast requirements\n   - Reduced motion support\n   - Touch target sizing\n   - Screen reader optimization\n\n**Best For**: Developers implementing the hero section\n\n**Reading Time**: 45-60 minutes\n\n**Code Examples**: 50+ production-ready snippets\n\n---\n\n### 3. [hero-section-quick-reference.md](./hero-section-quick-reference.md)\n**Quick Reference Guide** - Essential snippets and commands\n\n**Contents**:\n- Already installed dependencies\n- Quick installation commands\n- 10 essential code snippets\n- Performance optimization checklist\n- Accessibility checklist\n- File structure\n- Common pitfalls\n- Testing commands\n- Resource links\n\n**Best For**: Quick lookups during development\n\n**Reading Time**: 5-10 minutes\n\n---\n\n## Quick Start\n\n### 1. First Time Setup\n\n```bash\n# Navigate to project\ncd /Users/vladislavcaraseli/Documents/MoldovaDirect\n\n# Read research summary\ncat docs/research/RESEARCH_SUMMARY.md\n\n# Review existing configuration\ncat nuxt.config.ts\n```\n\n### 2. Install Recommended Dependencies\n\n```bash\n# Font optimization (recommended for CLS)\npnpm add -D @nuxt/fonts\n\n# GSAP for advanced animations (optional)\npnpm add gsap\n\n# Lottie animations (optional)\npnpm add vue3-lottie\n```\n\n### 3. Review Code Examples\n\nOpen and study:\n- `/docs/research/hero-section-technical-implementation.md`\n- Focus on sections relevant to your design\n\n### 4. Implement\n\nFollow the **Complete Hero Section Example** at the end of the technical implementation guide.\n\n---\n\n## Already Installed & Configured\n\nYour project already has these tools ready to use:\n\n| Package | Version | Config Location |\n|---------|---------|-----------------|\n| `@nuxt/image` | 1.11.0 | `/nuxt.config.ts` line 38-50 |\n| `@vueuse/motion` | 3.0.3 | `/nuxt.config.ts` line 33 |\n| `@vueuse/core` | 13.9.0 | Available globally |\n| `tailwindcss` | 4.1.12 | `/nuxt.config.ts` + `/assets/css/tailwind.css` |\n| `tailwindcss-animate` | 1.0.7 | Available for use |\n\n**Current Image Config**:\n```typescript\nimage: {\n  domains: [\"images.unsplash.com\"],\n  formats: [\"webp\", \"avif\"],\n  quality: 80,\n  screens: { xs: 320, sm: 640, md: 768, lg: 1024, xl: 1280, xxl: 1536 }\n}\n```\n\n---\n\n## Implementation Phases\n\n### Phase 1: Foundation (Recommended - Use Existing Tools)\n**Timeline**: 1 day\n**Tools**: @nuxt/image, @vueuse/motion, Tailwind CSS\n\n**Tasks**:\n- [ ] Implement optimized hero image with NuxtImg\n- [ ] Add basic v-motion animations\n- [ ] Use semantic HTML structure\n- [ ] Ensure accessibility (alt text, contrast, keyboard nav)\n- [ ] Specify all image dimensions (prevent CLS)\n\n**Expected Results**:\n- LCP: 2.0-2.5s\n- CLS: < 0.1\n- Accessibility: WCAG 2.2 AA compliant\n- Bundle size: No increase\n\n### Phase 2: Enhancement (Recommended)\n**Timeline**: 1-2 days\n**Additional Tools**: @nuxt/fonts, custom composables\n\n**Tasks**:\n- [ ] Install and configure @nuxt/fonts\n- [ ] Create custom Tailwind animations\n- [ ] Implement Intersection Observer for scroll reveals\n- [ ] Add reduced motion support composable\n- [ ] Create reusable animation composables\n\n**Expected Results**:\n- LCP: 1.5-2.0s\n- CLS: < 0.05\n- Enhanced UX with scroll animations\n- Bundle size: +5kb\n\n### Phase 3: Advanced (Optional)\n**Timeline**: 2-3 days\n**Additional Tools**: GSAP, Lottie (if needed)\n\n**Tasks**:\n- [ ] Setup GSAP with ScrollTrigger (if complex animations needed)\n- [ ] Add Lottie animations (if design includes illustrations)\n- [ ] Implement video background (if required)\n- [ ] Add performance monitoring\n- [ ] Setup A/B testing\n\n**Expected Results**:\n- Professional-grade animations\n- Advanced scroll effects\n- Bundle size: +40-65kb\n\n---\n\n## Key Decisions to Make\n\n### 1. Animation Complexity\n\n**Simple Animations** (Fades, Slides):\n-  Use @vueuse/motion (already installed)\n- Bundle: +0kb\n- Learning curve: Low\n\n**Complex Animations** (Parallax, Timelines):\n- Consider GSAP + ScrollTrigger\n- Bundle: +40kb\n- Learning curve: Medium\n\n### 2. Video Background\n\n**No Video**:\n- Faster page load\n- Simpler implementation\n- Better mobile experience\n\n**With Video**:\n- More impressive visuals\n- +5MB page weight\n- Requires poster image\n- More complex implementation\n\n### 3. Lottie Animations\n\n**Need Lottie If**:\n- Designer provides After Effects animations\n- Want scalable illustrations\n- Need complex motion graphics\n\n**Skip Lottie If**:\n- No design assets available\n- Simple CSS animations sufficient\n- Want to minimize dependencies\n\n---\n\n## Code Snippet Index\n\nQuick links to common snippets in the technical implementation guide:\n\n1. **Optimized Hero Image** - Section 1\n2. **Basic v-motion Animation** - Section 2.1\n3. **GSAP ScrollTrigger** - Section 2.2\n4. **Lottie Animation** - Section 2.3\n5. **Lazy Video Loading** - Section 3\n6. **Intersection Observer** - Section 4\n7. **Custom Tailwind Animations** - Section 5\n8. **LCP Optimization** - Section 6.1\n9. **CLS Prevention** - Section 6.2\n10. **Accessibility Pattern** - Section 7\n\n---\n\n## Performance Targets\n\n### Core Web Vitals (2025 Standards)\n\n| Metric | Target | Current | After Implementation |\n|--------|--------|---------|---------------------|\n| **LCP** | < 2.5s | ~4s | 1.5-2.0s |\n| **CLS** | < 0.1 | ~0.3 | < 0.05 |\n| **INP** | < 200ms | N/A | < 150ms |\n\n### Expected Improvements\n\n**Before Optimization**:\n- LCP: 3-5s (poor)\n- CLS: 0.2-0.4 (needs improvement)\n- Lighthouse Score: 60-70\n\n**After Phase 1**:\n- LCP: 2.0-2.5s (good)\n- CLS: < 0.1 (good)\n- Lighthouse Score: 85-90\n\n**After Phase 2**:\n- LCP: 1.5-2.0s (excellent)\n- CLS: < 0.05 (excellent)\n- Lighthouse Score: 90-95\n\n---\n\n## Accessibility Compliance\n\n### WCAG 2.2 AA Requirements\n\nAll code examples follow WCAG 2.2 AA standards:\n\n**Mandatory** (Legal requirement in 2025):\n- [x] Semantic HTML structure\n- [x] Descriptive alt text for images\n- [x] 4.5:1 color contrast ratio\n- [x] Keyboard navigation support\n- [x] Focus indicators\n- [x] Minimum 44x44px touch targets\n\n**Recommended** (Best practice):\n- [x] Skip to main content link\n- [x] ARIA labels where needed\n- [x] Reduced motion support\n- [x] Screen reader optimization\n\n---\n\n## Testing Checklist\n\n### Performance Testing\n\n```bash\n# Lighthouse (Chrome DevTools)\n# Run on: http://localhost:3000\n\n# Check these metrics:\n- LCP < 2.5s\n- CLS < 0.1\n- INP < 200ms\n- Performance Score > 90\n```\n\n### Accessibility Testing\n\n**Automated Tools**:\n- [x] axe DevTools browser extension\n- [x] Lighthouse Accessibility audit\n- [x] WAVE browser extension\n\n**Manual Testing**:\n- [ ] Keyboard navigation (Tab, Enter, Space, Esc)\n- [ ] Screen reader (NVDA, VoiceOver, JAWS)\n- [ ] Color contrast checker\n- [ ] Touch target sizes (mobile)\n- [ ] Reduced motion preference\n\n### Browser Testing\n\n**Desktop**:\n- [ ] Chrome (latest)\n- [ ] Firefox (latest)\n- [ ] Safari (latest)\n- [ ] Edge (latest)\n\n**Mobile**:\n- [ ] iOS Safari\n- [ ] Android Chrome\n- [ ] Mobile responsive (320px to 1920px)\n\n---\n\n## Common Issues & Solutions\n\n### Issue 1: High LCP\n**Symptoms**: Lighthouse reports LCP > 3s\n**Solution**: See Section 6.1 in technical guide\n**Quick fix**: Add `loading=\"eager\"` and `fetchpriority=\"high\"` to hero image\n\n### Issue 2: Layout Shift (CLS)\n**Symptoms**: Content jumps during load\n**Solution**: See Section 6.2 in technical guide\n**Quick fix**: Always specify width/height on images\n\n### Issue 3: Animations Not Working\n**Symptoms**: v-motion directive has no effect\n**Solution**: Check `@vueuse/motion/nuxt` is in modules array\n**Quick fix**: Restart dev server after config changes\n\n### Issue 4: GSAP Not Found\n**Symptoms**: Cannot find module 'gsap'\n**Solution**: Install with `pnpm add gsap`\n**Quick fix**: Check plugin file has `.client.ts` suffix\n\n### Issue 5: Hydration Mismatch\n**Symptoms**: Console errors about mismatched content\n**Solution**: Wrap client-only components with `<client-only>`\n**Quick fix**: Use `<client-only>` for Lottie and video\n\n---\n\n## File Structure\n\n```\n/Users/vladislavcaraseli/Documents/MoldovaDirect/\n assets/\n    animations/          # Lottie JSON files\n    css/\n       tailwind.css     # Custom Tailwind config & animations\n    videos/              # Hero videos (if used)\n\n composables/\n    useGsap.ts           # GSAP composable (if using)\n    useReducedMotion.ts  # Accessibility\n    useRevealOnScroll.ts # Scroll animations\n    usePerformanceMetrics.ts # Performance monitoring\n\n docs/\n    research/            # This directory\n        README.md        # This file\n        RESEARCH_SUMMARY.md\n        hero-section-technical-implementation.md\n        hero-section-quick-reference.md\n\n plugins/\n    gsap.client.ts       # GSAP setup (if using)\n    Vue3Lottie.client.ts # Lottie setup (if using)\n\n public/\n    images/\n       hero-*.jpg       # Hero images\n    videos/\n        hero.mp4         # Hero videos (if used)\n\n nuxt.config.ts           # Configuration (already setup)\n```\n\n---\n\n## Resources & Links\n\n### Official Documentation\n- [Nuxt Image](https://image.nuxt.com/)\n- [VueUse Motion](https://motion.vueuse.org/)\n- [VueUse Core](https://vueuse.org/)\n- [GSAP](https://greensock.com/docs/)\n- [Tailwind CSS](https://tailwindcss.com/)\n- [Vue3 Lottie](https://vue3-lottie.vercel.app/)\n\n### Web Standards\n- [WCAG 2.2](https://www.w3.org/WAI/WCAG22/quickref/)\n- [Core Web Vitals](https://web.dev/vitals/)\n- [MDN Web Docs](https://developer.mozilla.org/)\n\n### Tools\n- [Lighthouse](https://developers.google.com/web/tools/lighthouse)\n- [axe DevTools](https://www.deque.com/axe/devtools/)\n- [WebPageTest](https://www.webpagetest.org/)\n- [PageSpeed Insights](https://pagespeed.web.dev/)\n\n---\n\n## Support & Questions\n\n### Getting Help\n\n1. **Review Documentation First**:\n   - RESEARCH_SUMMARY.md for overview\n   - Technical implementation guide for details\n   - Quick reference for snippets\n\n2. **Check Common Issues**:\n   - See \"Common Issues & Solutions\" section above\n\n3. **Test with Tools**:\n   - Lighthouse for performance\n   - axe DevTools for accessibility\n   - Browser DevTools for debugging\n\n4. **Consult Official Docs**:\n   - Links provided in Resources section\n\n---\n\n## Next Steps\n\n1. **Read**: RESEARCH_SUMMARY.md (10-15 min)\n2. **Review**: Existing project configuration\n3. **Plan**: Choose implementation phase (1, 2, or 3)\n4. **Install**: Required dependencies\n5. **Implement**: Follow technical guide\n6. **Test**: Performance and accessibility\n7. **Iterate**: Based on metrics\n8. **Deploy**: Monitor Core Web Vitals\n\n---\n\n## Research Completion\n\n- **Total Documentation**: 4 files\n- **Word Count**: 75,000+ words\n- **Code Examples**: 60+ production-ready snippets\n- **Coverage**: 100% of requested topics\n- **Quality**: Production-ready, tested patterns\n- **Accessibility**: WCAG 2.2 AA compliant\n- **Performance**: Core Web Vitals optimized\n\n**Research Status**:  Complete\n**Last Updated**: 2025-11-09\n**Ready for Implementation**: Yes\n\n---\n\n**Happy Coding!** \n",
              "category": "how-to"
            },
            {
              "path": "docs/research/RESEARCH_SUMMARY.md",
              "name": "RESEARCH_SUMMARY.md",
              "size": 12728,
              "lastModified": "2025-11-09T17:52:02.977Z",
              "content": "# Hero Section Technical Research Summary\n\n**Date**: 2025-11-09\n**Project**: Moldova Direct\n**Focus**: Nuxt 3 Hero Section Implementation\n\n---\n\n## Executive Summary\n\nComprehensive technical research completed for implementing an impressive, performant, and accessible hero section in Nuxt 3. The research covers 7 major areas with production-ready code examples tailored to the project's existing dependencies and configuration.\n\n## Key Findings\n\n### 1. Existing Project Assets\n\nThe project already has excellent tools configured:\n\n| Package | Version | Status | Purpose |\n|---------|---------|--------|---------|\n| `@nuxt/image` | 1.11.0 |  Configured | Image optimization |\n| `@vueuse/motion` | 3.0.3 |  Configured | Animation library |\n| `@vueuse/core` | 13.9.0 |  Installed | Composables (Intersection Observer) |\n| `tailwindcss` | 4.1.12 |  Configured | CSS framework |\n| `tailwindcss-animate` | 1.0.7 |  Installed | Animation utilities |\n\n**Current nuxt.config.ts settings**:\n- Image formats: WebP, AVIF\n- Quality: 80\n- Responsive breakpoints: xs to xxl\n- Motion module: Enabled\n\n### 2. Recommended Additions\n\n#### Optional but Recommended\n```bash\npnpm add gsap                    # Advanced scroll animations\npnpm add vue3-lottie            # JSON animations\npnpm add -D @nuxt/fonts         # Font optimization (CLS prevention)\n```\n\n### 3. Core Web Vitals Targets (2025)\n\n| Metric | Target | Critical For |\n|--------|--------|--------------|\n| LCP (Largest Contentful Paint) | < 2.5s | SEO, User Experience |\n| CLS (Cumulative Layout Shift) | < 0.1 | Layout Stability |\n| INP (Interaction to Next Paint) | < 200ms | Responsiveness |\n\n**Note**: INP replaced FID in 2024 as the official metric.\n\n### 4. Technical Implementation Options\n\n#### A. Image Optimization (@nuxt/image)\n\n**Status**:  Already configured\n\n**Key Features**:\n- Automatic format conversion (WebP, AVIF)\n- Responsive image generation\n- Lazy loading support\n- Blur-up placeholders\n- CDN integration\n\n**Best Practice for Hero**:\n```vue\n<NuxtImg\n  src=\"/hero.jpg\"\n  loading=\"eager\"        # Critical for LCP\n  fetchpriority=\"high\"   # Browser hint\n  preload                # Preload in <head>\n  format=\"webp\"\n  quality=\"85\"\n/>\n```\n\n**Impact**:\n- LCP improvement: 40-60%\n- Bandwidth savings: 30-50%\n- CLS prevention: When dimensions specified\n\n#### B. Animation Libraries\n\n##### Option 1: @vueuse/motion (Recommended - Already Installed)\n\n**Pros**:\n-  Already configured\n-  SSR support\n-  Simple API\n-  Small bundle size\n-  Custom preset support\n\n**Cons**:\n- Limited to basic animations\n- No scroll-based timeline control\n\n**Use Cases**:\n- Fade-in effects\n- Slide animations\n- Simple entrance animations\n- Staggered reveals\n\n**Code Example**:\n```vue\n<div v-motion :initial=\"{ opacity: 0, y: 100 }\" :enter=\"{ opacity: 1, y: 0 }\">\n  Content\n</div>\n```\n\n##### Option 2: GSAP + ScrollTrigger\n\n**Pros**:\n- Professional-grade animations\n- Timeline control\n- Scroll-based triggers\n- Parallax effects\n- Industry standard\n\n**Cons**:\n- Larger bundle size (~40kb)\n- Steeper learning curve\n- Requires plugin setup\n\n**Use Cases**:\n- Complex scroll animations\n- Parallax backgrounds\n- Timeline sequences\n- Professional portfolios\n\n**Setup Required**:\n- Create plugin file\n- Register ScrollTrigger\n- Create composable (recommended)\n\n##### Option 3: Lottie Animations\n\n**Pros**:\n- Designer-friendly (Adobe After Effects)\n- High-quality illustrations\n- Small JSON file sizes\n- Scalable vectors\n\n**Cons**:\n- Requires design assets\n- Limited to prepared animations\n- Client-side only\n\n**Use Cases**:\n- Decorative animations\n- Loading states\n- Brand illustrations\n- Interactive icons\n\n#### C. Video Optimization\n\n**Formats**:\n- WebM (VP9) - Best compression, Chrome/Firefox\n- MP4 (H.264) - Fallback for Safari/iOS\n\n**Best Practices**:\n```vue\n<video autoplay muted loop playsinline preload=\"metadata\" poster=\"/poster.jpg\">\n  <source src=\"/hero.webm\" type=\"video/webm\">\n  <source src=\"/hero.mp4\" type=\"video/mp4\">\n</video>\n```\n\n**Critical Attributes**:\n- `muted` - Required for autoplay\n- `playsinline` - Prevents iOS fullscreen\n- `poster` - Shows while loading (prevents CLS)\n- `preload=\"metadata\"` - Balance loading/performance\n\n**Compression Targets**:\n- File size: < 5MB\n- Resolution: 1920x1080 max\n- Bitrate: 1-2 Mbps\n\n#### D. Intersection Observer API\n\n**Status**:  Available via @vueuse/core\n\n**Composable**: `useIntersectionObserver`\n\n**Use Cases**:\n- Lazy loading content\n- Scroll-triggered animations\n- Analytics tracking\n- Infinite scroll\n\n**Example**:\n```typescript\nconst { stop } = useIntersectionObserver(\n  elementRef,\n  ([entry]) => {\n    if (entry.isIntersecting) {\n      // Trigger animation\n    }\n  },\n  { threshold: 0.3 }\n)\n```\n\n#### E. Tailwind CSS Animations\n\n**Status**:  Tailwind v4 configured\n\n**Built-in Classes**:\n- `animate-spin`\n- `animate-ping`\n- `animate-pulse`\n- `animate-bounce`\n\n**Custom Animations**:\nTailwind v4 uses `@theme` and `@keyframes` in CSS files:\n\n```css\n@theme {\n  --animate-fade-in: fade-in 1s ease-out;\n}\n\n@keyframes fade-in {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n```\n\n### 5. Performance Optimization Strategies\n\n#### LCP Optimization\n\n**Impact**: Critical for SEO and user experience\n\n**Implementation**:\n1.  Use `loading=\"eager\"` on hero images\n2.  Set `fetchpriority=\"high\"`\n3.  Enable `preload` attribute\n4.  Use modern formats (WebP/AVIF)\n5.  Optimize quality (80-85)\n6.  Install `@nuxt/fonts` for font optimization\n\n**Expected Results**:\n- Before: 3-5 seconds LCP\n- After: 1.5-2.5 seconds LCP\n- Improvement: 40-60%\n\n#### CLS Prevention\n\n**Impact**: Critical for user experience and SEO\n\n**Implementation**:\n1.  Always specify width/height\n2.  Use `aspect-ratio` CSS property\n3.  Reserve space for dynamic content\n4.  Optimize font loading (install @nuxt/fonts)\n5.  Use placeholders during image load\n\n**Expected Results**:\n- Before: 0.2-0.4 CLS\n- After: < 0.1 CLS\n- Improvement: 75%+ reduction\n\n### 6. Accessibility Requirements (WCAG 2.2)\n\n**Status**: WCAG 2.2 is the 2025 legal standard (4,605 ADA lawsuits in 2024)\n\n#### Critical Requirements\n\n| Requirement | Target | Implementation |\n|-------------|--------|----------------|\n| Color Contrast | 4.5:1 (normal text) | Use contrast checker |\n| Touch Targets | 44x44px minimum | Set min-height/width |\n| Keyboard Nav | Full support | Proper focus states |\n| Alt Text | All images | Descriptive text |\n| Semantic HTML | Native elements | `<section>`, `<main>` |\n| Skip Links | Required | Focus-visible link |\n\n#### Implementation Priority\n\n**High Priority** (Legal requirement):\n1. Descriptive alt text for all images\n2. Color contrast compliance\n3. Keyboard navigation support\n4. Semantic HTML structure\n\n**Medium Priority** (Best practice):\n1. Skip to main content link\n2. ARIA labels for complex components\n3. Focus management\n4. Live regions for dynamic content\n\n**Recommended** (Enhanced UX):\n1. Reduced motion support\n2. High contrast mode\n3. Screen reader optimization\n\n### 7. Accessibility-First Patterns\n\n```vue\n<!-- Semantic structure -->\n<section aria-labelledby=\"hero-heading\">\n  <h1 id=\"hero-heading\">Page Title</h1>\n\n  <!-- Descriptive links -->\n  <a href=\"/products\" aria-label=\"Explore our Moldovan wine collection\">\n    Shop Now\n  </a>\n\n  <!-- Skip link -->\n  <a href=\"#main-content\" class=\"sr-only focus:not-sr-only\">\n    Skip to main content\n  </a>\n</section>\n```\n\n## Recommended Implementation Strategy\n\n### Phase 1: Foundation (Day 1)\n1.  Use existing @nuxt/image configuration\n2.  Implement basic @vueuse/motion animations\n3.  Add semantic HTML structure\n4.  Ensure proper alt text\n5.  Specify image dimensions\n\n**Deliverable**: Functional, accessible hero with basic animations\n\n### Phase 2: Enhancement (Day 2-3)\n1. Install and configure `@nuxt/fonts`\n2. Add custom Tailwind animations\n3. Implement Intersection Observer for scroll reveals\n4. Add reduced motion support\n5. Create reusable composables\n\n**Deliverable**: Polished hero with advanced features\n\n### Phase 3: Advanced (Optional)\n1. Install and setup GSAP if complex animations needed\n2. Add Lottie animations for branding\n3. Implement video background (if design requires)\n4. Add performance monitoring\n5. A/B testing setup\n\n**Deliverable**: Professional-grade hero section\n\n## Performance Impact Estimates\n\n| Optimization | LCP Impact | CLS Impact | Bundle Size |\n|--------------|------------|------------|-------------|\n| @nuxt/image | -40% | -75% | +15kb |\n| @vueuse/motion | 0 | 0 | +8kb (installed) |\n| GSAP + ScrollTrigger | 0 | 0 | +40kb |\n| Lottie | 0 | 0 | +25kb |\n| @nuxt/fonts | -15% | -80% | +5kb |\n\n**Total Impact** (with recommended additions):\n- LCP: 1.5-2.0s (55% improvement)\n- CLS: < 0.05 (80% improvement)\n- Bundle Size: +65kb (acceptable)\n\n## Browser Support\n\nAll recommended solutions support:\n- Chrome/Edge: Full support\n- Firefox: Full support\n- Safari: Full support\n- iOS Safari: Full support (with `playsinline` for video)\n- Android Chrome: Full support\n\n**Graceful Degradation**:\n- Older browsers: Static images, no animations\n- `prefers-reduced-motion`: Respect user preference\n- JavaScript disabled: Content still accessible\n\n## Security Considerations\n\n1. **CSP (Content Security Policy)**:\n   - Add `nonce` attribute for inline styles\n   - Whitelist animation domains\n\n2. **CORS**:\n   - Configure for external image domains\n   - Already configured in nuxt.config.ts\n\n3. **Video Sources**:\n   - Self-host when possible\n   - Use CDN with proper headers\n\n## Documentation Structure\n\n```\n/docs/research/\n hero-section-technical-implementation.md  # Full guide (53k+ words)\n hero-section-quick-reference.md           # Quick snippets\n RESEARCH_SUMMARY.md                       # This file\n```\n\n## File Locations\n\n**Config Files**:\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/nuxt.config.ts`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/assets/css/tailwind.css`\n\n**New Files to Create** (from documentation):\n- `/composables/useGsap.ts` (if using GSAP)\n- `/composables/useReducedMotion.ts` (accessibility)\n- `/composables/useRevealOnScroll.ts` (scroll animations)\n- `/composables/usePerformanceMetrics.ts` (monitoring)\n- `/plugins/gsap.client.ts` (if using GSAP)\n- `/plugins/Vue3Lottie.client.ts` (if using Lottie)\n\n## Next Steps\n\n1. **Review Documentation**:\n   - Read `/docs/research/hero-section-technical-implementation.md`\n   - Review code examples\n   - Understand trade-offs\n\n2. **Install Dependencies**:\n   ```bash\n   pnpm add -D @nuxt/fonts  # Recommended\n   pnpm add gsap           # If complex animations needed\n   pnpm add vue3-lottie    # If using Lottie animations\n   ```\n\n3. **Create Composables**:\n   - Copy composables from documentation\n   - Customize for project needs\n   - Add tests\n\n4. **Implement Hero Section**:\n   - Start with Phase 1 (Foundation)\n   - Test performance with Lighthouse\n   - Validate accessibility with axe DevTools\n   - Iterate based on metrics\n\n5. **Monitor & Optimize**:\n   - Track Core Web Vitals\n   - A/B test variations\n   - Gather user feedback\n   - Continuously improve\n\n## Questions to Consider\n\n1. **Video Background**: Does design require video? (Adds 5MB+ to page load)\n2. **Animation Complexity**: Simple fades or complex scroll effects? (GSAP vs Motion)\n3. **Lottie Assets**: Do we have designer-created animations?\n4. **Target Devices**: Mobile-first or desktop-first approach?\n5. **Content Strategy**: Static hero or dynamic content?\n\n## Resources\n\n- Full Documentation: `/docs/research/hero-section-technical-implementation.md`\n- Quick Reference: `/docs/research/hero-section-quick-reference.md`\n- Project Config: `/nuxt.config.ts`\n\n## Research Methodology\n\n1. **Web Search**: Latest 2025 documentation and best practices\n2. **Official Docs**: Nuxt, VueUse, GSAP, Tailwind\n3. **Real-world Examples**: GitHub repositories and case studies\n4. **Performance Standards**: Google Web Vitals, Lighthouse\n5. **Accessibility Standards**: WCAG 2.2, ARIA guidelines\n6. **Project Analysis**: Reviewed existing dependencies and configuration\n\n## Conclusion\n\nThe Moldova Direct project is well-positioned for implementing an impressive hero section with:\n\n Strong foundation (Nuxt 3, @nuxt/image, @vueuse/motion)\n Modern tooling (Tailwind v4, TypeScript)\n Performance-first configuration\n Minor additions recommended (@nuxt/fonts)\n\n**Recommendation**: Proceed with Phase 1 implementation using existing tools, then enhance based on specific design requirements and performance metrics.\n\n---\n\n**Research Completed**: 2025-11-09\n**Total Documentation**: 3 files, 70,000+ words\n**Code Examples**: 50+ production-ready snippets\n**Coverage**: 100% of requested topics\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8044127582052335,
          "recommendation": "Consider consolidating into README.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/specs/GLOBAL_REQUIREMENTS.md",
              "name": "GLOBAL_REQUIREMENTS.md",
              "size": 7021,
              "lastModified": "2026-01-14T21:35:39.895Z",
              "content": "# Requirements Specification - Moldova Direct E-Commerce Platform\n\n## Project Overview\nMoldova Direct is an e-commerce platform for authentic Moldovan food and wine products with delivery to Spain.\n\n## User Stories & Acceptance Criteria\n\n### 1. User Authentication & Account Management\n\n#### US-1.1: User Registration\n**As a** customer  \n**I want to** create an account  \n**So that** I can track orders and save my preferences\n\n**Acceptance Criteria:**\n- WHEN a user submits registration with valid email and password THE SYSTEM SHALL create an account and log them in\n- WHEN a user submits registration with existing email THE SYSTEM SHALL display error \"Email already registered\"\n- WHEN a user submits weak password THE SYSTEM SHALL display password requirements\n- THE SYSTEM SHALL send welcome email after successful registration\n- THE SYSTEM SHALL support registration in 4 languages (ES/EN/RO/RU)\n\n#### US-1.2: User Login\n**As a** registered customer  \n**I want to** log into my account  \n**So that** I can access my order history and saved information\n\n**Acceptance Criteria:**\n- WHEN a user submits valid credentials THE SYSTEM SHALL authenticate and redirect to account dashboard\n- WHEN a user submits invalid credentials THE SYSTEM SHALL display \"Invalid email or password\"\n- THE SYSTEM SHALL maintain session for 7 days with \"Remember me\" option\n- THE SYSTEM SHALL provide password reset functionality via email\n\n### 2. Product Catalog & Search\n\n#### US-2.1: Browse Products\n**As a** visitor  \n**I want to** browse Moldovan products  \n**So that** I can find items to purchase\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL display products with image, name, price, and description\n- THE SYSTEM SHALL provide category filtering (Wine, Food, Spirits, Gifts)\n- THE SYSTEM SHALL support search by product name and description\n- THE SYSTEM SHALL display prices in EUR with Spanish VAT included\n- THE SYSTEM SHALL show product availability status\n\n#### US-2.2: Product Details\n**As a** customer  \n**I want to** view detailed product information  \n**So that** I can make informed purchase decisions\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL display multiple product images\n- THE SYSTEM SHALL show detailed description, ingredients, and origin\n- THE SYSTEM SHALL display customer reviews and ratings\n- THE SYSTEM SHALL show related/recommended products\n- THE SYSTEM SHALL provide \"Add to Cart\" functionality\n\n### 3. Shopping Cart & Checkout\n\n#### US-3.1: Shopping Cart Management\n**As a** customer  \n**I want to** manage items in my cart  \n**So that** I can control what I purchase\n\n**Acceptance Criteria:**\n- WHEN a user adds item to cart THE SYSTEM SHALL update cart count and show confirmation\n- THE SYSTEM SHALL persist cart for 30 days for anonymous users\n- THE SYSTEM SHALL allow quantity updates and item removal\n- THE SYSTEM SHALL calculate and display subtotal, VAT, and shipping costs\n- THE SYSTEM SHALL apply promotional codes and discounts\n\n#### US-3.2: Checkout Process\n**As a** customer  \n**I want to** complete my purchase  \n**So that** I can receive my products\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL collect shipping address for Spain delivery\n- THE SYSTEM SHALL validate Spanish postal codes and addresses\n- THE SYSTEM SHALL offer multiple payment methods (Card, PayPal)\n- THE SYSTEM SHALL calculate shipping based on weight and destination\n- THE SYSTEM SHALL send order confirmation email with tracking\n\n### 4. Order Management\n\n#### US-4.1: Order Tracking\n**As a** customer  \n**I want to** track my orders  \n**So that** I know when to expect delivery\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL provide order status updates (Processing, Shipped, Delivered)\n- THE SYSTEM SHALL send email notifications for status changes\n- THE SYSTEM SHALL provide tracking number for shipped orders\n- THE SYSTEM SHALL display estimated delivery date\n- THE SYSTEM SHALL allow order cancellation within 24 hours\n\n### 5. Multi-Language Support\n\n#### US-5.1: Language Selection\n**As a** user  \n**I want to** use the site in my preferred language  \n**So that** I can understand all content\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL support Spanish (default), English, Romanian, and Russian\n- WHEN a user selects language THE SYSTEM SHALL translate all UI elements\n- THE SYSTEM SHALL remember language preference in user profile\n- THE SYSTEM SHALL maintain language selection across sessions\n- THE SYSTEM SHALL provide language-specific customer support\n\n### 6. Admin Dashboard\n\n#### US-6.1: Product Management\n**As an** admin  \n**I want to** manage products  \n**So that** I can keep catalog updated\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL allow CRUD operations for products\n- THE SYSTEM SHALL support bulk import/export of products\n- THE SYSTEM SHALL manage product images and galleries\n- THE SYSTEM SHALL track inventory levels\n- THE SYSTEM SHALL set product visibility and availability\n\n#### US-6.2: Order Processing\n**As an** admin  \n**I want to** process orders  \n**So that** customers receive their products\n\n**Acceptance Criteria:**\n- THE SYSTEM SHALL display new orders in real-time\n- THE SYSTEM SHALL allow order status updates\n- THE SYSTEM SHALL generate packing slips and invoices\n- THE SYSTEM SHALL integrate with shipping providers\n- THE SYSTEM SHALL handle refunds and returns\n\n## Non-Functional Requirements\n\n### Performance\n- WHEN a user loads any page THE SYSTEM SHALL display content within 2 seconds\n- THE SYSTEM SHALL handle 1000 concurrent users\n- THE SYSTEM SHALL maintain 99.9% uptime\n\n### Security\n- THE SYSTEM SHALL encrypt all sensitive data in transit and at rest\n- THE SYSTEM SHALL implement GDPR compliance for EU customers\n- THE SYSTEM SHALL use secure payment processing (PCI DSS compliant)\n- THE SYSTEM SHALL implement rate limiting and DDoS protection\n\n### Scalability\n- THE SYSTEM SHALL auto-scale based on traffic\n- THE SYSTEM SHALL use CDN for static assets\n- THE SYSTEM SHALL implement database read replicas for high load\n\n### Accessibility\n- THE SYSTEM SHALL meet WCAG 2.1 Level AA standards\n- THE SYSTEM SHALL support screen readers\n- THE SYSTEM SHALL provide keyboard navigation\n\n## Compliance Requirements\n\n### Legal\n- THE SYSTEM SHALL comply with Spanish e-commerce regulations\n- THE SYSTEM SHALL display required legal pages (Terms, Privacy, Cookies)\n- THE SYSTEM SHALL implement age verification for alcohol sales\n- THE SYSTEM SHALL maintain transaction records for 5 years\n\n### Payment\n- THE SYSTEM SHALL comply with PSD2 for payment processing\n- THE SYSTEM SHALL implement 3D Secure for card payments\n- THE SYSTEM SHALL provide invoices with Spanish VAT\n\n## Integration Requirements\n\n### External Services\n- THE SYSTEM SHALL integrate with payment gateways (Stripe, PayPal)\n- THE SYSTEM SHALL integrate with shipping providers (Correos, DHL)\n- THE SYSTEM SHALL integrate with email service (SendGrid/Resend)\n- THE SYSTEM SHALL integrate with analytics (Google Analytics, Vercel Analytics)\n- THE SYSTEM SHALL integrate with customer support (WhatsApp Business)",
              "category": "reference"
            },
            {
              "path": "docs/specs/product-catalog/requirements.md",
              "name": "requirements.md",
              "size": 15548,
              "lastModified": "2025-12-04T10:27:33.908Z",
              "content": "# Product Catalog Requirements Document\n\n## Introduction\n\nThe product catalog system enables customers to browse, search, and view detailed information about Moldovan food and wine products available on Moldova Direct. The catalog must support multi-language product information, category-based navigation, advanced filtering, and responsive design across all devices while maintaining optimal performance for large product inventories.\n\n## Requirements\n\n### Requirement 1: Product Display and Information\n\n**User Story:** As a customer, I want to view detailed product information including images, descriptions, prices, and availability, so that I can make informed purchasing decisions.\n\n#### Acceptance Criteria\n\n**WHEN** a user views a product listing  \n**THEN** the system **SHALL** display product name in the user's selected language  \n**AND** the system **SHALL** show the current price in EUR with proper formatting  \n**AND** the system **SHALL** display at least one high-quality product image  \n**AND** the system **SHALL** indicate stock availability status\n\n**WHEN** a user clicks on a product to view details  \n**THEN** the system **SHALL** display the full product information page  \n**AND** the system **SHALL** show product description in the user's selected language  \n**AND** the system **SHALL** display all available product images in a gallery format  \n**AND** the system **SHALL** show detailed specifications and attributes  \n**AND** the system **SHALL** display related products or recommendations\n\n**WHEN** a product is out of stock  \n**THEN** the system **SHALL** clearly indicate \"Out of Stock\" status  \n**AND** the system **SHALL** disable the \"Add to Cart\" button  \n**AND** the system **SHALL** provide an option to notify when back in stock\n\n**WHEN** product information is not available in the user's selected language  \n**THEN** the system **SHALL** fall back to the default language (Spanish)  \n**AND** the system **SHALL** indicate the language being displayed\n\n### Requirement 2: Category Navigation and Organization\n\n**User Story:** As a customer, I want to browse products by categories, so that I can easily find the type of products I'm looking for.\n\n#### Acceptance Criteria\n\n**WHEN** a user views the main product catalog  \n**THEN** the system **SHALL** display all available product categories  \n**AND** the system **SHALL** show category names in the user's selected language  \n**AND** the system **SHALL** display the number of products in each category  \n**AND** the system **SHALL** include representative category images\n\n**WHEN** a user selects a specific category  \n**THEN** the system **SHALL** display all products within that category  \n**AND** the system **SHALL** show subcategories if they exist  \n**AND** the system **SHALL** maintain breadcrumb navigation  \n**AND** the system **SHALL** provide filtering options relevant to the category\n\n**WHEN** a category has more than 20 products  \n**THEN** the system **SHALL** implement pagination or infinite scroll  \n**AND** the system **SHALL** display page indicators if using pagination  \n**AND** the system **SHALL** maintain filter and sort selections across pages\n\n**WHEN** a user navigates through category hierarchy  \n**THEN** the system **SHALL** update the URL to reflect the current path  \n**AND** the system **SHALL** enable direct linking to specific category views  \n**AND** the system **SHALL** provide clear navigation back to parent categories\n\n### Requirement 3: Product Search Functionality\n\n**User Story:** As a customer, I want to search for products by name, description, or attributes, so that I can quickly find specific items I'm interested in.\n\n#### Acceptance Criteria\n\n**WHEN** a user enters a search query in the search box  \n**THEN** the system **SHALL** search across product names, descriptions, and attributes  \n**AND** the system **SHALL** return results ranked by relevance  \n**AND** the system **SHALL** highlight matching terms in search results  \n**AND** the system **SHALL** support partial word matching\n\n**WHEN** a search query returns results  \n**THEN** the system **SHALL** display the total number of results found  \n**AND** the system **SHALL** show results in a grid or list format  \n**AND** the system **SHALL** provide filtering options to refine results  \n**AND** the system **SHALL** enable sorting by relevance, price, or name\n\n**WHEN** a search query returns no results  \n**THEN** the system **SHALL** display a \"No products found\" message  \n**AND** the system **SHALL** suggest alternative search terms or spelling corrections  \n**AND** the system **SHALL** provide links to popular categories or products  \n**AND** the system **SHALL** offer to notify when matching products become available\n\n**WHEN** a user performs a search in a specific language  \n**THEN** the system **SHALL** search in the content of that language  \n**AND** the system **SHALL** fall back to default language content if no matches found  \n**AND** the system **SHALL** indicate the language used for search results\n\n### Requirement 4: Product Filtering and Sorting\n\n**User Story:** As a customer, I want to filter and sort products by various criteria, so that I can efficiently narrow down my options based on my preferences and budget.\n\n#### Acceptance Criteria\n\n**WHEN** a user views a product listing (category or search results)  \n**THEN** the system **SHALL** provide filtering options for price range, availability, and product attributes  \n**AND** the system **SHALL** show the number of products matching each filter option  \n**AND** the system **SHALL** enable multiple filter selection  \n**AND** the system **SHALL** display currently active filters with removal options\n\n**WHEN** a user applies product filters  \n**THEN** the system **SHALL** update the product listing immediately  \n**AND** the system **SHALL** maintain filter state in the URL for bookmarking  \n**AND** the system **SHALL** show the number of results matching current filters  \n**AND** the system **SHALL** preserve sort order when filters are applied\n\n**WHEN** a user selects a sort option (price low-to-high, high-to-low, name, newest)  \n**THEN** the system **SHALL** reorder products according to the selected criteria  \n**AND** the system **SHALL** maintain the sort order across pagination  \n**AND** the system **SHALL** indicate the current sort option in the interface  \n**AND** the system **SHALL** preserve filters when sort order changes\n\n**WHEN** a user clears all filters  \n**THEN** the system **SHALL** return to the unfiltered view of the category or search  \n**AND** the system **SHALL** reset to default sorting  \n**AND** the system **SHALL** update the URL to remove filter parameters\n\n### Requirement 5: Mobile-Responsive Product Browsing\n\n**User Story:** As a mobile customer, I want a fully functional product browsing experience on my device, so that I can effectively shop regardless of screen size.\n\n#### Acceptance Criteria\n\n**WHEN** a user accesses the product catalog on mobile devices  \n**THEN** the system **SHALL** display products in a mobile-optimized layout  \n**AND** product images **SHALL** be appropriately sized for mobile screens  \n**AND** product information **SHALL** be easily readable without zooming  \n**AND** navigation elements **SHALL** be touch-friendly with adequate spacing\n\n**WHEN** a user browses product listings on mobile  \n**THEN** the system **SHALL** adapt the grid layout for optimal mobile viewing  \n**AND** filter options **SHALL** be accessible through mobile-friendly interface (e.g., collapsible panels)  \n**AND** search functionality **SHALL** work effectively with mobile keyboards  \n**AND** sorting options **SHALL** be easily accessible and usable\n\n**WHEN** a user views product details on mobile  \n**THEN** the system **SHALL** optimize the layout for vertical scrolling  \n**AND** product images **SHALL** support pinch-to-zoom functionality  \n**AND** all product information **SHALL** be accessible without horizontal scrolling  \n**AND** the \"Add to Cart\" action **SHALL** be prominently placed and easily tappable\n\n### Requirement 6: Product Image Management\n\n**User Story:** As a customer, I want to view high-quality product images from multiple angles, so that I can better assess the products before purchasing.\n\n#### Acceptance Criteria\n\n**WHEN** a user views product listings  \n**THEN** each product **SHALL** display a primary image that represents the product clearly  \n**AND** images **SHALL** load efficiently with appropriate optimization  \n**AND** images **SHALL** include alt text for accessibility  \n**AND** placeholder images **SHALL** display if product images are unavailable\n\n**WHEN** a user views product details  \n**THEN** the system **SHALL** display all available product images in a gallery  \n**AND** the system **SHALL** provide image navigation (thumbnails, next/previous)  \n**AND** images **SHALL** support enlargement for detailed viewing  \n**AND** the system **SHALL** load high-resolution images on demand\n\n**WHEN** product images are loading  \n**THEN** the system **SHALL** display loading indicators or placeholder content  \n**AND** the system **SHALL** gracefully handle image loading failures  \n**AND** the system **SHALL** provide fallback images for products without photos\n\n**WHEN** a user interacts with product images on mobile  \n**THEN** the system **SHALL** support touch gestures for navigation  \n**AND** the system **SHALL** enable pinch-to-zoom functionality  \n**AND** image galleries **SHALL** be optimized for touch interaction\n\n### Requirement 7: Multi-Language Product Content\n\n**User Story:** As a customer, I want product information displayed in my preferred language, so that I can understand product details and make informed decisions.\n\n#### Acceptance Criteria\n\n**WHEN** a user selects a language preference  \n**THEN** all product names **SHALL** display in the selected language  \n**AND** product descriptions **SHALL** display in the selected language  \n**AND** category names **SHALL** display in the selected language  \n**AND** product attributes and specifications **SHALL** display in the selected language\n\n**WHEN** product content is not available in the user's selected language  \n**THEN** the system **SHALL** fall back to the default language (Spanish)  \n**AND** the system **SHALL** indicate which language is being displayed  \n**AND** the system **SHALL** maintain consistent formatting and layout\n\n**WHEN** a user switches languages while browsing  \n**THEN** the system **SHALL** update all product content immediately  \n**AND** the system **SHALL** maintain the current browsing context (category, filters, etc.)  \n**AND** the system **SHALL** preserve the user's position in product listings\n\n**WHEN** search functionality is used with different languages  \n**THEN** the system **SHALL** search content in the selected language  \n**AND** the system **SHALL** provide relevant results regardless of language  \n**AND** search suggestions **SHALL** appear in the user's selected language\n\n### Requirement 8: Product Availability and Inventory Display\n\n**User Story:** As a customer, I want to see real-time product availability information, so that I know which items I can purchase immediately.\n\n#### Acceptance Criteria\n\n**WHEN** a user views product listings or details  \n**THEN** the system **SHALL** display current stock status (In Stock, Low Stock, Out of Stock)  \n**AND** the system **SHALL** show quantity available for low stock items  \n**AND** stock information **SHALL** be updated in real-time or near real-time  \n**AND** the system **SHALL** prevent adding out-of-stock items to cart\n\n**WHEN** a product's stock level changes while a user is viewing it  \n**THEN** the system **SHALL** update the stock display without requiring page refresh  \n**AND** the system **SHALL** adjust available purchase quantities if applicable  \n**AND** the system **SHALL** notify the user if the product becomes unavailable\n\n**WHEN** a product is temporarily out of stock  \n**THEN** the system **SHALL** provide an option to be notified when back in stock  \n**AND** the system **SHALL** show estimated restock dates if available  \n**AND** the system **SHALL** allow browsing of similar or alternative products\n\n**WHEN** stock levels are critically low (less than 5 items)  \n**THEN** the system **SHALL** display a \"Low Stock\" warning  \n**AND** the system **SHALL** show the exact quantity remaining  \n**AND** the system **SHALL** encourage prompt purchase decision\n\n### Requirement 9: Product Recommendations and Related Items\n\n**User Story:** As a customer, I want to see product recommendations and related items, so that I can discover additional products that might interest me.\n\n#### Acceptance Criteria\n\n**WHEN** a user views a product detail page  \n**THEN** the system **SHALL** display related products from the same category  \n**AND** the system **SHALL** show complementary products that pair well together  \n**AND** recommendations **SHALL** be based on product attributes and customer behavior  \n**AND** the system **SHALL** limit recommendations to available products\n\n**WHEN** a user adds a product to their cart  \n**THEN** the system **SHALL** suggest frequently bought together items  \n**AND** recommendations **SHALL** be relevant to the added product  \n**AND** the system **SHALL** make it easy to add recommended items to cart\n\n**WHEN** a user browses categories or search results  \n**THEN** the system **SHALL** highlight featured or popular products  \n**AND** the system **SHALL** show trending items in the category  \n**AND** featured products **SHALL** be clearly distinguished from regular listings\n\n**WHEN** displaying product recommendations  \n**THEN** the system **SHALL** respect user language preferences for product names  \n**AND** recommendations **SHALL** maintain consistent formatting with other product displays  \n**AND** the system **SHALL** provide clear navigation to recommended product details\n\n### Requirement 10: Performance and Loading Optimization\n\n**User Story:** As a customer, I want fast-loading product pages and smooth browsing experience, so that I can efficiently explore the catalog without delays.\n\n#### Acceptance Criteria\n\n**WHEN** a user navigates to any product catalog page  \n**THEN** the initial page content **SHALL** load within 3 seconds on standard connections  \n**AND** product images **SHALL** load progressively without blocking page interaction  \n**AND** the system **SHALL** implement lazy loading for off-screen content  \n**AND** navigation elements **SHALL** be immediately responsive\n\n**WHEN** a user scrolls through product listings  \n**THEN** the system **SHALL** load additional products smoothly (infinite scroll or pagination)  \n**AND** the system **SHALL** maintain stable layout during content loading  \n**AND** the system **SHALL** provide loading indicators for additional content\n\n**WHEN** a user applies filters or changes sort order  \n**THEN** the system **SHALL** update results within 2 seconds  \n**AND** the system **SHALL** provide immediate feedback that the action is processing  \n**AND** the system **SHALL** maintain smooth interaction during updates\n\n**WHEN** catalog data is loading or updating  \n**THEN** the system **SHALL** display appropriate loading states  \n**AND** the system **SHALL** gracefully handle slow or failed network requests  \n**AND** the system **SHALL** provide retry mechanisms for failed operations  \n**AND** the system **SHALL** cache frequently accessed product data for improved performance\n",
              "category": "reference"
            },
            {
              "path": "docs/specs/shopping-cart/requirements.md",
              "name": "requirements.md",
              "size": 13146,
              "lastModified": "2025-12-04T10:27:33.913Z",
              "content": "# Shopping Cart Requirements Document\n\n## Introduction\n\nThe shopping cart feature enables customers to collect products they wish to purchase, manage quantities, and proceed to checkout. This is a critical component of the Moldova Direct e-commerce platform that must provide a seamless experience across all devices and languages while maintaining data persistence and real-time inventory validation.\n\n## Requirements\n\n### Requirement 1: Add Products to Cart\n\n**User Story:** As a customer, I want to add products to my shopping cart from product pages, so that I can collect items for purchase.\n\n#### EARS Format Requirements\n\n**WHEN** a customer clicks \"Add to Cart\" on a product page  \n**THEN** the system **SHALL** add the specified quantity to their cart  \n**AND** the system **SHALL** validate the quantity against available stock\n\n**WHEN** a product is already in the cart  \n**THEN** the system **SHALL** increase the quantity by the specified amount  \n**AND** the system **SHALL** update the item total price immediately\n\n**WHEN** adding a product would exceed available stock  \n**THEN** the system **SHALL** display an error message and prevent the addition  \n**AND** the system **SHALL** show the maximum available quantity\n\n**WHEN** a product is successfully added  \n**THEN** the system **SHALL** display a confirmation message  \n**AND** the system **SHALL** update the cart icon to show the new item count  \n**AND** the system **SHALL** persist the cart data to localStorage\n\n### Requirement 2: Cart Persistence and Session Management\n\n**User Story:** As a customer, I want my cart to persist across browser sessions, so that I don't lose my selected items when I return to the site.\n\n#### EARS Format Requirements\n\n**WHEN** a customer adds items to their cart  \n**THEN** the system **SHALL** save the cart data to localStorage immediately  \n**AND** the system **SHALL** include timestamp information for expiry tracking\n\n**WHEN** a customer returns to the site  \n**THEN** the system **SHALL** restore their previous cart contents  \n**AND** the system **SHALL** validate item availability and pricing  \n**AND** the system **SHALL** notify of any changes since last visit\n\n**WHEN** cart data is older than 30 days  \n**THEN** the system **SHALL** clear the expired cart data  \n**AND** the system **SHALL** not notify the user of the cleared cart\n\n**WHEN** localStorage is unavailable  \n**THEN** the system **SHALL** maintain cart data for the current session only  \n**AND** the system **SHALL** warn the user about temporary cart storage\n\n**WHEN** a customer's session expires  \n**THEN** the system **SHALL** generate a new session ID while preserving cart contents  \n**AND** the system **SHALL** maintain cart data across session renewals\n\n### Requirement 3: Quantity Management\n\n**User Story:** As a customer, I want to modify product quantities in my cart, so that I can adjust my order before checkout.\n\n#### EARS Format Requirements\n\n**WHEN** a customer increases quantity using the plus button  \n**THEN** the system **SHALL** increment the quantity by 1  \n**AND** the system **SHALL** validate against available stock before applying\n\n**WHEN** a customer decreases quantity using the minus button  \n**THEN** the system **SHALL** decrement the quantity by 1  \n**AND** the system **SHALL** ensure quantity remains positive\n\n**WHEN** quantity reaches zero through decrement  \n**THEN** the system **SHALL** remove the item from the cart  \n**AND** the system **SHALL** display a confirmation of item removal\n\n**WHEN** increasing quantity would exceed available stock  \n**THEN** the system **SHALL** prevent the increase and show an error message  \n**AND** the system **SHALL** display the maximum available quantity\n\n**WHEN** quantity is manually entered in an input field  \n**THEN** the system **SHALL** validate the input is a positive integer  \n**AND** the system **SHALL** validate against available stock  \n**AND** the system **SHALL** revert to previous quantity if validation fails\n\n**WHEN** quantity changes by any method  \n**THEN** the system **SHALL** update the item total and cart subtotal immediately  \n**AND** the system **SHALL** persist the change to localStorage\n\n### Requirement 4: Cart Item Removal\n\n**User Story:** As a customer, I want to remove items from my cart, so that I can eliminate products I no longer wish to purchase.\n\n#### EARS Format Requirements\n\n**WHEN** a customer clicks the remove button on a cart item  \n**THEN** the system **SHALL** remove the item completely from the cart  \n**AND** the system **SHALL** update localStorage immediately\n\n**WHEN** an item is removed  \n**THEN** the system **SHALL** display a confirmation message  \n**AND** the system **SHALL** provide an undo option for 5 seconds  \n**AND** the system **SHALL** update the cart totals immediately\n\n**WHEN** the last item is removed from the cart  \n**THEN** the system **SHALL** display the empty cart state  \n**AND** the system **SHALL** show a \"Continue Shopping\" button  \n**AND** the system **SHALL** clear all cart-related localStorage data\n\n### Requirement 5: Real-time Inventory Validation\n\n**User Story:** As a customer, I want my cart to reflect current product availability, so that I know which items are still available for purchase.\n\n#### EARS Format Requirements\n\n**WHEN** a customer views their cart  \n**THEN** the system **SHALL** validate all items against current inventory  \n**AND** the system **SHALL** check for price changes since items were added\n\n**WHEN** a product becomes completely out of stock  \n**THEN** the system **SHALL** remove it from the cart automatically  \n**AND** the system **SHALL** notify the customer with specific item details  \n**AND** the system **SHALL** offer to notify when item is back in stock\n\n**WHEN** a product's available quantity is less than cart quantity  \n**THEN** the system **SHALL** adjust cart quantity to maximum available stock  \n**AND** the system **SHALL** notify the customer of the quantity change  \n**AND** the system **SHALL** update pricing based on new quantity\n\n**WHEN** a product is no longer available (discontinued)  \n**THEN** the system **SHALL** remove it from the cart  \n**AND** the system **SHALL** display a notification explaining the removal  \n**AND** the system **SHALL** suggest similar alternative products\n\n**WHEN** inventory validation occurs  \n**THEN** the system **SHALL** update product information in the cart  \n**AND** the system **SHALL** refresh product images and descriptions  \n**AND** the system **SHALL** validate and update pricing\n\n### Requirement 6: Cart Summary and Calculations\n\n**User Story:** As a customer, I want to see accurate pricing and totals in my cart, so that I understand the cost of my order.\n\n#### EARS Format Requirements\n\n**WHEN** viewing the cart  \n**THEN** the system **SHALL** display the subtotal of all items  \n**AND** the system **SHALL** show individual item totals (price  quantity)  \n**AND** the system **SHALL** format all prices according to EUR currency standards\n\n**WHEN** item quantities change  \n**THEN** the system **SHALL** recalculate totals immediately  \n**AND** the system **SHALL** update both item totals and cart subtotal  \n**AND** the system **SHALL** animate price changes for visual feedback\n\n**WHEN** displaying prices in different locales  \n**THEN** the system **SHALL** format them according to the selected locale  \n**AND** the system **SHALL** use appropriate decimal separators and thousand separators  \n**AND** the system **SHALL** maintain EUR currency symbol placement per locale\n\n**WHEN** calculating totals  \n**THEN** the system **SHALL** use the most current product prices  \n**AND** the system **SHALL** handle rounding to two decimal places consistently  \n**AND** the system **SHALL** notify users if prices have changed since items were added\n\n**WHEN** the cart is empty  \n**THEN** the system **SHALL** display a subtotal of 0.00  \n**AND** the system **SHALL** hide checkout-related buttons  \n**AND** the system **SHALL** display the empty cart message and continue shopping option\n\n### Requirement 7: Empty Cart State\n\n**User Story:** As a customer, I want clear guidance when my cart is empty, so that I can easily continue shopping.\n\n#### EARS Format Requirements\n\n**WHEN** the cart is empty  \n**THEN** the system **SHALL** display an empty cart message in the user's selected language  \n**AND** the system **SHALL** show a \"Continue Shopping\" button linking to the products page  \n**AND** the system **SHALL** display an appropriate empty cart icon or illustration\n\n**WHEN** the cart is empty  \n**THEN** the checkout button **SHALL** be disabled or hidden  \n**AND** cart summary sections **SHALL** be hidden  \n**AND** the cart page **SHALL** focus on encouraging product discovery\n\n**WHEN** displaying the empty cart state  \n**THEN** the system **SHALL** suggest popular or featured products  \n**AND** the system **SHALL** provide easy navigation to main product categories  \n**AND** the system **SHALL** maintain consistent page layout and navigation\n\n### Requirement 8: Multi-language Support\n\n**User Story:** As a customer, I want the cart interface in my preferred language, so that I can understand all cart-related information.\n\n#### EARS Format Requirements\n\n**WHEN** a customer changes language  \n**THEN** all cart interface text **SHALL** update to the selected language immediately  \n**AND** button labels, headings, and messages **SHALL** be translated  \n**AND** the cart **SHALL** maintain its current state during language switch\n\n**WHEN** displaying product names in the cart  \n**THEN** the system **SHALL** show them in the customer's selected language  \n**AND** the system **SHALL** fall back to default language if translation unavailable  \n**AND** the system **SHALL** maintain consistent name display across all cart views\n\n**WHEN** showing error messages or notifications  \n**THEN** the system **SHALL** display them in the customer's selected language  \n**AND** error messages **SHALL** be culturally appropriate and clear  \n**AND** action buttons in error dialogs **SHALL** use translated text\n\n**WHEN** formatting prices for different locales  \n**THEN** the system **SHALL** use the appropriate locale formatting for EUR  \n**AND** the system **SHALL** maintain consistent formatting across all price displays  \n**AND** tooltip or help text **SHALL** also be localized\n\n### Requirement 9: Mobile Responsiveness\n\n**User Story:** As a mobile customer, I want a fully functional cart experience on my device, so that I can manage my cart regardless of screen size.\n\n#### EARS Format Requirements\n\n**WHEN** accessing the cart on mobile devices  \n**THEN** all functionality **SHALL** work without horizontal scrolling  \n**AND** the layout **SHALL** adapt to portrait and landscape orientations  \n**AND** touch targets **SHALL** meet minimum size requirements (44px)\n\n**WHEN** viewing cart items on mobile  \n**THEN** product information **SHALL** be clearly readable without zooming  \n**AND** product images **SHALL** be appropriately sized for mobile screens  \n**AND** item details **SHALL** be organized for easy scanning\n\n**WHEN** using quantity controls on mobile  \n**THEN** plus/minus buttons **SHALL** be appropriately sized for touch interaction  \n**AND** quantity input fields **SHALL** trigger numeric keyboards  \n**AND** buttons **SHALL** provide haptic feedback where supported\n\n**WHEN** viewing the cart summary on mobile  \n**THEN** it **SHALL** be easily accessible and readable  \n**AND** the checkout button **SHALL** be prominently placed and easily tappable  \n**AND** price breakdowns **SHALL** be clearly formatted for mobile viewing\n\n### Requirement 10: Performance and Loading States\n\n**User Story:** As a customer, I want responsive cart interactions, so that I have confidence the system is working properly.\n\n#### EARS Format Requirements\n\n**WHEN** cart operations are in progress (add, remove, update)  \n**THEN** the system **SHALL** display loading indicators on affected UI elements  \n**AND** the system **SHALL** disable relevant buttons to prevent duplicate actions  \n**AND** loading states **SHALL** provide clear visual feedback\n\n**WHEN** cart operations complete successfully  \n**THEN** loading states **SHALL** be cleared immediately  \n**AND** the system **SHALL** show success confirmation  \n**AND** UI elements **SHALL** be re-enabled for further interaction\n\n**WHEN** cart data is loading on page load  \n**THEN** the system **SHALL** show a loading spinner or skeleton UI  \n**AND** the system **SHALL** load critical cart information first  \n**AND** secondary details **SHALL** load progressively\n\n**WHEN** cart operations fail  \n**THEN** the system **SHALL** display appropriate error messages  \n**AND** the system **SHALL** provide retry options for failed operations  \n**AND** the system **SHALL** revert to previous state if operation cannot be completed\n\n**WHEN** the cart page loads initially  \n**THEN** it **SHALL** render within 2 seconds on standard connections  \n**AND** basic cart structure **SHALL** appear within 1 second  \n**AND** the system **SHALL** prioritize above-the-fold content loading\n",
              "category": "reference"
            },
            {
              "path": "docs/specs/user-authentication/requirements.md",
              "name": "requirements.md",
              "size": 12443,
              "lastModified": "2025-12-04T10:27:33.914Z",
              "content": "# User Authentication Requirements Document\n\n## Introduction\n\nThe user authentication system enables secure user registration, login, and session management for Moldova Direct customers. This system is mandatory for all transactions as the platform does not support guest checkout. The authentication system must provide multi-language support, secure token-based authentication, and seamless user experience across all devices.\n\n## Requirements\n\n### Requirement 1: User Registration\n\n**User Story:** As a new customer, I want to create an account with my email and password, so that I can make purchases on Moldova Direct.\n\n#### EARS Format Requirements\n\n**WHEN** a user submits valid registration information (email, password, confirm password, terms acceptance)  \n**THEN** the system **SHALL** create a new user account and send a verification email  \n**AND** the system **SHALL** redirect the user to the verification pending page  \n**AND** the system **SHALL** encrypt the password using secure hashing\n\n**WHEN** a user attempts to register with an email that already exists  \n**THEN** the system **SHALL** display an error message \"Email already registered\"  \n**AND** the system **SHALL** provide a link to the login page\n\n**WHEN** a user submits invalid registration data (weak password, invalid email format, mismatched passwords)  \n**THEN** the system **SHALL** display specific validation error messages  \n**AND** the system **SHALL** highlight the invalid fields  \n**AND** the system **SHALL** preserve valid field values\n\n**WHEN** a user does not accept the terms and conditions  \n**THEN** the system **SHALL** prevent account creation  \n**AND** the system **SHALL** display a message requiring terms acceptance\n\n### Requirement 2: Email Verification\n\n**User Story:** As a registered user, I want to verify my email address, so that I can activate my account and start shopping.\n\n#### EARS Format Requirements\n\n**WHEN** a user clicks the verification link in their email  \n**THEN** the system **SHALL** verify the token validity  \n**AND** the system **SHALL** activate the user account if token is valid  \n**AND** the system **SHALL** redirect to login page with success message\n\n**WHEN** a user clicks an expired or invalid verification link  \n**THEN** the system **SHALL** display an error message  \n**AND** the system **SHALL** provide an option to resend verification email\n\n**WHEN** a user requests to resend verification email  \n**THEN** the system **SHALL** generate a new verification token  \n**AND** the system **SHALL** send a new verification email  \n**AND** the system **SHALL** invalidate any previous verification tokens\n\n**WHEN** an already verified user clicks a verification link  \n**THEN** the system **SHALL** redirect to login page  \n**AND** the system **SHALL** display a message that the account is already verified\n\n### Requirement 3: User Login\n\n**User Story:** As a registered customer, I want to log into my account using my email and password, so that I can access my profile and make purchases.\n\n#### EARS Format Requirements\n\n**WHEN** a user submits valid login credentials (verified email and correct password)  \n**THEN** the system **SHALL** authenticate the user  \n**AND** the system **SHALL** generate JWT access and refresh tokens  \n**AND** the system **SHALL** redirect to the intended page or homepage  \n**AND** the system **SHALL** update the last login timestamp\n\n**WHEN** a user submits invalid credentials  \n**THEN** the system **SHALL** display a generic error message \"Invalid email or password\"  \n**AND** the system **SHALL** not reveal whether email exists or password is incorrect  \n**AND** the system **SHALL** clear the password field\n\n**WHEN** a user attempts to login with an unverified email  \n**THEN** the system **SHALL** display a message requiring email verification  \n**AND** the system **SHALL** provide an option to resend verification email\n\n**WHEN** a user exceeds maximum login attempts (5 attempts)  \n**THEN** the system **SHALL** temporarily lock the account for 15 minutes  \n**AND** the system **SHALL** display a lockout message with unlock time\n\n### Requirement 4: Password Reset\n\n**User Story:** As a customer who has forgotten my password, I want to reset it using my email address, so that I can regain access to my account.\n\n#### EARS Format Requirements\n\n**WHEN** a user requests password reset with a valid registered email  \n**THEN** the system **SHALL** generate a secure reset token  \n**AND** the system **SHALL** send a password reset email  \n**AND** the system **SHALL** display a confirmation message regardless of email existence\n\n**WHEN** a user clicks a valid password reset link  \n**THEN** the system **SHALL** verify the token validity and expiration (30 minutes)  \n**AND** the system **SHALL** display the password reset form  \n**AND** the system **SHALL** require new password and confirmation\n\n**WHEN** a user submits a new password via reset form  \n**THEN** the system **SHALL** validate password strength requirements  \n**AND** the system **SHALL** update the user's password with encryption  \n**AND** the system **SHALL** invalidate all existing sessions  \n**AND** the system **SHALL** invalidate the reset token  \n**AND** the system **SHALL** redirect to login with success message\n\n**WHEN** a user clicks an expired or invalid reset link  \n**THEN** the system **SHALL** display an error message  \n**AND** the system **SHALL** provide an option to request a new reset link\n\n### Requirement 5: Session Management\n\n**User Story:** As a logged-in customer, I want my session to persist across browser tabs and reasonable time periods, so that I don't have to repeatedly log in during my shopping session.\n\n#### EARS Format Requirements\n\n**WHEN** a user successfully logs in  \n**THEN** the system **SHALL** create a session with JWT access token (15 minutes expiry)  \n**AND** the system **SHALL** store a refresh token as httpOnly cookie (7 days expiry)  \n**AND** the system **SHALL** persist login state across browser tabs\n\n**WHEN** an access token expires during user activity  \n**THEN** the system **SHALL** automatically refresh the token using the refresh token  \n**AND** the system **SHALL** maintain user session without interruption  \n**AND** the system **SHALL** update the access token expiry time\n\n**WHEN** a refresh token expires or is invalid  \n**THEN** the system **SHALL** log out the user  \n**AND** the system **SHALL** redirect to login page with session expired message  \n**AND** the system **SHALL** clear all authentication data\n\n**WHEN** a user logs out voluntarily  \n**THEN** the system **SHALL** invalidate the current session tokens  \n**AND** the system **SHALL** clear all authentication data from browser  \n**AND** the system **SHALL** redirect to homepage with logout confirmation\n\n### Requirement 6: Multi-Language Authentication\n\n**User Story:** As a customer, I want the authentication interface in my preferred language, so that I can understand all authentication-related information and messages.\n\n#### EARS Format Requirements\n\n**WHEN** a user changes the language setting  \n**THEN** all authentication forms and messages **SHALL** update to the selected language  \n**AND** error messages **SHALL** display in the user's preferred language  \n**AND** email notifications **SHALL** be sent in the user's preferred language\n\n**WHEN** a user receives authentication emails (verification, password reset)  \n**THEN** the email content **SHALL** be in the user's selected language  \n**AND** the email **SHALL** maintain consistent branding and formatting\n\n**WHEN** a user sets their language preference during registration  \n**THEN** the system **SHALL** store this preference in their profile  \n**AND** the system **SHALL** use this language for all future communications\n\n### Requirement 7: Security and Protection\n\n**User Story:** As a customer, I want my account and personal information to be secure, so that I can trust the platform with my data and transactions.\n\n#### EARS Format Requirements\n\n**WHEN** a user creates or updates their password  \n**THEN** the system **SHALL** enforce password requirements (minimum 8 characters, uppercase, lowercase, number)  \n**AND** the system **SHALL** encrypt the password using bcrypt or equivalent  \n**AND** the system **SHALL** never store or log passwords in plain text\n\n**WHEN** authentication requests are made  \n**THEN** the system **SHALL** implement rate limiting (5 attempts per 15 minutes per IP)  \n**AND** the system **SHALL** log security events for monitoring  \n**AND** the system **SHALL** use HTTPS for all authentication communications\n\n**WHEN** a user's session is compromised or suspicious activity is detected  \n**THEN** the system **SHALL** invalidate all user sessions  \n**AND** the system **SHALL** require the user to log in again  \n**AND** the system **SHALL** send a security notification email\n\n**WHEN** handling JWT tokens  \n**THEN** the system **SHALL** use secure signing algorithms (RS256 or HS256)  \n**AND** the system **SHALL** include appropriate claims (user ID, email, expiry)  \n**AND** the system **SHALL** validate token signature and expiry on each request\n\n### Requirement 8: Mobile Responsiveness\n\n**User Story:** As a mobile customer, I want a fully functional authentication experience on my device, so that I can register and log in regardless of screen size.\n\n#### EARS Format Requirements\n\n**WHEN** a user accesses authentication forms on mobile devices  \n**THEN** all forms **SHALL** be fully functional without horizontal scrolling  \n**AND** input fields **SHALL** be appropriately sized for touch interaction  \n**AND** error messages **SHALL** be clearly visible and readable\n\n**WHEN** a user types in email or password fields on mobile  \n**THEN** the system **SHALL** use appropriate input types and keyboards  \n**AND** the system **SHALL** prevent auto-capitalization for email fields  \n**AND** password fields **SHALL** include show/hide password toggle\n\n**WHEN** authentication forms are displayed on various screen sizes  \n**THEN** the layout **SHALL** adapt appropriately  \n**AND** all interactive elements **SHALL** meet minimum touch target sizes (44px)\n\n### Requirement 9: Error Handling and User Feedback\n\n**User Story:** As a customer, I want clear feedback when authentication actions succeed or fail, so that I understand what's happening and what I need to do next.\n\n#### EARS Format Requirements\n\n**WHEN** authentication operations are in progress  \n**THEN** the system **SHALL** display loading indicators  \n**AND** the system **SHALL** disable form submission during processing  \n**AND** the system **SHALL** provide feedback within 3 seconds for normal operations\n\n**WHEN** authentication errors occur  \n**THEN** the system **SHALL** display user-friendly error messages  \n**AND** the system **SHALL** provide actionable guidance for resolution  \n**AND** the system **SHALL** maintain form data where appropriate\n\n**WHEN** authentication operations complete successfully  \n**THEN** the system **SHALL** display confirmation messages  \n**AND** the system **SHALL** provide clear next steps to the user  \n**AND** the system **SHALL** redirect appropriately after a brief delay\n\n### Requirement 10: Integration with Shopping Features\n\n**User Story:** As an authenticated customer, I want my authentication state to integrate seamlessly with shopping features, so that I have a cohesive experience throughout the platform.\n\n#### EARS Format Requirements\n\n**WHEN** an unauthenticated user attempts to access protected features (cart checkout, profile, orders)  \n**THEN** the system **SHALL** redirect to login page  \n**AND** the system **SHALL** preserve the intended destination for post-login redirect  \n**AND** the system **SHALL** display a message explaining login requirement\n\n**WHEN** a user logs in after being redirected from a protected page  \n**THEN** the system **SHALL** redirect back to the originally requested page  \n**AND** the system **SHALL** maintain any temporary data (cart contents, form inputs)  \n**AND** the system **SHALL** display a welcome back message\n\n**WHEN** a user's authentication state changes (login/logout)  \n**THEN** the system **SHALL** update all UI elements reflecting authentication status  \n**AND** the system **SHALL** refresh user-specific data (profile info, order history)  \n**AND** the system **SHALL** maintain cart contents across authentication state changes\n",
              "category": "reference"
            }
          ],
          "similarity": 0.880909187475429,
          "recommendation": "Consider consolidating into GLOBAL_REQUIREMENTS.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/specs/order-confirmation-emails/task-3-completion-summary.md",
              "name": "task-3-completion-summary.md",
              "size": 8799,
              "lastModified": "2025-12-04T10:27:33.905Z",
              "content": "# Task 3 Completion Summary: Extend Email Service Functionality\n\n## Overview\n\nTask 3 \"Extend email service functionality\" has been successfully completed. This task extended the existing email infrastructure to support order confirmation emails with comprehensive logging and automated retry capabilities.\n\n## Completed Subtasks\n\n###  Task 3.1: Create order-specific email utilities\n**Status**: Completed  \n**Verification**: `.kiro/specs/order-confirmation-emails/task-3.1-verification.md`\n\n**Key Deliverables**:\n- Order-specific email sending functions\n- Email template rendering with order data\n- Data transformation utilities\n- Multi-language support\n- Email logging integration\n\n###  Task 3.2: Implement email retry logic with exponential backoff\n**Status**: Completed  \n**Verification**: `.kiro/specs/order-confirmation-emails/task-3.2-verification.md`\n\n**Key Deliverables**:\n- Exponential backoff retry mechanism\n- Automated retry processing\n- Admin alert system\n- Retry statistics and monitoring\n- API endpoints for manual control\n\n## Implementation Details\n\n### Files Created/Modified\n\n#### Core Utilities\n1. **`server/utils/orderEmails.ts`** (Modified)\n   - `sendOrderConfirmationEmail()` - Send confirmation with logging\n   - `sendOrderStatusEmail()` - Send status updates\n   - `retryEmailDelivery()` - Retry failed deliveries\n   - `transformOrderToEmailData()` - Transform DB orders to email format\n\n2. **`server/utils/emailRetryService.ts`** (New)\n   - `processEmailRetries()` - Batch retry processing\n   - `processEmailRetry()` - Individual email retry\n   - `checkAndSendAdminAlerts()` - Alert monitoring\n   - `sendAdminAlert()` - Send admin notifications\n   - `getRetryStatistics()` - Performance metrics\n   - `scheduleEmailRetries()` - Automated scheduling\n\n3. **`server/utils/emailLogging.ts`** (Existing)\n   - Already implemented in previous tasks\n   - Provides logging infrastructure\n\n#### Email Templates\n4. **`server/utils/emailTemplates/orderConfirmation.ts`** (Existing)\n   - Responsive HTML template\n   - Multi-language support\n   - Already implemented in previous tasks\n\n5. **`server/utils/emailTemplates/types.ts`** (Existing)\n   - Type definitions for email data\n\n6. **`server/utils/emailTemplates/translations.ts`** (Existing)\n   - Multi-language translations\n\n7. **`server/utils/emailTemplates/formatters.ts`** (Existing)\n   - Locale-specific formatting\n\n#### API Endpoints\n8. **`server/api/admin/email-retries/process.post.ts`** (New)\n   - Manual batch retry trigger\n\n9. **`server/api/admin/email-retries/[id].post.ts`** (New)\n   - Retry specific email\n\n10. **`server/api/admin/email-retries/stats.get.ts`** (New)\n    - Get retry statistics\n\n#### Tests\n11. **`server/utils/__tests__/orderEmails.test.ts`** (New)\n    - Data transformation tests\n    - Locale handling tests\n\n12. **`server/utils/__tests__/emailRetryService.test.ts`** (New)\n    - Exponential backoff tests\n    - Retry logic tests\n\n#### Documentation\n13. **`server/utils/emailRetryService.README.md`** (New)\n    - Complete usage guide\n    - Configuration documentation\n    - Troubleshooting guide\n\n## Technical Architecture\n\n### Email Sending Flow\n```\nOrder Created\n    \ntransformOrderToEmailData()\n    \ngenerateOrderConfirmationTemplate()\n    \nsendEmail()\n    \ncreateEmailLog()\n    \nrecordEmailAttempt()\n```\n\n### Retry Flow\n```\nScheduled Task (every 5 min)\n    \ngetPendingEmailsForRetry()\n    \nFor each pending email:\n    - Check max attempts\n    - Calculate backoff delay\n    - Check time since last attempt\n    - Retry if ready\n    - Update email log\n    \nCheck failure threshold\n    \nSend admin alert if needed\n```\n\n### Exponential Backoff\n```\nAttempt 1: 1 second delay\nAttempt 2: 2 seconds delay (2^1  1s)\nAttempt 3: 4 seconds delay (2^2  1s)\nTotal: 7 seconds maximum retry window\n```\n\n## Requirements Satisfied\n\n### From Task 3.1\n **Requirement 1.1**: Order confirmation emails sent within 30 seconds  \n **Requirement 4.1**: Email delivery attempts logged with timestamp  \n **Requirement 4.2**: Email logging functionality for tracking\n\n### From Task 3.2\n **Requirement 4.2**: Retry mechanism with exponential backoff (max 3 attempts)  \n **Requirement 4.3**: Failure logging after all retries  \n **Requirement 4.3**: Admin alert system for persistent failures\n\n## Key Features\n\n### 1. Order Email Utilities\n-  Send order confirmation emails\n-  Send order status update emails\n-  Transform database orders to email format\n-  Multi-language support (es, en, ro, ru)\n-  Locale-specific formatting\n-  Tracking URL generation\n\n### 2. Email Template System\n-  Responsive HTML templates\n-  Mobile-friendly design\n-  Accessible markup\n-  Brand-consistent styling\n-  Dynamic content rendering\n\n### 3. Email Logging\n-  Track all delivery attempts\n-  Record success/failure status\n-  Store error messages\n-  Link to external service IDs\n-  Query and filter logs\n\n### 4. Retry Mechanism\n-  Exponential backoff strategy\n-  Maximum 3 retry attempts\n-  Automatic retry processing\n-  Manual retry capability\n-  Configurable parameters\n\n### 5. Admin Alerts\n-  Automatic failure monitoring\n-  Threshold-based alerts\n-  Detailed failure reports\n-  Action recommendations\n-  Configurable alert settings\n\n### 6. Monitoring & Statistics\n-  Retry success/failure rates\n-  Average attempts per email\n-  Time-based filtering\n-  Performance metrics\n\n## API Endpoints\n\n### Manual Retry Processing\n```bash\nPOST /api/admin/email-retries/process\n```\nTriggers batch retry of all pending emails.\n\n### Retry Specific Email\n```bash\nPOST /api/admin/email-retries/{emailLogId}\n```\nRetries a single email by log ID.\n\n### Get Retry Statistics\n```bash\nGET /api/admin/email-retries/stats?dateFrom=2024-01-01&dateTo=2024-01-31\n```\nReturns retry performance metrics.\n\n## Configuration\n\n### Retry Configuration\n```typescript\n{\n  maxAttempts: 3,           // Maximum retry attempts\n  backoffMultiplier: 2,     // Exponential multiplier\n  initialDelayMs: 1000      // Initial delay (1 second)\n}\n```\n\n### Admin Alert Configuration\n```typescript\n{\n  enabled: true,                              // Enable alerts\n  alertEmail: 'admin@moldovadirect.com',     // Admin email\n  alertThreshold: 5                          // Failures before alert\n}\n```\n\nSet via environment:\n```bash\nADMIN_ALERT_EMAIL=admin@moldovadirect.com\n```\n\n## Testing\n\n### Unit Tests\n-  Order data transformation\n-  Locale-specific handling\n-  Exponential backoff calculation\n-  Retry eligibility logic\n-  Configuration scenarios\n\n### Test Coverage\n- Data transformation functions\n- Retry timing calculations\n- Multi-language support\n- Error handling\n\n## Documentation\n\n### Created Documentation\n1. **Task 3.1 Verification** - Implementation details for subtask 3.1\n2. **Task 3.2 Verification** - Implementation details for subtask 3.2\n3. **Email Retry Service README** - Complete usage guide\n4. **This Summary** - Overall task completion summary\n\n## Integration Points\n\nThe email service integrates with:\n1. **Order Creation API** - Triggers confirmation emails\n2. **Email Logging System** - Tracks all attempts\n3. **Database** - Stores email logs and order data\n4. **Resend Service** - External email delivery\n5. **Admin Dashboard** - Monitoring and manual control\n\n## Performance Considerations\n\n### Efficiency\n- Batch processing of pending emails\n- Configurable retry intervals\n- Exponential backoff prevents overload\n- Database query optimization\n\n### Reliability\n- Automatic retry for transient failures\n- Maximum attempt limit prevents infinite loops\n- Graceful error handling\n- Alert system doesn't break retry process\n\n### Scalability\n- Scheduled processing handles high volume\n- Configurable batch sizes\n- Database indexing for fast queries\n- Async email sending\n\n## Security\n\n### Email Security\n- Sanitized email content\n- Secure tracking URLs\n- Rate limiting support\n- Bounce handling\n\n### Admin Security\n- TODO: Add admin authentication to API endpoints\n- Secure alert email delivery\n- Protected retry endpoints\n\n## Next Steps\n\nWith Task 3 complete, the next task is:\n\n**Task 4: Integrate email sending with order creation**\n- Modify order creation endpoint\n- Handle authenticated and guest users\n- Implement error handling\n- Add order data transformation\n\n## Conclusion\n\nTask 3 has been successfully completed with all requirements satisfied. The email service now has:\n-  Order-specific email utilities\n-  Comprehensive email logging\n-  Automated retry with exponential backoff\n-  Admin alert system\n-  Monitoring and statistics\n-  API endpoints for manual control\n-  Complete documentation\n-  Unit tests\n\nThe system is ready for integration with the order creation flow in Task 4.\n",
              "category": "reference"
            },
            {
              "path": "docs/specs/order-confirmation-emails/task-3.2-verification.md",
              "name": "task-3.2-verification.md",
              "size": 6767,
              "lastModified": "2025-12-04T10:27:33.906Z",
              "content": "# Task 3.2 Verification: Implement email retry logic with exponential backoff\n\n## Implementation Summary\n\nTask 3.2 has been successfully completed. The email retry system with exponential backoff and admin alerts has been fully implemented.\n\n### 1. Email Retry Mechanism\n\n**File: `server/utils/emailRetryService.ts`**\n\n **Exponential Backoff Implementation**\n- `calculateRetryDelay()` - Calculates delay using formula: `initialDelay  backoffMultiplier^(attempt-1)`\n- Default configuration: 1s, 2s, 4s delays (total 7 seconds)\n- Configurable via `EmailRetryConfig`\n\n **Retry Processing**\n- `processEmailRetries()` - Batch processes pending emails\n- `processEmailRetry()` - Handles individual email retry with timing checks\n- Automatic status updates based on retry results\n- Maximum 3 attempts per email (configurable)\n\n **Retry Logic**\n- Checks if email should be retried based on attempt count\n- Validates sufficient time has passed since last attempt\n- Calculates next retry time for failed attempts\n- Marks emails as `failed` after max attempts reached\n\n### 2. Failure Logging System\n\n**File: `server/utils/emailLogging.ts`**\n\n **Comprehensive Logging**\n- Records all retry attempts with timestamps\n- Tracks success/failure status\n- Stores error messages and bounce reasons\n- Maintains attempt counter\n- Links to external email service IDs\n\n **Query and Reporting**\n- `getPendingEmailsForRetry()` - Gets emails ready for retry\n- `getEmailLog()` - Retrieves individual email logs\n- `getEmailLogs()` - Queries logs with filters\n- `getEmailDeliveryStats()` - Calculates delivery statistics\n\n### 3. Admin Alert System\n\n**File: `server/utils/emailRetryService.ts`**\n\n **Automatic Alerts**\n- `checkAndSendAdminAlerts()` - Monitors failure threshold\n- `sendAdminAlert()` - Sends formatted alert emails\n- Default threshold: 5 consecutive failures\n- Configurable via `AdminAlertConfig`\n\n **Alert Content**\n- Email log IDs of failed deliveries\n- Number of attempts per email\n- Error messages\n- Next retry times\n- Action items for administrators\n\n **Alert Configuration**\n- Environment variable: `ADMIN_ALERT_EMAIL`\n- Enable/disable alerts\n- Adjustable failure threshold\n- Graceful error handling (alerts don't break retry process)\n\n### 4. API Endpoints\n\n**Files: `server/api/admin/email-retries/`**\n\n **Manual Retry Processing**\n- `POST /api/admin/email-retries/process` - Trigger batch retry\n- Returns processed count, success/failure stats\n- Includes detailed results for each email\n\n **Individual Email Retry**\n- `POST /api/admin/email-retries/[id]` - Retry specific email\n- Validates email log ID\n- Returns retry result with status\n\n **Retry Statistics**\n- `GET /api/admin/email-retries/stats` - Get performance metrics\n- Date range filtering\n- Success/failure rates\n- Average attempts per email\n\n### 5. Automated Scheduling\n\n **Scheduled Processing**\n- `scheduleEmailRetries()` - Sets up recurring retry processing\n- Configurable interval (default: 5 minutes)\n- Automatic error recovery\n- Continuous monitoring\n\n## Exponential Backoff Details\n\n### Default Configuration\n```typescript\n{\n  maxAttempts: 3,\n  backoffMultiplier: 2,\n  initialDelayMs: 1000\n}\n```\n\n### Retry Schedule\n| Attempt | Delay | Total Time |\n|---------|-------|------------|\n| 1       | 1s    | 1s         |\n| 2       | 2s    | 3s         |\n| 3       | 4s    | 7s         |\n\n### Benefits\n- Prevents email service overload\n- Allows transient issues to resolve\n- Reduces unnecessary retry attempts\n- Configurable for different scenarios\n\n## Admin Alert Example\n\nWhen 5+ emails fail, administrators receive:\n\n```\nSubject:  Email Delivery Failures - 5 emails failed\n\nAlert Summary:\n5 email(s) failed to deliver after retry attempts.\n\nFailed Emails:\n\n Email Log ID  Attempts  Error            Next Retry       \n\n 123           3         Network timeout  No more retries  \n 124           2         Rate limit       2024-01-15 10:05 \n 125           3         Invalid address  No more retries  \n 126           1         Service error    2024-01-15 10:02 \n 127           3         Auth failed      No more retries  \n\n\nAction Required:\n Review the email logs in the admin dashboard\n Check email service configuration and status\n Verify recipient email addresses are valid\n Consider manual intervention for critical orders\n```\n\n## Testing\n\n**File: `server/utils/__tests__/emailRetryService.test.ts`**\n\n Unit tests verify:\n- Exponential backoff calculation\n- Retry eligibility logic\n- Different configuration scenarios\n- Timing calculations\n- Realistic retry windows\n\n## Requirements Satisfied\n\n **Requirement 4.2**: Email delivery fails  retry up to 3 times with exponential backoff\n **Requirement 4.3**: Email delivery fails after all retries  log failure and alert administrators\n **Requirement 4.3**: System logs failure and updates customer email status\n\n## Key Features\n\n### Reliability\n- Automatic retry for transient failures\n- Exponential backoff prevents service overload\n- Maximum attempt limit prevents infinite loops\n\n### Monitoring\n- Comprehensive logging of all attempts\n- Real-time statistics and metrics\n- Admin alerts for critical failures\n\n### Flexibility\n- Configurable retry parameters\n- Adjustable alert thresholds\n- Manual retry capability\n- Scheduled automatic processing\n\n### Error Handling\n- Graceful handling of retry failures\n- Alert system doesn't break retry process\n- Detailed error messages for debugging\n- Status tracking throughout lifecycle\n\n## Documentation\n\n **README Created**: `server/utils/emailRetryService.README.md`\n- Complete usage guide\n- Configuration options\n- API endpoint documentation\n- Troubleshooting guide\n- Best practices\n\n## Integration Points\n\nThe retry service integrates with:\n1. **Email Logging System** - Tracks all attempts\n2. **Order Email Utilities** - Performs actual retries\n3. **Admin Dashboard** - Provides monitoring interface\n4. **Email Service** - Sends retry attempts and alerts\n\n## Next Steps\n\nTask 3 is now complete. The next task (4.1) will integrate email sending with order creation endpoints.\n",
              "category": "reference"
            }
          ],
          "similarity": 0.846390536334519,
          "recommendation": "Consider consolidating into task-3.2-verification.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/testing/TESTING_REVIEW.md",
              "name": "TESTING_REVIEW.md",
              "size": 11411,
              "lastModified": "2026-01-06T15:49:37.119Z",
              "content": "# Moldova Direct - Testing Strategy Review\n\n**Review Date:** November 27, 2025\n**Status:** In-depth analysis of current testing state and recommendations\n\n---\n\n## Executive Summary\n\nThe project has a foundational testing infrastructure with **65+ test files** across unit, integration, and E2E tests. However, there are significant gaps in coverage, especially for components (2% coverage) and stores (0% coverage). The testing strategy is partially implemented with good patterns in place but requires systematic expansion.\n\n---\n\n## Current Testing State\n\n### Test File Distribution\n\n| Category | Total Files | Tests | Coverage |\n|----------|-------------|-------|----------|\n| Composables | 50 | 9 | **18%** |\n| Components | 239 | 5 | **2%** |\n| Pinia Stores | 25 | 0 | **0%** |\n| Server API Routes | 108 | 10 | **9%** |\n| Server Utils | 31 | 6 | **19%** |\n| Middleware | 7 | 2 | **29%** |\n| Pages | 47 | 0 | **0%** (E2E only) |\n\n### Testing Frameworks\n\n| Framework | Purpose | Status |\n|-----------|---------|--------|\n| Vitest | Unit & Integration tests | Configured |\n| Playwright | E2E tests | Configured |\n| @vue/test-utils | Component testing | Available |\n| @pinia/testing | Store testing | Available |\n| @axe-core/playwright | Accessibility | Installed |\n\n---\n\n## What's Working Well\n\n### 1. Test Infrastructure\n- **Dual Vitest configuration**: Separate configs for unit (`vitest.config.ts`) and integration tests (`vitest.config.integration.ts`)\n- **Comprehensive Playwright setup**: Multi-browser, multi-locale support (es, en, ro, ru)\n- **Test utilities**: Well-organized mock utilities (`tests/utils/`) for Stripe, Supabase, etc.\n- **Nuxt auto-import mocking**: Proper mocking of Nuxt composables in `tests/setup/vitest.setup.ts`\n\n### 2. Test Quality Patterns\n- **Security-focused tests**: RBAC authorization tests for admin endpoints (`authorization.test.ts`)\n- **Critical path coverage**: Cart auto-save, checkout session persistence\n- **Regression tests**: Admin middleware security regression tests\n- **Error handling tests**: Stripe error formatting, payment failures\n\n### 3. E2E Test Coverage\n- **41 E2E test files** covering:\n  - Authentication flows (login, register, password reset, logout)\n  - Cart functionality\n  - Admin dashboard operations\n  - Security/GDPR compliance\n  - Accessibility testing\n\n### 4. Test Organization\n```\ntests/\n e2e/              # Playwright E2E tests\n    admin/        # Admin panel tests\n    auth/         # Authentication tests\n    ...\n unit/             # Unit tests\n integration/      # Integration tests\n server/           # Server-side tests\n    api/          # API endpoint tests\n    utils/        # Utility tests\n middleware/       # Middleware tests\n setup/            # Test configuration\n utils/            # Test utilities\n```\n\n---\n\n## Critical Gaps & Issues\n\n### 1. Zero Store Coverage (Priority: HIGH)\n\n**Problem:** Pinia stores have **0% test coverage** despite being critical for state management.\n\n**Impact:**\n- Cart store (`stores/cart/`) handles payment-critical logic\n- Auth store manages user sessions\n- Checkout stores coordinate multi-step purchase flow\n\n**Affected Files:**\n- `stores/cart/core.ts` - Cart operations\n- `stores/cart/persistence.ts` - Cookie persistence\n- `stores/cart/validation.ts` - Input validation\n- `stores/checkout.ts` - Checkout flow\n- `stores/auth.ts` - Authentication state\n- `stores/adminOrders.ts` - Order management\n\n### 2. Minimal Component Coverage (Priority: HIGH)\n\n**Problem:** Only **5 of 239 components** (2%) have unit tests.\n\n**Tested Components:**\n- `VideoHero.test.ts`\n- `ChartLoader.test.ts`\n- `AsyncTableWrapper.test.ts`\n- `AppFooter.test.ts`\n- `AppHeader.test.ts`\n\n**Missing Critical Components:**\n- `components/checkout/*` - Payment forms\n- `components/cart/*` - Cart UI\n- `components/product/*` - Product display\n- `components/admin/*` - Admin interfaces\n\n### 3. Disabled Coverage Thresholds (Priority: MEDIUM)\n\n**Problem:** Coverage thresholds are commented out in `vitest.config.ts:56-90`:\n```typescript\n// TODO: Re-enable coverage thresholds after completing test coverage improvements\n// Temporarily disabled to allow lockfile fix to be pushed\n// thresholds: {\n//   global: {\n//     branches: 70,\n//     functions: 75,\n//     lines: 80,\n//     statements: 80,\n//   },\n// ...\n```\n\n**Impact:** No enforcement of minimum coverage, leading to coverage regression.\n\n### 4. E2E Tests Disabled in CI (Priority: HIGH)\n\n**Problem:** E2E tests are disabled in `.github/workflows/e2e-tests.yml`:\n```yaml\n# E2E tests are temporarily disabled - uncomment when database setup is configured\nplaceholder:\n  name: Tests Placeholder\n  runs-on: ubuntu-latest\n  steps:\n    - name: Tests disabled\n      run: echo \"E2E tests are temporarily disabled\"\n```\n\n**Impact:** No automated E2E test execution on PRs or main branch.\n\n### 5. Skipped Tests (Priority: MEDIUM)\n\n**Problem:** Multiple tests are skipped due to architectural issues:\n\nIn `useStripe.test.ts`:\n```typescript\n// Note: The following tests are skipped due to module-level singleton pattern\n// TODO: Refactor composable to support test isolation or use vi.resetModules()\nit.skip('handles missing publishable key', async () => { ... })\nit.skip('handles Stripe loading failure', async () => { ... })\n```\n\n**Impact:** Error handling paths are not tested for payment processing.\n\n### 6. No Visual Regression Tests (Priority: MEDIUM)\n\n**Problem:** `tests/visual/` directory is empty despite being configured:\n```typescript\n// playwright.config.ts\n'test:visual': 'PLAYWRIGHT_TEST=true playwright test tests/visual',\n```\n\n**Impact:** UI changes can break without detection.\n\n### 7. Missing API Route Tests (Priority: HIGH)\n\n**Problem:** Only 10 of 108 API routes (9%) have tests.\n\n**Untested Critical Endpoints:**\n- `server/api/checkout/create-payment-intent.post.ts`\n- `server/api/checkout/confirm-payment.post.ts`\n- `server/api/orders/create.post.ts`\n- Most `server/api/admin/*` endpoints\n\n---\n\n## Best Practices Comparison\n\n### Applied Best Practices\n\n| Practice | Status | Location |\n|----------|--------|----------|\n| Test isolation | Partial | `beforeEach` cleanup in most tests |\n| Meaningful test names | Yes | Descriptive `describe` and `it` blocks |\n| AAA pattern | Yes | Arrange-Act-Assert in unit tests |\n| Mock external services | Yes | Stripe, Supabase mocks in `tests/utils/` |\n| Security testing | Yes | RBAC, auth middleware tests |\n| Multi-locale E2E | Yes | All 4 locales in Playwright config |\n\n### Missing Best Practices\n\n| Practice | Status | Recommendation |\n|----------|--------|----------------|\n| Coverage thresholds | Disabled | Re-enable with realistic targets |\n| CI test execution | Disabled | Fix database setup, enable CI |\n| Snapshot testing | None | Add for component output |\n| Performance testing | None | Add load tests for critical APIs |\n| Contract testing | None | Add for API versioning |\n| Mutation testing | None | Consider for critical paths |\n| Test data factories | Partial | Expand `tests/utils/create*.ts` |\n\n---\n\n## Recommended Actions\n\n### Immediate (Week 1-2)\n\n1. **Enable E2E tests in CI**\n   - Configure test database in GitHub Actions\n   - Use Supabase CLI for local database\n   - Uncomment workflow jobs\n\n2. **Add Pinia store tests**\n   - Priority: `cart/core.ts`, `auth.ts`, `checkout.ts`\n   - Use `@pinia/testing` package\n   - Test computed properties and actions\n\n3. **Re-enable coverage thresholds**\n   - Start with lower thresholds (50% global)\n   - Incrementally increase as tests are added\n\n### Short-term (Week 3-4)\n\n4. **Test critical composables**\n   - `useCart.ts`\n   - `useAuth.ts`\n   - `useOrders.ts`\n   - `useCheckout*.ts`\n\n5. **Add checkout component tests**\n   - Payment form validation\n   - Address form handling\n   - Order review display\n\n6. **Fix skipped tests**\n   - Refactor `useStripe` to support test isolation\n   - Use `vi.resetModules()` between tests\n\n### Medium-term (Month 2)\n\n7. **API endpoint tests**\n   - All checkout endpoints\n   - Order creation/management\n   - Admin CRUD operations\n\n8. **Visual regression testing**\n   - Add Playwright visual comparison\n   - Set up baseline screenshots\n   - Cover critical pages\n\n9. **Component test expansion**\n   - Product components\n   - Cart components\n   - Navigation components\n\n### Long-term (Month 3+)\n\n10. **Performance testing**\n    - Load testing for API endpoints\n    - Lighthouse CI integration\n    - Bundle size monitoring\n\n11. **Test documentation**\n    - Testing guidelines\n    - Mock patterns\n    - Coverage requirements\n\n---\n\n## Specific Test Recommendations\n\n### High-Priority Tests to Add\n\n```typescript\n// 1. Cart Store Tests (stores/cart/core.test.ts)\ndescribe('Cart Store', () => {\n  it('should add item to cart')\n  it('should update item quantity')\n  it('should calculate totals correctly')\n  it('should persist to cookie')\n  it('should handle stock limits')\n})\n\n// 2. Auth Store Tests (stores/auth.test.ts)\ndescribe('Auth Store', () => {\n  it('should handle login')\n  it('should handle logout')\n  it('should refresh session')\n  it('should handle token expiration')\n})\n\n// 3. Checkout Flow Tests\ndescribe('Checkout Integration', () => {\n  it('should validate shipping address')\n  it('should calculate shipping costs')\n  it('should process payment')\n  it('should create order on success')\n})\n\n// 4. Payment API Tests\ndescribe('POST /api/checkout/create-payment-intent', () => {\n  it('should create payment intent for valid cart')\n  it('should reject empty cart')\n  it('should handle Stripe errors')\n  it('should require authentication')\n})\n```\n\n---\n\n## Test Configuration Issues\n\n### vitest.config.ts Exclusions\n\nMany tests are excluded from the standard unit test run:\n```typescript\nexclude: [\n  // These should be in integration config only\n  'tests/server/api/admin/__tests__/**/*.test.ts',\n  'tests/server/api/admin/orders/__tests__/**/*.test.ts',\n  'tests/server/api/admin/products/__tests__/**/*.test.ts',\n  // ...\n]\n```\n\n**Recommendation:** Ensure excluded tests run in integration config and add CI job for integration tests.\n\n### Integration Test Setup\n\nIntegration tests require environment variables but setup is minimal:\n```typescript\n// vitest.integration.setup.ts\nbeforeAll(() => {\n  const requiredEnvVars = ['SUPABASE_URL', 'SUPABASE_SERVICE_KEY']\n  // Only checks existence, not validity\n})\n```\n\n**Recommendation:** Add database connection validation and test data seeding.\n\n---\n\n## Metrics & Targets\n\n### Current State\n- Unit test files: 25+\n- E2E test files: 41\n- Overall estimated coverage: ~15-20%\n\n### Target State (3 months)\n- Unit test coverage: 70%+\n- Critical path coverage: 90%+\n- E2E test coverage: 80%+ of user flows\n- CI test pass rate: 95%+\n\n---\n\n## Conclusion\n\nThe project has a solid testing foundation with appropriate tooling and some well-written tests. However, the coverage gaps in stores, components, and API routes represent significant risk, especially for payment and authentication flows. The disabled CI pipeline means tests aren't running automatically, reducing their value.\n\n**Priority Actions:**\n1. Enable CI E2E tests\n2. Add Pinia store tests\n3. Enable coverage thresholds\n4. Test payment/checkout flows\n\nWith focused effort over 2-3 months, the project can achieve industry-standard test coverage and significantly reduce regression risk.\n",
              "category": "reference"
            },
            {
              "path": "docs/testing/TEST_COVERAGE_SUMMARY.md",
              "name": "TEST_COVERAGE_SUMMARY.md",
              "size": 4968,
              "lastModified": "2026-01-06T15:49:37.120Z",
              "content": "# Test Coverage Summary - MoldovaDirect\n\n**Date:** 2025-12-29  \n**Status:**  NEEDS ATTENTION\n\n---\n\n## Overall Coverage: 6.64%\n\n| Metric | Coverage | Status |\n|--------|----------|--------|\n| **Statements** | 6.64% (5,922/89,073) |  Critical |\n| **Branches** | 78.77% (2,041/2,591) |  Good |\n| **Functions** | 69.92% (993/1,420) |  Fair |\n| **Lines** | 6.64% (5,922/89,073) |  Critical |\n\n---\n\n## Critical Issues\n\n### 1. CI/CD Tests Disabled \n**Impact:** High regression risk on every deployment\n\n**Status:** E2E tests completely disabled in GitHub Actions\n```yaml\n# Current state in .github/workflows/e2e-tests.yml\nplaceholder:\n  run: echo \"E2E tests are temporarily disabled\"\n```\n\n**Action Required:** Configure test database and enable workflow\n\n---\n\n### 2. Zero API Route Coverage \n**Impact:** Payment, checkout, and order management untested\n\n**Stats:**\n- 112 API routes in server/api/\n- 0 integration tests\n- Only 1 E2E test for products API\n\n**Critical Untested Routes:**\n- `server/api/checkout/create-order.post.ts`\n- `server/api/stripe/create-payment-intent.post.ts`\n- `server/api/stripe/webhook.post.ts`\n- All admin API routes\n\n**Action Required:** Add API integration tests (5 days effort)\n\n---\n\n### 3. Low Component Coverage \n**Impact:** UI bugs may slip through\n\n**Stats:**\n- 261 Vue components\n- Only 8 with unit tests (3%)\n- Remaining 253 untested\n\n**Priority Untested Components:**\n- Cart: CartDrawer, CartSummary, CartItem\n- Product: ProductCard, ProductFilters, ProductGallery\n- Admin: All 50+ admin panel components\n\n**Action Required:** Add component tests (8 days effort)\n\n---\n\n## Test Breakdown\n\n### Unit Tests: 26 files \n-  Cart store and analytics (9 tests)\n-  Composables (13 tests)\n-  Pinia stores (4 tests)\n- Coverage: ~15% of codebase\n\n### E2E Tests: 20 files \n-  Critical flows (6 tests, <5 min)\n-  Auth, Admin, Products (14 tests)\n-  Only runs locally (CI/CD disabled)\n- Coverage: ~30% of user flows\n\n### Integration Tests: 1 file \n-  Only admin auth flows tested\n-  No API route tests\n-  No database integration tests\n\n### Visual Regression: 2 files \n- Basic theme and UI validation\n- Not comprehensive\n\n---\n\n## What's Working Well \n\n1. **Test Organization**\n   - Clear directory structure\n   - Separate configs for unit/E2E\n   - Pre-commit tests (<30s)\n   - Critical tests (<5min)\n\n2. **Cart Testing**\n   - Comprehensive unit tests\n   - Analytics tracking tested\n   - Persistence tested\n   - Security validated\n\n3. **E2E Infrastructure**\n   - Playwright configured\n   - Page objects pattern\n   - Multi-locale support\n   - Cross-browser setup\n\n---\n\n## What Needs Improvement \n\n1. **Test Isolation**\n   -  No database rollback\n   -  Tests may pollute shared state\n   -  No order cleanup\n\n2. **Test Data Management**\n   -  No test data factories\n   -  Manual test data creation\n   -  No mock external services\n\n3. **Flaky Tests**\n   -  No tracking system\n   -  Hard-coded waits (2000ms)\n   -  Debug screenshots in repo\n\n---\n\n## Immediate Actions (This Week)\n\n### Priority 1: Enable CI/CD Tests\n**Effort:** 2 days  \n**Impact:** Critical\n\n- Configure test database in GitHub Actions\n- Enable e2e-tests.yml workflow\n- Verify tests run on PR\n\n### Priority 2: Add Checkout API Tests\n**Effort:** 3 days  \n**Impact:** Critical\n\n- Test order creation\n- Test cart validation\n- Test payment intent creation\n- Mock Stripe webhook\n\n### Priority 3: Add Component Tests\n**Effort:** 2 days  \n**Impact:** High\n\n- CartDrawer.vue\n- ProductCard.vue\n- Header.vue\n\n---\n\n## 30-Day Goals\n\n| Goal | Target | Current |\n|------|--------|---------|\n| Overall Coverage | 15% | 6.64% |\n| API Routes Coverage | 60% | 0% |\n| Component Coverage | 20% | 3% |\n| CI/CD Tests | Enabled | Disabled |\n| Critical Path Coverage | 100% | ~70% |\n\n---\n\n## 90-Day Goals\n\n| Goal | Target |\n|------|--------|\n| Overall Coverage | 50% |\n| API Routes Coverage | 80% |\n| Component Coverage | 60% |\n| Performance Tests | Enabled |\n| Mutation Score | >75% |\n\n---\n\n## Key Metrics to Track\n\n### Coverage Metrics\n- [ ] Overall coverage percentage\n- [ ] Coverage by directory\n- [ ] Critical path coverage\n- [ ] Weekly coverage trend\n\n### Test Health\n- [ ] Total test count\n- [ ] Test execution time\n- [ ] Flaky test rate\n- [ ] Test failure rate\n\n### Quality Metrics\n- [ ] Mutation score\n- [ ] Defect escape rate\n- [ ] Time to find bugs\n\n---\n\n## Resources\n\n- **Full Analysis:** `/docs/testing/TEST_COVERAGE_ANALYSIS.md`\n- **Current Coverage:** `/coverage/index.html`\n- **Test Configs:**\n  - Vitest: `vitest.config.ts`\n  - Playwright: `playwright.config.ts`\n- **CI/CD:** `.github/workflows/e2e-tests.yml`\n\n---\n\n## Status Indicators\n\n **Critical** - Immediate action required  \n **Warning** - Needs attention soon  \n **Good** - Meeting standards  \n **Excellent** - Exceeding standards\n\n---\n\n**Last Updated:** 2025-12-29  \n**Next Review:** 2025-01-05 (Weekly)\n",
              "category": "reference"
            }
          ],
          "similarity": 0.813488973368577,
          "recommendation": "Consider consolidating into TEST_COVERAGE_SUMMARY.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/testing/VISUAL-REGRESSION-SETUP.md",
              "name": "VISUAL-REGRESSION-SETUP.md",
              "size": 5573,
              "lastModified": "2026-01-06T15:49:37.120Z",
              "content": "# Visual Regression Testing Setup\n\n**Status:**  Comprehensive baselines created for Hybrid Progressive Checkout\n**Coverage:** 28 screenshot assertions across all checkout states, locales, and devices\n**Date:** 2025-12-26\n\n---\n\n## Overview\n\nVisual regression testing has been implemented for the Hybrid Progressive Checkout flow using Playwright's screenshot comparison capabilities. This ensures UI consistency and catches unintended visual changes.\n\n## What's Included\n\n### Test Files\n\n1. **`tests/visual-regression/checkout-flow.spec.ts`** (NEW)\n   - 22 test cases\n   - 28 screenshot assertions\n   - Comprehensive checkout flow coverage\n\n2. **`tests/visual-regression/critical-pages.spec.ts`** (Existing)\n   - Homepage, products, cart, auth pages\n   - Additional ~20 screenshots\n\n### Documentation\n\n- **`tests/visual-regression/README.md`** - Complete guide\n- **`tests/visual-regression/QUICK-START.md`** - Quick reference\n- **`playwright.visual-regression.config.ts`** - Configuration\n\n### Coverage Breakdown\n\n#### Checkout Flow Screenshots (28 total)\n\n**Empty State (4):**\n- Desktop empty redirect/state\n- Mobile empty redirect/state\n\n**Guest Checkout Flow (9):**\n- Guest prompt (desktop)\n- Initial state (desktop + mobile)\n- Address filled (desktop)\n- Shipping methods loaded (desktop)\n- Shipping method selected (desktop)\n- Payment selected (desktop)\n- Ready to place order (desktop + mobile)\n\n**Multi-Locale (4):**\n- Spanish (es)\n- English (en)\n- Romanian (ro)\n- Russian (ru)\n\n**Component Screenshots (4):**\n- Order summary sidebar\n- Address form (empty + filled)\n- Mobile sticky footer\n\n**Error States (1):**\n- Validation errors (desktop)\n\n**Express Checkout (3):**\n- Express banner (desktop + mobile)\n- Express dismissed (desktop)\n\n**Tablet Viewport (2):**\n- Initial state\n- Ready to order\n\n---\n\n## Quick Start\n\n### Generate Baselines (First Time)\n\n```bash\n# Ensure dev server is running\nnpm run dev\n\n# Generate all checkout baselines\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n```\n\n### Run Tests\n\n```bash\n# Compare against baselines\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n\n# View results\nnpx playwright show-report test-results/visual-regression-html\n```\n\n### Update Baselines\n\nAfter intentional UI changes:\n\n```bash\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts --update-snapshots\n```\n\n---\n\n## Integration with Development Workflow\n\n### Before Committing Checkout Changes\n\n1. **Make UI changes**\n2. **Run visual tests:**\n   ```bash\n   npx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n   ```\n3. **Review diffs:** If tests fail, check HTML report\n4. **Update baselines** if changes are intentional:\n   ```bash\n   npx playwright test checkout-flow --config=playwright.visual-regression.config.ts --update-snapshots\n   ```\n5. **Commit both code AND baseline screenshots**\n\n### Pull Request Checklist\n\n- [ ] Visual regression tests pass OR\n- [ ] Baseline screenshots updated (with justification)\n- [ ] Visual diffs reviewed and approved\n- [ ] Screenshots committed to repo\n\n---\n\n## CI/CD Integration\n\nVisual regression tests can be integrated into GitHub Actions:\n\n```yaml\n- name: Run visual regression tests\n  run: npx playwright test --config=playwright.visual-regression.config.ts\n\n- name: Upload visual test results\n  if: always()\n  uses: actions/upload-artifact@v3\n  with:\n    name: visual-regression-results\n    path: test-results/\n```\n\n---\n\n## Key Features\n\n### Dynamic Content Masking\n\nPrices, totals, and timestamps are automatically masked to prevent false positives:\n\n```typescript\nconst dynamicContentMasks = [\n  '[data-testid=\"item-price\"]',\n  '[data-testid=\"cart-total\"]',\n  '[data-testid=\"order-total\"]',\n  '[data-testid=\"timestamp\"]',\n]\n```\n\n### Multi-Viewport Testing\n\n- **Desktop:** 1920x1080\n- **Tablet:** 768x1024\n- **Mobile:** 375x667\n\n### Tolerance Settings\n\n```typescript\nmaxDiffPixelRatio: 0.02  // 2% pixel difference allowed\nthreshold: 0.2           // Per-pixel color tolerance\n```\n\n---\n\n## Test Data Consistency\n\nTests use standardized test data from `tests/e2e/critical/constants.ts`:\n\n```typescript\nTEST_ADDRESS: {\n  fullName: 'Test User',\n  street: '123 Test Street',\n  city: 'Test City',\n  postalCode: '12345',\n  country: 'ES',\n  phone: '+34 600 123 456',\n}\n```\n\n---\n\n## Next Steps\n\n### Immediate Actions\n\n1. **Generate baselines** (user will run the tests)\n2. **Review screenshots** for quality and coverage\n3. **Commit baselines** to version control\n\n### Future Enhancements\n\n- Add admin panel visual regression tests\n- Add product detail page variations\n- Add cart variations (multiple items, discounts)\n- Integrate into CI/CD pipeline\n- Add visual regression for error pages\n\n---\n\n## Related Documentation\n\n- [Visual Regression README](../../tests/visual-regression/README.md)\n- [Quick Start Guide](../../tests/visual-regression/QUICK-START.md)\n- [E2E Testing Guide](../../tests/e2e/README.md)\n- [Checkout Page Object](../../tests/e2e/page-objects/CheckoutPage.ts)\n\n---\n\n## Maintenance\n\n### When to Update Baselines\n\n- Design system changes\n- Component library updates\n- Intentional UI/UX improvements\n- Bug fixes that change visual appearance\n\n### Review Process\n\n1. Developer updates baselines locally\n2. Commit updated screenshots\n3. PR reviewer checks visual diffs\n4. Approve if changes are intentional\n5. Merge PR with updated baselines\n\n---\n\n**Questions?** See [tests/visual-regression/README.md](../../tests/visual-regression/README.md) for comprehensive documentation.\n",
              "category": "how-to"
            },
            {
              "path": "docs/testing/VISUAL-REGRESSION-SUMMARY.md",
              "name": "VISUAL-REGRESSION-SUMMARY.md",
              "size": 9750,
              "lastModified": "2026-01-06T15:49:37.120Z",
              "content": "# Visual Regression Test Baselines - Implementation Summary\n\n**Created:** 2025-12-26\n**Status:**  Complete - Ready for baseline generation\n**Coverage:** 28 screenshot assertions for Hybrid Progressive Checkout\n\n---\n\n## What Was Created\n\n### 1. Test Implementation\n\n**File:** `tests/visual-regression/checkout-flow.spec.ts`\n- **22 test cases** covering all checkout states\n- **24 screenshot assertions** (28 total with multi-locale)\n- **Coverage:**\n  - Empty state (desktop + mobile)\n  - Guest checkout flow (9 states)\n  - Multi-locale (ES, EN, RO, RU)\n  - Component screenshots (4)\n  - Error states\n  - Express checkout banner (3 states)\n  - Tablet viewport (2 states)\n\n### 2. Documentation\n\nCreated comprehensive documentation:\n\n1. **`tests/visual-regression/README.md`** (9.2 KB)\n   - Complete guide to visual regression testing\n   - Configuration details\n   - Best practices\n   - Troubleshooting guide\n   - CI/CD integration examples\n\n2. **`tests/visual-regression/QUICK-START.md`** (5.5 KB)\n   - Quick reference for common commands\n   - Coverage breakdown\n   - Test categories\n   - Common issues and solutions\n\n3. **`docs/testing/VISUAL-REGRESSION-SETUP.md`**\n   - Project-level documentation\n   - Integration with development workflow\n   - Maintenance guidelines\n\n### 3. Directory Structure\n\n```\ntests/visual-regression/\n README.md                          # Comprehensive guide\n QUICK-START.md                     # Quick reference\n checkout-flow.spec.ts              # NEW: Checkout tests (22 tests)\n critical-pages.spec.ts             # Existing: Other pages\n screenshots/                       # Baseline storage (empty - to be generated)\n    (baselines will be created here)\n critical-pages.spec.ts-snapshots/  # Existing baselines\n```\n\n---\n\n## Screenshot Coverage Details\n\n### Total: 28 Screenshot Assertions\n\n#### 1. Empty State (4 screenshots)\n- `checkout-empty-redirect-desktop.png`\n- `checkout-empty-state-desktop.png`\n- `checkout-empty-redirect-mobile.png`\n- `checkout-empty-state-mobile.png`\n\n#### 2. Guest Checkout Flow (9 screenshots)\n- `checkout-guest-prompt-desktop-en.png`\n- `checkout-guest-initial-desktop.png`\n- `checkout-guest-initial-mobile.png`\n- `checkout-address-filled-desktop.png`\n- `checkout-shipping-methods-desktop.png`\n- `checkout-shipping-selected-desktop.png`\n- `checkout-payment-selected-desktop.png`\n- `checkout-ready-to-order-desktop.png`\n- `checkout-ready-to-order-mobile.png`\n\n#### 3. Multi-Locale Coverage (4 screenshots)\n- `checkout-initial-desktop-es.png` (Spanish)\n- `checkout-initial-desktop-en.png` (English)\n- `checkout-initial-desktop-ro.png` (Romanian)\n- `checkout-initial-desktop-ru.png` (Russian)\n\n#### 4. Component Screenshots (4 screenshots)\n- `component-order-summary-desktop.png`\n- `component-address-form-empty.png`\n- `component-address-form-filled.png`\n- `component-mobile-sticky-footer.png`\n\n#### 5. Error States (1 screenshot)\n- `checkout-validation-errors-desktop.png`\n\n#### 6. Express Checkout Banner (3 screenshots)\n- `checkout-express-banner-desktop.png`\n- `checkout-express-dismissed-desktop.png`\n- `checkout-express-banner-mobile.png`\n\n#### 7. Tablet Viewport (2 screenshots)\n- `checkout-initial-tablet.png`\n- `checkout-ready-to-order-tablet.png`\n\n---\n\n## Test Features\n\n### Dynamic Content Masking\nAutomatically masks changing content to prevent false positives:\n- Item prices\n- Cart totals\n- Order totals\n- Timestamps\n- Loading spinners\n\n### Multi-Viewport Testing\n- **Desktop:** 1920x1080\n- **Tablet:** 768x1024\n- **Mobile:** 375x667\n\n### Tolerance Configuration\n- **Max pixel difference:** 2% (allows minor rendering variations)\n- **Per-pixel threshold:** 0.2 (color tolerance)\n- **Animations:** Disabled for consistent screenshots\n\n### Conditional Tests\nExpress checkout tests skip if authentication credentials not available:\n```typescript\nif (!CriticalTestHelpers.hasTestUserCredentials()) {\n  test.skip()\n  return\n}\n```\n\n---\n\n## Usage Instructions\n\n### Generate Baselines (First Time)\n\n**Prerequisites:**\n1. Start dev server: `npm run dev`\n2. Ensure server is running on `http://localhost:3000`\n\n**Generate all baselines:**\n```bash\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n```\n\n**This will create 28 baseline screenshots in:**\n`tests/visual-regression/screenshots/`\n\n### Run Visual Regression Tests\n\n**Compare against baselines:**\n```bash\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n```\n\n**View results:**\n```bash\nnpx playwright show-report test-results/visual-regression-html\n```\n\n### Update Baselines\n\n**After intentional UI changes:**\n```bash\nnpx playwright test checkout-flow --config=playwright.visual-regression.config.ts --update-snapshots\n```\n\n---\n\n## Test Categories\n\nRun specific categories for faster feedback:\n\n```bash\n# Guest checkout flow only (9 screenshots)\nnpx playwright test checkout-flow -g \"Guest Checkout Flow\" --config=playwright.visual-regression.config.ts\n\n# Multi-locale only (4 screenshots)\nnpx playwright test checkout-flow -g \"Multi-Locale\" --config=playwright.visual-regression.config.ts\n\n# Component screenshots only (4 screenshots)\nnpx playwright test checkout-flow -g \"Component Screenshots\" --config=playwright.visual-regression.config.ts\n\n# Express checkout only (3 screenshots, requires auth)\nnpx playwright test checkout-flow -g \"Express Checkout\" --config=playwright.visual-regression.config.ts\n\n# Tablet viewport only (2 screenshots)\nnpx playwright test checkout-flow -g \"Tablet Viewport\" --config=playwright.visual-regression.config.ts\n\n# Error states only (1 screenshot)\nnpx playwright test checkout-flow -g \"Error States\" --config=playwright.visual-regression.config.ts\n```\n\n---\n\n## Integration with Workflow\n\n### Before Committing Checkout Changes\n\n1. Make UI changes to checkout\n2. Run visual regression tests\n3. If tests fail:\n   - View HTML report: `npx playwright show-report test-results/visual-regression-html`\n   - Review visual diffs\n   - If intentional, update baselines: `--update-snapshots`\n4. Commit code + baseline screenshots together\n\n### Pull Request Workflow\n\n1. Run tests locally before creating PR\n2. Update baselines if needed\n3. Commit baseline screenshots with code changes\n4. PR reviewer checks visual diffs\n5. Approve if changes are intentional\n\n---\n\n## Technical Implementation\n\n### Page Object Model Integration\nUses existing `CheckoutPage` class from E2E tests:\n```typescript\nimport { CheckoutPage } from '../e2e/page-objects/CheckoutPage'\n```\n\n### Test Helpers\nLeverages `CriticalTestHelpers` for consistent operations:\n- `addFirstProductToCart()` - Adds product before checkout\n- `loginAsTestUser()` - For express checkout tests\n- Test data from `TEST_DATA.TEST_ADDRESS`\n\n### Screenshot Options\n```typescript\nconst screenshotOptions = {\n  maxDiffPixelRatio: 0.02,\n  threshold: 0.2,\n  animations: 'disabled' as const,\n}\n```\n\n---\n\n## File Sizes\n\n- `checkout-flow.spec.ts`: 21 KB (716 lines)\n- `README.md`: 9.2 KB (comprehensive guide)\n- `QUICK-START.md`: 5.5 KB (quick reference)\n\n---\n\n## Next Steps\n\n### Immediate (User Action Required)\n\n1. **Generate baselines:**\n   ```bash\n   npm run dev  # Ensure server is running\n   npx playwright test checkout-flow --config=playwright.visual-regression.config.ts\n   ```\n\n2. **Review screenshots:**\n   - Check `tests/visual-regression/screenshots/`\n   - Verify all 28 baselines generated\n   - Ensure screenshots capture expected states\n\n3. **Commit baselines:**\n   ```bash\n   git add tests/visual-regression/screenshots/\n   git add tests/visual-regression/checkout-flow.spec.ts\n   git add tests/visual-regression/README.md\n   git add tests/visual-regression/QUICK-START.md\n   git add docs/testing/VISUAL-REGRESSION-SETUP.md\n   git commit -m \"feat: add visual regression tests for checkout flow\"\n   ```\n\n### Future Enhancements\n\n- Add admin panel visual regression tests\n- Add product detail page variations\n- Add cart variations (multiple items, discounts, promotions)\n- Integrate into CI/CD pipeline\n- Add visual regression for error pages (404, 500)\n- Add visual regression for search results\n- Add visual regression for user account pages\n\n---\n\n## Success Criteria\n\n **Complete:**\n- 22 test cases implemented\n- 28 screenshot assertions created\n- Multi-locale coverage (4 locales)\n- Multi-viewport coverage (desktop, tablet, mobile)\n- Error state coverage\n- Express checkout coverage\n- Component-level screenshots\n- Comprehensive documentation\n- Quick reference guide\n\n **Pending (User Action):**\n- Generate baseline screenshots (first run)\n- Review and approve baselines\n- Commit baselines to repository\n\n---\n\n## Related Files\n\n### Test Files\n- `tests/visual-regression/checkout-flow.spec.ts` - NEW checkout tests\n- `tests/visual-regression/critical-pages.spec.ts` - Existing page tests\n- `playwright.visual-regression.config.ts` - Playwright config\n\n### Page Objects\n- `tests/e2e/page-objects/CheckoutPage.ts` - Checkout page object\n- `tests/e2e/critical/helpers/critical-test-helpers.ts` - Test helpers\n- `tests/e2e/critical/constants.ts` - Test constants\n\n### Documentation\n- `tests/visual-regression/README.md` - Comprehensive guide\n- `tests/visual-regression/QUICK-START.md` - Quick reference\n- `docs/testing/VISUAL-REGRESSION-SETUP.md` - Project docs\n\n---\n\n## Support\n\nFor issues or questions:\n1. Check `tests/visual-regression/README.md` for detailed docs\n2. Check `tests/visual-regression/QUICK-START.md` for common commands\n3. Review Playwright documentation: https://playwright.dev/docs/test-snapshots\n4. Check test output and HTML report for specific failures\n\n---\n\n**Status:**  Implementation complete. Ready for baseline generation.\n**Next:** Run tests to generate 28 baseline screenshots.\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8810348592612716,
          "recommendation": "Consider consolidating into VISUAL-REGRESSION-SETUP.md (most recent) and archiving others"
        },
        {
          "files": [
            {
              "path": "docs/visual-regression/VISUAL_REGRESSION_REVIEW_INDEX.md",
              "name": "VISUAL_REGRESSION_REVIEW_INDEX.md",
              "size": 6434,
              "lastModified": "2026-01-06T15:49:17.486Z",
              "content": "# Visual Regression Testing Review - Documentation Index\n\n**Review Date:** 2025-12-09  \n**Reviewer:** Visual Regression Testing Specialist  \n**Project:** Moldova Direct E-commerce\n\n---\n\n## Start Here\n\n**Read this first:** [VISUAL_REGRESSION_SUMMARY.md](VISUAL_REGRESSION_SUMMARY.md)\n\nThis one-page executive summary answers:\n- Are the \"strange pictures\" a bug? (No!)\n- Are the baselines ready to use? (Yes!)\n- What needs to be fixed? (Config only)\n- How do I fix it? (2 options provided)\n\n---\n\n## Detailed Documentation\n\n### 1. Full Technical Report\n**File:** [VISUAL_REGRESSION_REVIEW_REPORT.md](VISUAL_REGRESSION_REVIEW_REPORT.md)\n\nComprehensive 10-section analysis including:\n- Complete screenshot inventory (13 baselines)\n- Detailed findings per screenshot\n- Test coverage analysis\n- Quality assessment (strengths/weaknesses)\n- Risk assessment\n- Baseline update strategy\n- Comparison workflow for future runs\n\n**Read if:** You want complete technical details and evidence.\n\n### 2. Issues and Fixes Guide\n**File:** [VISUAL_REGRESSION_ISSUES_AND_FIXES.md](VISUAL_REGRESSION_ISSUES_AND_FIXES.md)\n\nStep-by-step fixes for all identified issues:\n- Fix #1: Update testMatch pattern (quick fix)\n- Fix #2: Create dedicated visual regression project (recommended)\n- Fix #3: Update conditional tests to always execute\n- Implementation checklist\n- How-to run commands\n\n**Read if:** You're ready to implement the fixes.\n\n---\n\n## Key Findings Summary\n\n### The \"Strange Pictures\" - RESOLVED\n\n**User Concern:** Screenshots looked unusual, very tall, possibly broken\n\n**Investigation Result:** NOT A BUG\n\n- Homepage mobile: 11,940px tall = 14 content sections (legitimate)\n- Products mobile: 9,762px tall = 12 products stacked (correct layout)\n- Detailed analysis confirmed NO rendering errors, NO duplicate content\n\n**Verdict:** Baselines accurately represent your content-rich pages.\n\n### Configuration Issue - ACTION REQUIRED\n\n**Problem:** Visual regression tests not running in CI/CD\n\n**Cause:** `playwright.config.ts` doesn't include `visual-regression` directory\n\n**Impact:** 5 missing baselines (homepage-desktop, homepage-tablet, filters, category, 404)\n\n**Solution:** Add 1 line to config OR add dedicated project (see Fixes guide)\n\n---\n\n## Quick Statistics\n\n### Baseline Screenshots\n- **Created:** 13/18 (72%)\n- **Missing:** 5/18 (28%)\n- **Total Size:** 5.2 MB\n- **Status:** All valid, production-ready\n\n### Page Heights Analyzed\n**Desktop (1920px wide):**\n- Shortest: 64px (header component)\n- Tallest: 2,982px (products page)\n- Average: ~1,500px\n\n**Mobile (375-492px wide):**\n- Shortest: 1,825px (login page)\n- Tallest: 11,940px (homepage - 14 sections)\n- Average: ~5,800px\n\n### Test Quality Score\n- **Baseline Quality:** 8.5/10\n- **Test Coverage:** 72% (13/18)\n- **Configuration:** Needs update\n- **Overall Confidence:** 95%\n\n---\n\n## Action Items\n\n**Priority:** HIGH\n- [ ] Apply Fix #1 or Fix #2 from Issues & Fixes guide\n- [ ] Run tests to generate 5 missing baselines\n- [ ] Verify all 18 baselines created\n\n**Priority:** MEDIUM\n- [ ] Update conditional tests (Fix #3)\n- [ ] Commit baselines to git\n\n**Priority:** LOW\n- [ ] Fix duplicate ID: `language-switcher-trigger`\n- [ ] Consider multi-locale baselines (en, ro, ru)\n\n---\n\n## How to Use Visual Regression Testing (After Fixes)\n\n### 1. Make Code Changes\nEdit your components, styles, layouts, etc.\n\n### 2. Run Visual Tests\n```bash\nnpx playwright test tests/visual-regression\n```\n\n### 3. Review Results\n- **PASS:** No visual changes detected\n- **FAIL:** Visual differences found (Playwright shows diff images)\n\n### 4. Make Decision\n- **Intentional change?** Update baselines: `npx playwright test --update-snapshots`\n- **Unintended bug?** Fix the code and re-run tests\n\n---\n\n## Files and Locations\n\n### Documentation (Created by this review)\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_SUMMARY.md`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_REVIEW_REPORT.md`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_ISSUES_AND_FIXES.md`\n- `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_REVIEW_INDEX.md` (this file)\n\n### Test Files\n- Test spec: `/Users/vladislavcaraseli/Documents/MoldovaDirect/tests/visual-regression/critical-pages.spec.ts`\n- Config: `/Users/vladislavcaraseli/Documents/MoldovaDirect/playwright.config.ts`\n\n### Baseline Screenshots\n- Directory: `/Users/vladislavcaraseli/Documents/MoldovaDirect/tests/visual-regression/critical-pages.spec.ts-snapshots/`\n- Count: 13 PNG files\n- Total size: ~5.2 MB\n\n---\n\n## Evidence of Analysis\n\nDuring this review, the following tests were executed:\n\n1. **Dimension Analysis:** All 13 screenshots measured and validated\n2. **Homepage Structure Test:** Identified 14 sections totaling 10,783px\n3. **Products Page Test:** Confirmed 12 unique products, no duplicates\n4. **Duplicate Content Check:** Found 1 duplicate ID (non-blocking)\n5. **Element Height Analysis:** Verified no abnormally tall elements\n6. **Page Navigation Tests:** Confirmed all pages load correctly\n\n**Total tests run:** 6 diagnostic test suites\n**Issues found:** 0 rendering bugs\n**Configuration issues:** 1 (testMatch pattern)\n\n---\n\n## Recommendations\n\n### Immediate (Do Now)\n1. Apply configuration fix (1 line change or add project)\n2. Generate missing baselines\n3. Review this documentation with your team\n\n### Short-term (Next Sprint)\n1. Integrate visual regression into CI/CD pipeline\n2. Update conditional tests for better coverage\n3. Fix duplicate ID HTML validation issue\n\n### Long-term (Future Enhancement)\n1. Create locale-specific baselines (en, ro, ru)\n2. Add more component-level screenshots\n3. Expand coverage to error states and edge cases\n\n---\n\n## Questions & Support\n\n**Q: Are the tall screenshots a problem?**\nA: No, they're correct. Your homepage has 14 content sections on mobile.\n\n**Q: Can I use these baselines in production?**\nA: Yes, all 13 existing baselines are valid and production-ready.\n\n**Q: What happens if I don't apply the fixes?**\nA: Visual regression tests won't run automatically. You'll miss 5 baselines.\n\n**Q: How often should I update baselines?**\nA: Only when you intentionally change the UI. Never update to \"make tests pass.\"\n\n**Q: What if tests become flaky?**\nA: Add masking for dynamic content or adjust threshold in screenshotOptions.\n\n---\n\n**Review Complete:** 2025-12-09  \n**Next Review:** After implementing fixes or 30 days\n",
              "category": "how-to"
            },
            {
              "path": "docs/visual-regression/VISUAL_REGRESSION_SUMMARY.md",
              "name": "VISUAL_REGRESSION_SUMMARY.md",
              "size": 4242,
              "lastModified": "2026-01-06T15:49:17.486Z",
              "content": "# Visual Regression Testing Review - Executive Summary\n\n**Date:** 2025-12-09  \n**Status:** BASELINES VALID  | Configuration Needs Update \n\n---\n\n## Quick Verdict\n\n**Your \"strange pictures\" concern: RESOLVED - Not a bug!**\n\nThe extremely tall screenshots (11,940px for homepage mobile, 9,762px for products mobile) are **completely normal** and accurately represent your content-rich pages. After deep analysis:\n\n- Homepage mobile has **14 legitimate content sections** (hero, products, testimonials, FAQ, etc.)\n- Products mobile displays **12 unique products** stacked vertically\n- **No rendering bugs, no duplicates, no infinite scroll issues**\n- All layouts are correct and intentional\n\n**Bottom line:** These baselines are ready to use for visual regression testing.\n\n---\n\n## What Was Found\n\n###  GOOD NEWS (13/18 baselines created successfully)\n\nAll 13 captured screenshots are pixel-perfect representations of your app:\n- Cart pages (empty + with items)\n- Authentication (login + register, desktop + mobile)\n- Product pages (listing + detail, desktop + mobile)\n- Homepage mobile\n- Header + Footer components\n- Search results\n\n**No visual bugs detected.**\n\n###  ISSUE: 5 Missing Baselines\n\n**Root cause:** Playwright config doesn't include `visual-regression` directory in `testMatch` pattern.\n\nMissing screenshots:\n1. Homepage desktop\n2. Homepage tablet  \n3. Product filters sidebar\n4. Category page\n5. 404 error page\n\n---\n\n## How to Fix (Choose One)\n\n### Option 1: Quick Fix (1 line change)\n\nEdit `/Users/vladislavcaraseli/Documents/MoldovaDirect/playwright.config.ts`:\n\n```typescript\ntestMatch: [\n  '**/e2e/**/*.spec.ts',\n  '**/pre-commit/**/*.spec.ts',\n  '**/critical/**/*.spec.ts',\n  '**/visual-regression/**/*.spec.ts'  // ADD THIS LINE\n],\n```\n\nThen run:\n```bash\nnpx playwright test tests/visual-regression --update-snapshots\n```\n\n### Option 2: Better Fix (Dedicated Project)\n\nAdd to `projects` array in `playwright.config.ts`:\n\n```typescript\n{\n  name: 'visual-regression',\n  testDir: './tests/visual-regression',\n  testMatch: '**/*.spec.ts',\n  use: {\n    ...devices['Desktop Chrome'],\n    locale: 'es',\n  },\n  retries: 0,\n  timeout: 60000,\n},\n```\n\nThen run:\n```bash\nnpx playwright test --project=visual-regression --update-snapshots\n```\n\n---\n\n## Screenshot Dimension Analysis\n\n### Desktop (1920px wide)\n- Header: 64px tall (component only)\n- Products: 2,982px tall\n- Average: ~1,500px tall\n\n### Mobile (375-492px wide)\n- Homepage: 11,940px tall (14 sections)\n- Products: 9,762px tall (12 products)\n- Average: ~5,800px tall\n\n**All heights are legitimate - these are full-page screenshots capturing all content.**\n\n---\n\n## Next Steps\n\n1. **Choose Option 1 or Option 2** above to enable visual regression tests\n2. **Run the command** to generate missing baselines\n3. **Commit all screenshots** to git (they're your new baselines)\n4. **On future runs**, Playwright will compare against these baselines and highlight any visual changes\n\n---\n\n## How Visual Regression Works (After Fix)\n\n```bash\n# Make a code change\n# Run visual tests\nnpx playwright test tests/visual-regression\n\n# If test fails:\n# - Playwright shows you a diff image with red highlights\n# - You decide: Is this intentional or a bug?\n# - If intentional: npx playwright test --update-snapshots\n# - If bug: Fix the code and re-run tests\n```\n\n---\n\n## Additional Finding\n\n**Minor issue:** Duplicate HTML ID `language-switcher-trigger` found in the DOM.\n\n- **Impact:** LOW (doesn't affect visual testing)\n- **Recommendation:** Fix for HTML validation/accessibility\n- **Priority:** LOW\n\n---\n\n## Files Referenced\n\n- Test file: `/Users/vladislavcaraseli/Documents/MoldovaDirect/tests/visual-regression/critical-pages.spec.ts`\n- Config file: `/Users/vladislavcaraseli/Documents/MoldovaDirect/playwright.config.ts`\n- Baselines: `/Users/vladislavcaraseli/Documents/MoldovaDirect/tests/visual-regression/critical-pages.spec.ts-snapshots/`\n- Detailed report: `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_REVIEW_REPORT.md`\n- Fixes guide: `/Users/vladislavcaraseli/Documents/MoldovaDirect/VISUAL_REGRESSION_ISSUES_AND_FIXES.md`\n\n---\n\n**Confidence Score: 95%** - The existing baselines are production-ready. Apply the config fix to complete the setup.\n",
              "category": "how-to"
            }
          ],
          "similarity": 0.8082144537912801,
          "recommendation": "Consider consolidating into VISUAL_REGRESSION_REVIEW_INDEX.md (most recent) and archiving others"
        }
      ]
    },
    "gaps": {
      "missingTutorials": [
        "getting-started",
        "first-feature",
        "testing-basics",
        "deployment-basics"
      ],
      "missingHowTos": [
        "checkout",
        "database-migration"
      ],
      "missingReference": [
        "api-reference",
        "architecture",
        "configuration",
        "components"
      ],
      "missingExplanations": [
        "architecture-overview",
        "design-decisions",
        "security-model"
      ],
      "priority": "critical"
    }
  },
  "recommendations": [
    "Found 26 sets of duplicate content. Consider consolidating.",
    "Documentation gaps detected with critical priority. Focus on creating missing content."
  ],
  "generatedAt": "2026-01-15T11:23:51.026Z"
}