# E2E Test Infrastructure Review - GitHub Issues Summary

**Review Date:** 2025-11-01
**Total Issues Created:** 6

---

## ðŸ”´ Critical Priority (P0) - Fix Immediately

### Issue #58: Rotate Exposed Supabase Service Key
**Priority:** P0 - Critical
**Labels:** security, critical, P0
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/58

**Impact:** Exposed service key in `.env.example` grants full database access to anyone with repository access.

**Action Required:**
1. Rotate key in Supabase dashboard immediately
2. Update all environments
3. Remove real key from .env.example

**Estimated Time:** 30 minutes

---

### Issue #59: Remove Hardcoded Test Credentials
**Priority:** P0 - Critical
**Labels:** security, critical, P0, test-infrastructure
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/59

**Impact:** Hardcoded test credentials create potential backdoor accounts.

**Action Required:**
1. Verify accounts don't exist in production
2. Replace hardcoded credentials with environment variables
3. Add database constraint to prevent test accounts

**Estimated Time:** 1 hour

---

## ðŸŸ  High Priority (P1) - Fix This Week

### Issue #60: Fix Global Setup Authentication
**Priority:** P1 - High
**Labels:** bug, P1, test-infrastructure
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/60

**Impact:** Global setup doesn't actually authenticate users, creating empty storage states.

**Action Required:**
1. Implement actual login in global-setup.ts
2. Update authenticatedPage fixture to use storage state
3. Add storage state config to all browser projects

**Estimated Time:** 2-3 hours

---

### Issue #61: Remove Hardcoded Spanish Text
**Priority:** P1 - High
**Labels:** bug, P1, test-infrastructure
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/61

**Impact:** Multi-locale testing completely broken - tests only work in Spanish.

**Action Required:**
1. Add data-testid attributes to components
2. Replace text-based selectors in cart-helpers.ts
3. Verify tests work in all 4 locales

**Estimated Time:** 2-3 hours

---

### Issue #62: Eliminate waitForTimeout Anti-Pattern
**Priority:** P1 - High
**Labels:** performance, P1, test-infrastructure
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/62

**Impact:** 7 instances of arbitrary waits make tests slow and flaky (60-70% slower).

**Action Required:**
1. Replace all waitForTimeout with proper assertions
2. Wait for element state changes instead of fixed delays
3. Add ESLint rule to prevent regression

**Estimated Time:** 4-5 hours

---

## ðŸŸ¡ Medium Priority (P2) - Consider Next Week

### Issue #63: Simplify Over-Engineered Infrastructure
**Priority:** P2 - Medium
**Labels:** enhancement, P2, test-infrastructure
**Link:** https://github.com/caraseli02/MoldovaDirect/issues/63

**Impact:** 1,300+ lines of infrastructure for zero test files - YAGNI violation.

**Action Required:**
1. Choose approach: Radical simplification vs incremental cleanup
2. Delete unused infrastructure (recommended: 95%)
3. Write 3-5 simple tests
4. Extract helpers only when duplicating code 3+ times

**Estimated Time:** 1-2 hours to delete, ongoing to rebuild properly

---

## Timeline Recommendation

### Day 1 (Today)
- [ ] Fix Issue #58 (Rotate service key)
- [ ] Fix Issue #59 (Remove hardcoded credentials)

**Total Time:** ~1.5 hours

### Day 2-3 (This Week)
- [ ] Fix Issue #60 (Global setup auth)
- [ ] Fix Issue #61 (Remove Spanish text)

**Total Time:** ~5 hours

### Day 4 (This Week)
- [ ] Fix Issue #62 (Eliminate waitForTimeout)

**Total Time:** ~4-5 hours

### Day 5 (Next Week)
- [ ] Start Issue #63 (Simplify infrastructure)
- [ ] Write first 3 e2e tests

**Total Time:** Ongoing

---

## Dependencies

```
Issue #58 (P0) â”€â”€â”
                 â”œâ”€â”€> Issue #60 (P1) â”€â”€â”
Issue #59 (P0) â”€â”€â”˜                     â”œâ”€â”€> Issue #63 (P2)
                                       â”‚
Issue #61 (P1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
Issue #62 (P1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Recommendation:** Work through issues in numerical order for smoothest workflow.

---

## Quick Links

- [All Issues](https://github.com/caraseli02/MoldovaDirect/issues?q=is%3Aissue+label%3Atest-infrastructure)
- [P0 Issues](https://github.com/caraseli02/MoldovaDirect/issues?q=is%3Aissue+label%3AP0)
- [P1 Issues](https://github.com/caraseli02/MoldovaDirect/issues?q=is%3Aissue+label%3AP1)
- [Security Issues](https://github.com/caraseli02/MoldovaDirect/issues?q=is%3Aissue+label%3Asecurity)

---

## Tracking Progress

As you complete each issue:

1. Update the issue with progress comments
2. Mark as closed when fully resolved
3. Reference the issue in commit messages:
   ```bash
   git commit -m "security: rotate exposed service key (#58)"
   git commit -m "fix: remove hardcoded test credentials (#59)"
   ```

---

**Generated by:** Claude Code Review System
**Review Command:** `/compounding-engineering:review e2e tests setup files`
**Date:** 2025-11-01
